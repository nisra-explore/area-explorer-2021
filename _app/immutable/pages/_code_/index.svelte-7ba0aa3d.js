import{S as Ba,i as Oa,s as Fa,e as ki,b as Ie,f as bt,g as As,t as Ot,d as zs,h as O,o as Vy,U as $t,V as Dr,j as Uy,O as Fc,l as ce,m as he,n as fe,p as U,W as Lc,q as De,X as Rc,Q as Nc,R as Vc,T as Uc,Y as eu,Z as xo,_ as wo,I as V,K as Lh,E as Ro,$ as Js,J as en,r as we,u as Se,v as Ct,w as Jr,x as Yr,y as Qr,B as $r,a as He,c as Je,M as Kn,G as $u,a0 as jy,a1 as ym,P as Kg,a2 as Xg,a3 as qy,a4 as Zy,a5 as Wg,a6 as of,C as Tu,z as Iu,A as Au}from"../../chunks/index-50f9e43e.js";import{a as zh,u as af,S as Hg,m as La,c as gm,b as Jg,d as Rr,e as sf}from"../../chunks/Section-f82c33d7.js";import{b as El}from"../../chunks/paths-1c47712a.js";import{c as ec,w as Lr,d as hn}from"../../chunks/singletons-2c3f9d32.js";var _m={},Gf={},Kf=34,Th=10,Xf=13;function Gy(c){return new Function("d","return {"+c.map(function(h,f){return JSON.stringify(h)+": d["+f+'] || ""'}).join(",")+"}")}function Yg(c,h){var f=Gy(c);return function(y,v){return h(f(y),v,c)}}function vm(c){var h=Object.create(null),f=[];return c.forEach(function(y){for(var v in y)v in h||f.push(h[v]=v)}),f}function Da(c,h){var f=c+"",y=f.length;return y<h?new Array(h-y+1).join(0)+f:f}function Qg(c){return c<0?"-"+Da(-c,6):c>9999?"+"+Da(c,6):Da(c,4)}function $g(c){var h=c.getUTCHours(),f=c.getUTCMinutes(),y=c.getUTCSeconds(),v=c.getUTCMilliseconds();return isNaN(c)?"Invalid Date":Qg(c.getUTCFullYear())+"-"+Da(c.getUTCMonth()+1,2)+"-"+Da(c.getUTCDate(),2)+(v?"T"+Da(h,2)+":"+Da(f,2)+":"+Da(y,2)+"."+Da(v,3)+"Z":y?"T"+Da(h,2)+":"+Da(f,2)+":"+Da(y,2)+"Z":f||h?"T"+Da(h,2)+":"+Da(f,2)+"Z":"")}function e_(c){var h=new RegExp('["'+c+`
\r]`),f=c.charCodeAt(0);function y(G,j){var H,de,Ce=v(G,function(xe,Xe){if(H)return H(xe,Xe-1);de=xe,H=j?Yg(xe,j):Gy(xe)});return Ce.columns=de||[],Ce}function v(G,j){var H=[],de=G.length,Ce=0,xe=0,Xe,Ue=de<=0,Bt=!1;G.charCodeAt(de-1)===Th&&--de,G.charCodeAt(de-1)===Xf&&--de;function St(){if(Ue)return Gf;if(Bt)return Bt=!1,_m;var We,tr=Ce,Xt;if(G.charCodeAt(tr)===Kf){for(;Ce++<de&&G.charCodeAt(Ce)!==Kf||G.charCodeAt(++Ce)===Kf;);return(We=Ce)>=de?Ue=!0:(Xt=G.charCodeAt(Ce++))===Th?Bt=!0:Xt===Xf&&(Bt=!0,G.charCodeAt(Ce)===Th&&++Ce),G.slice(tr+1,We-1).replace(/""/g,'"')}for(;Ce<de;){if((Xt=G.charCodeAt(We=Ce++))===Th)Bt=!0;else if(Xt===Xf)Bt=!0,G.charCodeAt(Ce)===Th&&++Ce;else if(Xt!==f)continue;return G.slice(tr,We)}return Ue=!0,G.slice(tr,de)}for(;(Xe=St())!==Gf;){for(var ut=[];Xe!==_m&&Xe!==Gf;)ut.push(Xe),Xe=St();j&&(ut=j(ut,xe++))==null||H.push(ut)}return H}function x(G,j){return G.map(function(H){return j.map(function(de){return B(H[de])}).join(c)})}function a(G,j){return j==null&&(j=vm(G)),[j.map(B).join(c)].concat(x(G,j)).join(`
`)}function A(G,j){return j==null&&(j=vm(G)),x(G,j).join(`
`)}function I(G){return G.map(R).join(`
`)}function R(G){return G.map(B).join(c)}function B(G){return G==null?"":G instanceof Date?$g(G):h.test(G+="")?'"'+G.replace(/"/g,'""')+'"':G}return{parse:y,parseRows:v,format:a,formatBody:A,formatRows:I,formatRow:R,formatValue:B}}var t_=e_(","),r_=t_.parse;function i_(c){for(var h in c){var f=c[h].trim(),y,v;if(!f)f=null;else if(f==="true")f=!0;else if(f==="false")f=!1;else if(f==="NaN")f=NaN;else if(!isNaN(y=+f))f=y;else if(v=f.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))n_&&!!v[4]&&!v[7]&&(f=f.replace(/-/g,"/").replace(/T/," ")),f=new Date(f);else continue;c[h]=f}return c}const n_=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();async function o_(c,h=window.fetch){let y=await(await h(c)).text();return await r_(y,i_)}function zu(c){let h=Math.round(c)%10;return c==11?"th":h==1?"st":h==2?"nd":h==3?"rd":"th"}function lf(c){return c>0?"increase":c<0?"decrease":"nochange"}function sr(c,h="",f=0){return c!=0?Math.abs(c).toFixed(f)+h:h=="pp"?"n/c":"No change"}function bm(c,h="",f=0){return c!=0?Math.abs(c).toFixed(f)+h:h=="pp"?"n/c":"<1%)"}ec.disable_scroll_handling;const xm=ec.goto;ec.invalidate;ec.prefetch;ec.prefetch_routes;ec.before_navigate;ec.after_navigate;function a_(c){return c===0?!0:c}function ku(c){return a_(c)?Array.isArray(c)?h=>c.map(f=>typeof f!="function"?h[f]:f(h)):typeof c!="function"?h=>h[c]:c:null}function s_(c){const h={};for(const f of c){if(Object(f)!==f)throw new TypeError("iterable for fromEntries should yield objects");const{"0":y,"1":v}=f;Object.defineProperty(h,y,{configurable:!0,enumerable:!0,writable:!0,value:v})}return h}function Wf(c,h={}){return s_(Object.entries(c).filter(([f,y])=>y!==void 0&&h[f]===void 0))}function l_(c,h){if(!Array.isArray(c))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof c}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(h)||h===void 0||h===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const f={},y=Object.keys(h),v=y.length;let x,a,A,I,R,B,G,j;const H=c.length;for(x=0;x<v;x+=1){for(I=y[x],G=h[I],R=null,B=null,a=0;a<H;a+=1)if(j=G(c[a]),Array.isArray(j)){const de=j.length;for(A=0;A<de;A+=1)j[A]!==void 0&&j[A]!==null&&Number.isNaN(j[A])===!1&&((R===null||j[A]<R)&&(R=j[A]),(B===null||j[A]>B)&&(B=j[A]))}else j!=null&&Number.isNaN(j)===!1&&((R===null||j<R)&&(R=j),(B===null||j>B)&&(B=j));f[I]=[R,B]}return f}function Ky(c=[],h){return Array.isArray(h)===!0?h.map((f,y)=>f===null?c[y]:f):c}function Xp(c){return function([f,y]){return f?Ky(f[c],y):y}}function rf(c,h){return c==null||h==null?NaN:c<h?-1:c>h?1:c>=h?0:NaN}function u_(c,h){return c==null||h==null?NaN:h<c?-1:h>c?1:h>=c?0:NaN}function Xy(c){let h,f,y;c.length!==2?(h=rf,f=(A,I)=>rf(c(A),I),y=(A,I)=>c(A)-I):(h=c===rf||c===u_?c:c_,f=c,y=c);function v(A,I,R=0,B=A.length){if(R<B){if(h(I,I)!==0)return B;do{const G=R+B>>>1;f(A[G],I)<0?R=G+1:B=G}while(R<B)}return R}function x(A,I,R=0,B=A.length){if(R<B){if(h(I,I)!==0)return B;do{const G=R+B>>>1;f(A[G],I)<=0?R=G+1:B=G}while(R<B)}return R}function a(A,I,R=0,B=A.length){const G=v(A,I,R,B-1);return G>R&&y(A[G-1],I)>-y(A[G],I)?G-1:G}return{left:v,center:a,right:x}}function c_(){return 0}function h_(c){return c===null?NaN:+c}const p_=Xy(rf),f_=p_.right;Xy(h_).center;const d_=f_;class wm extends Map{constructor(h,f=g_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:f}}),h!=null)for(const[y,v]of h)this.set(y,v)}get(h){return super.get(Sm(this,h))}has(h){return super.has(Sm(this,h))}set(h,f){return super.set(m_(this,h),f)}delete(h){return super.delete(y_(this,h))}}function Sm({_intern:c,_key:h},f){const y=h(f);return c.has(y)?c.get(y):f}function m_({_intern:c,_key:h},f){const y=h(f);return c.has(y)?c.get(y):(c.set(y,f),f)}function y_({_intern:c,_key:h},f){const y=h(f);return c.has(y)&&(f=c.get(y),c.delete(y)),f}function g_(c){return c!==null&&typeof c=="object"?c.valueOf():c}var ed=Math.sqrt(50),td=Math.sqrt(10),rd=Math.sqrt(2);function __(c,h,f){var y,v=-1,x,a,A;if(h=+h,c=+c,f=+f,c===h&&f>0)return[c];if((y=h<c)&&(x=c,c=h,h=x),(A=Wy(c,h,f))===0||!isFinite(A))return[];if(A>0){let I=Math.round(c/A),R=Math.round(h/A);for(I*A<c&&++I,R*A>h&&--R,a=new Array(x=R-I+1);++v<x;)a[v]=(I+v)*A}else{A=-A;let I=Math.round(c*A),R=Math.round(h*A);for(I/A<c&&++I,R/A>h&&--R,a=new Array(x=R-I+1);++v<x;)a[v]=(I+v)/A}return y&&a.reverse(),a}function Wy(c,h,f){var y=(h-c)/Math.max(0,f),v=Math.floor(Math.log(y)/Math.LN10),x=y/Math.pow(10,v);return v>=0?(x>=ed?10:x>=td?5:x>=rd?2:1)*Math.pow(10,v):-Math.pow(10,-v)/(x>=ed?10:x>=td?5:x>=rd?2:1)}function v_(c,h,f){var y=Math.abs(h-c)/Math.max(0,f),v=Math.pow(10,Math.floor(Math.log(y)/Math.LN10)),x=y/v;return x>=ed?v*=10:x>=td?v*=5:x>=rd&&(v*=2),h<c?-v:v}function b_(c,h,f){c=+c,h=+h,f=(v=arguments.length)<2?(h=c,c=0,1):v<3?1:+f;for(var y=-1,v=Math.max(0,Math.ceil((h-c)/f))|0,x=new Array(v);++y<v;)x[y]=c+y*f;return x}function df(c,h){switch(arguments.length){case 0:break;case 1:this.range(c);break;default:this.range(h).domain(c);break}return this}const Em=Symbol("implicit");function Hy(){var c=new wm,h=[],f=[],y=Em;function v(x){let a=c.get(x);if(a===void 0){if(y!==Em)return y;c.set(x,a=h.push(x)-1)}return f[a%f.length]}return v.domain=function(x){if(!arguments.length)return h.slice();h=[],c=new wm;for(const a of x)c.has(a)||c.set(a,h.push(a)-1);return v},v.range=function(x){return arguments.length?(f=Array.from(x),v):f.slice()},v.unknown=function(x){return arguments.length?(y=x,v):y},v.copy=function(){return Hy(h,f).unknown(y)},df.apply(v,arguments),v}function Jy(){var c=Hy().unknown(void 0),h=c.domain,f=c.range,y=0,v=1,x,a,A=!1,I=0,R=0,B=.5;delete c.unknown;function G(){var j=h().length,H=v<y,de=H?v:y,Ce=H?y:v;x=(Ce-de)/Math.max(1,j-I+R*2),A&&(x=Math.floor(x)),de+=(Ce-de-x*(j-I))*B,a=x*(1-I),A&&(de=Math.round(de),a=Math.round(a));var xe=b_(j).map(function(Xe){return de+x*Xe});return f(H?xe.reverse():xe)}return c.domain=function(j){return arguments.length?(h(j),G()):h()},c.range=function(j){return arguments.length?([y,v]=j,y=+y,v=+v,G()):[y,v]},c.rangeRound=function(j){return[y,v]=j,y=+y,v=+v,A=!0,G()},c.bandwidth=function(){return a},c.step=function(){return x},c.round=function(j){return arguments.length?(A=!!j,G()):A},c.padding=function(j){return arguments.length?(I=Math.min(1,R=+j),G()):I},c.paddingInner=function(j){return arguments.length?(I=Math.min(1,j),G()):I},c.paddingOuter=function(j){return arguments.length?(R=+j,G()):R},c.align=function(j){return arguments.length?(B=Math.max(0,Math.min(1,j)),G()):B},c.copy=function(){return Jy(h(),[y,v]).round(A).paddingInner(I).paddingOuter(R).align(B)},df.apply(G(),arguments)}function sd(c,h,f){c.prototype=h.prototype=f,f.constructor=c}function Yy(c,h){var f=Object.create(c.prototype);for(var y in h)f[y]=h[y];return f}function Rh(){}var Ch=.7,uf=1/Ch,Bc="\\s*([+-]?\\d+)\\s*",Mh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Sl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",x_=/^#([0-9a-f]{3,8})$/,w_=new RegExp(`^rgb\\(${Bc},${Bc},${Bc}\\)$`),S_=new RegExp(`^rgb\\(${Sl},${Sl},${Sl}\\)$`),E_=new RegExp(`^rgba\\(${Bc},${Bc},${Bc},${Mh}\\)$`),k_=new RegExp(`^rgba\\(${Sl},${Sl},${Sl},${Mh}\\)$`),T_=new RegExp(`^hsl\\(${Mh},${Sl},${Sl}\\)$`),I_=new RegExp(`^hsla\\(${Mh},${Sl},${Sl},${Mh}\\)$`),km={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};sd(Rh,Dh,{copy(c){return Object.assign(new this.constructor,this,c)},displayable(){return this.rgb().displayable()},hex:Tm,formatHex:Tm,formatHex8:A_,formatHsl:z_,formatRgb:Im,toString:Im});function Tm(){return this.rgb().formatHex()}function A_(){return this.rgb().formatHex8()}function z_(){return Qy(this).formatHsl()}function Im(){return this.rgb().formatRgb()}function Dh(c){var h,f;return c=(c+"").trim().toLowerCase(),(h=x_.exec(c))?(f=h[1].length,h=parseInt(h[1],16),f===6?Am(h):f===3?new Ra(h>>8&15|h>>4&240,h>>4&15|h&240,(h&15)<<4|h&15,1):f===8?Wp(h>>24&255,h>>16&255,h>>8&255,(h&255)/255):f===4?Wp(h>>12&15|h>>8&240,h>>8&15|h>>4&240,h>>4&15|h&240,((h&15)<<4|h&15)/255):null):(h=w_.exec(c))?new Ra(h[1],h[2],h[3],1):(h=S_.exec(c))?new Ra(h[1]*255/100,h[2]*255/100,h[3]*255/100,1):(h=E_.exec(c))?Wp(h[1],h[2],h[3],h[4]):(h=k_.exec(c))?Wp(h[1]*255/100,h[2]*255/100,h[3]*255/100,h[4]):(h=T_.exec(c))?Cm(h[1],h[2]/100,h[3]/100,1):(h=I_.exec(c))?Cm(h[1],h[2]/100,h[3]/100,h[4]):km.hasOwnProperty(c)?Am(km[c]):c==="transparent"?new Ra(NaN,NaN,NaN,0):null}function Am(c){return new Ra(c>>16&255,c>>8&255,c&255,1)}function Wp(c,h,f,y){return y<=0&&(c=h=f=NaN),new Ra(c,h,f,y)}function P_(c){return c instanceof Rh||(c=Dh(c)),c?(c=c.rgb(),new Ra(c.r,c.g,c.b,c.opacity)):new Ra}function id(c,h,f,y){return arguments.length===1?P_(c):new Ra(c,h,f,y==null?1:y)}function Ra(c,h,f,y){this.r=+c,this.g=+h,this.b=+f,this.opacity=+y}sd(Ra,id,Yy(Rh,{brighter(c){return c=c==null?uf:Math.pow(uf,c),new Ra(this.r*c,this.g*c,this.b*c,this.opacity)},darker(c){return c=c==null?Ch:Math.pow(Ch,c),new Ra(this.r*c,this.g*c,this.b*c,this.opacity)},rgb(){return this},clamp(){return new Ra(Qu(this.r),Qu(this.g),Qu(this.b),cf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zm,formatHex:zm,formatHex8:C_,formatRgb:Pm,toString:Pm}));function zm(){return`#${Yu(this.r)}${Yu(this.g)}${Yu(this.b)}`}function C_(){return`#${Yu(this.r)}${Yu(this.g)}${Yu(this.b)}${Yu((isNaN(this.opacity)?1:this.opacity)*255)}`}function Pm(){const c=cf(this.opacity);return`${c===1?"rgb(":"rgba("}${Qu(this.r)}, ${Qu(this.g)}, ${Qu(this.b)}${c===1?")":`, ${c})`}`}function cf(c){return isNaN(c)?1:Math.max(0,Math.min(1,c))}function Qu(c){return Math.max(0,Math.min(255,Math.round(c)||0))}function Yu(c){return c=Qu(c),(c<16?"0":"")+c.toString(16)}function Cm(c,h,f,y){return y<=0?c=h=f=NaN:f<=0||f>=1?c=h=NaN:h<=0&&(c=NaN),new Hs(c,h,f,y)}function Qy(c){if(c instanceof Hs)return new Hs(c.h,c.s,c.l,c.opacity);if(c instanceof Rh||(c=Dh(c)),!c)return new Hs;if(c instanceof Hs)return c;c=c.rgb();var h=c.r/255,f=c.g/255,y=c.b/255,v=Math.min(h,f,y),x=Math.max(h,f,y),a=NaN,A=x-v,I=(x+v)/2;return A?(h===x?a=(f-y)/A+(f<y)*6:f===x?a=(y-h)/A+2:a=(h-f)/A+4,A/=I<.5?x+v:2-x-v,a*=60):A=I>0&&I<1?0:a,new Hs(a,A,I,c.opacity)}function M_(c,h,f,y){return arguments.length===1?Qy(c):new Hs(c,h,f,y==null?1:y)}function Hs(c,h,f,y){this.h=+c,this.s=+h,this.l=+f,this.opacity=+y}sd(Hs,M_,Yy(Rh,{brighter(c){return c=c==null?uf:Math.pow(uf,c),new Hs(this.h,this.s,this.l*c,this.opacity)},darker(c){return c=c==null?Ch:Math.pow(Ch,c),new Hs(this.h,this.s,this.l*c,this.opacity)},rgb(){var c=this.h%360+(this.h<0)*360,h=isNaN(c)||isNaN(this.s)?0:this.s,f=this.l,y=f+(f<.5?f:1-f)*h,v=2*f-y;return new Ra(Hf(c>=240?c-240:c+120,v,y),Hf(c,v,y),Hf(c<120?c+240:c-120,v,y),this.opacity)},clamp(){return new Hs(Mm(this.h),Hp(this.s),Hp(this.l),cf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const c=cf(this.opacity);return`${c===1?"hsl(":"hsla("}${Mm(this.h)}, ${Hp(this.s)*100}%, ${Hp(this.l)*100}%${c===1?")":`, ${c})`}`}}));function Mm(c){return c=(c||0)%360,c<0?c+360:c}function Hp(c){return Math.max(0,Math.min(1,c||0))}function Hf(c,h,f){return(c<60?h+(f-h)*c/60:c<180?f:c<240?h+(f-h)*(240-c)/60:h)*255}const ld=c=>()=>c;function D_(c,h){return function(f){return c+f*h}}function L_(c,h,f){return c=Math.pow(c,f),h=Math.pow(h,f)-c,f=1/f,function(y){return Math.pow(c+y*h,f)}}function R_(c){return(c=+c)==1?$y:function(h,f){return f-h?L_(h,f,c):ld(isNaN(h)?f:h)}}function $y(c,h){var f=h-c;return f?D_(c,f):ld(isNaN(c)?h:c)}const Dm=function c(h){var f=R_(h);function y(v,x){var a=f((v=id(v)).r,(x=id(x)).r),A=f(v.g,x.g),I=f(v.b,x.b),R=$y(v.opacity,x.opacity);return function(B){return v.r=a(B),v.g=A(B),v.b=I(B),v.opacity=R(B),v+""}}return y.gamma=c,y}(1);function B_(c,h){h||(h=[]);var f=c?Math.min(h.length,c.length):0,y=h.slice(),v;return function(x){for(v=0;v<f;++v)y[v]=c[v]*(1-x)+h[v]*x;return y}}function O_(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}function F_(c,h){var f=h?h.length:0,y=c?Math.min(f,c.length):0,v=new Array(y),x=new Array(f),a;for(a=0;a<y;++a)v[a]=ud(c[a],h[a]);for(;a<f;++a)x[a]=h[a];return function(A){for(a=0;a<y;++a)x[a]=v[a](A);return x}}function N_(c,h){var f=new Date;return c=+c,h=+h,function(y){return f.setTime(c*(1-y)+h*y),f}}function hf(c,h){return c=+c,h=+h,function(f){return c*(1-f)+h*f}}function V_(c,h){var f={},y={},v;(c===null||typeof c!="object")&&(c={}),(h===null||typeof h!="object")&&(h={});for(v in h)v in c?f[v]=ud(c[v],h[v]):y[v]=h[v];return function(x){for(v in f)y[v]=f[v](x);return y}}var nd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jf=new RegExp(nd.source,"g");function U_(c){return function(){return c}}function j_(c){return function(h){return c(h)+""}}function q_(c,h){var f=nd.lastIndex=Jf.lastIndex=0,y,v,x,a=-1,A=[],I=[];for(c=c+"",h=h+"";(y=nd.exec(c))&&(v=Jf.exec(h));)(x=v.index)>f&&(x=h.slice(f,x),A[a]?A[a]+=x:A[++a]=x),(y=y[0])===(v=v[0])?A[a]?A[a]+=v:A[++a]=v:(A[++a]=null,I.push({i:a,x:hf(y,v)})),f=Jf.lastIndex;return f<h.length&&(x=h.slice(f),A[a]?A[a]+=x:A[++a]=x),A.length<2?I[0]?j_(I[0].x):U_(h):(h=I.length,function(R){for(var B=0,G;B<h;++B)A[(G=I[B]).i]=G.x(R);return A.join("")})}function ud(c,h){var f=typeof h,y;return h==null||f==="boolean"?ld(h):(f==="number"?hf:f==="string"?(y=Dh(h))?(h=y,Dm):q_:h instanceof Dh?Dm:h instanceof Date?N_:O_(h)?B_:Array.isArray(h)?F_:typeof h.valueOf!="function"&&typeof h.toString!="function"||isNaN(h)?V_:hf)(c,h)}function Z_(c,h){return c=+c,h=+h,function(f){return Math.round(c*(1-f)+h*f)}}function G_(c){return function(){return c}}function K_(c){return+c}var Lm=[0,1];function wl(c){return c}function od(c,h){return(h-=c=+c)?function(f){return(f-c)/h}:G_(isNaN(h)?NaN:.5)}function X_(c,h){var f;return c>h&&(f=c,c=h,h=f),function(y){return Math.max(c,Math.min(h,y))}}function W_(c,h,f){var y=c[0],v=c[1],x=h[0],a=h[1];return v<y?(y=od(v,y),x=f(a,x)):(y=od(y,v),x=f(x,a)),function(A){return x(y(A))}}function H_(c,h,f){var y=Math.min(c.length,h.length)-1,v=new Array(y),x=new Array(y),a=-1;for(c[y]<c[0]&&(c=c.slice().reverse(),h=h.slice().reverse());++a<y;)v[a]=od(c[a],c[a+1]),x[a]=f(h[a],h[a+1]);return function(A){var I=d_(c,A,1,y)-1;return x[I](v[I](A))}}function eg(c,h){return h.domain(c.domain()).range(c.range()).interpolate(c.interpolate()).clamp(c.clamp()).unknown(c.unknown())}function tg(){var c=Lm,h=Lm,f=ud,y,v,x,a=wl,A,I,R;function B(){var j=Math.min(c.length,h.length);return a!==wl&&(a=X_(c[0],c[j-1])),A=j>2?H_:W_,I=R=null,G}function G(j){return j==null||isNaN(j=+j)?x:(I||(I=A(c.map(y),h,f)))(y(a(j)))}return G.invert=function(j){return a(v((R||(R=A(h,c.map(y),hf)))(j)))},G.domain=function(j){return arguments.length?(c=Array.from(j,K_),B()):c.slice()},G.range=function(j){return arguments.length?(h=Array.from(j),B()):h.slice()},G.rangeRound=function(j){return h=Array.from(j),f=Z_,B()},G.clamp=function(j){return arguments.length?(a=j?!0:wl,B()):a!==wl},G.interpolate=function(j){return arguments.length?(f=j,B()):f},G.unknown=function(j){return arguments.length?(x=j,G):x},function(j,H){return y=j,v=H,B()}}function J_(){return tg()(wl,wl)}function Y_(c){return Math.abs(c=Math.round(c))>=1e21?c.toLocaleString("en").replace(/,/g,""):c.toString(10)}function pf(c,h){if((f=(c=h?c.toExponential(h-1):c.toExponential()).indexOf("e"))<0)return null;var f,y=c.slice(0,f);return[y.length>1?y[0]+y.slice(2):y,+c.slice(f+1)]}function jc(c){return c=pf(Math.abs(c)),c?c[1]:NaN}function Q_(c,h){return function(f,y){for(var v=f.length,x=[],a=0,A=c[0],I=0;v>0&&A>0&&(I+A+1>y&&(A=Math.max(1,y-I)),x.push(f.substring(v-=A,v+A)),!((I+=A+1)>y));)A=c[a=(a+1)%c.length];return x.reverse().join(h)}}function $_(c){return function(h){return h.replace(/[0-9]/g,function(f){return c[+f]})}}var ev=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ff(c){if(!(h=ev.exec(c)))throw new Error("invalid format: "+c);var h;return new cd({fill:h[1],align:h[2],sign:h[3],symbol:h[4],zero:h[5],width:h[6],comma:h[7],precision:h[8]&&h[8].slice(1),trim:h[9],type:h[10]})}ff.prototype=cd.prototype;function cd(c){this.fill=c.fill===void 0?" ":c.fill+"",this.align=c.align===void 0?">":c.align+"",this.sign=c.sign===void 0?"-":c.sign+"",this.symbol=c.symbol===void 0?"":c.symbol+"",this.zero=!!c.zero,this.width=c.width===void 0?void 0:+c.width,this.comma=!!c.comma,this.precision=c.precision===void 0?void 0:+c.precision,this.trim=!!c.trim,this.type=c.type===void 0?"":c.type+""}cd.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function tv(c){e:for(var h=c.length,f=1,y=-1,v;f<h;++f)switch(c[f]){case".":y=v=f;break;case"0":y===0&&(y=f),v=f;break;default:if(!+c[f])break e;y>0&&(y=0);break}return y>0?c.slice(0,y)+c.slice(v+1):c}var rg;function rv(c,h){var f=pf(c,h);if(!f)return c+"";var y=f[0],v=f[1],x=v-(rg=Math.max(-8,Math.min(8,Math.floor(v/3)))*3)+1,a=y.length;return x===a?y:x>a?y+new Array(x-a+1).join("0"):x>0?y.slice(0,x)+"."+y.slice(x):"0."+new Array(1-x).join("0")+pf(c,Math.max(0,h+x-1))[0]}function Rm(c,h){var f=pf(c,h);if(!f)return c+"";var y=f[0],v=f[1];return v<0?"0."+new Array(-v).join("0")+y:y.length>v+1?y.slice(0,v+1)+"."+y.slice(v+1):y+new Array(v-y.length+2).join("0")}const Bm={"%":(c,h)=>(c*100).toFixed(h),b:c=>Math.round(c).toString(2),c:c=>c+"",d:Y_,e:(c,h)=>c.toExponential(h),f:(c,h)=>c.toFixed(h),g:(c,h)=>c.toPrecision(h),o:c=>Math.round(c).toString(8),p:(c,h)=>Rm(c*100,h),r:Rm,s:rv,X:c=>Math.round(c).toString(16).toUpperCase(),x:c=>Math.round(c).toString(16)};function Om(c){return c}var Fm=Array.prototype.map,Nm=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function iv(c){var h=c.grouping===void 0||c.thousands===void 0?Om:Q_(Fm.call(c.grouping,Number),c.thousands+""),f=c.currency===void 0?"":c.currency[0]+"",y=c.currency===void 0?"":c.currency[1]+"",v=c.decimal===void 0?".":c.decimal+"",x=c.numerals===void 0?Om:$_(Fm.call(c.numerals,String)),a=c.percent===void 0?"%":c.percent+"",A=c.minus===void 0?"\u2212":c.minus+"",I=c.nan===void 0?"NaN":c.nan+"";function R(G){G=ff(G);var j=G.fill,H=G.align,de=G.sign,Ce=G.symbol,xe=G.zero,Xe=G.width,Ue=G.comma,Bt=G.precision,St=G.trim,ut=G.type;ut==="n"?(Ue=!0,ut="g"):Bm[ut]||(Bt===void 0&&(Bt=12),St=!0,ut="g"),(xe||j==="0"&&H==="=")&&(xe=!0,j="0",H="=");var We=Ce==="$"?f:Ce==="#"&&/[boxX]/.test(ut)?"0"+ut.toLowerCase():"",tr=Ce==="$"?y:/[%p]/.test(ut)?a:"",Xt=Bm[ut],xt=/[defgprs%]/.test(ut);Bt=Bt===void 0?6:/[gprs]/.test(ut)?Math.max(1,Math.min(21,Bt)):Math.max(0,Math.min(20,Bt));function qt(Ge){var Rt=We,yt=tr,gt,Le,Ne;if(ut==="c")yt=Xt(Ge)+yt,Ge="";else{Ge=+Ge;var Et=Ge<0||1/Ge<0;if(Ge=isNaN(Ge)?I:Xt(Math.abs(Ge),Bt),St&&(Ge=tv(Ge)),Et&&+Ge==0&&de!=="+"&&(Et=!1),Rt=(Et?de==="("?de:A:de==="-"||de==="("?"":de)+Rt,yt=(ut==="s"?Nm[8+rg/3]:"")+yt+(Et&&de==="("?")":""),xt){for(gt=-1,Le=Ge.length;++gt<Le;)if(Ne=Ge.charCodeAt(gt),48>Ne||Ne>57){yt=(Ne===46?v+Ge.slice(gt+1):Ge.slice(gt))+yt,Ge=Ge.slice(0,gt);break}}}Ue&&!xe&&(Ge=h(Ge,1/0));var mr=Rt.length+Ge.length+yt.length,Wt=mr<Xe?new Array(Xe-mr+1).join(j):"";switch(Ue&&xe&&(Ge=h(Wt+Ge,Wt.length?Xe-yt.length:1/0),Wt=""),H){case"<":Ge=Rt+Ge+yt+Wt;break;case"=":Ge=Rt+Wt+Ge+yt;break;case"^":Ge=Wt.slice(0,mr=Wt.length>>1)+Rt+Ge+yt+Wt.slice(mr);break;default:Ge=Wt+Rt+Ge+yt;break}return x(Ge)}return qt.toString=function(){return G+""},qt}function B(G,j){var H=R((G=ff(G),G.type="f",G)),de=Math.max(-8,Math.min(8,Math.floor(jc(j)/3)))*3,Ce=Math.pow(10,-de),xe=Nm[8+de/3];return function(Xe){return H(Ce*Xe)+xe}}return{format:R,formatPrefix:B}}var Jp,ig,ng;nv({thousands:",",grouping:[3],currency:["$",""]});function nv(c){return Jp=iv(c),ig=Jp.format,ng=Jp.formatPrefix,Jp}function ov(c){return Math.max(0,-jc(Math.abs(c)))}function av(c,h){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(jc(h)/3)))*3-jc(Math.abs(c)))}function sv(c,h){return c=Math.abs(c),h=Math.abs(h)-c,Math.max(0,jc(h)-jc(c))+1}function lv(c,h,f,y){var v=v_(c,h,f),x;switch(y=ff(y==null?",f":y),y.type){case"s":{var a=Math.max(Math.abs(c),Math.abs(h));return y.precision==null&&!isNaN(x=av(v,a))&&(y.precision=x),ng(y,a)}case"":case"e":case"g":case"p":case"r":{y.precision==null&&!isNaN(x=sv(v,Math.max(Math.abs(c),Math.abs(h))))&&(y.precision=x-(y.type==="e"));break}case"f":case"%":{y.precision==null&&!isNaN(x=ov(v))&&(y.precision=x-(y.type==="%")*2);break}}return ig(y)}function og(c){var h=c.domain;return c.ticks=function(f){var y=h();return __(y[0],y[y.length-1],f==null?10:f)},c.tickFormat=function(f,y){var v=h();return lv(v[0],v[v.length-1],f==null?10:f,y)},c.nice=function(f){f==null&&(f=10);var y=h(),v=0,x=y.length-1,a=y[v],A=y[x],I,R,B=10;for(A<a&&(R=a,a=A,A=R,R=v,v=x,x=R);B-- >0;){if(R=Wy(a,A,f),R===I)return y[v]=a,y[x]=A,h(y);if(R>0)a=Math.floor(a/R)*R,A=Math.ceil(A/R)*R;else if(R<0)a=Math.ceil(a*R)/R,A=Math.floor(A*R)/R;else break;I=R}return c},c}function nf(){var c=J_();return c.copy=function(){return eg(c,nf())},df.apply(c,arguments),og(c)}function Vm(c){return function(h){return h<0?-Math.pow(-h,c):Math.pow(h,c)}}function uv(c){return c<0?-Math.sqrt(-c):Math.sqrt(c)}function cv(c){return c<0?-c*c:c*c}function hv(c){var h=c(wl,wl),f=1;function y(){return f===1?c(wl,wl):f===.5?c(uv,cv):c(Vm(f),Vm(1/f))}return h.exponent=function(v){return arguments.length?(f=+v,y()):f},og(h)}function ag(){var c=hv(tg());return c.copy=function(){return eg(c,ag()).exponent(c.exponent())},df.apply(c,arguments),c}function pv(){return ag.apply(null,arguments).exponent(.5)}const Ah={x:nf,y:nf,z:nf,r:pv};function fv(c){return c.constant?"symlog":c.base?"log":c.exponent?c.exponent()===.5?"sqrt":"pow":"other"}function Um(c){return c}function dv(c){return h=>Math.log(c*h)}function mv(c){return h=>c*Math.exp(h)}function yv(c){return h=>Math.sign(h)*Math.log1p(Math.abs(h/c))}function gv(c){return h=>Math.sign(h)*Math.expm1(Math.abs(h))*c}function Yp(c){return function(f){return f<0?-Math.pow(-f,c):Math.pow(f,c)}}function _v(c){const h=fv(c);if(h==="log"){const f=Math.sign(c.domain()[0]);return{lift:dv(f),ground:mv(f),scaleType:h}}return h==="pow"?{lift:Yp(1),ground:Yp(1/1),scaleType:h}:h==="sqrt"?{lift:Yp(.5),ground:Yp(1/.5),scaleType:h}:h==="symlog"?{lift:yv(1),ground:gv(1),scaleType:h}:{lift:Um,ground:Um,scaleType:h}}function vv(c,h){if(typeof c.range!="function")throw new Error("Scale method `range` must be a function");if(typeof c.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(h))return c.domain();c.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",c.domain()),c.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",c.range());const{lift:f,ground:y}=_v(c),v=c.domain()[0],x=Object.prototype.toString.call(v)==="[object Date]",[a,A]=c.domain().map(H=>f(x?H.getTime():H)),[I,R]=c.range(),B=h[0]||0,G=h[1]||0,j=(A-a)/(Math.abs(R-I)-B-G);return[a-B*j,G*j+A].map(H=>y(x?new Date(H):H))}function bv(c,h,f,y,v){let x,a;return v===!0?(x=0,a=100):(x=c==="r"?1:0,a=c==="y"?f:c==="r"?25:h),y===!0?[a,x]:[x,a]}function xv(c,h,f,y,v,x){return v?typeof v=="function"?v({width:h,height:f}):v:bv(c,h,f,y,x)}function Qp(c){return function([f,y,v,x,a,A,I,R,B,G]){if(y===null)return null;const j=xv(c,I,R,A,B,G),H=f===Ah[c]?f():f.copy();return H.domain(Ky(y[c],v)).range(j),x&&H.domain(vv(H,x)),a===!0&&(typeof H.nice=="function"?H.nice():console.error(`[Layer Cake] You set \`${c}Nice: true\` but the ${c}Scale does not have a \`.nice\` method. Ignoring...`)),H}}function $p([c,h]){return f=>{const y=c(f);return Array.isArray(y)?y.map(v=>h(v)):h(y)}}function ef([c]){if(typeof c=="function"){if(typeof c.range=="function")return c.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const tf={x:!1,y:!0,z:!1,r:!1};const wv=c=>({element:c[0]&4,width:c[0]&256,height:c[0]&512,aspectRatio:c[0]&1024,containerWidth:c[0]&128,containerHeight:c[0]&64}),jm=c=>({element:c[2],width:c[8],height:c[9],aspectRatio:c[10],containerWidth:c[7],containerHeight:c[6]});function qm(c){let h,f,y;const v=c[90].default,x=Fc(v,c,c[89],jm);return{c(){h=ce("div"),x&&x.c(),this.h()},l(a){h=he(a,"DIV",{class:!0});var A=fe(h);x&&x.l(A),A.forEach(O),this.h()},h(){U(h,"class","layercake-container svelte-vhzpsp"),Lc(()=>c[92].call(h)),De(h,"position",c[5],!1),De(h,"top",c[5]==="absolute"?"0":null,!1),De(h,"right",c[5]==="absolute"?"0":null,!1),De(h,"bottom",c[5]==="absolute"?"0":null,!1),De(h,"left",c[5]==="absolute"?"0":null,!1),De(h,"pointer-events",c[4]===!1?"none":null,!1)},m(a,A){Ie(a,h,A),x&&x.m(h,null),c[91](h),f=Rc(h,c[92].bind(h)),y=!0},p(a,A){x&&x.p&&(!y||A[0]&1988|A[2]&134217728)&&Nc(x,v,a,a[89],y?Uc(v,a[89],A,wv):Vc(a[89]),jm),A[0]&32&&De(h,"position",a[5],!1),A[0]&32&&De(h,"top",a[5]==="absolute"?"0":null,!1),A[0]&32&&De(h,"right",a[5]==="absolute"?"0":null,!1),A[0]&32&&De(h,"bottom",a[5]==="absolute"?"0":null,!1),A[0]&32&&De(h,"left",a[5]==="absolute"?"0":null,!1),A[0]&16&&De(h,"pointer-events",a[4]===!1?"none":null,!1)},i(a){y||(bt(x,a),y=!0)},o(a){Ot(x,a),y=!1},d(a){a&&O(h),x&&x.d(a),c[91](null),f()}}}function Sv(c){let h,f,y=(c[3]===!0||typeof window<"u")&&qm(c);return{c(){y&&y.c(),h=ki()},l(v){y&&y.l(v),h=ki()},m(v,x){y&&y.m(v,x),Ie(v,h,x),f=!0},p(v,x){v[3]===!0||typeof window<"u"?y?(y.p(v,x),x[0]&8&&bt(y,1)):(y=qm(v),y.c(),bt(y,1),y.m(h.parentNode,h)):y&&(As(),Ot(y,1,1,()=>{y=null}),zs())},i(v){f||(bt(y),f=!0)},o(v){Ot(y),f=!1},d(v){y&&y.d(v),v&&O(h)}}}function Ev(c,h,f){let y,v,x,a,A,I,R,B,G,j,H,de,Ce,xe,Xe,Ue,Bt,St,ut,We,tr,Xt,xt,qt,Ge,Rt,yt,gt,Le,Ne,Et,mr,Wt,qe,$e,lr,gr,pi,ii,Zr,Gr,{$$slots:si={},$$scope:kt}=h,{ssr:ur=!1}=h,{pointerEvents:wt=!0}=h,{position:Ht="relative"}=h,{percentRange:It=!1}=h,{width:ei=void 0}=h,{height:Or=void 0}=h,{containerWidth:li=ei||100}=h,{containerHeight:_n=Or||100}=h,{element:Si=void 0}=h,{x:tn=void 0}=h,{y:wr=void 0}=h,{z:fi=void 0}=h,{r:Fi=void 0}=h,{data:Ni=[]}=h,{xDomain:di=void 0}=h,{yDomain:oo=void 0}=h,{zDomain:Xi=void 0}=h,{rDomain:vn=void 0}=h,{xNice:Xn=!1}=h,{yNice:Bo=!1}=h,{zNice:zn=!1}=h,{rNice:Wn=!1}=h,{xReverse:ia=tf.x}=h,{yReverse:So=tf.y}=h,{zReverse:Pn=tf.z}=h,{rReverse:Cn=tf.r}=h,{xPadding:Eo=void 0}=h,{yPadding:Oo=void 0}=h,{zPadding:na=void 0}=h,{rPadding:Fo=void 0}=h,{xScale:ao=Ah.x}=h,{yScale:Kr=Ah.y}=h,{zScale:mi=Ah.z}=h,{rScale:rn=Ah.r}=h,{xRange:so=void 0}=h,{yRange:xr=void 0}=h,{zRange:M=void 0}=h,{rRange:F=void 0}=h,{padding:q={}}=h,{extents:Y={}}=h,{flatData:re=void 0}=h,{custom:ue={}}=h,ye=!1;Vy(()=>{ye=!0});const Z={},oe=Lr(It);$t(c,oe,_e=>f(128,pi=_e));const ve=Lr(li);$t(c,ve,_e=>f(7,gr=_e));const Ve=Lr(_n);$t(c,Ve,_e=>f(6,lr=_e));const Ze=Lr(Wf(Y));$t(c,Ze,_e=>f(127,$e=_e));const Re=Lr(Ni);$t(c,Re,_e=>f(126,qe=_e));const je=Lr(re||Ni);$t(c,je,_e=>f(125,Wt=_e));const ht=Lr(q);$t(c,ht,_e=>f(124,mr=_e));const st=Lr(ku(tn));$t(c,st,_e=>f(123,Et=_e));const ze=Lr(ku(wr));$t(c,ze,_e=>f(122,Ne=_e));const tt=Lr(ku(fi));$t(c,tt,_e=>f(121,Le=_e));const Ye=Lr(ku(Fi));$t(c,Ye,_e=>f(120,gt=_e));const it=Lr(di);$t(c,it,_e=>f(119,yt=_e));const Ut=Lr(oo);$t(c,Ut,_e=>f(118,Rt=_e));const ot=Lr(Xi);$t(c,ot,_e=>f(117,Ge=_e));const er=Lr(vn);$t(c,er,_e=>f(116,qt=_e));const cr=Lr(Xn);$t(c,cr,_e=>f(115,xt=_e));const Zt=Lr(Bo);$t(c,Zt,_e=>f(114,Xt=_e));const or=Lr(zn);$t(c,or,_e=>f(113,tr=_e));const Jt=Lr(Wn);$t(c,Jt,_e=>f(112,We=_e));const ui=Lr(ia);$t(c,ui,_e=>f(111,ut=_e));const fr=Lr(So);$t(c,fr,_e=>f(110,St=_e));const Fr=Lr(Pn);$t(c,Fr,_e=>f(109,Bt=_e));const nr=Lr(Cn);$t(c,nr,_e=>f(108,Ue=_e));const Gt=Lr(Eo);$t(c,Gt,_e=>f(107,Xe=_e));const ar=Lr(Oo);$t(c,ar,_e=>f(106,xe=_e));const Ei=Lr(na);$t(c,Ei,_e=>f(105,Ce=_e));const ko=Lr(Fo);$t(c,ko,_e=>f(104,de=_e));const Nr=Lr(so);$t(c,Nr,_e=>f(103,H=_e));const ni=Lr(xr);$t(c,ni,_e=>f(102,j=_e));const _a=Lr(M);$t(c,_a,_e=>f(101,G=_e));const No=Lr(F);$t(c,No,_e=>f(100,B=_e));const Sr=Lr(ao);$t(c,Sr,_e=>f(99,R=_e));const Vo=Lr(Kr);$t(c,Vo,_e=>f(98,I=_e));const Xr=Lr(mi);$t(c,Xr,_e=>f(97,A=_e));const Er=Lr(rn);$t(c,Er,_e=>f(96,a=_e));const yi=Lr(Z);$t(c,yi,_e=>f(94,v=_e));const Pr=Lr(ue);$t(c,Pr,_e=>f(95,x=_e));const Wi=hn([st,ze,tt,Ye],([_e,nn,Ti,Br])=>{const Bn={};return _e&&(Bn.x=_e),nn&&(Bn.y=nn),Ti&&(Bn.z=Ti),Br&&(Bn.r=Br),Bn}),Mn=hn([ht,ve,Ve],([_e])=>Object.assign({top:0,right:0,bottom:0,left:0},_e)),Ps=hn([ve,Ve,Mn],([_e,nn,Ti])=>{const Br={};return Br.top=Ti.top,Br.right=_e-Ti.right,Br.bottom=nn-Ti.bottom,Br.left=Ti.left,Br.width=Br.right-Br.left,Br.height=Br.bottom-Br.top,Br.width<=0&&ye===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Br.height<=0&&ye===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Br}),oi=hn([Ps],([_e])=>_e.width);$t(c,oi,_e=>f(8,ii=_e));const Dn=hn([Ps],([_e])=>_e.height);$t(c,Dn,_e=>f(9,Zr=_e));const Vi=hn([je,Wi,Ze],([_e,nn,Ti])=>{const Br=Wf(nn,Ti);return Object.keys(Br).length>0?{...l_(_e,Br),...Ti}:{}}),ai=hn([Vi,it],Xp("x")),bn=hn([Vi,Ut],Xp("y")),Ui=hn([Vi,ot],Xp("z")),Uo=hn([Vi,er],Xp("r")),jo=hn([Sr,Vi,ai,Gt,cr,ui,oi,Dn,Nr,oe],Qp("x")),Ys=hn([st,jo],$p),Ci=hn([Vo,Vi,bn,ar,Zt,fr,oi,Dn,ni,oe],Qp("y")),Na=hn([ze,Ci],$p),qo=hn([Xr,Vi,Ui,Ei,or,Fr,oi,Dn,_a,oe],Qp("z")),kl=hn([tt,qo],$p),oa=hn([Er,Vi,Uo,ko,Jt,nr,oi,Dn,No,oe],Qp("r")),ls=hn([Ye,oa],$p),aa=hn([jo],ef),Cs=hn([Ci],ef),Ln=hn([qo],ef),Zo=hn([oa],ef),va=hn([oi,Dn],([_e,nn])=>_e/nn);$t(c,va,_e=>f(10,Gr=_e));function Rn(_e){eu[_e?"unshift":"push"](()=>{Si=_e,f(2,Si)})}function lo(){li=this.clientWidth,_n=this.clientHeight,f(0,li),f(1,_n)}return c.$$set=_e=>{"ssr"in _e&&f(3,ur=_e.ssr),"pointerEvents"in _e&&f(4,wt=_e.pointerEvents),"position"in _e&&f(5,Ht=_e.position),"percentRange"in _e&&f(51,It=_e.percentRange),"width"in _e&&f(52,ei=_e.width),"height"in _e&&f(53,Or=_e.height),"containerWidth"in _e&&f(0,li=_e.containerWidth),"containerHeight"in _e&&f(1,_n=_e.containerHeight),"element"in _e&&f(2,Si=_e.element),"x"in _e&&f(54,tn=_e.x),"y"in _e&&f(55,wr=_e.y),"z"in _e&&f(56,fi=_e.z),"r"in _e&&f(57,Fi=_e.r),"data"in _e&&f(58,Ni=_e.data),"xDomain"in _e&&f(59,di=_e.xDomain),"yDomain"in _e&&f(60,oo=_e.yDomain),"zDomain"in _e&&f(61,Xi=_e.zDomain),"rDomain"in _e&&f(62,vn=_e.rDomain),"xNice"in _e&&f(63,Xn=_e.xNice),"yNice"in _e&&f(64,Bo=_e.yNice),"zNice"in _e&&f(65,zn=_e.zNice),"rNice"in _e&&f(66,Wn=_e.rNice),"xReverse"in _e&&f(67,ia=_e.xReverse),"yReverse"in _e&&f(68,So=_e.yReverse),"zReverse"in _e&&f(69,Pn=_e.zReverse),"rReverse"in _e&&f(70,Cn=_e.rReverse),"xPadding"in _e&&f(71,Eo=_e.xPadding),"yPadding"in _e&&f(72,Oo=_e.yPadding),"zPadding"in _e&&f(73,na=_e.zPadding),"rPadding"in _e&&f(74,Fo=_e.rPadding),"xScale"in _e&&f(75,ao=_e.xScale),"yScale"in _e&&f(76,Kr=_e.yScale),"zScale"in _e&&f(77,mi=_e.zScale),"rScale"in _e&&f(78,rn=_e.rScale),"xRange"in _e&&f(79,so=_e.xRange),"yRange"in _e&&f(80,xr=_e.yRange),"zRange"in _e&&f(81,M=_e.zRange),"rRange"in _e&&f(82,F=_e.rRange),"padding"in _e&&f(83,q=_e.padding),"extents"in _e&&f(84,Y=_e.extents),"flatData"in _e&&f(85,re=_e.flatData),"custom"in _e&&f(86,ue=_e.custom),"$$scope"in _e&&f(89,kt=_e.$$scope)},c.$$.update=()=>{c.$$.dirty[1]&8388608&&tn&&f(87,Z.x=tn,Z),c.$$.dirty[1]&16777216&&wr&&f(87,Z.y=wr,Z),c.$$.dirty[1]&33554432&&fi&&f(87,Z.z=fi,Z),c.$$.dirty[1]&67108864&&Fi&&f(87,Z.r=Fi,Z),c.$$.dirty[1]&268435456&&di&&f(87,Z.xDomain=di,Z),c.$$.dirty[1]&536870912&&oo&&f(87,Z.yDomain=oo,Z),c.$$.dirty[1]&1073741824&&Xi&&f(87,Z.zDomain=Xi,Z),c.$$.dirty[2]&1&&vn&&f(87,Z.rDomain=vn,Z),c.$$.dirty[2]&131072&&so&&f(87,Z.xRange=so,Z),c.$$.dirty[2]&262144&&xr&&f(87,Z.yRange=xr,Z),c.$$.dirty[2]&524288&&M&&f(87,Z.zRange=M,Z),c.$$.dirty[2]&1048576&&F&&f(87,Z.rRange=F,Z),c.$$.dirty[1]&1048576&&Dr(oe,pi=It,pi),c.$$.dirty[0]&1&&Dr(ve,gr=li,gr),c.$$.dirty[0]&2&&Dr(Ve,lr=_n,lr),c.$$.dirty[2]&4194304&&Dr(Ze,$e=Wf(Y),$e),c.$$.dirty[1]&134217728&&Dr(Re,qe=Ni,qe),c.$$.dirty[1]&134217728|c.$$.dirty[2]&8388608&&Dr(je,Wt=re||Ni,Wt),c.$$.dirty[2]&2097152&&Dr(ht,mr=q,mr),c.$$.dirty[1]&8388608&&Dr(st,Et=ku(tn),Et),c.$$.dirty[1]&16777216&&Dr(ze,Ne=ku(wr),Ne),c.$$.dirty[1]&33554432&&Dr(tt,Le=ku(fi),Le),c.$$.dirty[1]&67108864&&Dr(Ye,gt=ku(Fi),gt),c.$$.dirty[1]&268435456&&Dr(it,yt=di,yt),c.$$.dirty[1]&536870912&&Dr(Ut,Rt=oo,Rt),c.$$.dirty[1]&1073741824&&Dr(ot,Ge=Xi,Ge),c.$$.dirty[2]&1&&Dr(er,qt=vn,qt),c.$$.dirty[2]&2&&Dr(cr,xt=Xn,xt),c.$$.dirty[2]&4&&Dr(Zt,Xt=Bo,Xt),c.$$.dirty[2]&8&&Dr(or,tr=zn,tr),c.$$.dirty[2]&16&&Dr(Jt,We=Wn,We),c.$$.dirty[2]&32&&Dr(ui,ut=ia,ut),c.$$.dirty[2]&64&&Dr(fr,St=So,St),c.$$.dirty[2]&128&&Dr(Fr,Bt=Pn,Bt),c.$$.dirty[2]&256&&Dr(nr,Ue=Cn,Ue),c.$$.dirty[2]&512&&Dr(Gt,Xe=Eo,Xe),c.$$.dirty[2]&1024&&Dr(ar,xe=Oo,xe),c.$$.dirty[2]&2048&&Dr(Ei,Ce=na,Ce),c.$$.dirty[2]&4096&&Dr(ko,de=Fo,de),c.$$.dirty[2]&131072&&Dr(Nr,H=so,H),c.$$.dirty[2]&262144&&Dr(ni,j=xr,j),c.$$.dirty[2]&524288&&Dr(_a,G=M,G),c.$$.dirty[2]&1048576&&Dr(No,B=F,B),c.$$.dirty[2]&8192&&Dr(Sr,R=ao,R),c.$$.dirty[2]&16384&&Dr(Vo,I=Kr,I),c.$$.dirty[2]&32768&&Dr(Xr,A=mi,A),c.$$.dirty[2]&65536&&Dr(Er,a=rn,a),c.$$.dirty[2]&16777216&&Dr(Pr,x=ue,x),c.$$.dirty[2]&33554432&&Dr(yi,v=Z,v),c.$$.dirty[2]&67108864&&Uy("LayerCake",y)},f(88,y={activeGetters:Wi,width:oi,height:Dn,percentRange:oe,aspectRatio:va,containerWidth:ve,containerHeight:Ve,x:st,y:ze,z:tt,r:Ye,custom:Pr,data:Re,xNice:cr,yNice:Zt,zNice:or,rNice:Jt,xReverse:ui,yReverse:fr,zReverse:Fr,rReverse:nr,xPadding:Gt,yPadding:ar,zPadding:Ei,rPadding:ko,padding:Mn,flatData:je,extents:Vi,xDomain:ai,yDomain:bn,zDomain:Ui,rDomain:Uo,xRange:aa,yRange:Cs,zRange:Ln,rRange:Zo,config:yi,xScale:jo,xGet:Ys,yScale:Ci,yGet:Na,zScale:qo,zGet:kl,rScale:oa,rGet:ls}),[li,_n,Si,ur,wt,Ht,lr,gr,ii,Zr,Gr,oe,ve,Ve,Ze,Re,je,ht,st,ze,tt,Ye,it,Ut,ot,er,cr,Zt,or,Jt,ui,fr,Fr,nr,Gt,ar,Ei,ko,Nr,ni,_a,No,Sr,Vo,Xr,Er,yi,Pr,oi,Dn,va,It,ei,Or,tn,wr,fi,Fi,Ni,di,oo,Xi,vn,Xn,Bo,zn,Wn,ia,So,Pn,Cn,Eo,Oo,na,Fo,ao,Kr,mi,rn,so,xr,M,F,q,Y,re,ue,Z,y,kt,si,Rn,lo]}class kv extends Ba{constructor(h){super(),Oa(this,h,Ev,Sv,Fa,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const Tv=c=>({element:c&1}),Zm=c=>({element:c[0]}),Iv=c=>({element:c&1}),Gm=c=>({element:c[0]});function Av(c){let h,f,y,v,x;const a=c[12].defs,A=Fc(a,c,c[11],Gm),I=c[12].default,R=Fc(I,c,c[11],Zm);return{c(){h=xo("svg"),f=xo("defs"),A&&A.c(),y=xo("g"),R&&R.c(),this.h()},l(B){h=wo(B,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var G=fe(h);f=wo(G,"defs",{});var j=fe(f);A&&A.l(j),j.forEach(O),y=wo(G,"g",{class:!0,transform:!0});var H=fe(y);R&&R.l(H),H.forEach(O),G.forEach(O),this.h()},h(){U(y,"class","layercake-layout-svg_g"),U(y,"transform",v="translate("+c[7].left+", "+c[7].top+")"),U(h,"class","layercake-layout-svg svelte-u84d8d"),U(h,"viewBox",c[4]),U(h,"width",c[5]),U(h,"height",c[6]),De(h,"z-index",c[2],!1),De(h,"pointer-events",c[3]===!1?"none":null,!1)},m(B,G){Ie(B,h,G),V(h,f),A&&A.m(f,null),V(h,y),R&&R.m(y,null),c[13](y),c[14](h),x=!0},p(B,[G]){A&&A.p&&(!x||G&2049)&&Nc(A,a,B,B[11],x?Uc(a,B[11],G,Iv):Vc(B[11]),Gm),R&&R.p&&(!x||G&2049)&&Nc(R,I,B,B[11],x?Uc(I,B[11],G,Tv):Vc(B[11]),Zm),(!x||G&128&&v!==(v="translate("+B[7].left+", "+B[7].top+")"))&&U(y,"transform",v),(!x||G&16)&&U(h,"viewBox",B[4]),(!x||G&32)&&U(h,"width",B[5]),(!x||G&64)&&U(h,"height",B[6]),G&4&&De(h,"z-index",B[2],!1),G&8&&De(h,"pointer-events",B[3]===!1?"none":null,!1)},i(B){x||(bt(A,B),bt(R,B),x=!0)},o(B){Ot(A,B),Ot(R,B),x=!1},d(B){B&&O(h),A&&A.d(B),R&&R.d(B),c[13](null),c[14](null)}}}function zv(c,h,f){let y,v,x,{$$slots:a={},$$scope:A}=h,{element:I=void 0}=h,{innerElement:R=void 0}=h,{zIndex:B=void 0}=h,{pointerEvents:G=void 0}=h,{viewBox:j=void 0}=h;const{containerWidth:H,containerHeight:de,padding:Ce}=Lh("LayerCake");$t(c,H,Ue=>f(5,y=Ue)),$t(c,de,Ue=>f(6,v=Ue)),$t(c,Ce,Ue=>f(7,x=Ue));function xe(Ue){eu[Ue?"unshift":"push"](()=>{R=Ue,f(1,R)})}function Xe(Ue){eu[Ue?"unshift":"push"](()=>{I=Ue,f(0,I)})}return c.$$set=Ue=>{"element"in Ue&&f(0,I=Ue.element),"innerElement"in Ue&&f(1,R=Ue.innerElement),"zIndex"in Ue&&f(2,B=Ue.zIndex),"pointerEvents"in Ue&&f(3,G=Ue.pointerEvents),"viewBox"in Ue&&f(4,j=Ue.viewBox),"$$scope"in Ue&&f(11,A=Ue.$$scope)},[I,R,B,G,j,y,v,x,H,de,Ce,A,a,xe,Xe]}class Pv extends Ba{constructor(h){super(),Oa(this,h,zv,Av,Fa,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Km(c,h,f){const y=c.slice();return y[24]=h[f],y[26]=f,y}function Xm(c){let h,f,y,v;return{c(){h=xo("rect"),this.h()},l(x){h=wo(x,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),fe(h).forEach(O),this.h()},h(){U(h,"class","group-rect"),U(h,"data-id",c[26]),U(h,"x",f=c[11].bandwidth?c[7](c[24]):c[7](c[24])[0]),U(h,"y",y=c[13](c[12](c[24]))-1),U(h,"width",v=c[11].bandwidth?c[11].bandwidth():c[9](c[24])),U(h,"height","3"),U(h,"fill","#CEDC20"),U(h,"stroke",c[0]),U(h,"stroke-width",c[1])},m(x,a){Ie(x,h,a)},p(x,a){a&3200&&f!==(f=x[11].bandwidth?x[7](x[24]):x[7](x[24])[0])&&U(h,"x",f),a&13312&&y!==(y=x[13](x[12](x[24]))-1)&&U(h,"y",y),a&3584&&v!==(v=x[11].bandwidth?x[11].bandwidth():x[9](x[24]))&&U(h,"width",v),a&1&&U(h,"stroke",x[0]),a&2&&U(h,"stroke-width",x[1])},d(x){x&&O(h)}}}function Wm(c){let h,f,y,v,x,a,A,I,R=c[12]&&Xm(c);return{c(){h=xo("rect"),R&&R.c(),a=xo("text"),this.h()},l(B){h=wo(B,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),fe(h).forEach(O),R&&R.l(B),a=wo(B,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),fe(a).forEach(O),this.h()},h(){U(h,"class","group-rect"),U(h,"data-id",c[26]),U(h,"x",f=c[11].bandwidth?c[7](c[24]):c[7](c[24])[0]),U(h,"y",y=c[6](c[24])),U(h,"width",v=c[11].bandwidth?c[11].bandwidth():c[9](c[24])),U(h,"height",x=c[8](c[24])),U(h,"fill",c[4]),U(h,"stroke",c[0]),U(h,"stroke-width",c[1]),U(a,"x",A=c[11].bandwidth?c[7](c[24])+c[11].bandwidth()/2:c[7](c[24])[0]),U(a,"y",I=c[6](c[24])-4),U(a,"dx",c[2]),U(a,"dy",c[3]),U(a,"text-anchor",c[5])},m(B,G){Ie(B,h,G),R&&R.m(B,G),Ie(B,a,G)},p(B,G){G&3200&&f!==(f=B[11].bandwidth?B[7](B[24]):B[7](B[24])[0])&&U(h,"x",f),G&1088&&y!==(y=B[6](B[24]))&&U(h,"y",y),G&3584&&v!==(v=B[11].bandwidth?B[11].bandwidth():B[9](B[24]))&&U(h,"width",v),G&1280&&x!==(x=B[8](B[24]))&&U(h,"height",x),G&16&&U(h,"fill",B[4]),G&1&&U(h,"stroke",B[0]),G&2&&U(h,"stroke-width",B[1]),B[12]?R?R.p(B,G):(R=Xm(B),R.c(),R.m(a.parentNode,a)):R&&(R.d(1),R=null),G&3200&&A!==(A=B[11].bandwidth?B[7](B[24])+B[11].bandwidth()/2:B[7](B[24])[0])&&U(a,"x",A),G&1088&&I!==(I=B[6](B[24])-4)&&U(a,"y",I),G&4&&U(a,"dx",B[2]),G&8&&U(a,"dy",B[3]),G&32&&U(a,"text-anchor",B[5])},d(B){B&&O(h),R&&R.d(B),B&&O(a)}}}function Cv(c){let h,f=c[10],y=[];for(let v=0;v<f.length;v+=1)y[v]=Wm(Km(c,f,v));return{c(){h=xo("g");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=wo(v,"g",{class:!0});var x=fe(h);for(let a=0;a<y.length;a+=1)y[a].l(x);x.forEach(O),this.h()},h(){U(h,"class","column-group svelte-wgzwsk")},m(v,x){Ie(v,h,x);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,[x]){if(x&16383){f=v[10];let a;for(a=0;a<f.length;a+=1){const A=Km(v,f,a);y[a]?y[a].p(A,x):(y[a]=Wm(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},i:Ro,o:Ro,d(v){v&&O(h),Js(y,v)}}}function Mv(c,h,f){let y,v,x,a,A,I,R,B,G;const{data:j,xGet:H,yGet:de,yRange:Ce,xScale:xe,yScale:Xe,y:Ue,z:Bt}=Lh("LayerCake");$t(c,j,Ge=>f(10,I=Ge)),$t(c,H,Ge=>f(7,A=Ge)),$t(c,de,Ge=>f(6,x=Ge)),$t(c,Ce,Ge=>f(22,a=Ge)),$t(c,xe,Ge=>f(11,R=Ge)),$t(c,Xe,Ge=>f(13,G=Ge)),$t(c,Bt,Ge=>f(12,B=Ge));let{stroke:St=""}=h,{strokeWidth:ut=0}=h,{dxTick:We=0}=h,{dyTick:tr=0}=h,{formatVal:Xt=Ge=>Ge}=h,{fill:xt="#00205b"}=h,{textAnchor:qt="middle"}=h;return c.$$set=Ge=>{"stroke"in Ge&&f(0,St=Ge.stroke),"strokeWidth"in Ge&&f(1,ut=Ge.strokeWidth),"dxTick"in Ge&&f(2,We=Ge.dxTick),"dyTick"in Ge&&f(3,tr=Ge.dyTick),"formatVal"in Ge&&f(21,Xt=Ge.formatVal),"fill"in Ge&&f(4,xt=Ge.fill),"textAnchor"in Ge&&f(5,qt=Ge.textAnchor)},c.$$.update=()=>{c.$$.dirty&128&&f(9,y=Ge=>{const Rt=A(Ge);return Math.max(0,Rt[1]-Rt[0])}),c.$$.dirty&4194368&&f(8,v=Ge=>a[0]-x(Ge))},[St,ut,We,tr,xt,qt,x,A,v,y,I,R,B,G,j,H,de,Ce,xe,Xe,Bt,Xt,a]}class Dv extends Ba{constructor(h){super(),Oa(this,h,Mv,Cv,Fa,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,formatVal:21,fill:4,textAnchor:5})}}function Hm(c,h,f){const y=c.slice();return y[28]=h[f],y[30]=f,y}function Jm(c){let h,f,y,v;return{c(){h=xo("line"),this.h()},l(x){h=wo(x,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),fe(h).forEach(O),this.h()},h(){U(h,"y1",f=c[20]*-1),U(h,"y2",y=c[14]&&c[30]%2==0?c[10]+c[8]+2:c[10]+c[8]-13),U(h,"x1","0"),U(h,"x2","0"),U(h,"stroke",c[11]),U(h,"stroke-width",v=c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)?2:1),U(h,"class","svelte-fwjh80"),en(h,"baseline",c[13])},m(x,a){Ie(x,h,a)},p(x,a){a&1048576&&f!==(f=x[20]*-1)&&U(h,"y1",f),a&17664&&y!==(y=x[14]&&x[30]%2==0?x[10]+x[8]+2:x[10]+x[8]-13)&&U(h,"y2",y),a&2048&&U(h,"stroke",x[11]),a&32784&&v!==(v=x[15]&&Array.isArray(x[4])&&x[30]==Math.floor(x[4].length/2)?2:1)&&U(h,"stroke-width",v),a&8192&&en(h,"baseline",x[13])},d(x){x&&O(h)}}}function Lv(c){let h=c[1](c[28])+"",f;return{c(){f=we(h)},l(y){f=Se(y,h)},m(y,v){Ie(y,f,v)},p(y,v){v&262146&&h!==(h=y[1](y[28])+"")&&Ct(f,h)},d(y){y&&O(f)}}}function Rv(c){let h,f=c[1](c[28])+"",y,v;return{c(){h=we(c[5]),y=we(f),v=we(c[6])},l(x){h=Se(x,c[5]),y=Se(x,f),v=Se(x,c[6])},m(x,a){Ie(x,h,a),Ie(x,y,a),Ie(x,v,a)},p(x,a){a&32&&Ct(h,x[5]),a&262146&&f!==(f=x[1](x[28])+"")&&Ct(y,f),a&64&&Ct(v,x[6])},d(x){x&&O(h),x&&O(y),x&&O(v)}}}function Ym(c){let h,f,y,v,x,a,A,I=c[0]!==!1&&Jm(c);function R(j,H){return j[30]==j[18].length-1?Rv:Lv}let B=R(c),G=B(c);return{c(){h=xo("g"),I&&I.c(),f=xo("text"),G.c(),this.h()},l(j){h=wo(j,"g",{class:!0,transform:!0});var H=fe(h);I&&I.l(H),f=wo(H,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var de=fe(f);G.l(de),de.forEach(O),H.forEach(O),this.h()},h(){U(f,"x",y=c[7]||c[16]?c[17].bandwidth()/2:0),U(f,"y",v=c[3]?c[20]*-1-6:c[14]&&c[30]%2==0?c[8]+15:c[8]),U(f,"dx",x=c[24](c[30])=="start"?c[9]-2:c[24](c[30])=="end"?c[9]+2:c[9]),U(f,"dy",c[10]),U(f,"text-anchor",c[24](c[30])),U(f,"fill",c[12]),U(f,"class","svelte-fwjh80"),en(f,"bold",c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)),U(h,"class",a="tick tick-"+c[28]+" svelte-fwjh80"),U(h,"transform",A="translate("+c[17](c[28])+","+c[19][0]+")")},m(j,H){Ie(j,h,H),I&&I.m(h,null),V(h,f),G.m(f,null)},p(j,H){j[0]!==!1?I?I.p(j,H):(I=Jm(j),I.c(),I.m(h,f)):I&&(I.d(1),I=null),B===(B=R(j))&&G?G.p(j,H):(G.d(1),G=B(j),G&&(G.c(),G.m(f,null))),H&196736&&y!==(y=j[7]||j[16]?j[17].bandwidth()/2:0)&&U(f,"x",y),H&1065224&&v!==(v=j[3]?j[20]*-1-6:j[14]&&j[30]%2==0?j[8]+15:j[8])&&U(f,"y",v),H&512&&x!==(x=j[24](j[30])=="start"?j[9]-2:j[24](j[30])=="end"?j[9]+2:j[9])&&U(f,"dx",x),H&1024&&U(f,"dy",j[10]),H&4096&&U(f,"fill",j[12]),H&32784&&en(f,"bold",j[15]&&Array.isArray(j[4])&&j[30]==Math.floor(j[4].length/2)),H&262144&&a!==(a="tick tick-"+j[28]+" svelte-fwjh80")&&U(h,"class",a),H&917504&&A!==(A="translate("+j[17](j[28])+","+j[19][0]+")")&&U(h,"transform",A)},d(j){j&&O(h),I&&I.d(),G.d()}}}function Qm(c){let h,f,y;return{c(){h=xo("line"),this.h()},l(v){h=wo(v,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),fe(h).forEach(O),this.h()},h(){U(h,"class","baseline svelte-fwjh80"),U(h,"y1",c[20]),U(h,"y2","0"),U(h,"x1",f=c[17](0)),U(h,"x2",y=c[17](0)),U(h,"stroke",c[11])},m(v,x){Ie(v,h,x)},p(v,x){x&1048576&&U(h,"y1",v[20]),x&131072&&f!==(f=v[17](0))&&U(h,"x1",f),x&131072&&y!==(y=v[17](0))&&U(h,"x2",y),x&2048&&U(h,"stroke",v[11])},d(v){v&&O(h)}}}function Bv(c){let h,f,y=c[18],v=[];for(let a=0;a<y.length;a+=1)v[a]=Ym(Hm(c,y,a));let x=c[2]===!0&&Qm(c);return{c(){h=xo("g");for(let a=0;a<v.length;a+=1)v[a].c();f=ki(),x&&x.c(),this.h()},l(a){h=wo(a,"g",{class:!0});var A=fe(h);for(let I=0;I<v.length;I+=1)v[I].l(A);f=ki(),x&&x.l(A),A.forEach(O),this.h()},h(){U(h,"class","axis x-axis")},m(a,A){Ie(a,h,A);for(let I=0;I<v.length;I+=1)v[I].m(h,null);V(h,f),x&&x.m(h,null)},p(a,[A]){if(A&18874363){y=a[18];let I;for(I=0;I<y.length;I+=1){const R=Hm(a,y,I);v[I]?v[I].p(R,A):(v[I]=Ym(R),v[I].c(),v[I].m(h,f))}for(;I<v.length;I+=1)v[I].d(1);v.length=y.length}a[2]===!0?x?x.p(a,A):(x=Qm(a),x.c(),x.m(h,null)):x&&(x.d(1),x=null)},i:Ro,o:Ro,d(a){a&&O(h),Js(v,a),x&&x.d()}}}function Ov(c,h,f){let y,v,x,a,A;const{width:I,height:R,xScale:B,yScale:G,yRange:j}=Lh("LayerCake");$t(c,R,Le=>f(20,A=Le)),$t(c,B,Le=>f(17,x=Le)),$t(c,j,Le=>f(19,a=Le));let{gridlines:H=!0}=h,{formatTick:de=Le=>Le}=h,{baseline:Ce=!1}=h,{flipped:xe=!1}=h,{snapTicks:Xe=!1}=h,{ticks:Ue=void 0}=h,{prefix:Bt=""}=h,{suffix:St=""}=h,{xTick:ut=void 0}=h,{yTick:We=15}=h,{dxTick:tr=0}=h,{dyTick:Xt=0}=h,{lineColor:xt="#999"}=h,{textColor:qt="#555"}=h,{solid:Ge=!1}=h,{stagger:Rt=!1}=h,{median:yt=!0}=h;function gt(Le){if(Xe===!0){if(Le===0)return"start";if(Le===v.length-1)return"end"}return"middle"}return c.$$set=Le=>{"gridlines"in Le&&f(0,H=Le.gridlines),"formatTick"in Le&&f(1,de=Le.formatTick),"baseline"in Le&&f(2,Ce=Le.baseline),"flipped"in Le&&f(3,xe=Le.flipped),"snapTicks"in Le&&f(25,Xe=Le.snapTicks),"ticks"in Le&&f(4,Ue=Le.ticks),"prefix"in Le&&f(5,Bt=Le.prefix),"suffix"in Le&&f(6,St=Le.suffix),"xTick"in Le&&f(7,ut=Le.xTick),"yTick"in Le&&f(8,We=Le.yTick),"dxTick"in Le&&f(9,tr=Le.dxTick),"dyTick"in Le&&f(10,Xt=Le.dyTick),"lineColor"in Le&&f(11,xt=Le.lineColor),"textColor"in Le&&f(12,qt=Le.textColor),"solid"in Le&&f(13,Ge=Le.solid),"stagger"in Le&&f(14,Rt=Le.stagger),"median"in Le&&f(15,yt=Le.median)},c.$$.update=()=>{c.$$.dirty&131072&&f(16,y=typeof x.bandwidth=="function"),c.$$.dirty&196624&&f(18,v=Array.isArray(Ue)?Ue:y?x.domain():x.ticks(Ue))},[H,de,Ce,xe,Ue,Bt,St,ut,We,tr,Xt,xt,qt,Ge,Rt,yt,y,x,v,a,A,R,B,j,gt,Xe]}class Fv extends Ba{constructor(h){super(),Oa(this,h,Ov,Bv,Fa,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function Nv(c){let h,f,y,v;return h=new Dv({props:{fill:c[1],formatVal:c[5]}}),y=new Fv({props:{gridlines:!1}}),{c(){Jr(h.$$.fragment),f=He(),Jr(y.$$.fragment)},l(x){Yr(h.$$.fragment,x),f=Je(x),Yr(y.$$.fragment,x)},m(x,a){Qr(h,x,a),Ie(x,f,a),Qr(y,x,a),v=!0},p(x,a){const A={};a&2&&(A.fill=x[1]),a&32&&(A.formatVal=x[5]),h.$set(A)},i(x){v||(bt(h.$$.fragment,x),bt(y.$$.fragment,x),v=!0)},o(x){Ot(h.$$.fragment,x),Ot(y.$$.fragment,x),v=!1},d(x){$r(h,x),x&&O(f),$r(y,x)}}}function Vv(c){let h,f;return h=new Pv({props:{$$slots:{default:[Nv]},$$scope:{ctx:c}}}),{c(){Jr(h.$$.fragment)},l(y){Yr(h.$$.fragment,y)},m(y,v){Qr(h,y,v),f=!0},p(y,v){const x={};v&1058&&(x.$$scope={dirty:v,ctx:y}),h.$set(x)},i(y){f||(bt(h.$$.fragment,y),f=!0)},o(y){Ot(h.$$.fragment,y),f=!1},d(y){$r(h,y)}}}function Uv(c){let h,f,y;return f=new kv({props:{padding:{top:15,right:0,bottom:20,left:0},x:c[2],y:c[3],z:c[4],xScale:Jy().paddingInner([.02]).round(!0),xDomain:c[7],yDomain:c[6],zDomain:c[6],data:c[0],$$slots:{default:[Vv]},$$scope:{ctx:c}}}),{c(){h=ce("div"),Jr(f.$$.fragment),this.h()},l(v){h=he(v,"DIV",{class:!0});var x=fe(h);Yr(f.$$.fragment,x),x.forEach(O),this.h()},h(){U(h,"class","chart-container svelte-s9z6lx")},m(v,x){Ie(v,h,x),Qr(f,h,null),y=!0},p(v,[x]){const a={};x&4&&(a.x=v[2]),x&8&&(a.y=v[3]),x&16&&(a.z=v[4]),x&128&&(a.xDomain=v[7]),x&64&&(a.yDomain=v[6]),x&64&&(a.zDomain=v[6]),x&1&&(a.data=v[0]),x&1058&&(a.$$scope={dirty:x,ctx:v}),f.$set(a)},i(v){y||(bt(f.$$.fragment,v),y=!0)},o(v){Ot(f.$$.fragment,v),y=!1},d(v){v&&O(h),$r(f)}}}function jv(c,h,f){let y,v,x,{data:a}=h,{suffix:A="%"}=h,{decimals:I=0}=h,{fill:R="#00205B"}=h,{xKey:B="x"}=h,{yKey:G="y"}=h,{zKey:j=null}=h;return c.$$set=H=>{"data"in H&&f(0,a=H.data),"suffix"in H&&f(8,A=H.suffix),"decimals"in H&&f(9,I=H.decimals),"fill"in H&&f(1,R=H.fill),"xKey"in H&&f(2,B=H.xKey),"yKey"in H&&f(3,G=H.yKey),"zKey"in H&&f(4,j=H.zKey)},c.$$.update=()=>{c.$$.dirty&5&&f(7,y=a.map(H=>H[B])),c.$$.dirty&9&&f(6,v=[0,Math.max(...a.map(H=>H[G]))]),c.$$.dirty&768&&f(5,x=H=>H.toFixed(I)+A)},[a,R,B,G,j,x,v,y,A,I]}class qv extends Ba{constructor(h){super(),Oa(this,h,jv,Uv,Fa,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function $m(c,h,f){const y=c.slice();return y[7]=h[f],y[9]=f,y}function ey(c){let h,f=c[0],y=[];for(let v=0;v<f.length;v+=1)y[v]=ty($m(c,f,v));return{c(){h=xo("svg");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=wo(v,"svg",{class:!0});var x=fe(h);for(let a=0;a<y.length;a+=1)y[a].l(x);x.forEach(O),this.h()},h(){U(h,"class","stack svelte-q6mgyr")},m(v,x){Ie(v,h,x);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,x){if(x&31){f=v[0];let a;for(a=0;a<f.length;a+=1){const A=$m(v,f,a);y[a]?y[a].p(A,x):(y[a]=ty(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){v&&O(h),Js(y,v)}}}function ty(c){let h,f;return{c(){h=xo("rect"),this.h()},l(y){h=wo(y,"rect",{class:!0,x:!0,style:!0}),fe(h).forEach(O),this.h()},h(){U(h,"class","cell svelte-q6mgyr"),U(h,"x",f=c[4][c[9]]/c[3]*100+"%"),De(h,"width",c[7][c[1]]/c[3]*100+"%"),De(h,"fill",c[2][c[9]])},m(y,v){Ie(y,h,v)},p(y,v){v&24&&f!==(f=y[4][y[9]]/y[3]*100+"%")&&U(h,"x",f),v&11&&De(h,"width",y[7][y[1]]/y[3]*100+"%"),v&4&&De(h,"fill",y[2][y[9]])},d(y){y&&O(h)}}}function Zv(c){let h,f=c[3]&&c[4]&&ey(c);return{c(){f&&f.c(),h=ki()},l(y){f&&f.l(y),h=ki()},m(y,v){f&&f.m(y,v),Ie(y,h,v)},p(y,[v]){y[3]&&y[4]?f?f.p(y,v):(f=ey(y),f.c(),f.m(h.parentNode,h)):f&&(f.d(1),f=null)},i:Ro,o:Ro,d(y){f&&f.d(y),y&&O(h)}}}function Gv(c,h,f){let{data:y}=h,{xKey:v="x"}=h,{yKey:x="y"}=h,{colors:a=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=h,A,I;function R(){f(3,A=y.map(G=>G[x]).reduce((G,j)=>G+j,0));let B=[0];y.forEach(G=>B.push(B[B.length-1]+G[x])),f(4,I=B)}return c.$$set=B=>{"data"in B&&f(0,y=B.data),"xKey"in B&&f(5,v=B.xKey),"yKey"in B&&f(1,x=B.yKey),"colors"in B&&f(2,a=B.colors)},c.$$.update=()=>{c.$$.dirty&3&&(y||x)&&R()},[y,x,a,A,I,v]}class sg extends Ba{constructor(h){super(),Oa(this,h,Gv,Zv,Fa,{data:0,xKey:5,yKey:1,colors:2})}}function ry(c,h,f){const y=c.slice();return y[12]=h[f],y[14]=f,y}function Kv(c){let h,f,y=c[6](c[12][c[3]])+"",v,x;return{c(){h=ce("span"),f=we("(NI "),v=we(y),x=we(")"),this.h()},l(a){h=he(a,"SPAN",{class:!0,style:!0});var A=fe(h);f=Se(A,"(NI "),v=Se(A,y),x=Se(A,")"),A.forEach(O),this.h()},h(){U(h,"class",""),De(h,"color","#3878C5")},m(a,A){Ie(a,h,A),V(h,f),V(h,v),V(h,x)},p(a,A){A&9&&y!==(y=a[6](a[12][a[3]])+"")&&Ct(v,y)},d(a){a&&O(h)}}}function Xv(c){let h,f,y=bm(Math.round(c[12][c[3]]),"%)")+"",v;return{c(){h=ce("span"),f=we("(2011 "),v=we(y),this.h()},l(x){h=he(x,"SPAN",{class:!0,style:!0});var a=fe(h);f=Se(a,"(2011 "),v=Se(a,y),a.forEach(O),this.h()},h(){U(h,"class",""),De(h,"color","#3878C5")},m(x,a){Ie(x,h,a),V(h,f),V(h,v)},p(x,a){a&9&&y!==(y=bm(Math.round(x[12][x[3]]),"%)")+"")&&Ct(v,y)},d(x){x&&O(h)}}}function iy(c){let h,f,y,v,x=c[12][c[1]]+"",a,A,I=c[6](c[12][c[2]])+"",R,B,G;function j(Ce,xe){if(Ce[3]=="prev")return Xv;if(Ce[3])return Kv}let H=j(c),de=H&&H(c);return{c(){h=ce("li"),f=xo("svg"),y=xo("rect"),v=He(),a=we(x),A=He(),R=we(I),B=He(),de&&de.c(),G=He(),this.h()},l(Ce){h=he(Ce,"LI",{style:!0,class:!0});var xe=fe(h);f=wo(xe,"svg",{width:!0,height:!0,class:!0});var Xe=fe(f);y=wo(Xe,"rect",{width:!0,height:!0,style:!0});var Ue=fe(y);Ue.forEach(O),Xe.forEach(O),v=Je(xe),a=Se(xe,x),A=Je(xe),R=Se(xe,I),B=Je(xe),de&&de.l(xe),G=Je(xe),xe.forEach(O),this.h()},h(){U(y,"width","20"),U(y,"height","30"),De(y,"fill",c[4][c[14]]),U(f,"width","20"),U(f,"height","30"),U(f,"class","bullet svelte-89uh35"),De(h,"color",c[5]),U(h,"class","svelte-89uh35")},m(Ce,xe){Ie(Ce,h,xe),V(h,f),V(f,y),V(h,v),V(h,a),V(h,A),V(h,R),V(h,B),de&&de.m(h,null),V(h,G)},p(Ce,xe){xe&16&&De(y,"fill",Ce[4][Ce[14]]),xe&3&&x!==(x=Ce[12][Ce[1]]+"")&&Ct(a,x),xe&5&&I!==(I=Ce[6](Ce[12][Ce[2]])+"")&&Ct(R,I),H===(H=j(Ce))&&de?de.p(Ce,xe):(de&&de.d(1),de=H&&H(Ce),de&&(de.c(),de.m(h,G))),xe&32&&De(h,"color",Ce[5])},d(Ce){Ce&&O(h),de&&de.d()}}}function Wv(c){let h,f=c[0],y=[];for(let v=0;v<f.length;v+=1)y[v]=iy(ry(c,f,v));return{c(){h=ce("ul");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=he(v,"UL",{class:!0});var x=fe(h);for(let a=0;a<y.length;a+=1)y[a].l(x);x.forEach(O),this.h()},h(){U(h,"class","svelte-89uh35")},m(v,x){Ie(v,h,x);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,[x]){if(x&127){f=v[0];let a;for(a=0;a<f.length;a+=1){const A=ry(v,f,a);y[a]?y[a].p(A,x):(y[a]=iy(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},i:Ro,o:Ro,d(v){v&&O(h),Js(y,v)}}}function Hv(c,h,f){let y,{data:v}=h,{xKey:x="x"}=h,{yKey:a="y"}=h,{zKey:A="ew"}=h,{colors:I=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=h,{textColor:R="#555"}=h,{mutedColor:B="#999"}=h,{decimals:G=null}=h,{round:j=!1}=h;function H(de){let Ce;return G?Ce=(de/y*100).toFixed(G)+"%":de/y*100<1?Ce="<1%":Ce=(de/y*100).toFixed(0)+"%",Ce}return c.$$set=de=>{"data"in de&&f(0,v=de.data),"xKey"in de&&f(1,x=de.xKey),"yKey"in de&&f(2,a=de.yKey),"zKey"in de&&f(3,A=de.zKey),"colors"in de&&f(4,I=de.colors),"textColor"in de&&f(5,R=de.textColor),"mutedColor"in de&&f(7,B=de.mutedColor),"decimals"in de&&f(8,G=de.decimals),"round"in de&&f(9,j=de.round)},c.$$.update=()=>{c.$$.dirty&5&&(y=v.map(de=>de[a]).reduce((de,Ce)=>de+Ce,0)),c.$$.dirty&9&&v.map(de=>de[A]).reduce((de,Ce)=>de+Ce,0)},[v,x,a,A,I,R,H,B,G,j]}class Jv extends Ba{constructor(h){super(),Oa(this,h,Hv,Wv,Fa,{data:0,xKey:1,yKey:2,zKey:3,colors:4,textColor:5,mutedColor:7,decimals:8,round:9})}}function ny(c){let h,f,y,v;f=new sg({props:{data:c[0],yKey:c[4],colors:c[5]}});let x=c[7]&&oy(c);return{c(){h=ce("div"),Jr(f.$$.fragment),y=He(),x&&x.c(),this.h()},l(a){h=he(a,"DIV",{class:!0,style:!0});var A=fe(h);Yr(f.$$.fragment,A),y=Je(A),x&&x.l(A),A.forEach(O),this.h()},h(){U(h,"class","chart svelte-1tebgpk"),De(h,"height",c[1]*.28+"px")},m(a,A){Ie(a,h,A),Qr(f,h,null),V(h,y),x&&x.m(h,null),v=!0},p(a,A){const I={};A&1&&(I.data=a[0]),A&16&&(I.yKey=a[4]),A&32&&(I.colors=a[5]),f.$set(I),a[7]?x?x.p(a,A):(x=oy(a),x.c(),x.m(h,null)):x&&(x.d(1),x=null),(!v||A&2)&&De(h,"height",a[1]*.28+"px")},i(a){v||(bt(f.$$.fragment,a),v=!0)},o(a){Ot(f.$$.fragment,a),v=!1},d(a){a&&O(h),$r(f),x&&x.d()}}}function oy(c){let h,f;return{c(){h=ce("div"),f=we(c[7]),this.h()},l(y){h=he(y,"DIV",{class:!0});var v=fe(h);f=Se(v,c[7]),v.forEach(O),this.h()},h(){U(h,"class","label svelte-1tebgpk")},m(y,v){Ie(y,h,v),V(h,f)},p(y,v){v&128&&Ct(f,y[7])},d(y){y&&O(h)}}}function Yv(c){let h,f,y,v,x,a,A;f=new sg({props:{data:c[0],yKey:c[3],colors:c[5]}});let I=c[4]&&ny(c);return a=new Jv({props:{data:c[0],xKey:c[2],yKey:c[3],zKey:c[4],decimals:c[6],colors:c[5]}}),{c(){h=ce("div"),Jr(f.$$.fragment),y=He(),I&&I.c(),v=He(),x=ce("div"),Jr(a.$$.fragment),this.h()},l(R){h=he(R,"DIV",{class:!0,style:!0});var B=fe(h);Yr(f.$$.fragment,B),B.forEach(O),y=Je(R),I&&I.l(R),v=Je(R),x=he(R,"DIV",{class:!0});var G=fe(x);Yr(a.$$.fragment,G),G.forEach(O),this.h()},h(){U(h,"class","chart svelte-1tebgpk"),De(h,"padding-top","3px"),De(h,"height",(c[4]?c[1]*.72:c[1])+"px"),U(x,"class","legend svelte-1tebgpk")},m(R,B){Ie(R,h,B),Qr(f,h,null),Ie(R,y,B),I&&I.m(R,B),Ie(R,v,B),Ie(R,x,B),Qr(a,x,null),A=!0},p(R,[B]){const G={};B&1&&(G.data=R[0]),B&8&&(G.yKey=R[3]),B&32&&(G.colors=R[5]),f.$set(G),(!A||B&18)&&De(h,"height",(R[4]?R[1]*.72:R[1])+"px"),R[4]?I?(I.p(R,B),B&16&&bt(I,1)):(I=ny(R),I.c(),bt(I,1),I.m(v.parentNode,v)):I&&(As(),Ot(I,1,1,()=>{I=null}),zs());const j={};B&1&&(j.data=R[0]),B&4&&(j.xKey=R[2]),B&8&&(j.yKey=R[3]),B&16&&(j.zKey=R[4]),B&64&&(j.decimals=R[6]),B&32&&(j.colors=R[5]),a.$set(j)},i(R){A||(bt(f.$$.fragment,R),bt(I),bt(a.$$.fragment,R),A=!0)},o(R){Ot(f.$$.fragment,R),Ot(I),Ot(a.$$.fragment,R),A=!1},d(R){R&&O(h),$r(f),R&&O(y),I&&I.d(R),R&&O(v),R&&O(x),$r(a)}}}function Qv(c,h,f){let{data:y}=h,{height:v=80}=h,{xKey:x="x"}=h,{yKey:a="y"}=h,{zKey:A="ew"}=h,{colors:I=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=h,{decimals:R=null}=h,{label:B=null}=h;return c.$$set=G=>{"data"in G&&f(0,y=G.data),"height"in G&&f(1,v=G.height),"xKey"in G&&f(2,x=G.xKey),"yKey"in G&&f(3,a=G.yKey),"zKey"in G&&f(4,A=G.zKey),"colors"in G&&f(5,I=G.colors),"decimals"in G&&f(6,R=G.decimals),"label"in G&&f(7,B=G.label)},[y,v,x,a,A,I,R,B]}class Ws extends Ba{constructor(h){super(),Oa(this,h,Qv,Yv,Fa,{data:0,height:1,xKey:2,yKey:3,zKey:4,colors:5,decimals:6,label:7})}}var $v=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e0={rgb2hsl:Bh,rgb2hsv:mf,rgb2hwb:Oh,rgb2cmyk:Fh,rgb2keyword:Nh,rgb2xyz:hd,rgb2lab:pd,rgb2lch:t0,hsl2rgb:yf,hsl2hsv:r0,hsl2hwb:i0,hsl2cmyk:n0,hsl2keyword:o0,hsv2rgb:gf,hsv2hsl:a0,hsv2hwb:s0,hsv2cmyk:l0,hsv2keyword:u0,hwb2rgb:Vh,hwb2hsl:c0,hwb2hsv:h0,hwb2cmyk:p0,hwb2keyword:f0,cmyk2rgb:Uh,cmyk2hsl:d0,cmyk2hsv:m0,cmyk2hwb:y0,cmyk2keyword:g0,keyword2rgb:tc,keyword2hsl:x0,keyword2hsv:w0,keyword2hwb:S0,keyword2cmyk:E0,keyword2lab:k0,keyword2xyz:T0,xyz2rgb:lg,xyz2lab:ug,xyz2lch:_0,lab2xyz:fd,lab2rgb:cg,lab2lch:dd,lch2lab:md,lch2xyz:v0,lch2rgb:b0};function Bh(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255,v=Math.min(h,f,y),x=Math.max(h,f,y),a=x-v,A,I,R;return x==v?A=0:h==x?A=(f-y)/a:f==x?A=2+(y-h)/a:y==x&&(A=4+(h-f)/a),A=Math.min(A*60,360),A<0&&(A+=360),R=(v+x)/2,x==v?I=0:R<=.5?I=a/(x+v):I=a/(2-x-v),[A,I*100,R*100]}function mf(c){var h=c[0],f=c[1],y=c[2],v=Math.min(h,f,y),x=Math.max(h,f,y),a=x-v,A,I,R;return x==0?I=0:I=a/x*1e3/10,x==v?A=0:h==x?A=(f-y)/a:f==x?A=2+(y-h)/a:y==x&&(A=4+(h-f)/a),A=Math.min(A*60,360),A<0&&(A+=360),R=x/255*1e3/10,[A,I,R]}function Oh(c){var h=c[0],f=c[1],x=c[2],y=Bh(c)[0],v=1/255*Math.min(h,Math.min(f,x)),x=1-1/255*Math.max(h,Math.max(f,x));return[y,v*100,x*100]}function Fh(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255,v,x,a,A;return A=Math.min(1-h,1-f,1-y),v=(1-h-A)/(1-A)||0,x=(1-f-A)/(1-A)||0,a=(1-y-A)/(1-A)||0,[v*100,x*100,a*100,A*100]}function Nh(c){return hg[JSON.stringify(c)]}function hd(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255;h=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,f=f>.04045?Math.pow((f+.055)/1.055,2.4):f/12.92,y=y>.04045?Math.pow((y+.055)/1.055,2.4):y/12.92;var v=h*.4124+f*.3576+y*.1805,x=h*.2126+f*.7152+y*.0722,a=h*.0193+f*.1192+y*.9505;return[v*100,x*100,a*100]}function pd(c){var h=hd(c),f=h[0],y=h[1],v=h[2],x,a,A;return f/=95.047,y/=100,v/=108.883,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=v>.008856?Math.pow(v,1/3):7.787*v+16/116,x=116*y-16,a=500*(f-y),A=200*(y-v),[x,a,A]}function t0(c){return dd(pd(c))}function yf(c){var h=c[0]/360,f=c[1]/100,y=c[2]/100,v,x,a,A,I;if(f==0)return I=y*255,[I,I,I];y<.5?x=y*(1+f):x=y+f-y*f,v=2*y-x,A=[0,0,0];for(var R=0;R<3;R++)a=h+1/3*-(R-1),a<0&&a++,a>1&&a--,6*a<1?I=v+(x-v)*6*a:2*a<1?I=x:3*a<2?I=v+(x-v)*(2/3-a)*6:I=v,A[R]=I*255;return A}function r0(c){var h=c[0],f=c[1]/100,y=c[2]/100,v,x;return y===0?[0,0,0]:(y*=2,f*=y<=1?y:2-y,x=(y+f)/2,v=2*f/(y+f),[h,v*100,x*100])}function i0(c){return Oh(yf(c))}function n0(c){return Fh(yf(c))}function o0(c){return Nh(yf(c))}function gf(c){var h=c[0]/60,f=c[1]/100,I=c[2]/100,y=Math.floor(h)%6,v=h-Math.floor(h),x=255*I*(1-f),a=255*I*(1-f*v),A=255*I*(1-f*(1-v)),I=255*I;switch(y){case 0:return[I,A,x];case 1:return[a,I,x];case 2:return[x,I,A];case 3:return[x,a,I];case 4:return[A,x,I];case 5:return[I,x,a]}}function a0(c){var h=c[0],f=c[1]/100,y=c[2]/100,v,x;return x=(2-f)*y,v=f*y,v/=x<=1?x:2-x,v=v||0,x/=2,[h,v*100,x*100]}function s0(c){return Oh(gf(c))}function l0(c){return Fh(gf(c))}function u0(c){return Nh(gf(c))}function Vh(c){var h=c[0]/360,f=c[1]/100,y=c[2]/100,v=f+y,x,a,A,I;switch(v>1&&(f/=v,y/=v),x=Math.floor(6*h),a=1-y,A=6*h-x,(x&1)!=0&&(A=1-A),I=f+A*(a-f),x){default:case 6:case 0:r=a,g=I,b=f;break;case 1:r=I,g=a,b=f;break;case 2:r=f,g=a,b=I;break;case 3:r=f,g=I,b=a;break;case 4:r=I,g=f,b=a;break;case 5:r=a,g=f,b=I;break}return[r*255,g*255,b*255]}function c0(c){return Bh(Vh(c))}function h0(c){return mf(Vh(c))}function p0(c){return Fh(Vh(c))}function f0(c){return Nh(Vh(c))}function Uh(c){var h=c[0]/100,f=c[1]/100,y=c[2]/100,v=c[3]/100,x,a,A;return x=1-Math.min(1,h*(1-v)+v),a=1-Math.min(1,f*(1-v)+v),A=1-Math.min(1,y*(1-v)+v),[x*255,a*255,A*255]}function d0(c){return Bh(Uh(c))}function m0(c){return mf(Uh(c))}function y0(c){return Oh(Uh(c))}function g0(c){return Nh(Uh(c))}function lg(c){var h=c[0]/100,f=c[1]/100,y=c[2]/100,v,x,a;return v=h*3.2406+f*-1.5372+y*-.4986,x=h*-.9689+f*1.8758+y*.0415,a=h*.0557+f*-.204+y*1.057,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v=v*12.92,x=x>.0031308?1.055*Math.pow(x,1/2.4)-.055:x=x*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,v=Math.min(Math.max(0,v),1),x=Math.min(Math.max(0,x),1),a=Math.min(Math.max(0,a),1),[v*255,x*255,a*255]}function ug(c){var h=c[0],f=c[1],y=c[2],v,x,a;return h/=95.047,f/=100,y/=108.883,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=116*f-16,x=500*(h-f),a=200*(f-y),[v,x,a]}function _0(c){return dd(ug(c))}function fd(c){var h=c[0],f=c[1],y=c[2],v,x,a,A;return h<=8?(x=h*100/903.3,A=7.787*(x/100)+16/116):(x=100*Math.pow((h+16)/116,3),A=Math.pow(x/100,1/3)),v=v/95.047<=.008856?v=95.047*(f/500+A-16/116)/7.787:95.047*Math.pow(f/500+A,3),a=a/108.883<=.008859?a=108.883*(A-y/200-16/116)/7.787:108.883*Math.pow(A-y/200,3),[v,x,a]}function dd(c){var h=c[0],f=c[1],y=c[2],v,x,a;return v=Math.atan2(y,f),x=v*360/2/Math.PI,x<0&&(x+=360),a=Math.sqrt(f*f+y*y),[h,a,x]}function cg(c){return lg(fd(c))}function md(c){var h=c[0],f=c[1],y=c[2],v,x,a;return a=y/360*2*Math.PI,v=f*Math.cos(a),x=f*Math.sin(a),[h,v,x]}function v0(c){return fd(md(c))}function b0(c){return cg(md(c))}function tc(c){return ad[c]}function x0(c){return Bh(tc(c))}function w0(c){return mf(tc(c))}function S0(c){return Oh(tc(c))}function E0(c){return Fh(tc(c))}function k0(c){return pd(tc(c))}function T0(c){return hd(tc(c))}var ad={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},hg={};for(var ay in ad)hg[JSON.stringify(ad[ay])]=ay;var Yf=e0,Ju=function(){return new jh};for(var Ih in Yf){Ju[Ih+"Raw"]=function(c){return function(h){return typeof h=="number"&&(h=Array.prototype.slice.call(arguments)),Yf[c](h)}}(Ih);var sy=/(\w+)2(\w+)/.exec(Ih),Qf=sy[1],I0=sy[2];Ju[Qf]=Ju[Qf]||{},Ju[Qf][I0]=Ju[Ih]=function(c){return function(h){typeof h=="number"&&(h=Array.prototype.slice.call(arguments));var f=Yf[c](h);if(typeof f=="string"||f===void 0)return f;for(var y=0;y<f.length;y++)f[y]=Math.round(f[y]);return f}}(Ih)}var jh=function(){this.convs={}};jh.prototype.routeSpace=function(c,h){var f=h[0];return f===void 0?this.getValues(c):(typeof f=="number"&&(f=Array.prototype.slice.call(h)),this.setValues(c,f))};jh.prototype.setValues=function(c,h){return this.space=c,this.convs={},this.convs[c]=h,this};jh.prototype.getValues=function(c){var h=this.convs[c];if(!h){var f=this.space,y=this.convs[f];h=Ju[f][c](y),this.convs[c]=h}return h};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(c){jh.prototype[c]=function(h){return this.routeSpace(c,arguments)}});var A0=Ju,$f=A0,z0=function(c){var h,f,y,v;if(h=/^((?:rgb|hs[lv]|cmyk|xyz|lab)a?)\s*\(([^\)]*)\)/.exec(c)){var x=h[1],a=x.replace(/a$/,""),A=a==="cmyk"?4:3;f=$f[a],y=h[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map(function(R,B){return/%$/.test(R)&&B===A?parseFloat(R)/100:(/%$/.test(R),parseFloat(R))}),x===a&&y.push(1),v=y[A]===void 0?1:y[A],y=y.slice(0,A),f[a]=function(){return y}}else if(/^#[A-Fa-f0-9]+$/.test(c)){var a=c.replace(/^#/,""),A=a.length;f=$f.rgb,y=a.split(A===3?/(.)/:/(..)/),y=y.filter(Boolean).map(function(G){return parseInt(A===3?G+G:G,16)}),v=1,f.rgb=function(){return y},y[0]||(y[0]=0),y[1]||(y[1]=0),y[2]||(y[2]=0)}else f=$f.keyword,f.keyword=function(){return c},y=c,v=1;var I={rgb:void 0,hsl:void 0,hsv:void 0,cmyk:void 0,keyword:void 0,hex:void 0};try{I.rgb=f.rgb(y)}catch{}try{I.hsl=f.hsl(y)}catch{}try{I.hsv=f.hsv(y)}catch{}try{I.cmyk=f.cmyk(y)}catch{}try{I.keyword=f.keyword(y)}catch{}return I.rgb&&(I.hex="#"+I.rgb.map(function(R){var B=R.toString(16);return B.length===1?"0"+B:B}).join("")),I.rgb&&(I.rgba=I.rgb.concat(v)),I.hsl&&(I.hsla=I.hsl.concat(v)),I.hsv&&(I.hsva=I.hsv.concat(v)),I.cmyk&&(I.cmyka=I.cmyk.concat(v)),I};function P0(c){let h,f;const y=c[5].default,v=Fc(y,c,c[4],null);return{c(){h=ce("span"),v&&v.c(),this.h()},l(x){h=he(x,"SPAN",{class:!0,style:!0,role:!0});var a=fe(h);v&&v.l(a),a.forEach(O),this.h()},h(){U(h,"class","em svelte-s1t2y4"),De(h,"background-color",c[0]),De(h,"color",c[2]),U(h,"role","presentation"),en(h,"nowrap",c[1])},m(x,a){Ie(x,h,a),v&&v.m(h,null),f=!0},p(x,[a]){v&&v.p&&(!f||a&16)&&Nc(v,y,x,x[4],f?Uc(y,x[4],a,null):Vc(x[4]),null),(!f||a&1)&&De(h,"background-color",x[0]),(!f||a&4)&&De(h,"color",x[2]),a&2&&en(h,"nowrap",x[1])},i(x){f||(bt(v,x),f=!0)},o(x){Ot(v,x),f=!1},d(x){x&&O(h),v&&v.d(x)}}}function C0(c,h,f){let y,{$$slots:v={},$$scope:x}=h,{color:a="lightgrey"}=h,{nowrap:A=!0}=h;function I(B){return(B[0]*299+B[1]*587+B[2]*114)/1e3>125?"black":"white"}let R="black";return c.$$set=B=>{"color"in B&&f(0,a=B.color),"nowrap"in B&&f(1,A=B.nowrap),"$$scope"in B&&f(4,x=B.$$scope)},c.$$.update=()=>{c.$$.dirty&1&&f(3,y=z0(a).rgb),c.$$.dirty&8&&y&&f(2,R=I(y))},[a,A,R,y,x,v]}class _f extends Ba{constructor(h){super(),Oa(this,h,C0,P0,Fa,{color:0,nowrap:1})}}function ly(c,h,f){const y=c.slice();return y[33]=h[f],y[36]=h,y[35]=f,y}function uy(c,h,f){const y=c.slice();return y[33]=h[f],y[34]=h,y[35]=f,y}function M0(c){let h,f,y=(c[0]?c[0]:"Select one")+"",v,x,a,A,I,R;return{c(){h=ce("a"),f=ce("span"),v=we(y),x=He(),a=ce("span"),A=we("\xA0"),this.h()},l(B){h=he(B,"A",{id:!0,class:!0});var G=fe(h);f=he(G,"SPAN",{class:!0});var j=fe(f);v=Se(j,y),j.forEach(O),x=Je(G),a=he(G,"SPAN",{class:!0});var H=fe(a);A=Se(H,"\xA0"),H.forEach(O),G.forEach(O),this.h()},h(){U(f,"class","svelte-13flvue"),U(a,"class","button svelte-13flvue"),en(a,"search",c[3]),en(a,"down",!c[3]),U(h,"id","toggle"),U(h,"class","svelte-13flvue")},m(B,G){Ie(B,h,G),V(h,f),V(f,v),V(h,x),V(h,a),V(a,A),I||(R=Kn(h,"click",c[12]),I=!0)},p(B,G){G[0]&1&&y!==(y=(B[0]?B[0]:"Select one")+"")&&Ct(v,y),G[0]&8&&en(a,"search",B[3]),G[0]&8&&en(a,"down",!B[3])},d(B){B&&O(h),I=!1,R()}}}function D0(c){let h,f,y=c[5][c[1]]+"",v,x,a,A,I,R,B,G=c[2]&&cy(c);return{c(){h=ce("a"),f=ce("span"),v=we(y),x=He(),G&&G.c(),a=He(),A=ce("span"),I=we("\xA0"),this.h()},l(j){h=he(j,"A",{id:!0,class:!0});var H=fe(h);f=he(H,"SPAN",{class:!0});var de=fe(f);v=Se(de,y),x=Je(de),G&&G.l(de),de.forEach(O),a=Je(H),A=he(H,"SPAN",{class:!0});var Ce=fe(A);I=Se(Ce,"\xA0"),Ce.forEach(O),H.forEach(O),this.h()},h(){U(f,"class","selection svelte-13flvue"),U(A,"class","button close svelte-13flvue"),U(h,"id","toggle"),U(h,"class","selected svelte-13flvue")},m(j,H){Ie(j,h,H),V(h,f),V(f,v),V(f,x),G&&G.m(f,null),V(h,a),V(h,A),V(A,I),R||(B=[Kn(A,"click",c[14]),Kn(h,"click",c[12])],R=!0)},p(j,H){H[0]&34&&y!==(y=j[5][j[1]]+"")&&Ct(v,y),j[2]?G?G.p(j,H):(G=cy(j),G.c(),G.m(f,null)):G&&(G.d(1),G=null)},d(j){j&&O(h),G&&G.d(),R=!1,$u(B)}}}function cy(c){let h,f=c[5][c[2]]+"",y;return{c(){h=ce("small"),y=we(f),this.h()},l(v){h=he(v,"SMALL",{class:!0});var x=fe(h);y=Se(x,f),x.forEach(O),this.h()},h(){U(h,"class","svelte-13flvue")},m(v,x){Ie(v,h,x),V(h,y)},p(v,x){x[0]&36&&f!==(f=v[5][v[2]]+"")&&Ct(y,f)},d(v){v&&O(h)}}}function hy(c){let h,f,y,v,x,a;function A(B,G){return B[4].length<3?O0:B[8][0]&&B[2]?B0:B[8][0]?R0:L0}let I=A(c),R=I(c);return{c(){h=ce("div"),f=ce("input"),y=He(),v=ce("ul"),R.c(),this.h()},l(B){h=he(B,"DIV",{id:!0,style:!0,class:!0});var G=fe(h);f=he(G,"INPUT",{type:!0,placeholder:!0,autocomplete:!0,onfocus:!0,class:!0}),y=Je(G),v=he(G,"UL",{class:!0});var j=fe(v);R.l(j),j.forEach(O),G.forEach(O),this.h()},h(){U(f,"type","text"),U(f,"placeholder",""),U(f,"autocomplete","false"),f.autofocus="autofocus",U(f,"onfocus","this.select()"),U(f,"class","svelte-13flvue"),U(v,"class","svelte-13flvue"),U(h,"id","dropdown"),De(h,"top","0"),U(h,"class","svelte-13flvue")},m(B,G){Ie(B,h,G),V(h,f),ym(f,c[4]),c[24](f),V(h,y),V(h,v),R.m(v,null),c[31](h),f.focus(),x||(a=[Kn(f,"input",c[23]),Kn(f,"keyup",c[16])],x=!0)},p(B,G){G[0]&16&&f.value!==B[4]&&ym(f,B[4]),I===(I=A(B))&&R?R.p(B,G):(R.d(1),R=I(B),R&&(R.c(),R.m(v,null)))},d(B){B&&O(h),c[24](null),R.d(),c[31](null),x=!1,$u(a)}}}function L0(c){let h,f;return{c(){h=ce("li"),f=we("No results"),this.h()},l(y){h=he(y,"LI",{class:!0});var v=fe(h);f=Se(v,"No results"),v.forEach(O),this.h()},h(){U(h,"class","svelte-13flvue")},m(y,v){Ie(y,h,v),V(h,f)},p:Ro,d(y){y&&O(h)}}}function R0(c){let h,f=c[8],y=[];for(let v=0;v<f.length;v+=1)y[v]=py(ly(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=ki()},l(v){for(let x=0;x<y.length;x+=1)y[x].l(v);h=ki()},m(v,x){for(let a=0;a<y.length;a+=1)y[a].m(v,x);Ie(v,h,x)},p(v,x){if(x[0]&10626){f=v[8];let a;for(a=0;a<f.length;a+=1){const A=ly(v,f,a);y[a]?y[a].p(A,x):(y[a]=py(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){Js(y,v),v&&O(h)}}}function B0(c){let h,f=c[8],y=[];for(let v=0;v<f.length;v+=1)y[v]=fy(uy(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=ki()},l(v){for(let x=0;x<y.length;x+=1)y[x].l(v);h=ki()},m(v,x){for(let a=0;a<y.length;a+=1)y[a].m(v,x);Ie(v,h,x)},p(v,x){if(x[0]&10630){f=v[8];let a;for(a=0;a<f.length;a+=1){const A=uy(v,f,a);y[a]?y[a].p(A,x):(y[a]=fy(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){Js(y,v),v&&O(h)}}}function O0(c){let h,f;return{c(){h=ce("li"),f=we("Type a name..."),this.h()},l(y){h=he(y,"LI",{class:!0});var v=fe(h);f=Se(v,"Type a name..."),v.forEach(O),this.h()},h(){U(h,"class","svelte-13flvue")},m(y,v){Ie(y,h,v),V(h,f)},p:Ro,d(y){y&&O(h)}}}function py(c){let h,f=c[33][c[1]]+"",y,v,x=c[35],a,A;function I(){return c[28](c[33])}function R(){return c[29](c[35])}const B=()=>c[30](h,x),G=()=>c[30](null,x);return{c(){h=ce("li"),y=we(f),v=He(),this.h()},l(j){h=he(j,"LI",{class:!0});var H=fe(h);y=Se(H,f),v=Je(H),H.forEach(O),this.h()},h(){U(h,"class","svelte-13flvue"),en(h,"highlight",c[7]==c[35])},m(j,H){Ie(j,h,H),V(h,y),V(h,v),B(),a||(A=[Kn(h,"click",I),Kn(h,"mouseover",R)],a=!0)},p(j,H){c=j,H[0]&258&&f!==(f=c[33][c[1]]+"")&&Ct(y,f),x!==c[35]&&(G(),x=c[35],B()),H[0]&128&&en(h,"highlight",c[7]==c[35])},d(j){j&&O(h),G(),a=!1,$u(A)}}}function fy(c){let h,f=c[33][c[1]]+"",y,v,x,a=c[33][c[2]]+"",A,I,R=c[35],B,G;function j(){return c[25](c[33])}function H(){return c[26](c[35])}const de=()=>c[27](h,R),Ce=()=>c[27](null,R);return{c(){h=ce("li"),y=we(f),v=He(),x=ce("small"),A=we(a),I=He(),this.h()},l(xe){h=he(xe,"LI",{class:!0});var Xe=fe(h);y=Se(Xe,f),v=Je(Xe),x=he(Xe,"SMALL",{class:!0});var Ue=fe(x);A=Se(Ue,a),Ue.forEach(O),I=Je(Xe),Xe.forEach(O),this.h()},h(){U(x,"class","svelte-13flvue"),U(h,"class","svelte-13flvue"),en(h,"highlight",c[7]==c[35])},m(xe,Xe){Ie(xe,h,Xe),V(h,y),V(h,v),V(h,x),V(x,A),V(h,I),de(),B||(G=[Kn(h,"click",j),Kn(h,"mouseover",H)],B=!0)},p(xe,Xe){c=xe,Xe[0]&258&&f!==(f=c[33][c[1]]+"")&&Ct(y,f),Xe[0]&260&&a!==(a=c[33][c[2]]+"")&&Ct(A,a),R!==c[35]&&(Ce(),R=c[35],de()),Xe[0]&128&&en(h,"highlight",c[7]==c[35])},d(xe){xe&&O(h),Ce(),B=!1,$u(G)}}}function F0(c){let h,f,y,v;function x(R,B){return R[5]&&!R[3]?D0:M0}let a=x(c),A=a(c),I=c[6]&&hy(c);return{c(){h=ce("div"),A.c(),f=He(),I&&I.c(),this.h()},l(R){h=he(R,"DIV",{id:!0,class:!0});var B=fe(h);A.l(B),f=Je(B),I&&I.l(B),B.forEach(O),this.h()},h(){U(h,"id","select"),U(h,"class","svelte-13flvue"),en(h,"active",c[6])},m(R,B){Ie(R,h,B),A.m(h,null),V(h,f),I&&I.m(h,null),y||(v=[Kn(window,"click",c[17]),Kn(h,"keydown",c[15])],y=!0)},p(R,B){a===(a=x(R))&&A?A.p(R,B):(A.d(1),A=a(R),A&&(A.c(),A.m(h,f))),R[6]?I?I.p(R,B):(I=hy(R),I.c(),I.m(h,null)):I&&(I.d(1),I=null),B[0]&64&&en(h,"active",R[6])},i:Ro,o:Ro,d(R){R&&O(h),A.d(),I&&I.d(),y=!1,$u(v)}}}function N0(c){return new Promise(h=>setTimeout(h,c))}function V0(c,h,f){let y;const v=jy();let{options:x}=h,{selected:a=null}=h,{placeholder:A="Enter a town or area name"}=h,{value:I="code"}=h,{label:R="name"}=h,{group:B=null}=h,{search:G=!1}=h,j=a,H=a?x.find(qe=>{qe[I]==a[I]}):null,de=!1,Ce="",xe=null,Xe,Ue,Bt,St=[];function ut(qe){qe.stopPropagation(),f(4,Ce=""),f(6,de=!de),N0(10).then(()=>{Bt&&de&&Bt.focus()})}function We(qe){f(18,a=qe),f(6,de=!1),v("select",{selected:qe,value:qe[I]})}function tr(qe){qe.stopPropagation(),f(18,a=null),f(21,j=null),f(5,H=null),v("select",{selected:null,value:null})}function Xt(qe){de&&Xe[0]&&Number.isInteger(xe)&&(qe.keyCode===38?(f(7,xe-=xe>0?1:0),St[xe].scrollIntoView({block:"nearest",inline:"start"})):qe.keyCode===40&&(f(7,xe+=xe<Xe.length-1?1:0),St[xe].scrollIntoView({block:"nearest",inline:"end"})))}function xt(qe){Xe[0]&&Number.isInteger(xe)&&qe.keyCode===13&&We(Xe[xe])}function qt(qe){qe.target!==Ue&&(f(6,de=!1),f(7,xe=0))}function Ge(){Ce=this.value,f(4,Ce)}function Rt(qe){eu[qe?"unshift":"push"](()=>{Bt=qe,f(10,Bt)})}const yt=qe=>We(qe),gt=qe=>f(7,xe=qe);function Le(qe,$e){eu[qe?"unshift":"push"](()=>{St[$e]=qe,f(11,St)})}const Ne=qe=>We(qe),Et=qe=>f(7,xe=qe);function mr(qe,$e){eu[qe?"unshift":"push"](()=>{St[$e]=qe,f(11,St)})}function Wt(qe){eu[qe?"unshift":"push"](()=>{Ue=qe,f(9,Ue)})}return c.$$set=qe=>{"options"in qe&&f(19,x=qe.options),"selected"in qe&&f(18,a=qe.selected),"placeholder"in qe&&f(0,A=qe.placeholder),"value"in qe&&f(20,I=qe.value),"label"in qe&&f(1,R=qe.label),"group"in qe&&f(2,B=qe.group),"search"in qe&&f(3,G=qe.search)},c.$$.update=()=>{c.$$.dirty[0]&16&&f(22,y=Ce?new RegExp(Ce,"i"):null),c.$$.dirty[0]&4718594&&(f(8,Xe=y?x.filter(qe=>y.test(qe[R])):x),f(7,xe=0)),c.$$.dirty[0]&3932160&&j!=a&&(f(5,H=x.find(qe=>qe[I]==a[I])),f(21,j=a))},[A,R,B,G,Ce,H,de,xe,Xe,Ue,Bt,St,ut,We,tr,Xt,xt,qt,a,x,I,j,y,Ge,Rt,yt,gt,Le,Ne,Et,mr,Wt]}class U0 extends Ba{constructor(h){super(),Oa(this,h,V0,F0,Fa,{options:19,selected:18,placeholder:0,value:20,label:1,group:2,search:3},null,[-1,-1])}}var Ph={exports:{}};(function(c,h){(function(f,y){c.exports=y()})($v,function(){var f,y,v;function x(a,A){if(!f)f=A;else if(!y)y=A;else{var I="var sharedChunk = {}; ("+f+")(sharedChunk); ("+y+")(sharedChunk);",R={};f(R),v=A(R),typeof window<"u"&&(v.workerUrl=window.URL.createObjectURL(new Blob([I],{type:"text/javascript"})))}}return x(["exports"],function(a){function A(e,t){return e(t={exports:{}},t.exports),t.exports}var I=R;function R(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}R.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},R.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},R.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},R.prototype.solveCurveX=function(e,t){var i,l,p,d,_;for(t===void 0&&(t=1e-6),p=e,_=0;_<8;_++){if(d=this.sampleCurveX(p)-e,Math.abs(d)<t)return p;var E=this.sampleCurveDerivativeX(p);if(Math.abs(E)<1e-6)break;p-=d/E}if((p=e)<(i=0))return i;if(p>(l=1))return l;for(;i<l;){if(d=this.sampleCurveX(p),Math.abs(d-e)<t)return p;e>d?i=p:l=p,p=.5*(l-i)+i}return p},R.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var B=G;function G(e,t){this.x=e,this.y=t}G.prototype={clone:function(){return new G(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),p=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},G.convert=function(e){return e instanceof G?e:Array.isArray(e)?new G(e[0],e[1]):e};var j=typeof self<"u"?self:{},H=Math.pow(2,53)-1;function de(e,t,i,l){var p=new I(e,t,i,l);return function(d){return p.solve(d)}}var Ce=de(.25,.1,.25,1);function xe(e,t,i){return Math.min(i,Math.max(t,e))}function Xe(e,t,i){var l=i-t,p=((e-t)%l+l)%l+t;return p===t?i:p}function Ue(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var d=p[l];for(var _ in d)e[_]=d[_]}return e}var Bt=1;function St(){return Bt++}function ut(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function We(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function tr(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function Xt(e,t){return e.indexOf(t,e.length-t.length)!==-1}function xt(e,t,i){var l={};for(var p in e)l[p]=t.call(i||this,e[p],p,e);return l}function qt(e,t,i){var l={};for(var p in e)t.call(i||this,e[p],p,e)&&(l[p]=e[p]);return l}function Ge(e){return Array.isArray(e)?e.map(Ge):typeof e=="object"&&e?xt(e,Ge):e}var Rt={};function yt(e){Rt[e]||(typeof console<"u"&&console.warn(e),Rt[e]=!0)}function gt(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function Le(e){for(var t=0,i=0,l=e.length,p=l-1,d=void 0,_=void 0;i<l;p=i++)t+=((_=e[p]).x-(d=e[i]).x)*(d.y+_.y);return t}function Ne(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Et(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,p,d,_){var E=d||_;return t[p]=!E||E.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var mr=null;function Wt(e){if(mr==null){var t=e.navigator?e.navigator.userAgent:null;mr=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return mr}function qe(e){try{var t=j[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var $e,lr,gr,pi,ii=j.performance&&j.performance.now?j.performance.now.bind(j.performance):Date.now.bind(Date),Zr=j.requestAnimationFrame||j.mozRequestAnimationFrame||j.webkitRequestAnimationFrame||j.msRequestAnimationFrame,Gr=j.cancelAnimationFrame||j.mozCancelAnimationFrame||j.webkitCancelAnimationFrame||j.msCancelAnimationFrame,si={now:ii,frame:function(e){var t=Zr(e);return{cancel:function(){return Gr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=j.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return $e||($e=j.document.createElement("a")),$e.href=e,$e.href},hardwareConcurrency:j.navigator&&j.navigator.hardwareConcurrency||4,get devicePixelRatio(){return j.devicePixelRatio},get prefersReducedMotion(){return!!j.matchMedia&&(lr==null&&(lr=j.matchMedia("(prefers-reduced-motion: reduce)")),lr.matches)}},kt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ur={supported:!1,testSupport:function(e){!wt&&pi&&(Ht?It(e):gr=e)}},wt=!1,Ht=!1;function It(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,pi),e.isContextLost())return;ur.supported=!0}catch{}e.deleteTexture(t),wt=!0}j.document&&((pi=j.document.createElement("img")).onload=function(){gr&&It(gr),gr=null,Ht=!0},pi.onerror=function(){wt=!0,gr=null},pi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ei="01",Or=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function li(e){return e.indexOf("mapbox:")===0}Or.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ei,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Or.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Or.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Or.prototype.normalizeStyleURL=function(e,t){if(!li(e))return e;var i=wr(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Or.prototype.normalizeGlyphsURL=function(e,t){if(!li(e))return e;var i=wr(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Or.prototype.normalizeSourceURL=function(e,t){if(!li(e))return e;var i=wr(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},Or.prototype.normalizeSpriteURL=function(e,t,i,l){var p=wr(e);return li(e)?(p.path="/styles/v1"+p.path+"/sprite"+t+i,this._makeAPIURL(p,this._customAccessToken||l)):(p.path+=""+t+i,fi(p))},Or.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!li(e))return e;var i=wr(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(si.devicePixelRatio>=2||t===512?"@2x":"")+(ur.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(p){for(var d=0,_=p;d<_.length;d+=1){var E=_[d].match(/^access_token=(.*)$/);if(E)return E[1]}return null}(i.params)||kt.ACCESS_TOKEN;return kt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},Or.prototype.canonicalizeTileURL=function(e,t){var i=wr(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var p=i.params;return t&&(p=p.filter(function(d){return!d.match(/^access_token=/)})),p.length&&(l+="?"+p.join("&")),l},Or.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&li(t),l=[],p=0,d=e.tiles||[];p<d.length;p+=1){var _=d[p];Si(_)?l.push(this.canonicalizeTileURL(_,i)):l.push(_)}return l},Or.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=wr(kt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var p=e.params.indexOf("secure");p>=0&&e.params.splice(p,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!kt.REQUIRE_ACCESS_TOKEN)return fi(e);if(!(t=t||kt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(d){return d.indexOf("access_token")===-1}),e.params.push("access_token="+t),fi(e)};var _n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Si(e){return _n.test(e)}var tn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function wr(e){var t=e.match(tn);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function fi(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Fi(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(j.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Ni=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Ni.prototype.getStorageKey=function(e){var t,i=Fi(kt.ACCESS_TOKEN);return t=i&&i.u?j.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,p){return String.fromCharCode(Number("0x"+p))})):kt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},Ni.prototype.fetchEventData=function(){var e=qe("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=j.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var p=j.localStorage.getItem(i);p&&(this.anonId=p)}catch{yt("Unable to read from LocalStorage")}},Ni.prototype.saveEventData=function(){var e=qe("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{j.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&j.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{yt("Unable to write to LocalStorage")}},Ni.prototype.processRequests=function(e){},Ni.prototype.postEvent=function(e,t,i,l){var p=this;if(kt.EVENTS_URL){var d=wr(kt.EVENTS_URL);d.params.push("access_token="+(l||kt.ACCESS_TOKEN||""));var _={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:ei,userId:this.anonId},E=t?Ue(_,t):_,T={url:fi(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=xr(T,function(z){p.pendingRequest=null,i(z),p.saveEventData(),p.processRequests(l)})}},Ni.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var di,oo,Xi=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,p,d){this.skuToken=p,(kt.EVENTS_URL&&d||kt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(_){return li(_)||Si(_)}))&&this.queueRequest({id:l,timestamp:Date.now()},d)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var p=this.queue.shift(),d=p.id,_=p.timestamp;d&&this.success[d]||(this.anonId||this.fetchEventData(),We(this.anonId)||(this.anonId=ut()),this.postEvent(_,{skuToken:this.skuToken},function(E){E||d&&(l.success[d]=!0)},i))}},t}(Ni),vn=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){kt.EVENTS_URL&&kt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(p){return li(p)||Si(p)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var p=Fi(kt.ACCESS_TOKEN),d=p?p.u:kt.ACCESS_TOKEN,_=d!==this.eventData.tokenU;We(this.anonId)||(this.anonId=ut(),_=!0);var E=this.queue.shift();if(this.eventData.lastSuccess){var T=new Date(this.eventData.lastSuccess),z=new Date(E),C=(E-this.eventData.lastSuccess)/864e5;_=_||C>=1||C<-1||T.getDate()!==z.getDate()}else _=!0;if(!_)return this.processRequests();this.postEvent(E,{"enabled.telemetry":!1},function(D){D||(l.eventData.lastSuccess=E,l.eventData.tokenU=d)},i)}},t}(Ni)),Xn=vn.postTurnstileEvent.bind(vn),Bo=new Xi,zn=Bo.postMapLoadEvent.bind(Bo),Wn=500,ia=50;function So(){j.caches&&!di&&(di=j.caches.open("mapbox-tiles"))}function Pn(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Cn,Eo=1/0;function Oo(){return Cn==null&&(Cn=j.OffscreenCanvas&&new j.OffscreenCanvas(1,1).getContext("2d")&&typeof j.createImageBitmap=="function"),Cn}var na={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(na);var Fo=function(e){function t(i,l,p){l===401&&Si(p)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=p,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),ao=Ne()?function(){return self.worker&&self.worker.referrer}:function(){return(j.location.protocol==="blob:"?j.parent:j).location.href},Kr,mi,rn=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(ao())&&!/^\w+:/.test(i))){if(j.fetch&&j.Request&&j.AbortController&&j.Request.prototype.hasOwnProperty("signal"))return function(l,p){var d,_=new j.AbortController,E=new j.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:ao(),signal:_.signal}),T=!1,z=!1,C=(d=E.url).indexOf("sku=")>0&&Si(d);l.type==="json"&&E.headers.set("Accept","application/json");var D=function(K,te,ne){if(!z){if(K&&K.message!=="SecurityError"&&yt(K),te&&ne)return N(te);var pe=Date.now();j.fetch(E).then(function(ae){if(ae.ok){var ge=C?ae.clone():null;return N(ae,ge,pe)}return p(new Fo(ae.statusText,ae.status,l.url))}).catch(function(ae){ae.code!==20&&p(new Error(ae.message))})}},N=function(K,te,ne){(l.type==="arrayBuffer"?K.arrayBuffer():l.type==="json"?K.json():K.text()).then(function(pe){z||(te&&ne&&function(ae,ge,ke){if(So(),di){var Pe={status:ge.status,statusText:ge.statusText,headers:new j.Headers};ge.headers.forEach(function(Fe,Qe){return Pe.headers.set(Qe,Fe)});var Be=Et(ge.headers.get("Cache-Control")||"");Be["no-store"]||(Be["max-age"]&&Pe.headers.set("Expires",new Date(ke+1e3*Be["max-age"]).toUTCString()),new Date(Pe.headers.get("Expires")).getTime()-ke<42e4||function(Fe,Qe){if(oo===void 0)try{new Response(new ReadableStream),oo=!0}catch{oo=!1}oo?Qe(Fe.body):Fe.blob().then(Qe)}(ge,function(Fe){var Qe=new j.Response(Fe,Pe);So(),di&&di.then(function(nt){return nt.put(Pn(ae.url),Qe)}).catch(function(nt){return yt(nt.message)})}))}}(E,te,ne),T=!0,p(null,pe,K.headers.get("Cache-Control"),K.headers.get("Expires")))}).catch(function(pe){z||p(new Error(pe.message))})};return C?function(K,te){if(So(),!di)return te(null);var ne=Pn(K.url);di.then(function(pe){pe.match(ne).then(function(ae){var ge=function(ke){if(!ke)return!1;var Pe=new Date(ke.headers.get("Expires")||0),Be=Et(ke.headers.get("Cache-Control")||"");return Pe>Date.now()&&!Be["no-cache"]}(ae);pe.delete(ne),ge&&pe.put(ne,ae.clone()),te(null,ae,ge)}).catch(te)}).catch(te)}(E,D):D(null,null),{cancel:function(){z=!0,T||_.abort()}}}(e,t);if(Ne()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,p){var d=new j.XMLHttpRequest;for(var _ in d.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(d.responseType="arraybuffer"),l.headers)d.setRequestHeader(_,l.headers[_]);return l.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=l.credentials==="include",d.onerror=function(){p(new Error(d.statusText))},d.onload=function(){if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){var E=d.response;if(l.type==="json")try{E=JSON.parse(d.response)}catch(T){return p(T)}p(null,E,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else p(new Fo(d.statusText,d.status,l.url))},d.send(l.body),{cancel:function(){return d.abort()}}}(e,t)},so=function(e,t){return rn(Ue(e,{type:"arrayBuffer"}),t)},xr=function(e,t){return rn(Ue(e,{method:"POST"}),t)},M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Kr=[],mi=0;var F=function(e,t){if(ur.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),mi>=kt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return Kr.push(i),i}mi++;var l=!1,p=function(){if(!l)for(l=!0,mi--;Kr.length&&mi<kt.MAX_PARALLEL_IMAGE_REQUESTS;){var _=Kr.shift();_.cancelled||(_.cancel=F(_.requestParameters,_.callback).cancel)}},d=so(e,function(_,E,T,z){p(),_?t(_):E&&(Oo()?function(C,D){var N=new j.Blob([new Uint8Array(C)],{type:"image/png"});j.createImageBitmap(N).then(function(K){D(null,K)}).catch(function(K){D(new Error("Could not load image because of "+K.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(E,t):function(C,D,N,K){var te=new j.Image,ne=j.URL;te.onload=function(){D(null,te),ne.revokeObjectURL(te.src),te.onload=null,j.requestAnimationFrame(function(){te.src=M})},te.onerror=function(){return D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var pe=new j.Blob([new Uint8Array(C)],{type:"image/png"});te.cacheControl=N,te.expires=K,te.src=C.byteLength?ne.createObjectURL(pe):M}(E,t,T,z))});return{cancel:function(){d.cancel(),p()}}};function q(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function Y(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var re=function(e,t){t===void 0&&(t={}),Ue(this,t),this.type=e},ue=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",Ue({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(re),ye=function(){};ye.prototype.on=function(e,t){return this._listeners=this._listeners||{},q(e,t,this._listeners),this},ye.prototype.off=function(e,t){return Y(e,t,this._listeners),Y(e,t,this._oneTimeListeners),this},ye.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},q(e,t,this._oneTimeListeners),this},ye.prototype.fire=function(e,t){typeof e=="string"&&(e=new re(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,p=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<p.length;l+=1)p[l].call(this,e);for(var d=0,_=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];d<_.length;d+=1){var E=_[d];Y(i,E,this._oneTimeListeners),E.call(this,e)}var T=this._eventedParent;T&&(Ue(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(e))}else e instanceof ue&&console.error(e.error);return this},ye.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},ye.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Z={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},oe=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function ve(e){var t=e.value;return t?[new oe(e.key,t,"constants have been deprecated as of v8")]:[]}function Ve(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var d=p[l];for(var _ in d)e[_]=d[_]}return e}function Ze(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Re(e){if(Array.isArray(e))return e.map(Re);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=Re(e[i]);return t}return Ze(e)}var je=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),ht=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var p=l[i];this.bindings[p[0]]=p[1]}};ht.prototype.concat=function(e){return new ht(this,e)},ht.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},ht.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var st={kind:"null"},ze={kind:"number"},tt={kind:"string"},Ye={kind:"boolean"},it={kind:"color"},Ut={kind:"object"},ot={kind:"value"},er={kind:"collator"},cr={kind:"formatted"},Zt={kind:"resolvedImage"};function or(e,t){return{kind:"array",itemType:e,N:t}}function Jt(e){if(e.kind==="array"){var t=Jt(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var ui=[st,ze,tt,Ye,it,cr,Ut,or(ot),Zt];function fr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!fr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=ui;i<l.length;i+=1)if(!fr(l[i],t))return null}}return"Expected "+Jt(e)+" but found "+Jt(t)+" instead."}function Fr(e,t){return t.some(function(i){return i.kind===e.kind})}function nr(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Gt=A(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(E){return(E=Math.round(E))<0?0:E>255?255:E}function p(E){return l(E[E.length-1]==="%"?parseFloat(E)/100*255:parseInt(E))}function d(E){return(T=E[E.length-1]==="%"?parseFloat(E)/100:parseFloat(E))<0?0:T>1?1:T;var T}function _(E,T,z){return z<0?z+=1:z>1&&(z-=1),6*z<1?E+(T-E)*z*6:2*z<1?T:3*z<2?E+(T-E)*(2/3-z)*6:E}try{t.parseCSSColor=function(E){var T,z=E.replace(/ /g,"").toLowerCase();if(z in i)return i[z].slice();if(z[0]==="#")return z.length===4?(T=parseInt(z.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:z.length===7&&(T=parseInt(z.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var C=z.indexOf("("),D=z.indexOf(")");if(C!==-1&&D+1===z.length){var N=z.substr(0,C),K=z.substr(C+1,D-(C+1)).split(","),te=1;switch(N){case"rgba":if(K.length!==4)return null;te=d(K.pop());case"rgb":return K.length!==3?null:[p(K[0]),p(K[1]),p(K[2]),te];case"hsla":if(K.length!==4)return null;te=d(K.pop());case"hsl":if(K.length!==3)return null;var ne=(parseFloat(K[0])%360+360)%360/360,pe=d(K[1]),ae=d(K[2]),ge=ae<=.5?ae*(pe+1):ae+pe-ae*pe,ke=2*ae-ge;return[l(255*_(ke,ge,ne+1/3)),l(255*_(ke,ge,ne)),l(255*_(ke,ge,ne-1/3)),te];default:return null}}return null}}catch{}}).parseCSSColor,ar=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};ar.parse=function(e){if(e){if(e instanceof ar)return e;if(typeof e=="string"){var t=Gt(e);if(t)return new ar(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ar.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},ar.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},ar.black=new ar(0,0,0,1),ar.white=new ar(1,1,1,1),ar.transparent=new ar(0,0,0,0),ar.red=new ar(1,0,0,1);var Ei=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ei.prototype.compare=function(e,t){return this.collator.compare(e,t)},Ei.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ko=function(e,t,i,l,p){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=p},Nr=function(e){this.sections=e};Nr.fromString=function(e){return new Nr([new ko(e,null,null,null,null)])},Nr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Nr.factory=function(e){return e instanceof Nr?e:Nr.fromString(e)},Nr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Nr.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var p={};l.fontStack&&(p["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(p["font-scale"]=l.scale),l.textColor&&(p["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(p)}}return e};var ni=function(e){this.name=e.name,this.available=e.available};function _a(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function No(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof ar||e instanceof Ei||e instanceof Nr||e instanceof ni)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!No(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!No(e[l]))return!1;return!0}return!1}function Sr(e){if(e===null)return st;if(typeof e=="string")return tt;if(typeof e=="boolean")return Ye;if(typeof e=="number")return ze;if(e instanceof ar)return it;if(e instanceof Ei)return er;if(e instanceof Nr)return cr;if(e instanceof ni)return Zt;if(Array.isArray(e)){for(var t,i=e.length,l=0,p=e;l<p.length;l+=1){var d=Sr(p[l]);if(t){if(t===d)continue;t=ot;break}t=d}return or(t||ot,i)}return Ut}function Vo(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof ar||e instanceof Nr||e instanceof ni?e.toString():JSON.stringify(e)}ni.prototype.toString=function(){return this.name},ni.fromString=function(e){return e?new ni({name:e,available:!1}):null},ni.prototype.serialize=function(){return["image",this.name]};var Xr=function(e,t){this.type=e,this.value=t};Xr.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!No(e[1]))return t.error("invalid value");var i=e[1],l=Sr(i),p=t.expectedType;return l.kind!=="array"||l.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(l=p),new Xr(l,i)},Xr.prototype.evaluate=function(){return this.value},Xr.prototype.eachChild=function(){},Xr.prototype.outputDefined=function(){return!0},Xr.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ar?["rgba"].concat(this.value.toArray()):this.value instanceof Nr?this.value.serialize():this.value};var Er=function(e){this.name="ExpressionEvaluationError",this.message=e};Er.prototype.toJSON=function(){return this.message};var yi={string:tt,number:ze,boolean:Ye,object:Ut},Pr=function(e,t){this.type=e,this.args=t};Pr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,p=e[0];if(p==="array"){var d,_;if(e.length>2){var E=e[1];if(typeof E!="string"||!(E in yi)||E==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);d=yi[E],l++}else d=ot;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);_=e[2],l++}i=or(d,_)}else i=yi[p];for(var T=[];l<e.length;l++){var z=t.parse(e[l],l,ot);if(!z)return null;T.push(z)}return new Pr(i,T)},Pr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!fr(this.type,Sr(i)))return i;if(t===this.args.length-1)throw new Er("Expected value to be of type "+Jt(this.type)+", but found "+Jt(Sr(i))+" instead.")}return null},Pr.prototype.eachChild=function(e){this.args.forEach(e)},Pr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Pr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(p){return p.serialize()}))};var Wi=function(e){this.type=cr,this.sections=e};Wi.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],p=!1,d=1;d<=e.length-1;++d){var _=e[d];if(p&&typeof _=="object"&&!Array.isArray(_)){p=!1;var E=null;if(_["font-scale"]&&!(E=t.parse(_["font-scale"],1,ze)))return null;var T=null;if(_["text-font"]&&!(T=t.parse(_["text-font"],1,or(tt))))return null;var z=null;if(_["text-color"]&&!(z=t.parse(_["text-color"],1,it)))return null;var C=l[l.length-1];C.scale=E,C.font=T,C.textColor=z}else{var D=t.parse(e[d],1,ot);if(!D)return null;var N=D.type.kind;if(N!=="string"&&N!=="value"&&N!=="null"&&N!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,l.push({content:D,scale:null,font:null,textColor:null})}}return new Wi(l)},Wi.prototype.evaluate=function(e){return new Nr(this.sections.map(function(t){var i=t.content.evaluate(e);return Sr(i)===Zt?new ko("",i,null,null,null):new ko(Vo(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Wi.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},Wi.prototype.outputDefined=function(){return!1},Wi.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var p={};l.scale&&(p["font-scale"]=l.scale.serialize()),l.font&&(p["text-font"]=l.font.serialize()),l.textColor&&(p["text-color"]=l.textColor.serialize()),e.push(p)}return e};var Mn=function(e){this.type=Zt,this.input=e};Mn.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,tt);return i?new Mn(i):t.error("No image name provided.")},Mn.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=ni.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},Mn.prototype.eachChild=function(e){e(this.input)},Mn.prototype.outputDefined=function(){return!1},Mn.prototype.serialize=function(){return["image",this.input.serialize()]};var Ps={"to-boolean":Ye,"to-color":it,"to-number":ze,"to-string":tt},oi=function(e,t){this.type=e,this.args=t};oi.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=Ps[i],p=[],d=1;d<e.length;d++){var _=t.parse(e[d],d,ot);if(!_)return null;p.push(_)}return new oi(l,p)},oi.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,i,l=0,p=this.args;l<p.length;l+=1){if(i=null,(t=p[l].evaluate(e))instanceof ar)return t;if(typeof t=="string"){var d=e.parseColor(t);if(d)return d}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":_a(t[0],t[1],t[2],t[3])))return new ar(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Er(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var _=null,E=0,T=this.args;E<T.length;E+=1){if((_=T[E].evaluate(e))===null)return 0;var z=Number(_);if(!isNaN(z))return z}throw new Er("Could not convert "+JSON.stringify(_)+" to number.")}return this.type.kind==="formatted"?Nr.fromString(Vo(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?ni.fromString(Vo(this.args[0].evaluate(e))):Vo(this.args[0].evaluate(e))},oi.prototype.eachChild=function(e){this.args.forEach(e)},oi.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},oi.prototype.serialize=function(){if(this.type.kind==="formatted")return new Wi([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Mn(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Dn=["Unknown","Point","LineString","Polygon"],Vi=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Vi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Vi.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Dn[this.feature.type]:this.feature.type:null},Vi.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Vi.prototype.canonicalID=function(){return this.canonical},Vi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Vi.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ar.parse(e)),t};var ai=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};ai.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ai.prototype.eachChild=function(e){this.args.forEach(e)},ai.prototype.outputDefined=function(){return!1},ai.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ai.parse=function(e,t){var i,l=e[0],p=ai.definitions[l];if(!p)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var d=Array.isArray(p)?p[0]:p.type,_=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,E=_.filter(function(Mt){var pt=Mt[0];return!Array.isArray(pt)||pt.length===e.length-1}),T=null,z=0,C=E;z<C.length;z+=1){var D=C[z],N=D[0],K=D[1];T=new Br(t.registry,t.path,null,t.scope);for(var te=[],ne=!1,pe=1;pe<e.length;pe++){var ae=e[pe],ge=Array.isArray(N)?N[pe-1]:N.type,ke=T.parse(ae,1+te.length,ge);if(!ke){ne=!0;break}te.push(ke)}if(!ne)if(Array.isArray(N)&&N.length!==te.length)T.error("Expected "+N.length+" arguments, but found "+te.length+" instead.");else{for(var Pe=0;Pe<te.length;Pe++){var Be=Array.isArray(N)?N[Pe]:N.type,Fe=te[Pe];T.concat(Pe+1).checkSubtype(Be,Fe.type)}if(T.errors.length===0)return new ai(l,d,K,te)}}if(E.length===1)(i=t.errors).push.apply(i,T.errors);else{for(var Qe=(E.length?E:_).map(function(Mt){var pt;return pt=Mt[0],Array.isArray(pt)?"("+pt.map(Jt).join(", ")+")":"("+Jt(pt.type)+"...)"}).join(" | "),nt=[],Tt=1;Tt<e.length;Tt++){var ct=t.parse(e[Tt],1+nt.length);if(!ct)return null;nt.push(Jt(ct.type))}t.error("Expected arguments of type "+Qe+", but found ("+nt.join(", ")+") instead.")}return null},ai.register=function(e,t){for(var i in ai.definitions=t,t)e[i]=ai};var bn=function(e,t,i){this.type=er,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function Ui(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Uo(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function jo(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,p=Math.pow(2,t.z);return[Math.round(i*p*8192),Math.round(l*p*8192)]}function Ys(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function Ci(e,t){for(var i,l,p,d,_,E,T,z=!1,C=0,D=t.length;C<D;C++)for(var N=t[C],K=0,te=N.length;K<te-1;K++){if((d=(i=e)[0]-(l=N[K])[0])*(T=i[1]-(p=N[K+1])[1])-(E=i[0]-p[0])*(_=i[1]-l[1])==0&&d*E<=0&&_*T<=0)return!1;Ys(e,N[K],N[K+1])&&(z=!z)}return z}function Na(e,t){for(var i=0;i<t.length;i++)if(Ci(e,t[i]))return!0;return!1}function qo(e,t,i,l){var p=l[0]-i[0],d=l[1]-i[1],_=(e[0]-i[0])*d-p*(e[1]-i[1]),E=(t[0]-i[0])*d-p*(t[1]-i[1]);return _>0&&E<0||_<0&&E>0}function kl(e,t,i){for(var l=0,p=i;l<p.length;l+=1)for(var d=p[l],_=0;_<d.length-1;++_)if((D=[(C=d[_+1])[0]-(z=d[_])[0],C[1]-z[1]])[0]*(N=[(T=t)[0]-(E=e)[0],T[1]-E[1]])[1]-D[1]*N[0]!=0&&qo(E,T,z,C)&&qo(z,C,E,T))return!0;var E,T,z,C,D,N;return!1}function oa(e,t){for(var i=0;i<e.length;++i)if(!Ci(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(kl(e[l],e[l+1],t))return!1;return!0}function ls(e,t){for(var i=0;i<t.length;i++)if(oa(e,t[i]))return!0;return!1}function aa(e,t,i){for(var l=[],p=0;p<e.length;p++){for(var d=[],_=0;_<e[p].length;_++){var E=jo(e[p][_],i);Ui(t,E),d.push(E)}l.push(d)}return l}function Cs(e,t,i){for(var l=[],p=0;p<e.length;p++){var d=aa(e[p],t,i);l.push(d)}return l}function Ln(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var p=.5*l,d=e[0]-i[0]>p?-l:i[0]-e[0]>p?l:0;d===0&&(d=e[0]-i[2]>p?-l:i[2]-e[0]>p?l:0),e[0]+=d}Ui(t,e)}function Zo(e,t,i,l){for(var p=8192*Math.pow(2,l.z),d=[8192*l.x,8192*l.y],_=[],E=0,T=e;E<T.length;E+=1)for(var z=0,C=T[E];z<C.length;z+=1){var D=C[z],N=[D.x+d[0],D.y+d[1]];Ln(N,t,i,p),_.push(N)}return _}function va(e,t,i,l){for(var p,d=8192*Math.pow(2,l.z),_=[8192*l.x,8192*l.y],E=[],T=0,z=e;T<z.length;T+=1){for(var C=[],D=0,N=z[T];D<N.length;D+=1){var K=N[D],te=[K.x+_[0],K.y+_[1]];Ui(t,te),C.push(te)}E.push(C)}if(t[2]-t[0]<=d/2){(p=t)[0]=p[1]=1/0,p[2]=p[3]=-1/0;for(var ne=0,pe=E;ne<pe.length;ne+=1)for(var ae=0,ge=pe[ne];ae<ge.length;ae+=1)Ln(ge[ae],t,i,d)}return E}bn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Ye);if(!l)return null;var p=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Ye);if(!p)return null;var d=null;return i.locale&&!(d=t.parse(i.locale,1,tt))?null:new bn(l,p,d)},bn.prototype.evaluate=function(e){return new Ei(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},bn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},bn.prototype.outputDefined=function(){return!1},bn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Rn=function(e,t){this.type=Ye,this.geojson=e,this.geometries=t};function lo(e){if(e instanceof ai&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Rn)return!1;var t=!0;return e.eachChild(function(i){t&&!lo(i)&&(t=!1)}),t}function _e(e){if(e instanceof ai&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!_e(i)&&(t=!1)}),t}function nn(e,t){if(e instanceof ai&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!nn(l,t)&&(i=!1)}),i}Rn.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(No(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var p=i.features[l].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Rn(i,i.features[l].geometry)}else if(i.type==="Feature"){var d=i.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Rn(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Rn(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Rn.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],d=t.canonicalID();if(i.type==="Polygon"){var _=aa(i.coordinates,p,d),E=Zo(t.geometry(),l,p,d);if(!Uo(l,p))return!1;for(var T=0,z=E;T<z.length;T+=1)if(!Ci(z[T],_))return!1}if(i.type==="MultiPolygon"){var C=Cs(i.coordinates,p,d),D=Zo(t.geometry(),l,p,d);if(!Uo(l,p))return!1;for(var N=0,K=D;N<K.length;N+=1)if(!Na(K[N],C))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],d=t.canonicalID();if(i.type==="Polygon"){var _=aa(i.coordinates,p,d),E=va(t.geometry(),l,p,d);if(!Uo(l,p))return!1;for(var T=0,z=E;T<z.length;T+=1)if(!oa(z[T],_))return!1}if(i.type==="MultiPolygon"){var C=Cs(i.coordinates,p,d),D=va(t.geometry(),l,p,d);if(!Uo(l,p))return!1;for(var N=0,K=D;N<K.length;N+=1)if(!ls(K[N],C))return!1}return!0}(e,this.geometries)}return!1},Rn.prototype.eachChild=function(){},Rn.prototype.outputDefined=function(){return!0},Rn.prototype.serialize=function(){return["within",this.geojson]};var Ti=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Ti.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Ti(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Ti.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ti.prototype.eachChild=function(){},Ti.prototype.outputDefined=function(){return!1},Ti.prototype.serialize=function(){return["var",this.name]};var Br=function(e,t,i,l,p){t===void 0&&(t=[]),l===void 0&&(l=new ht),p===void 0&&(p=[]),this.registry=e,this.path=t,this.key=t.map(function(d){return"["+d+"]"}).join(""),this.scope=l,this.errors=p,this.expectedType=i};function Bn(e,t){for(var i,l=e.length-1,p=0,d=l,_=0;p<=d;)if((i=e[_=Math.floor((p+d)/2)])<=t){if(_===l||t<e[_+1])return _;p=_+1}else{if(!(i>t))throw new Er("Input is not a number.");d=_-1}return 0}Br.prototype.parse=function(e,t,i,l,p){return p===void 0&&(p={}),t?this.concat(t,i,l)._parse(e,p):this._parse(e,p)},Br.prototype._parse=function(e,t){function i(z,C,D){return D==="assert"?new Pr(C,[z]):D==="coerce"?new oi(C,[z]):z}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var p=this.registry[l];if(p){var d=p.parse(e,this);if(!d)return null;if(this.expectedType){var _=this.expectedType,E=d.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||E.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(_,E))return null}else d=i(d,_,t.typeAnnotation||"coerce");else d=i(d,_,t.typeAnnotation||"assert")}if(!(d instanceof Xr)&&d.type.kind!=="resolvedImage"&&function z(C){if(C instanceof Ti)return z(C.boundExpression);if(C instanceof ai&&C.name==="error"||C instanceof bn||C instanceof Rn)return!1;var D=C instanceof oi||C instanceof Pr,N=!0;return C.eachChild(function(K){N=D?N&&z(K):N&&K instanceof Xr}),!!N&&lo(C)&&nn(C,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(d)){var T=new Vi;try{d=new Xr(d.type,d.evaluate(T))}catch(z){return this.error(z.message),null}}return d}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Br.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,p=i?this.scope.concat(i):this.scope;return new Br(this.registry,l,t||null,p,this.errors)},Br.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(p){return"["+p+"]"}).join("");this.errors.push(new je(l,e))},Br.prototype.checkSubtype=function(e,t){var i=fr(e,t);return i&&this.error(i),i};var Hn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,p=i;l<p.length;l+=1){var d=p[l],_=d[1];this.labels.push(d[0]),this.outputs.push(_)}};function gi(e,t,i){return e*(1-i)+t*i}Hn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,ze);if(!i)return null;var l=[],p=null;t.expectedType&&t.expectedType.kind!=="value"&&(p=t.expectedType);for(var d=1;d<e.length;d+=2){var _=d===1?-1/0:e[d],E=e[d+1],T=d,z=d+1;if(typeof _!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(l.length&&l[l.length-1][0]>=_)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);var C=t.parse(E,z,p);if(!C)return null;p=p||C.type,l.push([_,C])}return new Hn(p,i,l)},Hn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;return l>=t[p-1]?i[p-1].evaluate(e):i[Bn(t,l)].evaluate(e)},Hn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Hn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Hn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var To=Object.freeze({__proto__:null,number:gi,color:function(e,t,i){return new ar(gi(e.r,t.r,i),gi(e.g,t.g,i),gi(e.b,t.b,i),gi(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,p){return gi(l,t[p],i)})}}),us=6/29*3*(6/29),Pu=Math.PI/180,Ms=180/Math.PI;function Ds(e){return e>.008856451679035631?Math.pow(e,1/3):e/us+4/29}function Qs(e){return e>6/29?e*e*e:us*(e-4/29)}function Tl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function $s(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Jn(e){var t=$s(e.r),i=$s(e.g),l=$s(e.b),p=Ds((.4124564*t+.3575761*i+.1804375*l)/.95047),d=Ds((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*d-16,a:500*(p-d),b:200*(d-Ds((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function sa(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*Qs(t),i=.95047*Qs(i),l=1.08883*Qs(l),new ar(Tl(3.2404542*i-1.5371385*t-.4985314*l),Tl(-.969266*i+1.8760108*t+.041556*l),Tl(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function Go(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var Io={forward:Jn,reverse:sa,interpolate:function(e,t,i){return{l:gi(e.l,t.l,i),a:gi(e.a,t.a,i),b:gi(e.b,t.b,i),alpha:gi(e.alpha,t.alpha,i)}}},Ls={forward:function(e){var t=Jn(e),i=t.l,l=t.a,p=t.b,d=Math.atan2(p,l)*Ms;return{h:d<0?d+360:d,c:Math.sqrt(l*l+p*p),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Pu,i=e.c;return sa({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Go(e.h,t.h,i),c:gi(e.c,t.c,i),l:gi(e.l,t.l,i),alpha:gi(e.alpha,t.alpha,i)}}},cs=Object.freeze({__proto__:null,lab:Io,hcl:Ls}),pn=function(e,t,i,l,p){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var d=0,_=p;d<_.length;d+=1){var E=_[d],T=E[1];this.labels.push(E[0]),this.outputs.push(T)}};function Il(e,t,i,l){var p=l-i,d=e-i;return p===0?0:t===1?d/p:(Math.pow(t,d)-1)/(Math.pow(t,p)-1)}pn.interpolationFactor=function(e,t,i,l){var p=0;if(e.name==="exponential")p=Il(t,e.base,i,l);else if(e.name==="linear")p=Il(t,1,i,l);else if(e.name==="cubic-bezier"){var d=e.controlPoints;p=new I(d[0],d[1],d[2],d[3]).solve(Il(t,1,i,l))}return p},pn.parse=function(e,t){var i=e[0],l=e[1],p=e[2],d=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var _=l[1];if(typeof _!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:_}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var E=l.slice(1);if(E.length!==4||E.some(function(pe){return typeof pe!="number"||pe<0||pe>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:E}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(p=t.parse(p,2,ze)))return null;var T=[],z=null;i==="interpolate-hcl"||i==="interpolate-lab"?z=it:t.expectedType&&t.expectedType.kind!=="value"&&(z=t.expectedType);for(var C=0;C<d.length;C+=2){var D=d[C],N=d[C+1],K=C+3,te=C+4;if(typeof D!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',K);if(T.length&&T[T.length-1][0]>=D)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',K);var ne=t.parse(N,te,z);if(!ne)return null;z=z||ne.type,T.push([D,ne])}return z.kind==="number"||z.kind==="color"||z.kind==="array"&&z.itemType.kind==="number"&&typeof z.N=="number"?new pn(z,i,l,p,T):t.error("Type "+Jt(z)+" is not interpolatable.")},pn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;if(l>=t[p-1])return i[p-1].evaluate(e);var d=Bn(t,l),_=pn.interpolationFactor(this.interpolation,l,t[d],t[d+1]),E=i[d].evaluate(e),T=i[d+1].evaluate(e);return this.operator==="interpolate"?To[this.type.kind.toLowerCase()](E,T,_):this.operator==="interpolate-hcl"?Ls.reverse(Ls.interpolate(Ls.forward(E),Ls.forward(T),_)):Io.reverse(Io.interpolate(Io.forward(E),Io.forward(T),_))},pn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},pn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},pn.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var uo=function(e,t){this.type=e,this.args=t};uo.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var p=[],d=0,_=e.slice(1);d<_.length;d+=1){var E=t.parse(_[d],1+p.length,i,void 0,{typeAnnotation:"omit"});if(!E)return null;i=i||E.type,p.push(E)}var T=l&&p.some(function(z){return fr(l,z.type)});return new uo(T?ot:i,p)},uo.prototype.evaluate=function(e){for(var t,i=null,l=0,p=0,d=this.args;p<d.length&&(l++,(i=d[p].evaluate(e))&&i instanceof ni&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);p+=1);return i},uo.prototype.eachChild=function(e){this.args.forEach(e)},uo.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},uo.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var co=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};co.prototype.evaluate=function(e){return this.result.evaluate(e)},co.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},co.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var p=e[l];if(typeof p!="string")return t.error("Expected string, but found "+typeof p+" instead.",l);if(/[^a-zA-Z0-9_]/.test(p))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var d=t.parse(e[l+1],l+1);if(!d)return null;i.push([p,d])}var _=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return _?new co(i,_):null},co.prototype.outputDefined=function(){return this.result.outputDefined()},co.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var Va=function(e,t,i){this.type=e,this.index=t,this.input=i};Va.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,ze),l=t.parse(e[2],2,or(t.expectedType||ot));return i&&l?new Va(l.type.itemType,i,l):null},Va.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new Er("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new Er("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new Er("Array index must be an integer, but found "+t+" instead.");return i[t]},Va.prototype.eachChild=function(e){e(this.index),e(this.input)},Va.prototype.outputDefined=function(){return!1},Va.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ao=function(e,t){this.type=Ye,this.needle=e,this.haystack=t};Ao.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,ot),l=t.parse(e[2],2,ot);return i&&l?Fr(i.type,[Ye,tt,ze,st,ot])?new Ao(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Jt(i.type)+" instead"):null},Ao.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!nr(t,["boolean","string","number","null"]))throw new Er("Expected first argument to be of type boolean, string, number or null, but found "+Jt(Sr(t))+" instead.");if(!nr(i,["string","array"]))throw new Er("Expected second argument to be of type array or string, but found "+Jt(Sr(i))+" instead.");return i.indexOf(t)>=0},Ao.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Ao.prototype.outputDefined=function(){return!0},Ao.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ko=function(e,t,i){this.type=ze,this.needle=e,this.haystack=t,this.fromIndex=i};Ko.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,ot),l=t.parse(e[2],2,ot);if(!i||!l)return null;if(!Fr(i.type,[Ye,tt,ze,st,ot]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Jt(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,ze);return p?new Ko(i,l,p):null}return new Ko(i,l)},Ko.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!nr(t,["boolean","string","number","null"]))throw new Er("Expected first argument to be of type boolean, string, number or null, but found "+Jt(Sr(t))+" instead.");if(!nr(i,["string","array"]))throw new Er("Expected second argument to be of type array or string, but found "+Jt(Sr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},Ko.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Ko.prototype.outputDefined=function(){return!1},Ko.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Ua=function(e,t,i,l,p,d){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=p,this.otherwise=d};Ua.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var p={},d=[],_=2;_<e.length-1;_+=2){var E=e[_],T=e[_+1];Array.isArray(E)||(E=[E]);var z=t.concat(_);if(E.length===0)return z.error("Expected at least one branch label.");for(var C=0,D=E;C<D.length;C+=1){var N=D[C];if(typeof N!="number"&&typeof N!="string")return z.error("Branch labels must be numbers or strings.");if(typeof N=="number"&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return z.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof N=="number"&&Math.floor(N)!==N)return z.error("Numeric branch labels must be integer values.");if(i){if(z.checkSubtype(i,Sr(N)))return null}else i=Sr(N);if(p[String(N)]!==void 0)return z.error("Branch labels must be unique.");p[String(N)]=d.length}var K=t.parse(T,_,l);if(!K)return null;l=l||K.type,d.push(K)}var te=t.parse(e[1],1,ot);if(!te)return null;var ne=t.parse(e[e.length-1],e.length-1,l);return ne?te.type.kind!=="value"&&t.concat(1).checkSubtype(i,te.type)?null:new Ua(i,l,te,p,d,ne):null},Ua.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Sr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Ua.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Ua.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Ua.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},p=0,d=Object.keys(this.cases).sort();p<d.length;p+=1){var _=d[p];(D=l[this.cases[_]])===void 0?(l[this.cases[_]]=i.length,i.push([this.cases[_],[_]])):i[D][1].push(_)}for(var E=function(K){return e.inputType.kind==="number"?Number(K):K},T=0,z=i;T<z.length;T+=1){var C=z[T],D=C[0],N=C[1];t.push(N.length===1?E(N[0]):N.map(E)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var ja=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};ja.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],p=1;p<e.length-1;p+=2){var d=t.parse(e[p],p,Ye);if(!d)return null;var _=t.parse(e[p+1],p+1,i);if(!_)return null;l.push([d,_]),i=i||_.type}var E=t.parse(e[e.length-1],e.length-1,i);return E?new ja(i,l,E):null},ja.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];if(l[0].evaluate(e))return p.evaluate(e)}return this.otherwise.evaluate(e)},ja.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];e(l[0]),e(p)}e(this.otherwise)},ja.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},ja.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Yn=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function tu(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function la(e,t,i,l){return l.compare(t,i)===0}function dr(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function p(d,_,E){this.type=Ye,this.lhs=d,this.rhs=_,this.collator=E,this.hasUntypedArgument=d.type.kind==="value"||_.type.kind==="value"}return p.parse=function(d,_){if(d.length!==3&&d.length!==4)return _.error("Expected two or three arguments.");var E=d[0],T=_.parse(d[1],1,ot);if(!T)return null;if(!tu(E,T.type))return _.concat(1).error('"'+E+`" comparisons are not supported for type '`+Jt(T.type)+"'.");var z=_.parse(d[2],2,ot);if(!z)return null;if(!tu(E,z.type))return _.concat(2).error('"'+E+`" comparisons are not supported for type '`+Jt(z.type)+"'.");if(T.type.kind!==z.type.kind&&T.type.kind!=="value"&&z.type.kind!=="value")return _.error("Cannot compare types '"+Jt(T.type)+"' and '"+Jt(z.type)+"'.");l&&(T.type.kind==="value"&&z.type.kind!=="value"?T=new Pr(z.type,[T]):T.type.kind!=="value"&&z.type.kind==="value"&&(z=new Pr(T.type,[z])));var C=null;if(d.length===4){if(T.type.kind!=="string"&&z.type.kind!=="string"&&T.type.kind!=="value"&&z.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(!(C=_.parse(d[3],3,er)))return null}return new p(T,z,C)},p.prototype.evaluate=function(d){var _=this.lhs.evaluate(d),E=this.rhs.evaluate(d);if(l&&this.hasUntypedArgument){var T=Sr(_),z=Sr(E);if(T.kind!==z.kind||T.kind!=="string"&&T.kind!=="number")throw new Er('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+T.kind+", "+z.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var C=Sr(_),D=Sr(E);if(C.kind!=="string"||D.kind!=="string")return t(d,_,E)}return this.collator?i(d,_,E,this.collator.evaluate(d)):t(d,_,E)},p.prototype.eachChild=function(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)},p.prototype.outputDefined=function(){return!0},p.prototype.serialize=function(){var d=[e];return this.eachChild(function(_){d.push(_.serialize())}),d},p}()}Yn.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,ot),l=t.parse(e[2],2,ze);if(!i||!l)return null;if(!Fr(i.type,[or(ot),tt,ot]))return t.error("Expected first argument to be of type array or string, but found "+Jt(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,ze);return p?new Yn(i.type,i,l,p):null}return new Yn(i.type,i,l)},Yn.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!nr(t,["string","array"]))throw new Er("Expected first argument to be of type array or string, but found "+Jt(Sr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Yn.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Yn.prototype.outputDefined=function(){return!1},Yn.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var qa=dr("==",function(e,t,i){return t===i},la),el=dr("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!la(0,t,i,l)}),hs=dr("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),rc=dr(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),ru=dr("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),ps=dr(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),zo=function(e,t,i,l,p){this.type=tt,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=p};zo.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,ze);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var p=null;if(l.locale&&!(p=t.parse(l.locale,1,tt)))return null;var d=null;if(l.currency&&!(d=t.parse(l.currency,1,tt)))return null;var _=null;if(l["min-fraction-digits"]&&!(_=t.parse(l["min-fraction-digits"],1,ze)))return null;var E=null;return l["max-fraction-digits"]&&!(E=t.parse(l["max-fraction-digits"],1,ze))?null:new zo(i,p,d,_,E)},zo.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},zo.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},zo.prototype.outputDefined=function(){return!1},zo.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var ba=function(e){this.type=ze,this.input=e};ba.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Jt(i.type)+" instead."):new ba(i):null},ba.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Er("Expected value to be of type string or array, but found "+Jt(Sr(t))+" instead.")},ba.prototype.eachChild=function(e){e(this.input)},ba.prototype.outputDefined=function(){return!1},ba.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Po={"==":qa,"!=":el,">":rc,"<":hs,">=":ps,"<=":ru,array:Pr,at:Va,boolean:Pr,case:ja,coalesce:uo,collator:bn,format:Wi,image:Mn,in:Ao,"index-of":Ko,interpolate:pn,"interpolate-hcl":pn,"interpolate-lab":pn,length:ba,let:co,literal:Xr,match:Ua,number:Pr,"number-format":zo,object:Pr,slice:Yn,step:Hn,string:Pr,"to-boolean":oi,"to-color":oi,"to-number":oi,"to-string":oi,var:Ti,within:Rn};function tl(e,t){var i=t[0],l=t[1],p=t[2],d=t[3];i=i.evaluate(e),l=l.evaluate(e),p=p.evaluate(e);var _=d?d.evaluate(e):1,E=_a(i,l,p,_);if(E)throw new Er(E);return new ar(i/255*_,l/255*_,p/255*_,_)}function iu(e,t){return e in t}function Al(e,t){var i=t[e];return i===void 0?null:i}function ho(e){return{type:e}}function nu(e){return{result:"success",value:e}}function On(e){return{result:"error",value:e}}function fn(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function ua(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Rs(e){return!!e.expression&&e.expression.interpolated}function kr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function ou(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Cu(e){return e}function Xo(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function fs(e,t,i,l,p){return Xo(typeof i===p?l[i]:void 0,e.default,t.default)}function Mu(e,t,i){if(kr(i)!=="number")return Xo(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var p=Bn(e.stops.map(function(d){return d[0]}),i);return e.stops[p][1]}function ds(e,t,i){var l=e.base!==void 0?e.base:1;if(kr(i)!=="number")return Xo(e.default,t.default);var p=e.stops.length;if(p===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[p-1][0])return e.stops[p-1][1];var d=Bn(e.stops.map(function(D){return D[0]}),i),_=function(D,N,K,te){var ne=te-K,pe=D-K;return ne===0?0:N===1?pe/ne:(Math.pow(N,pe)-1)/(Math.pow(N,ne)-1)}(i,l,e.stops[d][0],e.stops[d+1][0]),E=e.stops[d][1],T=e.stops[d+1][1],z=To[t.type]||Cu;if(e.colorSpace&&e.colorSpace!=="rgb"){var C=cs[e.colorSpace];z=function(D,N){return C.reverse(C.interpolate(C.forward(D),C.forward(N),_))}}return typeof E.evaluate=="function"?{evaluate:function(){for(var D=[],N=arguments.length;N--;)D[N]=arguments[N];var K=E.evaluate.apply(void 0,D),te=T.evaluate.apply(void 0,D);if(K!==void 0&&te!==void 0)return z(K,te,_)}}:z(E,T,_)}function ms(e,t,i){return t.type==="color"?i=ar.parse(i):t.type==="formatted"?i=Nr.fromString(i.toString()):t.type==="resolvedImage"?i=ni.fromString(i.toString()):kr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Xo(i,e.default,t.default)}ai.register(Po,{error:[{kind:"error"},[tt],function(e,t){throw new Er(t[0].evaluate(e))}],typeof:[tt,[ot],function(e,t){return Jt(Sr(t[0].evaluate(e)))}],"to-rgba":[or(ze,4),[it],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[it,[ze,ze,ze],tl],rgba:[it,[ze,ze,ze,ze],tl],has:{type:Ye,overloads:[[[tt],function(e,t){return iu(t[0].evaluate(e),e.properties())}],[[tt,Ut],function(e,t){var i=t[1];return iu(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:ot,overloads:[[[tt],function(e,t){return Al(t[0].evaluate(e),e.properties())}],[[tt,Ut],function(e,t){var i=t[1];return Al(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[ot,[tt],function(e,t){return Al(t[0].evaluate(e),e.featureState||{})}],properties:[Ut,[],function(e){return e.properties()}],"geometry-type":[tt,[],function(e){return e.geometryType()}],id:[ot,[],function(e){return e.id()}],zoom:[ze,[],function(e){return e.globals.zoom}],"heatmap-density":[ze,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[ze,[],function(e){return e.globals.lineProgress||0}],accumulated:[ot,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[ze,ho(ze),function(e,t){for(var i=0,l=0,p=t;l<p.length;l+=1)i+=p[l].evaluate(e);return i}],"*":[ze,ho(ze),function(e,t){for(var i=1,l=0,p=t;l<p.length;l+=1)i*=p[l].evaluate(e);return i}],"-":{type:ze,overloads:[[[ze,ze],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[ze],function(e,t){return-t[0].evaluate(e)}]]},"/":[ze,[ze,ze],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[ze,[ze,ze],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[ze,[],function(){return Math.LN2}],pi:[ze,[],function(){return Math.PI}],e:[ze,[],function(){return Math.E}],"^":[ze,[ze,ze],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[ze,[ze],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[ze,[ze],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[ze,[ze],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[ze,[ze],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[ze,[ze],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[ze,[ze],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[ze,[ze],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[ze,[ze],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[ze,[ze],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[ze,[ze],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[ze,ho(ze),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[ze,ho(ze),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[ze,[ze],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[ze,[ze],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[ze,[ze],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[ze,[ze],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Ye,[tt,ot],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[Ye,[ot],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Ye,[tt],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Ye,[tt,ot],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p<d}],"filter-id-<":[Ye,[ot],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<p}],"filter->":[Ye,[tt,ot],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p>d}],"filter-id->":[Ye,[ot],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>p}],"filter-<=":[Ye,[tt,ot],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p<=d}],"filter-id-<=":[Ye,[ot],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<=p}],"filter->=":[Ye,[tt,ot],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p>=d}],"filter-id->=":[Ye,[ot],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>=p}],"filter-has":[Ye,[ot],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Ye,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Ye,[or(tt)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Ye,[or(ot)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Ye,[tt,or(ot)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Ye,[tt,or(ot)],function(e,t){var i=t[0],l=t[1];return function(p,d,_,E){for(;_<=E;){var T=_+E>>1;if(d[T]===p)return!0;d[T]>p?E=T-1:_=T+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:Ye,overloads:[[[Ye,Ye],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[ho(Ye),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:Ye,overloads:[[[Ye,Ye],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[ho(Ye),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[Ye,[Ye],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Ye,[tt],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[tt,[tt],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[tt,[tt],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[tt,ho(ot),function(e,t){return t.map(function(i){return Vo(i.evaluate(e))}).join("")}],"resolved-locale":[tt,[er],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var ys=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Vi,this._defaultValue=t?function(i){return i.type==="color"&&ou(i.default)?new ar(0,0,0,0):i.type==="color"?ar.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function Bs(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Po}function ca(e,t){var i=new Br(Po,[],t?function(p){var d={color:it,string:tt,number:ze,enum:tt,boolean:Ye,formatted:cr,resolvedImage:Zt};return p.type==="array"?or(d[p.value]||ot,p.length):d[p.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?nu(new ys(l,t)):On(i.errors)}ys.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=d,this.expression.evaluate(this._evaluator)},ys.prototype.evaluate=function(e,t,i,l,p,d){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=d||null;try{var _=this.expression.evaluate(this._evaluator);if(_==null||typeof _=="number"&&_!=_)return this._defaultValue;if(this._enumValues&&!(_ in this._enumValues))throw new Er("Expected value to be one of "+Object.keys(this._enumValues).map(function(E){return JSON.stringify(E)}).join(", ")+", but found "+JSON.stringify(_)+" instead.");return _}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}};var rl=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!_e(t.expression)};rl.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,d)},rl.prototype.evaluate=function(e,t,i,l,p,d){return this._styleExpression.evaluate(e,t,i,l,p,d)};var Za=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!_e(t.expression),this.interpolationType=l};function Ga(e,t){if((e=ca(e,t)).result==="error")return e;var i=e.value.expression,l=lo(i);if(!l&&!fn(t))return On([new je("","data expressions not supported")]);var p=nn(i,["zoom"]);if(!p&&!ua(t))return On([new je("","zoom expressions not supported")]);var d=function _(E){var T=null;if(E instanceof co)T=_(E.result);else if(E instanceof uo)for(var z=0,C=E.args;z<C.length&&!(T=_(C[z]));z+=1);else(E instanceof Hn||E instanceof pn)&&E.input instanceof ai&&E.input.name==="zoom"&&(T=E);return T instanceof je||E.eachChild(function(D){var N=_(D);N instanceof je?T=N:!T&&N?T=new je("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):T&&N&&T!==N&&(T=new je("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),T}(i);return d||p?d instanceof je?On([d]):d instanceof pn&&!Rs(t)?On([new je("",'"interpolate" expressions cannot be used with this property')]):nu(d?new Za(l?"camera":"composite",e.value,d.labels,d instanceof pn?d.interpolation:void 0):new rl(l?"constant":"source",e.value)):On([new je("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Za.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,d)},Za.prototype.evaluate=function(e,t,i,l,p,d){return this._styleExpression.evaluate(e,t,i,l,p,d)},Za.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?pn.interpolationFactor(this.interpolationType,e,t,i):0};var Wo=function(e,t){this._parameters=e,this._specification=t,Ve(this,function i(l,p){var d,_,E,T=p.type==="color",z=l.stops&&typeof l.stops[0][0]=="object",C=z||!(z||l.property!==void 0),D=l.type||(Rs(p)?"exponential":"interval");if(T&&((l=Ve({},l)).stops&&(l.stops=l.stops.map(function(ct){return[ct[0],ar.parse(ct[1])]})),l.default=ar.parse(l.default?l.default:p.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!cs[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(D==="exponential")d=ds;else if(D==="interval")d=Mu;else if(D==="categorical"){d=fs,_=Object.create(null);for(var N=0,K=l.stops;N<K.length;N+=1){var te=K[N];_[te[0]]=te[1]}E=typeof l.stops[0][0]}else{if(D!=="identity")throw new Error('Unknown function type "'+D+'"');d=ms}if(z){for(var ne={},pe=[],ae=0;ae<l.stops.length;ae++){var ge=l.stops[ae],ke=ge[0].zoom;ne[ke]===void 0&&(ne[ke]={zoom:ke,type:l.type,property:l.property,default:l.default,stops:[]},pe.push(ke)),ne[ke].stops.push([ge[0].value,ge[1]])}for(var Pe=[],Be=0,Fe=pe;Be<Fe.length;Be+=1){var Qe=Fe[Be];Pe.push([ne[Qe].zoom,i(ne[Qe],p)])}var nt={name:"linear"};return{kind:"composite",interpolationType:nt,interpolationFactor:pn.interpolationFactor.bind(void 0,nt),zoomStops:Pe.map(function(ct){return ct[0]}),evaluate:function(ct,Mt){var pt=ct.zoom;return ds({stops:Pe,base:l.base},p,pt).evaluate(pt,Mt)}}}if(C){var Tt=D==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:Tt,interpolationFactor:pn.interpolationFactor.bind(void 0,Tt),zoomStops:l.stops.map(function(ct){return ct[0]}),evaluate:function(ct){return d(l,p,ct.zoom,_,E)}}}return{kind:"source",evaluate:function(ct,Mt){var pt=Mt&&Mt.properties?Mt.properties[l.property]:void 0;return pt===void 0?Xo(l.default,p.default):d(l,p,pt,_,E)}}}(this._parameters,this._specification))};function Co(e){var t=e.key,i=e.value,l=e.valueSpec||{},p=e.objectElementValidators||{},d=e.style,_=e.styleSpec,E=[],T=kr(i);if(T!=="object")return[new oe(t,i,"object expected, "+T+" found")];for(var z in i){var C=z.split(".")[0],D=l[C]||l["*"],N=void 0;if(p[C])N=p[C];else if(l[C])N=Yt;else if(p["*"])N=p["*"];else{if(!l["*"]){E.push(new oe(t,i[z],'unknown property "'+z+'"'));continue}N=Yt}E=E.concat(N({key:(t&&t+".")+z,value:i[z],valueSpec:D,style:d,styleSpec:_,object:i,objectKey:z},i))}for(var K in l)p[K]||l[K].required&&l[K].default===void 0&&i[K]===void 0&&E.push(new oe(t,i,'missing required property "'+K+'"'));return E}function gs(e){var t=e.value,i=e.valueSpec,l=e.style,p=e.styleSpec,d=e.key,_=e.arrayElementValidator||Yt;if(kr(t)!=="array")return[new oe(d,t,"array expected, "+kr(t)+" found")];if(i.length&&t.length!==i.length)return[new oe(d,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new oe(d,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var E={type:i.value,values:i.values};p.$version<7&&(E.function=i.function),kr(i.value)==="object"&&(E=i.value);for(var T=[],z=0;z<t.length;z++)T=T.concat(_({array:t,arrayIndex:z,value:t[z],valueSpec:E,style:l,styleSpec:p,key:d+"["+z+"]"}));return T}function il(e){var t=e.key,i=e.value,l=e.valueSpec,p=kr(i);return p==="number"&&i!=i&&(p="NaN"),p!=="number"?[new oe(t,i,"number expected, "+p+" found")]:"minimum"in l&&i<l.minimum?[new oe(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new oe(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function zl(e){var t,i,l,p=e.valueSpec,d=Ze(e.value.type),_={},E=d!=="categorical"&&e.value.property===void 0,T=!E,z=kr(e.value.stops)==="array"&&kr(e.value.stops[0])==="array"&&kr(e.value.stops[0][0])==="object",C=Co({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(K){if(d==="identity")return[new oe(K.key,K.value,'identity function may not have a "stops" property')];var te=[],ne=K.value;return te=te.concat(gs({key:K.key,value:ne,valueSpec:K.valueSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:D})),kr(ne)==="array"&&ne.length===0&&te.push(new oe(K.key,ne,"array must have at least one stop")),te},default:function(K){return Yt({key:K.key,value:K.value,valueSpec:p,style:K.style,styleSpec:K.styleSpec})}}});return d==="identity"&&E&&C.push(new oe(e.key,e.value,'missing required property "property"')),d==="identity"||e.value.stops||C.push(new oe(e.key,e.value,'missing required property "stops"')),d==="exponential"&&e.valueSpec.expression&&!Rs(e.valueSpec)&&C.push(new oe(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(T&&!fn(e.valueSpec)?C.push(new oe(e.key,e.value,"property functions not supported")):E&&!ua(e.valueSpec)&&C.push(new oe(e.key,e.value,"zoom functions not supported"))),d!=="categorical"&&!z||e.value.property!==void 0||C.push(new oe(e.key,e.value,'"property" property is required')),C;function D(K){var te=[],ne=K.value,pe=K.key;if(kr(ne)!=="array")return[new oe(pe,ne,"array expected, "+kr(ne)+" found")];if(ne.length!==2)return[new oe(pe,ne,"array length 2 expected, length "+ne.length+" found")];if(z){if(kr(ne[0])!=="object")return[new oe(pe,ne,"object expected, "+kr(ne[0])+" found")];if(ne[0].zoom===void 0)return[new oe(pe,ne,"object stop key must have zoom")];if(ne[0].value===void 0)return[new oe(pe,ne,"object stop key must have value")];if(l&&l>Ze(ne[0].zoom))return[new oe(pe,ne[0].zoom,"stop zoom values must appear in ascending order")];Ze(ne[0].zoom)!==l&&(l=Ze(ne[0].zoom),i=void 0,_={}),te=te.concat(Co({key:pe+"[0]",value:ne[0],valueSpec:{zoom:{}},style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:il,value:N}}))}else te=te.concat(N({key:pe+"[0]",value:ne[0],valueSpec:{},style:K.style,styleSpec:K.styleSpec},ne));return Bs(Re(ne[1]))?te.concat([new oe(pe+"[1]",ne[1],"expressions are not allowed in function stops.")]):te.concat(Yt({key:pe+"[1]",value:ne[1],valueSpec:p,style:K.style,styleSpec:K.styleSpec}))}function N(K,te){var ne=kr(K.value),pe=Ze(K.value),ae=K.value!==null?K.value:te;if(t){if(ne!==t)return[new oe(K.key,ae,ne+" stop domain type must match previous stop domain type "+t)]}else t=ne;if(ne!=="number"&&ne!=="string"&&ne!=="boolean")return[new oe(K.key,ae,"stop domain value must be a number, string, or boolean")];if(ne!=="number"&&d!=="categorical"){var ge="number expected, "+ne+" found";return fn(p)&&d===void 0&&(ge+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new oe(K.key,ae,ge)]}return d!=="categorical"||ne!=="number"||isFinite(pe)&&Math.floor(pe)===pe?d!=="categorical"&&ne==="number"&&i!==void 0&&pe<i?[new oe(K.key,ae,"stop domain values must appear in ascending order")]:(i=pe,d==="categorical"&&pe in _?[new oe(K.key,ae,"stop domain values must be unique")]:(_[pe]=!0,[])):[new oe(K.key,ae,"integer expected, found "+pe)]}}function Ka(e){var t=(e.expressionContext==="property"?Ga:ca)(Re(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new oe(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new oe(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!_e(i))return[new oe(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!_e(i))return[new oe(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!nn(i,["zoom","feature-state"]))return[new oe(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!lo(i))return[new oe(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function _s(e){var t=e.key,i=e.value,l=e.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(Ze(i))===-1&&p.push(new oe(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Ze(i))===-1&&p.push(new oe(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),p}function xn(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!xn(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}Wo.deserialize=function(e){return new Wo(e._parameters,e._specification)},Wo.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Ho={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Qn(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};xn(e)||(e=nl(e));var t=ca(e,Ho);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,p){return t.value.evaluate(i,l,{},p)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var p=1;p<l.length;p++)if(i(l[p]))return!0;return!1}(e)}}function Xa(e,t){return e<t?-1:e>t?1:0}function nl(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Wa(e[1],e[2],"=="):i==="!="?xa(Wa(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Wa(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(nl))):i==="all"?["all"].concat(e.slice(1).map(nl)):i==="none"?["all"].concat(e.slice(1).map(nl).map(xa)):i==="in"?ic(e[1],e.slice(2)):i==="!in"?xa(ic(e[1],e.slice(2))):i==="has"?au(e[1]):i==="!has"?xa(au(e[1])):i!=="within"||e}function Wa(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function ic(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Xa)]]:["filter-in-small",e,["literal",t]]}}function au(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function xa(e){return["!",e]}function Ha(e){return xn(Re(e.value))?Ka(Ve({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,p=i.key;if(kr(l)!=="array")return[new oe(p,l,"array expected, "+kr(l)+" found")];var d,_=i.styleSpec,E=[];if(l.length<1)return[new oe(p,l,"filter array must have at least 1 element")];switch(E=E.concat(_s({key:p+"[0]",value:l[0],valueSpec:_.filter_operator,style:i.style,styleSpec:i.styleSpec})),Ze(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Ze(l[1])==="$type"&&E.push(new oe(p,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&E.push(new oe(p,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(d=kr(l[1]))!=="string"&&E.push(new oe(p+"[1]",l[1],"string expected, "+d+" found"));for(var T=2;T<l.length;T++)d=kr(l[T]),Ze(l[1])==="$type"?E=E.concat(_s({key:p+"["+T+"]",value:l[T],valueSpec:_.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&E.push(new oe(p+"["+T+"]",l[T],"string, number, or boolean expected, "+d+" found"));break;case"any":case"all":case"none":for(var z=1;z<l.length;z++)E=E.concat(t({key:p+"["+z+"]",value:l[z],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=kr(l[1]),l.length!==2?E.push(new oe(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):d!=="string"&&E.push(new oe(p+"[1]",l[1],"string expected, "+d+" found"));break;case"within":d=kr(l[1]),l.length!==2?E.push(new oe(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):d!=="object"&&E.push(new oe(p+"[1]",l[1],"object expected, "+d+" found"))}return E}(e)}function Pl(e,t){var i=e.key,l=e.style,p=e.styleSpec,d=e.value,_=e.objectKey,E=p[t+"_"+e.layerType];if(!E)return[];var T=_.match(/^(.*)-transition$/);if(t==="paint"&&T&&E[T[1]]&&E[T[1]].transition)return Yt({key:i,value:d,valueSpec:p.transition,style:l,styleSpec:p});var z,C=e.valueSpec||E[_];if(!C)return[new oe(i,d,'unknown property "'+_+'"')];if(kr(d)==="string"&&fn(C)&&!C.tokens&&(z=/^{([^}]+)}$/.exec(d)))return[new oe(i,d,'"'+_+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(z[1])+" }`.")];var D=[];return e.layerType==="symbol"&&(_==="text-field"&&l&&!l.glyphs&&D.push(new oe(i,d,'use of "text-field" requires a style "glyphs" property')),_==="text-font"&&ou(Re(d))&&Ze(d.type)==="identity"&&D.push(new oe(i,d,'"text-font" does not support identity functions'))),D.concat(Yt({key:e.key,value:d,valueSpec:C,style:l,styleSpec:p,expressionContext:"property",propertyType:t,propertyKey:_}))}function Ja(e){return Pl(e,"paint")}function Ya(e){return Pl(e,"layout")}function su(e){var t=[],i=e.value,l=e.key,p=e.style,d=e.styleSpec;i.type||i.ref||t.push(new oe(l,i,'either "type" or "ref" is required'));var _,E=Ze(i.type),T=Ze(i.ref);if(i.id)for(var z=Ze(i.id),C=0;C<e.arrayIndex;C++){var D=p.layers[C];Ze(D.id)===z&&t.push(new oe(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+D.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(te){te in i&&t.push(new oe(l,i[te],'"'+te+'" is prohibited for ref layers'))}),p.layers.forEach(function(te){Ze(te.id)===T&&(_=te)}),_?_.ref?t.push(new oe(l,i.ref,"ref cannot reference another ref layer")):E=Ze(_.type):t.push(new oe(l,i.ref,'ref layer "'+T+'" not found'));else if(E!=="background")if(i.source){var N=p.sources&&p.sources[i.source],K=N&&Ze(N.type);N?K==="vector"&&E==="raster"?t.push(new oe(l,i.source,'layer "'+i.id+'" requires a raster source')):K==="raster"&&E!=="raster"?t.push(new oe(l,i.source,'layer "'+i.id+'" requires a vector source')):K!=="vector"||i["source-layer"]?K==="raster-dem"&&E!=="hillshade"?t.push(new oe(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!i.paint||!i.paint["line-gradient"]||K==="geojson"&&N.lineMetrics||t.push(new oe(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new oe(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new oe(l,i.source,'source "'+i.source+'" not found'))}else t.push(new oe(l,i,'missing required property "source"'));return t=t.concat(Co({key:l,value:i,valueSpec:d.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Yt({key:l+".type",value:i.type,valueSpec:d.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Ha,layout:function(te){return Co({layer:i,key:te.key,value:te.value,style:te.style,styleSpec:te.styleSpec,objectElementValidators:{"*":function(ne){return Ya(Ve({layerType:E},ne))}}})},paint:function(te){return Co({layer:i,key:te.key,value:te.value,style:te.style,styleSpec:te.styleSpec,objectElementValidators:{"*":function(ne){return Ja(Ve({layerType:E},ne))}}})}}}))}function Qa(e){var t=e.value,i=e.key,l=kr(t);return l!=="string"?[new oe(i,t,"string expected, "+l+" found")]:[]}var Cr={promoteId:function(e){var t=e.key,i=e.value;if(kr(i)==="string")return Qa({key:t,value:i});var l=[];for(var p in i)l.push.apply(l,Qa({key:t+"."+p,value:i[p]}));return l}};function ol(e){var t=e.value,i=e.key,l=e.styleSpec,p=e.style;if(!t.type)return[new oe(i,t,'"type" is required')];var d,_=Ze(t.type);switch(_){case"vector":case"raster":case"raster-dem":return Co({key:i,value:t,valueSpec:l["source_"+_.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Cr});case"geojson":if(d=Co({key:i,value:t,valueSpec:l.source_geojson,style:p,styleSpec:l,objectElementValidators:Cr}),t.cluster)for(var E in t.clusterProperties){var T=t.clusterProperties[E],z=T[0],C=typeof z=="string"?[z,["accumulated"],["get",E]]:z;d.push.apply(d,Ka({key:i+"."+E+".map",value:T[1],expressionContext:"cluster-map"})),d.push.apply(d,Ka({key:i+"."+E+".reduce",value:C,expressionContext:"cluster-reduce"}))}return d;case"video":return Co({key:i,value:t,valueSpec:l.source_video,style:p,styleSpec:l});case"image":return Co({key:i,value:t,valueSpec:l.source_image,style:p,styleSpec:l});case"canvas":return[new oe(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _s({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,styleSpec:l})}}function Fn(e){var t=e.value,i=e.styleSpec,l=i.light,p=e.style,d=[],_=kr(t);if(t===void 0)return d;if(_!=="object")return d.concat([new oe("light",t,"object expected, "+_+" found")]);for(var E in t){var T=E.match(/^(.*)-transition$/);d=d.concat(T&&l[T[1]]&&l[T[1]].transition?Yt({key:E,value:t[E],valueSpec:i.transition,style:p,styleSpec:i}):l[E]?Yt({key:E,value:t[E],valueSpec:l[E],style:p,styleSpec:i}):[new oe(E,t[E],'unknown property "'+E+'"')])}return d}var on={"*":function(){return[]},array:gs,boolean:function(e){var t=e.value,i=e.key,l=kr(t);return l!=="boolean"?[new oe(i,t,"boolean expected, "+l+" found")]:[]},number:il,color:function(e){var t=e.key,i=e.value,l=kr(i);return l!=="string"?[new oe(t,i,"color expected, "+l+" found")]:Gt(i)===null?[new oe(t,i,'color expected, "'+i+'" found')]:[]},constants:ve,enum:_s,filter:Ha,function:zl,layer:su,object:Co,source:ol,light:Fn,string:Qa,formatted:function(e){return Qa(e).length===0?[]:Ka(e)},resolvedImage:function(e){return Qa(e).length===0?[]:Ka(e)}};function Yt(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&ou(Ze(t))?zl(e):i.expression&&Bs(Re(t))?Ka(e):i.type&&on[i.type]?on[i.type](e):Co(Ve({},e,{valueSpec:i.type?l[i.type]:i}))}function Vr(e){var t=e.value,i=e.key,l=Qa(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new oe(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new oe(i,t,'"glyphs" url must include a "{range}" token'))),l}function an(e,t){t===void 0&&(t=Z);var i=[];return i=i.concat(Yt({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Vr,"*":function(){return[]}}})),e.constants&&(i=i.concat(ve({key:"constants",value:e.constants,style:e,styleSpec:t}))),Cl(i)}function Cl(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function vs(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return Cl(e.apply(this,t))}}an.source=vs(ol),an.light=vs(Fn),an.layer=vs(su),an.filter=vs(Ha),an.paintProperty=vs(Ja),an.layoutProperty=vs(Ya);var ha=an,Os=ha.light,Du=ha.paintProperty,pa=ha.layoutProperty;function $a(e,t){var i=!1;if(t&&t.length)for(var l=0,p=t;l<p.length;l+=1)e.fire(new ue(new Error(p[l].message))),i=!0;return i}var fa=Ii;function Ii(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var p=new Int32Array(this.arrayBuffer);e=p[0],this.d=(t=p[1])+2*(i=p[2]);for(var d=0;d<this.d*this.d;d++){var _=p[3+d],E=p[3+d+1];l.push(_===E?null:p.subarray(_,E))}var T=p[3+l.length+1];this.keys=p.subarray(p[3+l.length],T),this.bboxes=p.subarray(T),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var z=0;z<this.d*this.d;z++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var C=i/t*e;this.min=-C,this.max=e+C}Ii.prototype.insert=function(e,t,i,l,p){this._forEachCell(t,i,l,p,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(p)},Ii.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ii.prototype._insertCell=function(e,t,i,l,p,d){this.cells[p].push(d)},Ii.prototype.query=function(e,t,i,l,p){var d=this.min,_=this.max;if(e<=d&&t<=d&&_<=i&&_<=l&&!p)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(e,t,i,l,this._queryCell,E,{},p),E},Ii.prototype._queryCell=function(e,t,i,l,p,d,_,E){var T=this.cells[p];if(T!==null)for(var z=this.keys,C=this.bboxes,D=0;D<T.length;D++){var N=T[D];if(_[N]===void 0){var K=4*N;(E?E(C[K+0],C[K+1],C[K+2],C[K+3]):e<=C[K+2]&&t<=C[K+3]&&i>=C[K+0]&&l>=C[K+1])?(_[N]=!0,d.push(z[N])):_[N]=!1}}},Ii.prototype._forEachCell=function(e,t,i,l,p,d,_,E){for(var T=this._convertToCellCoord(e),z=this._convertToCellCoord(t),C=this._convertToCellCoord(i),D=this._convertToCellCoord(l),N=T;N<=C;N++)for(var K=z;K<=D;K++){var te=this.d*K+N;if((!E||E(this._convertFromCellCoord(N),this._convertFromCellCoord(K),this._convertFromCellCoord(N+1),this._convertFromCellCoord(K+1)))&&p.call(this,e,t,i,l,te,d,_,E))return}},Ii.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Ii.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Ii.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var p=new Int32Array(t+i+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var d=t,_=0;_<e.length;_++){var E=e[_];p[3+_]=d,p.set(E,d),d+=E.length}return p[3+e.length]=d,p.set(this.keys,d),p[3+e.length+1]=d+=this.keys.length,p.set(this.bboxes,d),d+=this.bboxes.length,p.buffer};var Jo=j.ImageData,lu=j.ImageBitmap,Ur={};function at(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Ur[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var Mi in at("Object",Object),fa.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},fa.deserialize=function(e){return new fa(e.buffer)},at("Grid",fa),at("Color",ar),at("Error",Error),at("ResolvedImage",ni),at("StylePropertyFunction",Wo),at("StyleExpression",ys,{omit:["_evaluator"]}),at("ZoomDependentExpression",Za),at("ZoomConstantExpression",rl),at("CompoundExpression",ai,{omit:["_evaluate"]}),Po)Po[Mi]._classRegistryKey||at("Expression_"+Mi,Po[Mi]);function al(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Yo(e){return lu&&e instanceof lu}function da(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(al(e)||Yo(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof Jo)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],p=0,d=e;p<d.length;p+=1)l.push(da(d[p],t));return l}if(typeof e=="object"){var _=e.constructor,E=_._classRegistryKey;if(!E)throw new Error("can't serialize object of unregistered class");var T=_.serialize?_.serialize(e,t):{};if(!_.serialize){for(var z in e)if(e.hasOwnProperty(z)&&!(Ur[E].omit.indexOf(z)>=0)){var C=e[z];T[z]=Ur[E].shallow.indexOf(z)>=0?C:da(C,t)}e instanceof Error&&(T.message=e.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return E!=="Object"&&(T.$name=E),T}throw new Error("can't serialize object of type "+typeof e)}function Nn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||al(e)||Yo(e)||ArrayBuffer.isView(e)||e instanceof Jo)return e;if(Array.isArray(e))return e.map(Nn);if(typeof e=="object"){var t=e.$name||"Object",i=Ur[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),p=0,d=Object.keys(e);p<d.length;p+=1){var _=d[p];if(_!=="$name"){var E=e[_];l[_]=Ur[t].shallow.indexOf(_)>=0?E:Nn(E)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var es=function(){this.first=!0};es.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var rt={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Ml(e){for(var t=0,i=e;t<i.length;t+=1)if(wa(i[t].charCodeAt(0)))return!0;return!1}function wa(e){return!(e!==746&&e!==747&&(e<4352||!(rt["Bopomofo Extended"](e)||rt.Bopomofo(e)||rt["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||rt["CJK Compatibility Ideographs"](e)||rt["CJK Compatibility"](e)||rt["CJK Radicals Supplement"](e)||rt["CJK Strokes"](e)||!(!rt["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||rt["CJK Unified Ideographs Extension A"](e)||rt["CJK Unified Ideographs"](e)||rt["Enclosed CJK Letters and Months"](e)||rt["Hangul Compatibility Jamo"](e)||rt["Hangul Jamo Extended-A"](e)||rt["Hangul Jamo Extended-B"](e)||rt["Hangul Jamo"](e)||rt["Hangul Syllables"](e)||rt.Hiragana(e)||rt["Ideographic Description Characters"](e)||rt.Kanbun(e)||rt["Kangxi Radicals"](e)||rt["Katakana Phonetic Extensions"](e)||rt.Katakana(e)&&e!==12540||!(!rt["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!rt["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||rt["Unified Canadian Aboriginal Syllabics"](e)||rt["Unified Canadian Aboriginal Syllabics Extended"](e)||rt["Vertical Forms"](e)||rt["Yijing Hexagram Symbols"](e)||rt["Yi Syllables"](e)||rt["Yi Radicals"](e))))}function Fs(e){return!(wa(e)||function(t){return!!(rt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||rt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||rt["Letterlike Symbols"](t)||rt["Number Forms"](t)||rt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||rt["Control Pictures"](t)&&t!==9251||rt["Optical Character Recognition"](t)||rt["Enclosed Alphanumerics"](t)||rt["Geometric Shapes"](t)||rt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||rt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||rt["CJK Symbols and Punctuation"](t)||rt.Katakana(t)||rt["Private Use Area"](t)||rt["CJK Compatibility Forms"](t)||rt["Small Form Variants"](t)||rt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function po(e){return e>=1424&&e<=2303||rt["Arabic Presentation Forms-A"](e)||rt["Arabic Presentation Forms-B"](e)}function Vn(e,t){return!(!t&&po(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||rt.Khmer(e))}function ma(e){for(var t=0,i=e;t<i.length;t+=1)if(po(i[t].charCodeAt(0)))return!0;return!1}var Dl=null,wn="unavailable",Un=null,bs=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(wn="error"),Dl&&Dl(e)};function Ns(){ts.fire(new re("pluginStateChange",{pluginStatus:wn,pluginURL:Un}))}var ts=new ye,Vs=function(){return wn},fo=function(){if(wn!=="deferred"||!Un)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");wn="loading",Ns(),Un&&so({url:Un},function(e){e?bs(e):(wn="loaded",Ns())})},$n={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return wn==="loaded"||$n.applyArabicShaping!=null},isLoading:function(){return wn==="loading"},setState:function(e){wn=e.pluginStatus,Un=e.pluginURL},isParsed:function(){return $n.applyArabicShaping!=null&&$n.processBidirectionalText!=null&&$n.processStyledBidirectionalText!=null},getPluginURL:function(){return Un}},rr=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new es,this.transition={})};rr.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,p=t;l<p.length;l+=1)if(!Vn(p[l].charCodeAt(0),i))return!1;return!0}(e,$n.isLoaded())},rr.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},rr.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var Ai=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(ou(i))return new Wo(i,l);if(Bs(i)){var p=Ga(i,l);if(p.result==="error")throw new Error(p.value.map(function(_){return _.key+": "+_.message}).join(", "));return p.value}var d=i;return typeof i=="string"&&l.type==="color"&&(d=ar.parse(i)),{kind:"constant",evaluate:function(){return d}}}(t===void 0?e.specification.default:t,e.specification)};Ai.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Ai.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var ji=function(e){this.property=e,this.value=new Ai(e,void 0)};ji.prototype.transitioned=function(e,t){return new eo(this.property,this.value,t,Ue({},e.transition,this.transition),e.now)},ji.prototype.untransitioned=function(){return new eo(this.property,this.value,null,{},0)};var ti=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};ti.prototype.getValue=function(e){return Ge(this._values[e].value.value)},ti.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new ji(this._values[e].property)),this._values[e].value=new Ai(this._values[e].property,t===null?void 0:Ge(t))},ti.prototype.getTransition=function(e){return Ge(this._values[e].transition)},ti.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new ji(this._values[e].property)),this._values[e].transition=Ge(t)||void 0},ti.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p);var d=this.getTransition(l);d!==void 0&&(e[l+"-transition"]=d)}return e},ti.prototype.transitioned=function(e,t){for(var i=new Sa(this._properties),l=0,p=Object.keys(this._values);l<p.length;l+=1){var d=p[l];i._values[d]=this._values[d].transitioned(e,t._values[d])}return i},ti.prototype.untransitioned=function(){for(var e=new Sa(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var eo=function(e,t,i,l,p){this.property=e,this.value=t,this.begin=p+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};eo.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,p=this.value.possiblyEvaluate(e,t,i),d=this.prior;if(d){if(l>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(l<this.begin)return d.possiblyEvaluate(e,t,i);var _=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(d.possiblyEvaluate(e,t,i),p,function(E){if(E<=0)return 0;if(E>=1)return 1;var T=E*E,z=T*E;return 4*(E<.5?z:3*(E-T)+z-.75)}(_))}return p};var Sa=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Sa.prototype.possiblyEvaluate=function(e,t,i){for(var l=new Us(this._properties),p=0,d=Object.keys(this._values);p<d.length;p+=1){var _=d[p];l._values[_]=this._values[_].possiblyEvaluate(e,t,i)}return l},Sa.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var Sn=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};Sn.prototype.getValue=function(e){return Ge(this._values[e].value)},Sn.prototype.setValue=function(e,t){this._values[e]=new Ai(this._values[e].property,t===null?void 0:Ge(t))},Sn.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p)}return e},Sn.prototype.possiblyEvaluate=function(e,t,i){for(var l=new Us(this._properties),p=0,d=Object.keys(this._values);p<d.length;p+=1){var _=d[p];l._values[_]=this._values[_].possiblyEvaluate(e,t,i)}return l};var jn=function(e,t,i){this.property=e,this.value=t,this.parameters=i};jn.prototype.isConstant=function(){return this.value.kind==="constant"},jn.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},jn.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var Us=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Us.prototype.get=function(e){return this._values[e]};var vt=function(e){this.specification=e};vt.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},vt.prototype.interpolate=function(e,t,i){var l=To[this.specification.type];return l?l(e,t,i):e};var dt=function(e,t){this.specification=e,this.overrides=t};dt.prototype.possiblyEvaluate=function(e,t,i,l){return new jn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},dt.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new jn(this,{kind:"constant",value:void 0},e.parameters);var l=To[this.specification.type];return l?new jn(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},dt.prototype.evaluate=function(e,t,i,l,p,d){return e.kind==="constant"?e.value:e.evaluate(t,i,l,p,d)};var sl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,p,d){if(i.value===void 0)return new jn(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var _=i.expression.evaluate(l,null,{},p,d),E=i.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,T=this._calculate(E,E,E,l);return new jn(this,{kind:"constant",value:T},l)}if(i.expression.kind==="camera"){var z=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new jn(this,{kind:"constant",value:z},l)}return new jn(this,i.expression,l)},t.prototype.evaluate=function(i,l,p,d,_,E){if(i.kind==="source"){var T=i.evaluate(l,p,d,_,E);return this._calculate(T,T,T,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},p,d),i.evaluate({zoom:Math.floor(l.zoom)},p,d),i.evaluate({zoom:Math.floor(l.zoom)+1},p,d),l):i.value},t.prototype._calculate=function(i,l,p,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}},t.prototype.interpolate=function(i){return i},t}(dt),Di=function(e){this.specification=e};Di.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var p=e.expression.evaluate(t,null,{},i,l);return this._calculate(p,p,p,t)}return this._calculate(e.expression.evaluate(new rr(Math.floor(t.zoom-1),t)),e.expression.evaluate(new rr(Math.floor(t.zoom),t)),e.expression.evaluate(new rr(Math.floor(t.zoom+1),t)),t)}},Di.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},Di.prototype.interpolate=function(e){return e};var to=function(e){this.specification=e};to.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},to.prototype.interpolate=function(){return!1};var Hi=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new Ai(i,void 0),p=this.defaultTransitionablePropertyValues[t]=new ji(i);this.defaultTransitioningPropertyValues[t]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};at("DataDrivenProperty",dt),at("DataConstantProperty",vt),at("CrossFadedDataDrivenProperty",sl),at("CrossFadedProperty",Di),at("ColorRampProperty",to);var Qo=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new Sn(l.layout)),l.paint)){for(var p in this._transitionablePaint=new ti(l.paint),i.paint)this.setPaintProperty(p,i.paint[p],{validate:!1});for(var d in i.layout)this.setLayoutProperty(d,i.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Us(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,p){p===void 0&&(p={}),l!=null&&this._validate(pa,"layers."+this.id+".layout."+i,i,l,p)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return Xt(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,p){if(p===void 0&&(p={}),l!=null&&this._validate(Du,"layers."+this.id+".paint."+i,i,l,p))return!1;if(Xt(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var d=this._transitionablePaint._values[i],_=d.property.specification["property-type"]==="cross-faded-data-driven",E=d.value.isDataDriven(),T=d.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var z=this._transitionablePaint._values[i].value;return z.isDataDriven()||E||_||this._handleOverridablePaintPropertyUpdate(i,T,z)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),qt(i,function(l,p){return!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,p,d,_){return _===void 0&&(_={}),(!_||_.validate!==!1)&&$a(this,i.call(ha,{key:l,layerType:this.type,objectKey:p,value:d,styleSpec:Z,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof jn&&fn(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(ye),Ea={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ll=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},hr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Wr(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(p){var d=Ea[p.type].BYTES_PER_ELEMENT,_=i=ka(i,Math.max(t,d)),E=p.components||1;return l=Math.max(l,d),i+=d*E,{name:p.name,type:p.type,components:E,offset:_}}),size:ka(i,Math.max(l,t)),alignment:t}}function ka(e,t){return Math.ceil(e/t)*t}hr.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},hr.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},hr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},hr.prototype.clear=function(){this.length=0},hr.prototype.resize=function(e){this.reserve(e),this.length=e},hr.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},hr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var rs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.int16[d+0]=l,this.int16[d+1]=p,i},t}(hr);rs.prototype.bytesPerElement=4,at("StructArrayLayout2i4",rs);var is=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var E=4*i;return this.int16[E+0]=l,this.int16[E+1]=p,this.int16[E+2]=d,this.int16[E+3]=_,i},t}(hr);is.prototype.bytesPerElement=8,at("StructArrayLayout4i8",is);var ns=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E){var T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,d,_,E)},t.prototype.emplace=function(i,l,p,d,_,E,T){var z=6*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.int16[z+2]=d,this.int16[z+3]=_,this.int16[z+4]=E,this.int16[z+5]=T,i},t}(hr);ns.prototype.bytesPerElement=12,at("StructArrayLayout2i4i12",ns);var qn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E){var T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,d,_,E)},t.prototype.emplace=function(i,l,p,d,_,E,T){var z=4*i,C=8*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.uint8[C+4]=d,this.uint8[C+5]=_,this.uint8[C+6]=E,this.uint8[C+7]=T,i},t}(hr);qn.prototype.bytesPerElement=8,at("StructArrayLayout2i4ub8",qn);var $o=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.float32[d+0]=l,this.float32[d+1]=p,i},t}(hr);$o.prototype.bytesPerElement=8,at("StructArrayLayout2f8",$o);var Zn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E,T,z,C,D){var N=this.length;return this.resize(N+1),this.emplace(N,i,l,p,d,_,E,T,z,C,D)},t.prototype.emplace=function(i,l,p,d,_,E,T,z,C,D,N){var K=10*i;return this.uint16[K+0]=l,this.uint16[K+1]=p,this.uint16[K+2]=d,this.uint16[K+3]=_,this.uint16[K+4]=E,this.uint16[K+5]=T,this.uint16[K+6]=z,this.uint16[K+7]=C,this.uint16[K+8]=D,this.uint16[K+9]=N,i},t}(hr);Zn.prototype.bytesPerElement=20,at("StructArrayLayout10ui20",Zn);var ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E,T,z,C,D,N,K){var te=this.length;return this.resize(te+1),this.emplace(te,i,l,p,d,_,E,T,z,C,D,N,K)},t.prototype.emplace=function(i,l,p,d,_,E,T,z,C,D,N,K,te){var ne=12*i;return this.int16[ne+0]=l,this.int16[ne+1]=p,this.int16[ne+2]=d,this.int16[ne+3]=_,this.uint16[ne+4]=E,this.uint16[ne+5]=T,this.uint16[ne+6]=z,this.uint16[ne+7]=C,this.int16[ne+8]=D,this.int16[ne+9]=N,this.int16[ne+10]=K,this.int16[ne+11]=te,i},t}(hr);ul.prototype.bytesPerElement=24,at("StructArrayLayout4i4ui4i24",ul);var ea=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.float32[_+0]=l,this.float32[_+1]=p,this.float32[_+2]=d,i},t}(hr);ea.prototype.bytesPerElement=12,at("StructArrayLayout3f12",ea);var os=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(hr);os.prototype.bytesPerElement=4,at("StructArrayLayout1ul4",os);var Ll=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E,T,z,C){var D=this.length;return this.resize(D+1),this.emplace(D,i,l,p,d,_,E,T,z,C)},t.prototype.emplace=function(i,l,p,d,_,E,T,z,C,D){var N=10*i,K=5*i;return this.int16[N+0]=l,this.int16[N+1]=p,this.int16[N+2]=d,this.int16[N+3]=_,this.int16[N+4]=E,this.int16[N+5]=T,this.uint32[K+3]=z,this.uint16[N+8]=C,this.uint16[N+9]=D,i},t}(hr);Ll.prototype.bytesPerElement=20,at("StructArrayLayout6i1ul2ui20",Ll);var xs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E){var T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,d,_,E)},t.prototype.emplace=function(i,l,p,d,_,E,T){var z=6*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.int16[z+2]=d,this.int16[z+3]=_,this.int16[z+4]=E,this.int16[z+5]=T,i},t}(hr);xs.prototype.bytesPerElement=12,at("StructArrayLayout2i2i2i12",xs);var mo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_){var E=this.length;return this.resize(E+1),this.emplace(E,i,l,p,d,_)},t.prototype.emplace=function(i,l,p,d,_,E){var T=4*i,z=8*i;return this.float32[T+0]=l,this.float32[T+1]=p,this.float32[T+2]=d,this.int16[z+6]=_,this.int16[z+7]=E,i},t}(hr);mo.prototype.bytesPerElement=16,at("StructArrayLayout2f1f2i16",mo);var Rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var E=12*i,T=3*i;return this.uint8[E+0]=l,this.uint8[E+1]=p,this.float32[T+1]=d,this.float32[T+2]=_,i},t}(hr);Rl.prototype.bytesPerElement=12,at("StructArrayLayout2ub2f12",Rl);var En=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.uint16[_+0]=l,this.uint16[_+1]=p,this.uint16[_+2]=d,i},t}(hr);En.prototype.bytesPerElement=6,at("StructArrayLayout3ui6",En);var sn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E,T,z,C,D,N,K,te,ne,pe,ae,ge){var ke=this.length;return this.resize(ke+1),this.emplace(ke,i,l,p,d,_,E,T,z,C,D,N,K,te,ne,pe,ae,ge)},t.prototype.emplace=function(i,l,p,d,_,E,T,z,C,D,N,K,te,ne,pe,ae,ge,ke){var Pe=24*i,Be=12*i,Fe=48*i;return this.int16[Pe+0]=l,this.int16[Pe+1]=p,this.uint16[Pe+2]=d,this.uint16[Pe+3]=_,this.uint32[Be+2]=E,this.uint32[Be+3]=T,this.uint32[Be+4]=z,this.uint16[Pe+10]=C,this.uint16[Pe+11]=D,this.uint16[Pe+12]=N,this.float32[Be+7]=K,this.float32[Be+8]=te,this.uint8[Fe+36]=ne,this.uint8[Fe+37]=pe,this.uint8[Fe+38]=ae,this.uint32[Be+10]=ge,this.int16[Pe+22]=ke,i},t}(hr);sn.prototype.bytesPerElement=48,at("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",sn);var ta=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E,T,z,C,D,N,K,te,ne,pe,ae,ge,ke,Pe,Be,Fe,Qe,nt,Tt,ct,Mt,pt,ir){var jt=this.length;return this.resize(jt+1),this.emplace(jt,i,l,p,d,_,E,T,z,C,D,N,K,te,ne,pe,ae,ge,ke,Pe,Be,Fe,Qe,nt,Tt,ct,Mt,pt,ir)},t.prototype.emplace=function(i,l,p,d,_,E,T,z,C,D,N,K,te,ne,pe,ae,ge,ke,Pe,Be,Fe,Qe,nt,Tt,ct,Mt,pt,ir,jt){var _t=34*i,pr=17*i;return this.int16[_t+0]=l,this.int16[_t+1]=p,this.int16[_t+2]=d,this.int16[_t+3]=_,this.int16[_t+4]=E,this.int16[_t+5]=T,this.int16[_t+6]=z,this.int16[_t+7]=C,this.uint16[_t+8]=D,this.uint16[_t+9]=N,this.uint16[_t+10]=K,this.uint16[_t+11]=te,this.uint16[_t+12]=ne,this.uint16[_t+13]=pe,this.uint16[_t+14]=ae,this.uint16[_t+15]=ge,this.uint16[_t+16]=ke,this.uint16[_t+17]=Pe,this.uint16[_t+18]=Be,this.uint16[_t+19]=Fe,this.uint16[_t+20]=Qe,this.uint16[_t+21]=nt,this.uint16[_t+22]=Tt,this.uint32[pr+12]=ct,this.float32[pr+13]=Mt,this.float32[pr+14]=pt,this.float32[pr+15]=ir,this.float32[pr+16]=jt,i},t}(hr);ta.prototype.bytesPerElement=68,at("StructArrayLayout8i15ui1ul4f68",ta);var Ta=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(hr);Ta.prototype.bytesPerElement=4,at("StructArrayLayout1f4",Ta);var dn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.int16[_+0]=l,this.int16[_+1]=p,this.int16[_+2]=d,i},t}(hr);dn.prototype.bytesPerElement=6,at("StructArrayLayout3i6",dn);var Lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=4*i;return this.uint32[2*i+0]=l,this.uint16[_+2]=p,this.uint16[_+3]=d,i},t}(hr);Lu.prototype.bytesPerElement=8,at("StructArrayLayout1ul2ui8",Lu);var js=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.uint16[d+0]=l,this.uint16[d+1]=p,i},t}(hr);js.prototype.bytesPerElement=4,at("StructArrayLayout2ui4",js);var as=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(hr);as.prototype.bytesPerElement=2,at("StructArrayLayout1ui2",as);var Ia=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var E=4*i;return this.float32[E+0]=l,this.float32[E+1]=p,this.float32[E+2]=d,this.float32[E+3]=_,i},t}(hr);Ia.prototype.bytesPerElement=16,at("StructArrayLayout4f16",Ia);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new B(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(ll);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(Ll);at("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(ll);o.prototype.size=48;var u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(sn);at("PlacedSymbolArray",u);var m=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(ll);m.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new m(this,i)},t}(ta);at("SymbolInstanceArray",w);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(Ta);at("GlyphOffsetArray",S);var k=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(dn);at("SymbolLineVertexArray",k);var P=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(ll);P.prototype.size=8;var L=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new P(this,i)},t}(Lu);at("FeatureIndexArray",L);var X=Wr([{name:"a_pos",components:2,type:"Int16"}],4).members,W=function(e){e===void 0&&(e=[]),this.segments=e};function J(e,t){return 256*(e=xe(Math.floor(e),0,255))+xe(Math.floor(t),0,255)}W.prototype.prepareSegment=function(e,t,i,l){var p=this.segments[this.segments.length-1];return e>W.MAX_VERTEX_ARRAY_LENGTH&&yt("Max vertices per segment is "+W.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!p||p.vertexLength+e>W.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==l)&&(p={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(p.sortKey=l),this.segments.push(p)),p},W.prototype.get=function(){return this.segments},W.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},W.simpleSegment=function(e,t,i,l){return new W([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},W.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,at("SegmentVector",W);var ee=Wr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ie=A(function(e){e.exports=function(t,i){var l,p,d,_,E,T,z,C;for(p=t.length-(l=3&t.length),d=i,E=3432918353,T=461845907,C=0;C<p;)z=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,d=27492+(65535&(_=5*(65535&(d=(d^=z=(65535&(z=(z=(65535&z)*E+(((z>>>16)*E&65535)<<16)&4294967295)<<15|z>>>17))*T+(((z>>>16)*T&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(z=0,l){case 3:z^=(255&t.charCodeAt(C+2))<<16;case 2:z^=(255&t.charCodeAt(C+1))<<8;case 1:d^=z=(65535&(z=(z=(65535&(z^=255&t.charCodeAt(C)))*E+(((z>>>16)*E&65535)<<16)&4294967295)<<15|z>>>17))*T+(((z>>>16)*T&65535)<<16)&4294967295}return d^=t.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0}}),se=A(function(e){e.exports=function(t,i){for(var l,p=t.length,d=i^p,_=0;p>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(_)|(255&t.charCodeAt(++_))<<8|(255&t.charCodeAt(++_))<<16|(255&t.charCodeAt(++_))<<24))+((1540483477*(l>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++_;switch(p){case 3:d^=(255&t.charCodeAt(_+2))<<16;case 2:d^=(255&t.charCodeAt(_+1))<<8;case 1:d=1540483477*(65535&(d^=255&t.charCodeAt(_)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0}}),$=ie,le=se;$.murmur3=ie,$.murmur2=le;var me=function(){this.ids=[],this.positions=[],this.indexed=!1};me.prototype.add=function(e,t,i,l){this.ids.push(Te(e)),this.positions.push(t,i,l)},me.prototype.getPositions=function(e){for(var t=Te(e),i=0,l=this.ids.length-1;i<l;){var p=i+l>>1;this.ids[p]>=t?l=p:i=p+1}for(var d=[];this.ids[i]===t;)d.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return d},me.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function p(d,_,E,T){for(;E<T;){for(var z=d[E+T>>1],C=E-1,D=T+1;;){do C++;while(d[C]<z);do D--;while(d[D]>z);if(C>=D)break;Ee(d,C,D),Ee(_,3*C,3*D),Ee(_,3*C+1,3*D+1),Ee(_,3*C+2,3*D+2)}D-E<T-D?(p(d,_,E,D),E=D+1):(p(d,_,D+1,T),T=D)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},me.deserialize=function(e){var t=new me;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var be=Math.pow(2,53)-1;function Te(e){var t=+e;return!isNaN(t)&&t<=be?t:$(String(e))}function Ee(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}at("FeaturePositionMap",me);var Ae=function(e,t){this.gl=e.gl,this.location=t},Oe=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Ae),Ke=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Ae),et=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Ae),lt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Ae),mt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Ae),Dt=function(e){function t(i,l){e.call(this,i,l),this.current=ar.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Ae),zt=new Float32Array(16),Kt=function(e){function t(i,l){e.call(this,i,l),this.current=zt}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Ae);function ft(e){return[J(255*e.r,255*e.g),J(255*e.b,255*e.a)]}var Ft=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};Ft.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},Ft.prototype.getBinding=function(e,t,i){return this.type==="color"?new Dt(e,t):new Ke(e,t)};var Nt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Nt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Nt.prototype.setUniform=function(e,t,i,l){var p=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;p&&e.set(p)},Nt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new mt(e,t):new Ke(e,t)};var Q=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(p){return{name:"a_"+p,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Q.prototype.populatePaintArray=function(e,t,i,l,p){var d=this.paintVertexArray.length,_=this.expression.evaluate(new rr(0),t,{},l,[],p);this.paintVertexArray.resize(e),this._setPaintValue(d,e,_)},Q.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,p)},Q.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=ft(i),p=e;p<t;p++)this.paintVertexArray.emplace(p,l[0],l[1]);else{for(var d=e;d<t;d++)this.paintVertexArray.emplace(d,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Q.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Q.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Me=function(e,t,i,l,p,d){this.expression=e,this.uniformNames=t.map(function(_){return"u_"+_+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=t.map(function(_){return{name:"a_"+_,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new d};Me.prototype.populatePaintArray=function(e,t,i,l,p){var d=this.expression.evaluate(new rr(this.zoom),t,{},l,[],p),_=this.expression.evaluate(new rr(this.zoom+1),t,{},l,[],p),E=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(E,e,d,_)},Me.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:this.zoom},i,l),d=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,p,d)},Me.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var p=ft(i),d=ft(l),_=e;_<t;_++)this.paintVertexArray.emplace(_,p[0],p[1],d[0],d[1]);else{for(var E=e;E<t;E++)this.paintVertexArray.emplace(E,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},Me.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Me.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Me.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=xe(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},Me.prototype.getBinding=function(e,t,i){return new Ke(e,t)};var Vt=function(e,t,i,l,p,d){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=d,this.zoomInPaintVertexArray=new p,this.zoomOutPaintVertexArray=new p};Vt.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Vt.prototype.updatePaintArray=function(e,t,i,l,p){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],p)},Vt.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var p=l[i.min],d=l[i.mid],_=l[i.max];if(p&&d&&_)for(var E=e;E<t;E++)this.zoomInPaintVertexArray.emplace(E,d.tl[0],d.tl[1],d.br[0],d.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],d.pixelRatio,p.pixelRatio),this.zoomOutPaintVertexArray.emplace(E,d.tl[0],d.tl[1],d.br[0],d.br[1],_.tl[0],_.tl[1],_.br[0],_.br[1],d.pixelRatio,_.pixelRatio)}},Vt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,ee.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,ee.members,this.expression.isStateDependent))},Vt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var At=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var p in e.paint._values)if(i(p)){var d=e.paint.get(p);if(d instanceof jn&&fn(d.property.specification)){var _=ci(p,e.type),E=d.value,T=d.property.specification.type,z=d.property.useIntegerZoom,C=d.property.specification["property-type"],D=C==="cross-faded"||C==="cross-faded-data-driven";if(E.kind==="constant")this.binders[p]=D?new Nt(E.value,_):new Ft(E.value,_,T),l.push("/u_"+p);else if(E.kind==="source"||D){var N=Tr(p,T,"source");this.binders[p]=D?new Vt(E,T,z,t,N,e.id):new Q(E,_,T,N),l.push("/a_"+p)}else{var K=Tr(p,T,"composite");this.binders[p]=new Me(E,_,T,z,t,K),l.push("/z_"+p)}}}this.cacheKey=l.sort().join("")};At.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Q||t instanceof Me?t.maxValue:0},At.prototype.populatePaintArrays=function(e,t,i,l,p){for(var d in this.binders){var _=this.binders[d];(_ instanceof Q||_ instanceof Me||_ instanceof Vt)&&_.populatePaintArray(e,t,i,l,p)}},At.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Nt&&l.setConstantPatternPositions(e,t)}},At.prototype.updatePaintArrays=function(e,t,i,l,p){var d=!1;for(var _ in e)for(var E=0,T=t.getPositions(_);E<T.length;E+=1){var z=T[E],C=i.feature(z.index);for(var D in this.binders){var N=this.binders[D];if((N instanceof Q||N instanceof Me||N instanceof Vt)&&N.expression.isStateDependent===!0){var K=l.paint.get(D);N.expression=K.value,N.updatePaintArray(z.start,z.end,C,e[_],p),d=!0}}}return d},At.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof Ft||i instanceof Nt)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},At.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Q||i instanceof Me)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Vt)for(var p=0;p<ee.members.length;p++)e.push(ee.members[p].name)}return e},At.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ft||i instanceof Nt||i instanceof Me)for(var l=0,p=i.uniformNames;l<p.length;l+=1)e.push(p[l])}return e},At.prototype.getPaintVertexBuffers=function(){return this._buffers},At.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var p=this.binders[l];if(p instanceof Ft||p instanceof Nt||p instanceof Me)for(var d=0,_=p.uniformNames;d<_.length;d+=1){var E=_[d];if(t[E]){var T=p.getBinding(e,t[E],E);i.push({name:E,property:l,binding:T})}}}return i},At.prototype.setUniforms=function(e,t,i,l){for(var p=0,d=t;p<d.length;p+=1){var _=d[p],E=_.name,T=_.property;this.binders[T].setUniform(_.binding,l,i.get(T),E)}},At.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Vt){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Q||i instanceof Me)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},At.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Q||i instanceof Me||i instanceof Vt)&&i.upload(e)}this.updatePaintBuffers()},At.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Q||t instanceof Me||t instanceof Vt)&&t.destroy()}};var Pt=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,p=e;l<p.length;l+=1){var d=p[l];this.programConfigurations[d.id]=new At(d,t,i)}this.needsUpload=!1,this._featureMap=new me,this._bufferOffset=0};function ci(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Tr(e,t,i){var l={color:{source:$o,composite:Ia},number:{source:Ta,composite:$o}},p=function(d){return{"line-pattern":{source:Zn,composite:Zn},"fill-pattern":{source:Zn,composite:Zn},"fill-extrusion-pattern":{source:Zn,composite:Zn}}[d]}(e);return p&&p[i]||l[t][i]}Pt.prototype.populatePaintArrays=function(e,t,i,l,p,d){for(var _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(e,t,l,p,d);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Pt.prototype.updatePaintArrays=function(e,t,i,l){for(var p=0,d=i;p<d.length;p+=1){var _=d[p];this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,t,_,l)||this.needsUpload}},Pt.prototype.get=function(e){return this.programConfigurations[e]},Pt.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Pt.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},at("ConstantBinder",Ft),at("CrossFadedConstantBinder",Nt),at("SourceExpressionBinder",Q),at("CrossFadedCompositeBinder",Vt),at("CompositeExpressionBinder",Me),at("ProgramConfiguration",At,{omit:["_buffers"]}),at("ProgramConfigurationSet",Pt);var zi=Math.pow(2,14)-1,_i=-zi-1;function jr(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var p=i[l],d=0;d<p.length;d++){var _=p[d],E=Math.round(_.x*t),T=Math.round(_.y*t);_.x=xe(E,_i,zi),_.y=xe(T,_i,zi),(E<_.x||E>_.x+1||T<_.y||T>_.y+1)&&yt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function Ir(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?jr(e):[]}}function Ji(e,t,i,l,p){e.emplaceBack(2*t+(l+1)/2,2*i+(p+1)/2)}var Li=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new rs,this.indexArray=new En,this.segments=new W,this.programConfigurations=new Pt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function mn(e,t){for(var i=0;i<e.length;i++)if(Yi(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(Yi(e,t[l]))return!0;return!!cl(e,t)}function qi(e,t,i){return!!Yi(e,t)||!!ln(t,e,i)}function kn(e,t){if(e.length===1)return hl(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],p=0;p<l.length;p++)if(Yi(e,l[p]))return!0;for(var d=0;d<e.length;d++)if(hl(t,e[d]))return!0;for(var _=0;_<t.length;_++)if(cl(e,t[_]))return!0;return!1}function Mo(e,t,i){if(e.length>1){if(cl(e,t))return!0;for(var l=0;l<t.length;l++)if(ln(t[l],e,i))return!0}for(var p=0;p<e.length;p++)if(ln(e[p],t,i))return!0;return!1}function cl(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],p=e[i+1],d=0;d<t.length-1;d++)if(qs(l,p,t[d],t[d+1]))return!0;return!1}function qs(e,t,i,l){return gt(e,i,l)!==gt(t,i,l)&&gt(e,t,i)!==gt(e,t,l)}function ln(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var p=1;p<t.length;p++)if(ya(e,t[p-1],t[p])<l)return!0;return!1}function ya(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var p=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(p<0?t:p>1?i:i.sub(t)._mult(p)._add(t))}function hl(e,t){for(var i,l,p,d=!1,_=0;_<e.length;_++)for(var E=0,T=(i=e[_]).length-1;E<i.length;T=E++)(l=i[E]).y>t.y!=(p=i[T]).y>t.y&&t.x<(p.x-l.x)*(t.y-l.y)/(p.y-l.y)+l.x&&(d=!d);return d}function Yi(e,t){for(var i=!1,l=0,p=e.length-1;l<e.length;p=l++){var d=e[l],_=e[p];d.y>t.y!=_.y>t.y&&t.x<(_.x-d.x)*(t.y-d.y)/(_.y-d.y)+d.x&&(i=!i)}return i}function pl(e,t,i){var l=i[0],p=i[2];if(e.x<l.x&&t.x<l.x||e.x>p.x&&t.x>p.x||e.y<l.y&&t.y<l.y||e.y>p.y&&t.y>p.y)return!1;var d=gt(e,t,i[0]);return d!==gt(e,t,i[1])||d!==gt(e,t,i[2])||d!==gt(e,t,i[3])}function ra(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Qi(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Aa(e,t,i,l,p){if(!t[0]&&!t[1])return e;var d=B.convert(t)._mult(p);i==="viewport"&&d._rotate(-l);for(var _=[],E=0;E<e.length;E++)_.push(e[E].sub(d));return _}Li.prototype.populate=function(e,t,i){var l=this.layers[0],p=[],d=null;l.type==="circle"&&(d=l.layout.get("circle-sort-key"));for(var _=0,E=e;_<E.length;_+=1){var T=E[_],z=T.feature,C=T.id,D=T.index,N=T.sourceLayerIndex,K=this.layers[0]._featureFilter.needGeometry,te=Ir(z,K);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),te,i)){var ne=d?d.evaluate(te,{},i):void 0,pe={id:C,properties:z.properties,type:z.type,sourceLayerIndex:N,index:D,geometry:K?te.geometry:jr(z),patterns:{},sortKey:ne};p.push(pe)}}d&&p.sort(function(nt,Tt){return nt.sortKey-Tt.sortKey});for(var ae=0,ge=p;ae<ge.length;ae+=1){var ke=ge[ae],Pe=ke.geometry,Be=ke.index,Fe=ke.sourceLayerIndex,Qe=e[Be].feature;this.addFeature(ke,Pe,Be,i),t.featureIndex.insert(Qe,Pe,Be,Fe,this.index)}},Li.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Li.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Li.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Li.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,X),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Li.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Li.prototype.addFeature=function(e,t,i,l){for(var p=0,d=t;p<d.length;p+=1)for(var _=0,E=d[p];_<E.length;_+=1){var T=E[_],z=T.x,C=T.y;if(!(z<0||z>=8192||C<0||C>=8192)){var D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),N=D.vertexLength;Ji(this.layoutVertexArray,z,C,-1,-1),Ji(this.layoutVertexArray,z,C,1,-1),Ji(this.layoutVertexArray,z,C,1,1),Ji(this.layoutVertexArray,z,C,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+3,N+2),D.vertexLength+=4,D.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},at("CircleBucket",Li,{omit:["layers"]});var za=new Hi({"circle-sort-key":new dt(Z.layout_circle["circle-sort-key"])}),ws={paint:new Hi({"circle-radius":new dt(Z.paint_circle["circle-radius"]),"circle-color":new dt(Z.paint_circle["circle-color"]),"circle-blur":new dt(Z.paint_circle["circle-blur"]),"circle-opacity":new dt(Z.paint_circle["circle-opacity"]),"circle-translate":new vt(Z.paint_circle["circle-translate"]),"circle-translate-anchor":new vt(Z.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new vt(Z.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new vt(Z.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new dt(Z.paint_circle["circle-stroke-width"]),"circle-stroke-color":new dt(Z.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new dt(Z.paint_circle["circle-stroke-opacity"])}),layout:za},vr=typeof Float32Array<"u"?Float32Array:Array;function yo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function vi(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3],E=t[4],T=t[5],z=t[6],C=t[7],D=t[8],N=t[9],K=t[10],te=t[11],ne=t[12],pe=t[13],ae=t[14],ge=t[15],ke=i[0],Pe=i[1],Be=i[2],Fe=i[3];return e[0]=ke*l+Pe*E+Be*D+Fe*ne,e[1]=ke*p+Pe*T+Be*N+Fe*pe,e[2]=ke*d+Pe*z+Be*K+Fe*ae,e[3]=ke*_+Pe*C+Be*te+Fe*ge,e[4]=(ke=i[4])*l+(Pe=i[5])*E+(Be=i[6])*D+(Fe=i[7])*ne,e[5]=ke*p+Pe*T+Be*N+Fe*pe,e[6]=ke*d+Pe*z+Be*K+Fe*ae,e[7]=ke*_+Pe*C+Be*te+Fe*ge,e[8]=(ke=i[8])*l+(Pe=i[9])*E+(Be=i[10])*D+(Fe=i[11])*ne,e[9]=ke*p+Pe*T+Be*N+Fe*pe,e[10]=ke*d+Pe*z+Be*K+Fe*ae,e[11]=ke*_+Pe*C+Be*te+Fe*ge,e[12]=(ke=i[12])*l+(Pe=i[13])*E+(Be=i[14])*D+(Fe=i[15])*ne,e[13]=ke*p+Pe*T+Be*N+Fe*pe,e[14]=ke*d+Pe*z+Be*K+Fe*ae,e[15]=ke*_+Pe*C+Be*te+Fe*ge,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Ss,Ru=vi;function uu(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3];return e[0]=i[0]*l+i[4]*p+i[8]*d+i[12]*_,e[1]=i[1]*l+i[5]*p+i[9]*d+i[13]*_,e[2]=i[2]*l+i[6]*p+i[10]*d+i[14]*_,e[3]=i[3]*l+i[7]*p+i[11]*d+i[15]*_,e}Ss=new vr(3),vr!=Float32Array&&(Ss[0]=0,Ss[1]=0,Ss[2]=0),function(){var e=new vr(4);vr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var nc=(function(){var e=new vr(2);vr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,ws)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Li(i)},t.prototype.queryRadius=function(i){var l=i;return ra("circle-radius",this,l)+ra("circle-stroke-width",this,l)+Qi(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,E,T,z){for(var C=Aa(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),E.angle,T),D=this.paint.get("circle-radius").evaluate(l,p)+this.paint.get("circle-stroke-width").evaluate(l,p),N=this.paint.get("circle-pitch-alignment")==="map",K=N?C:function(Qe,nt){return Qe.map(function(Tt){return Zs(Tt,nt)})}(C,z),te=N?D*T:D,ne=0,pe=d;ne<pe.length;ne+=1)for(var ae=0,ge=pe[ne];ae<ge.length;ae+=1){var ke=ge[ae],Pe=N?ke:Zs(ke,z),Be=te,Fe=uu([],[ke.x,ke.y,0,1],z);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Be*=Fe[3]/E.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Be*=E.cameraToCenterDistance/Fe[3]),qi(K,Pe,Be))return!0}return!1},t}(Qo));function Zs(e,t){var i=uu([],[e.x,e.y,0,1],t);return new B(i[0]/i[3],i[1]/i[3])}var Bu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Li);function Gs(e,t,i,l){var p=t.width,d=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==p*d*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(p*d*i);return e.width=p,e.height=d,e.data=l,e}function Bl(e,t,i){var l=t.width,p=t.height;if(l!==e.width||p!==e.height){var d=Gs({},{width:l,height:p},i);Pa(e,d,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,p)},i),e.width=l,e.height=p,e.data=d.data}}function Pa(e,t,i,l,p,d){if(p.width===0||p.height===0)return t;if(p.width>e.width||p.height>e.height||i.x>e.width-p.width||i.y>e.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>t.width||p.height>t.height||l.x>t.width-p.width||l.y>t.height-p.height)throw new RangeError("out of range destination coordinates for image copy");for(var _=e.data,E=t.data,T=0;T<p.height;T++)for(var z=((i.y+T)*e.width+i.x)*d,C=((l.y+T)*t.width+l.x)*d,D=0;D<p.width*d;D++)E[C+D]=_[z+D];return t}at("HeatmapBucket",Bu,{omit:["layers"]});var fl=function(e,t){Gs(this,e,1,t)};fl.prototype.resize=function(e){Bl(this,e,1)},fl.prototype.clone=function(){return new fl({width:this.width,height:this.height},new Uint8Array(this.data))},fl.copy=function(e,t,i,l,p){Pa(e,t,i,l,p,1)};var Gn=function(e,t){Gs(this,e,4,t)};Gn.prototype.resize=function(e){Bl(this,e,4)},Gn.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Gn.prototype.clone=function(){return new Gn({width:this.width,height:this.height},new Uint8Array(this.data))},Gn.copy=function(e,t,i,l,p){Pa(e,t,i,l,p,4)},at("AlphaImage",fl),at("RGBAImage",Gn);var vf={paint:new Hi({"heatmap-radius":new dt(Z.paint_heatmap["heatmap-radius"]),"heatmap-weight":new dt(Z.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new vt(Z.paint_heatmap["heatmap-intensity"]),"heatmap-color":new to(Z.paint_heatmap["heatmap-color"]),"heatmap-opacity":new vt(Z.paint_heatmap["heatmap-opacity"])})};function qc(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,p=e.image||new Gn({width:i,height:l}),d=function(te,ne,pe){t[e.evaluationKey]=pe;var ae=e.expression.evaluate(t);p.data[te+ne+0]=Math.floor(255*ae.r/ae.a),p.data[te+ne+1]=Math.floor(255*ae.g/ae.a),p.data[te+ne+2]=Math.floor(255*ae.b/ae.a),p.data[te+ne+3]=Math.floor(255*ae.a)};if(e.clips)for(var _=0,E=0;_<l;++_,E+=4*i)for(var T=0,z=0;T<i;T++,z+=4){var C=T/(i-1),D=e.clips[_];d(E,z,D.start*(1-C)+D.end*C)}else for(var N=0,K=0;N<i;N++,K+=4)d(0,K,N/(i-1));return p}var Zc=function(e){function t(i){e.call(this,i,vf),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Bu(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=qc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Qo),qh={paint:new Hi({"hillshade-illumination-direction":new vt(Z.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new vt(Z.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new vt(Z.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new vt(Z.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new vt(Z.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new vt(Z.paint_hillshade["hillshade-accent-color"])})},Zh=function(e){function t(i){e.call(this,i,qh)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Qo),Gh=Wr([{name:"a_pos",components:2,type:"Int16"}],4).members,cu=Ks,Kh=Ks;function Ks(e,t,i){i=i||2;var l,p,d,_,E,T,z,C=t&&t.length,D=C?t[0]*i:e.length,N=Gc(e,0,D,i,!0),K=[];if(!N||N.next===N.prev)return K;if(C&&(N=function(ne,pe,ae,ge){var ke,Pe,Be,Fe=[];for(ke=0,Pe=pe.length;ke<Pe;ke++)(Be=Gc(ne,pe[ke]*ge,ke<Pe-1?pe[ke+1]*ge:ne.length,ge,!1))===Be.next&&(Be.steiner=!0),Fe.push(Yh(Be));for(Fe.sort(dl),ke=0;ke<Fe.length;ke++)Jh(Fe[ke],ae),ae=Es(ae,ae.next);return ae}(e,t,N,i)),e.length>80*i){l=d=e[0],p=_=e[1];for(var te=i;te<D;te+=i)(E=e[te])<l&&(l=E),(T=e[te+1])<p&&(p=T),E>d&&(d=E),T>_&&(_=T);z=(z=Math.max(d-l,_-p))!==0?1/z:0}return Ou(N,K,i,l,p,z),K}function Gc(e,t,i,l,p){var d,_;if(p===Hc(e,t,i,l)>0)for(d=t;d<i;d+=l)_=Vl(d,e[d],e[d+1],_);else for(d=i-l;d>=t;d-=l)_=Vl(d,e[d],e[d+1],_);return _&&Fu(_,_.next)&&(pu(_),_=_.next),_}function Es(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!Fu(l,l.next)&&Ri(l.prev,l,l.next)!==0)l=l.next;else{if(pu(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function Ou(e,t,i,l,p,d,_){if(e){!_&&d&&function(C,D,N,K){var te=C;do te.z===null&&(te.z=oc(te.x,te.y,D,N,K)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next;while(te!==C);te.prevZ.nextZ=null,te.prevZ=null,function(ne){var pe,ae,ge,ke,Pe,Be,Fe,Qe,nt=1;do{for(ae=ne,ne=null,Pe=null,Be=0;ae;){for(Be++,ge=ae,Fe=0,pe=0;pe<nt&&(Fe++,ge=ge.nextZ);pe++);for(Qe=nt;Fe>0||Qe>0&&ge;)Fe!==0&&(Qe===0||!ge||ae.z<=ge.z)?(ke=ae,ae=ae.nextZ,Fe--):(ke=ge,ge=ge.nextZ,Qe--),Pe?Pe.nextZ=ke:ne=ke,ke.prevZ=Pe,Pe=ke;ae=ge}Pe.nextZ=null,nt*=2}while(Be>1)}(te)}(e,l,p,d);for(var E,T,z=e;e.prev!==e.next;)if(E=e.prev,T=e.next,d?Kc(e,l,p,d):Xh(e))t.push(E.i/i),t.push(e.i/i),t.push(T.i/i),pu(e),e=T.next,z=T.next;else if((e=T)===z){_?_===1?Ou(e=Wh(Es(e),t,i),t,i,l,p,d,2):_===2&&Hh(e,t,i,l,p,d):Ou(Es(e),t,i,l,p,d,1);break}}}function Xh(e){var t=e.prev,i=e,l=e.next;if(Ri(t,i,l)>=0)return!1;for(var p=e.next.next;p!==e.prev;){if(Ol(t.x,t.y,i.x,i.y,l.x,l.y,p.x,p.y)&&Ri(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Kc(e,t,i,l){var p=e.prev,d=e,_=e.next;if(Ri(p,d,_)>=0)return!1;for(var E=p.x>d.x?p.x>_.x?p.x:_.x:d.x>_.x?d.x:_.x,T=p.y>d.y?p.y>_.y?p.y:_.y:d.y>_.y?d.y:_.y,z=oc(p.x<d.x?p.x<_.x?p.x:_.x:d.x<_.x?d.x:_.x,p.y<d.y?p.y<_.y?p.y:_.y:d.y<_.y?d.y:_.y,t,i,l),C=oc(E,T,t,i,l),D=e.prevZ,N=e.nextZ;D&&D.z>=z&&N&&N.z<=C;){if(D!==e.prev&&D!==e.next&&Ol(p.x,p.y,d.x,d.y,_.x,_.y,D.x,D.y)&&Ri(D.prev,D,D.next)>=0||(D=D.prevZ,N!==e.prev&&N!==e.next&&Ol(p.x,p.y,d.x,d.y,_.x,_.y,N.x,N.y)&&Ri(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;D&&D.z>=z;){if(D!==e.prev&&D!==e.next&&Ol(p.x,p.y,d.x,d.y,_.x,_.y,D.x,D.y)&&Ri(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;N&&N.z<=C;){if(N!==e.prev&&N!==e.next&&Ol(p.x,p.y,d.x,d.y,_.x,_.y,N.x,N.y)&&Ri(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function Wh(e,t,i){var l=e;do{var p=l.prev,d=l.next.next;!Fu(p,d)&&Wc(p,l,l.next,d)&&Fl(p,d)&&Fl(d,p)&&(t.push(p.i/i),t.push(l.i/i),t.push(d.i/i),pu(l),pu(l.next),l=e=d),l=l.next}while(l!==e);return Es(l)}function Hh(e,t,i,l,p,d){var _=e;do{for(var E=_.next.next;E!==_.prev;){if(_.i!==E.i&&Qh(_,E)){var T=Nl(_,E);return _=Es(_,_.next),T=Es(T,T.next),Ou(_,t,i,l,p,d),void Ou(T,t,i,l,p,d)}E=E.next}_=_.next}while(_!==e)}function dl(e,t){return e.x-t.x}function Jh(e,t){if(t=function(l,p){var d,_=p,E=l.x,T=l.y,z=-1/0;do{if(T<=_.y&&T>=_.next.y&&_.next.y!==_.y){var C=_.x+(T-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(C<=E&&C>z){if(z=C,C===E){if(T===_.y)return _;if(T===_.next.y)return _.next}d=_.x<_.next.x?_:_.next}}_=_.next}while(_!==p);if(!d)return null;if(E===z)return d;var D,N=d,K=d.x,te=d.y,ne=1/0;_=d;do E>=_.x&&_.x>=K&&E!==_.x&&Ol(T<te?E:z,T,K,te,T<te?z:E,T,_.x,_.y)&&(D=Math.abs(T-_.y)/(E-_.x),Fl(_,l)&&(D<ne||D===ne&&(_.x>d.x||_.x===d.x&&Xc(d,_)))&&(d=_,ne=D)),_=_.next;while(_!==N);return d}(e,t)){var i=Nl(t,e);Es(t,t.next),Es(i,i.next)}}function Xc(e,t){return Ri(e.prev,e,t.prev)<0&&Ri(t.next,e,e.next)<0}function oc(e,t,i,l,p){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*p)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*p)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Yh(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function Ol(e,t,i,l,p,d,_,E){return(p-_)*(t-E)-(e-_)*(d-E)>=0&&(e-_)*(l-E)-(i-_)*(t-E)>=0&&(i-_)*(d-E)-(p-_)*(l-E)>=0}function Qh(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var p=i;do{if(p.i!==i.i&&p.next.i!==i.i&&p.i!==l.i&&p.next.i!==l.i&&Wc(p,p.next,i,l))return!0;p=p.next}while(p!==i);return!1}(e,t)&&(Fl(e,t)&&Fl(t,e)&&function(i,l){var p=i,d=!1,_=(i.x+l.x)/2,E=(i.y+l.y)/2;do p.y>E!=p.next.y>E&&p.next.y!==p.y&&_<(p.next.x-p.x)*(E-p.y)/(p.next.y-p.y)+p.x&&(d=!d),p=p.next;while(p!==i);return d}(e,t)&&(Ri(e.prev,e,t.prev)||Ri(e,t.prev,t))||Fu(e,t)&&Ri(e.prev,e,e.next)>0&&Ri(t.prev,t,t.next)>0)}function Ri(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Fu(e,t){return e.x===t.x&&e.y===t.y}function Wc(e,t,i,l){var p=hu(Ri(e,t,i)),d=hu(Ri(e,t,l)),_=hu(Ri(i,l,e)),E=hu(Ri(i,l,t));return p!==d&&_!==E||!(p!==0||!Nu(e,i,t))||!(d!==0||!Nu(e,l,t))||!(_!==0||!Nu(i,e,l))||!(E!==0||!Nu(i,t,l))}function Nu(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function hu(e){return e>0?1:e<0?-1:0}function Fl(e,t){return Ri(e.prev,e,e.next)<0?Ri(e,t,e.next)>=0&&Ri(e,e.prev,t)>=0:Ri(e,t,e.prev)<0||Ri(e,e.next,t)<0}function Nl(e,t){var i=new Vu(e.i,e.x,e.y),l=new Vu(t.i,t.x,t.y),p=e.next,d=t.prev;return e.next=t,t.prev=e,i.next=p,p.prev=i,l.next=i,i.prev=l,d.next=l,l.prev=d,l}function Vl(e,t,i,l){var p=new Vu(e,t,i);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function pu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Vu(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Hc(e,t,i,l){for(var p=0,d=t,_=i-l;d<i;d+=l)p+=(e[_]-e[d])*(e[d+1]+e[_+1]),_=d;return p}function $h(e,t,i,l,p){(function d(_,E,T,z,C){for(;z>T;){if(z-T>600){var D=z-T+1,N=E-T+1,K=Math.log(D),te=.5*Math.exp(2*K/3),ne=.5*Math.sqrt(K*te*(D-te)/D)*(N-D/2<0?-1:1);d(_,E,Math.max(T,Math.floor(E-N*te/D+ne)),Math.min(z,Math.floor(E+(D-N)*te/D+ne)),C)}var pe=_[E],ae=T,ge=z;for(Ul(_,T,E),C(_[z],pe)>0&&Ul(_,T,z);ae<ge;){for(Ul(_,ae,ge),ae++,ge--;C(_[ae],pe)<0;)ae++;for(;C(_[ge],pe)>0;)ge--}C(_[T],pe)===0?Ul(_,T,ge):Ul(_,++ge,z),ge<=E&&(T=ge+1),E<=ge&&(z=ge-1)}})(e,t,i||0,l||e.length-1,p||ep)}function Ul(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function ep(e,t){return e<t?-1:e>t?1:0}function ac(e,t){var i=e.length;if(i<=1)return[e];for(var l,p,d=[],_=0;_<i;_++){var E=Le(e[_]);E!==0&&(e[_].area=Math.abs(E),p===void 0&&(p=E<0),p===E<0?(l&&d.push(l),l=[e[_]]):l.push(e[_]))}if(l&&d.push(l),t>1)for(var T=0;T<d.length;T++)d[T].length<=t||($h(d[T],t,1,d[T].length-1,fu),d[T]=d[T].slice(0,t));return d}function fu(e,t){return t.area-e.area}function sc(e,t,i){for(var l=i.patternDependencies,p=!1,d=0,_=t;d<_.length;d+=1){var E=_[d].paint.get(e+"-pattern");E.isConstant()||(p=!0);var T=E.constantOr(null);T&&(p=!0,l[T.to]=!0,l[T.from]=!0)}return p}function Uu(e,t,i,l,p){for(var d=p.patternDependencies,_=0,E=t;_<E.length;_+=1){var T=E[_],z=T.paint.get(e+"-pattern").value;if(z.kind!=="constant"){var C=z.evaluate({zoom:l-1},i,{},p.availableImages),D=z.evaluate({zoom:l},i,{},p.availableImages),N=z.evaluate({zoom:l+1},i,{},p.availableImages);D=D&&D.name?D.name:D,N=N&&N.name?N.name:N,d[C=C&&C.name?C.name:C]=!0,d[D]=!0,d[N]=!0,i.patterns[T.id]={min:C,mid:D,max:N}}}return i}Ks.deviation=function(e,t,i,l){var p=t&&t.length,d=Math.abs(Hc(e,0,p?t[0]*i:e.length,i));if(p)for(var _=0,E=t.length;_<E;_++)d-=Math.abs(Hc(e,t[_]*i,_<E-1?t[_+1]*i:e.length,i));var T=0;for(_=0;_<l.length;_+=3){var z=l[_]*i,C=l[_+1]*i,D=l[_+2]*i;T+=Math.abs((e[z]-e[D])*(e[C+1]-e[z+1])-(e[z]-e[C])*(e[D+1]-e[z+1]))}return d===0&&T===0?0:Math.abs((T-d)/d)},Ks.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,p=0;p<e.length;p++){for(var d=0;d<e[p].length;d++)for(var _=0;_<t;_++)i.vertices.push(e[p][d][_]);p>0&&i.holes.push(l+=e[p-1].length)}return i},cu.default=Kh;var ss=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new rs,this.indexArray=new En,this.indexArray2=new js,this.programConfigurations=new Pt(e.layers,e.zoom),this.segments=new W,this.segments2=new W,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};ss.prototype.populate=function(e,t,i){this.hasPattern=sc("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),p=[],d=0,_=e;d<_.length;d+=1){var E=_[d],T=E.feature,z=E.id,C=E.index,D=E.sourceLayerIndex,N=this.layers[0]._featureFilter.needGeometry,K=Ir(T,N);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),K,i)){var te=l?l.evaluate(K,{},i,t.availableImages):void 0,ne={id:z,properties:T.properties,type:T.type,sourceLayerIndex:D,index:C,geometry:N?K.geometry:jr(T),patterns:{},sortKey:te};p.push(ne)}}l&&p.sort(function(Qe,nt){return Qe.sortKey-nt.sortKey});for(var pe=0,ae=p;pe<ae.length;pe+=1){var ge=ae[pe],ke=ge.geometry,Pe=ge.index,Be=ge.sourceLayerIndex;if(this.hasPattern){var Fe=Uu("fill",this.layers,ge,this.zoom,t);this.patternFeatures.push(Fe)}else this.addFeature(ge,ke,Pe,i,{});t.featureIndex.insert(e[Pe].feature,ke,Pe,Be,this.index)}},ss.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},ss.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},ss.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ss.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ss.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Gh),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},ss.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ss.prototype.addFeature=function(e,t,i,l,p){for(var d=0,_=ac(t,500);d<_.length;d+=1){for(var E=_[d],T=0,z=0,C=E;z<C.length;z+=1)T+=C[z].length;for(var D=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),N=D.vertexLength,K=[],te=[],ne=0,pe=E;ne<pe.length;ne+=1){var ae=pe[ne];if(ae.length!==0){ae!==E[0]&&te.push(K.length/2);var ge=this.segments2.prepareSegment(ae.length,this.layoutVertexArray,this.indexArray2),ke=ge.vertexLength;this.layoutVertexArray.emplaceBack(ae[0].x,ae[0].y),this.indexArray2.emplaceBack(ke+ae.length-1,ke),K.push(ae[0].x),K.push(ae[0].y);for(var Pe=1;Pe<ae.length;Pe++)this.layoutVertexArray.emplaceBack(ae[Pe].x,ae[Pe].y),this.indexArray2.emplaceBack(ke+Pe-1,ke+Pe),K.push(ae[Pe].x),K.push(ae[Pe].y);ge.vertexLength+=ae.length,ge.primitiveLength+=ae.length}}for(var Be=cu(K,te),Fe=0;Fe<Be.length;Fe+=3)this.indexArray.emplaceBack(N+Be[Fe],N+Be[Fe+1],N+Be[Fe+2]);D.vertexLength+=T,D.primitiveLength+=Be.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},at("FillBucket",ss,{omit:["layers","patternFeatures"]});var tp=new Hi({"fill-sort-key":new dt(Z.layout_fill["fill-sort-key"])}),Jc={paint:new Hi({"fill-antialias":new vt(Z.paint_fill["fill-antialias"]),"fill-opacity":new dt(Z.paint_fill["fill-opacity"]),"fill-color":new dt(Z.paint_fill["fill-color"]),"fill-outline-color":new dt(Z.paint_fill["fill-outline-color"]),"fill-translate":new vt(Z.paint_fill["fill-translate"]),"fill-translate-anchor":new vt(Z.paint_fill["fill-translate-anchor"]),"fill-pattern":new sl(Z.paint_fill["fill-pattern"])}),layout:tp},rp=function(e){function t(i){e.call(this,i,Jc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new ss(i)},t.prototype.queryRadius=function(){return Qi(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,E,T){return kn(Aa(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),E.angle,T),d)},t.prototype.isTileClipped=function(){return!0},t}(Qo),ip=Wr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,jl=ql;function ql(e,t,i,l,p){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=p,e.readFields(Yc,this,t)}function Yc(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,p){for(var d=l.readVarint()+l.pos;l.pos<d;){var _=p._keys[l.readVarint()],E=p._values[l.readVarint()];p.properties[_]=E}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function bf(e){for(var t,i,l=0,p=0,d=e.length,_=d-1;p<d;_=p++)l+=((i=e[_]).x-(t=e[p]).x)*(t.y+i.y);return l}ql.types=["Unknown","Point","LineString","Polygon"],ql.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,p=0,d=0,_=0,E=[];e.pos<i;){if(p<=0){var T=e.readVarint();l=7&T,p=T>>3}if(p--,l===1||l===2)d+=e.readSVarint(),_+=e.readSVarint(),l===1&&(t&&E.push(t),t=[]),t.push(new B(d,_));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&E.push(t),E},ql.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,p=0,d=0,_=1/0,E=-1/0,T=1/0,z=-1/0;e.pos<t;){if(l<=0){var C=e.readVarint();i=7&C,l=C>>3}if(l--,i===1||i===2)(p+=e.readSVarint())<_&&(_=p),p>E&&(E=p),(d+=e.readSVarint())<T&&(T=d),d>z&&(z=d);else if(i!==7)throw new Error("unknown command "+i)}return[_,T,E,z]},ql.prototype.toGeoJSON=function(e,t,i){var l,p,d=this.extent*Math.pow(2,i),_=this.extent*e,E=this.extent*t,T=this.loadGeometry(),z=ql.types[this.type];function C(K){for(var te=0;te<K.length;te++){var ne=K[te];K[te]=[360*(ne.x+_)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*(ne.y+E)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(l=0;l<T.length;l++)D[l]=T[l][0];C(T=D);break;case 2:for(l=0;l<T.length;l++)C(T[l]);break;case 3:for(T=function(K){var te=K.length;if(te<=1)return[K];for(var ne,pe,ae=[],ge=0;ge<te;ge++){var ke=bf(K[ge]);ke!==0&&(pe===void 0&&(pe=ke<0),pe===ke<0?(ne&&ae.push(ne),ne=[K[ge]]):ne.push(K[ge]))}return ne&&ae.push(ne),ae}(T),l=0;l<T.length;l++)for(p=0;p<T[l].length;p++)C(T[l][p])}T.length===1?T=T[0]:z="Multi"+z;var N={type:"Feature",geometry:{type:z,coordinates:T},properties:this.properties};return"id"in this&&(N.id=this.id),N};var Qc=lc;function lc(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(np,this,t),this.length=this._features.length}function np(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var p=null,d=l.readVarint()+l.pos;l.pos<d;){var _=l.readVarint()>>3;p=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return p}(i))}function op(e,t,i){if(e===3){var l=new Qc(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}lc.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new jl(this._pbf,t,this.extent,this._keys,this._values)};var Zl={VectorTile:function(e,t){this.layers=e.readFields(op,{},t)},VectorTileFeature:jl,VectorTileLayer:Qc},$c=Zl.VectorTileFeature.types,ju=Math.pow(2,13);function ks(e,t,i,l,p,d,_,E){e.emplaceBack(t,i,2*Math.floor(l*ju)+_,p*ju*2,d*ju*2,Math.round(E))}var go=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ns,this.indexArray=new En,this.programConfigurations=new Pt(e.layers,e.zoom),this.segments=new W,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function ap(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}go.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=sc("fill-extrusion",this.layers,t);for(var l=0,p=e;l<p.length;l+=1){var d=p[l],_=d.feature,E=d.id,T=d.index,z=d.sourceLayerIndex,C=this.layers[0]._featureFilter.needGeometry,D=Ir(_,C);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),D,i)){var N={id:E,sourceLayerIndex:z,index:T,geometry:C?D.geometry:jr(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(Uu("fill-extrusion",this.layers,N,this.zoom,t)):this.addFeature(N,N.geometry,T,i,{}),t.featureIndex.insert(_,N.geometry,T,z,this.index,!0)}}},go.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.features;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},go.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},go.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},go.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},go.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ip),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},go.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},go.prototype.addFeature=function(e,t,i,l,p){for(var d=0,_=ac(t,500);d<_.length;d+=1){for(var E=_[d],T=0,z=0,C=E;z<C.length;z+=1)T+=C[z].length;for(var D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),N=0,K=E;N<K.length;N+=1){var te=K[N];if(te.length!==0&&!((pr=te).every(function(Qt){return Qt.x<0})||pr.every(function(Qt){return Qt.x>8192})||pr.every(function(Qt){return Qt.y<0})||pr.every(function(Qt){return Qt.y>8192})))for(var ne=0,pe=0;pe<te.length;pe++){var ae=te[pe];if(pe>=1){var ge=te[pe-1];if(!ap(ae,ge)){D.vertexLength+4>W.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var ke=ae.sub(ge)._perp()._unit(),Pe=ge.dist(ae);ne+Pe>32768&&(ne=0),ks(this.layoutVertexArray,ae.x,ae.y,ke.x,ke.y,0,0,ne),ks(this.layoutVertexArray,ae.x,ae.y,ke.x,ke.y,0,1,ne),ks(this.layoutVertexArray,ge.x,ge.y,ke.x,ke.y,0,0,ne+=Pe),ks(this.layoutVertexArray,ge.x,ge.y,ke.x,ke.y,0,1,ne);var Be=D.vertexLength;this.indexArray.emplaceBack(Be,Be+2,Be+1),this.indexArray.emplaceBack(Be+1,Be+2,Be+3),D.vertexLength+=4,D.primitiveLength+=2}}}}if(D.vertexLength+T>W.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),$c[e.type]==="Polygon"){for(var Fe=[],Qe=[],nt=D.vertexLength,Tt=0,ct=E;Tt<ct.length;Tt+=1){var Mt=ct[Tt];if(Mt.length!==0){Mt!==E[0]&&Qe.push(Fe.length/2);for(var pt=0;pt<Mt.length;pt++){var ir=Mt[pt];ks(this.layoutVertexArray,ir.x,ir.y,0,0,1,1,0),Fe.push(ir.x),Fe.push(ir.y)}}}for(var jt=cu(Fe,Qe),_t=0;_t<jt.length;_t+=3)this.indexArray.emplaceBack(nt+jt[_t],nt+jt[_t+2],nt+jt[_t+1]);D.primitiveLength+=jt.length/3,D.vertexLength+=T}}var pr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},at("FillExtrusionBucket",go,{omit:["layers","features"]});var eh={paint:new Hi({"fill-extrusion-opacity":new vt(Z["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new dt(Z["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new vt(Z["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new vt(Z["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new sl(Z["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new dt(Z["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new dt(Z["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new vt(Z["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},xf=function(e){function t(i){e.call(this,i,eh)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new go(i)},t.prototype.queryRadius=function(){return Qi(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,E,T,z){var C=Aa(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),E.angle,T),D=this.paint.get("fill-extrusion-height").evaluate(l,p),N=this.paint.get("fill-extrusion-base").evaluate(l,p),K=function(ne,pe,ae,ge){for(var ke=[],Pe=0,Be=ne;Pe<Be.length;Pe+=1){var Fe=Be[Pe],Qe=[Fe.x,Fe.y,0,1];uu(Qe,Qe,pe),ke.push(new B(Qe[0]/Qe[3],Qe[1]/Qe[3]))}return ke}(C,z),te=function(ne,pe,ae,ge){for(var ke=[],Pe=[],Be=ge[8]*pe,Fe=ge[9]*pe,Qe=ge[10]*pe,nt=ge[11]*pe,Tt=ge[8]*ae,ct=ge[9]*ae,Mt=ge[10]*ae,pt=ge[11]*ae,ir=0,jt=ne;ir<jt.length;ir+=1){for(var _t=[],pr=[],Qt=0,_r=jt[ir];Qt<_r.length;Qt+=1){var Lt=_r[Qt],Ar=Lt.x,xi=Lt.y,Bi=ge[0]*Ar+ge[4]*xi+ge[12],Pi=ge[1]*Ar+ge[5]*xi+ge[13],wi=ge[2]*Ar+ge[6]*xi+ge[14],Oi=ge[3]*Ar+ge[7]*xi+ge[15],yn=wi+Qe,gn=Oi+nt,vo=Bi+Tt,In=Pi+ct,bo=wi+Mt,Zi=Oi+pt,An=new B((Bi+Be)/gn,(Pi+Fe)/gn);An.z=yn/gn,_t.push(An);var yr=new B(vo/Zi,In/Zi);yr.z=bo/Zi,pr.push(yr)}ke.push(_t),Pe.push(pr)}return[ke,Pe]}(d,N,D,z);return function(ne,pe,ae){var ge=1/0;kn(ae,pe)&&(ge=uc(ae,pe[0]));for(var ke=0;ke<pe.length;ke++)for(var Pe=pe[ke],Be=ne[ke],Fe=0;Fe<Pe.length-1;Fe++){var Qe=Pe[Fe],nt=[Qe,Pe[Fe+1],Be[Fe+1],Be[Fe],Qe];mn(ae,nt)&&(ge=Math.min(ge,uc(ae,nt)))}return ge!==1/0&&ge}(te[0],te[1],K)},t}(Qo);function du(e,t){return e.x*t.x+e.y*t.y}function uc(e,t){if(e.length===1){for(var i,l=0,p=t[l++];!i||p.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var d=t[l],_=e[0],E=i.sub(p),T=d.sub(p),z=_.sub(p),C=du(E,E),D=du(E,T),N=du(T,T),K=du(z,E),te=du(z,T),ne=C*N-D*D,pe=(N*K-D*te)/ne,ae=(C*te-D*K)/ne,ge=p.z*(1-pe-ae)+i.z*pe+d.z*ae;if(isFinite(ge))return ge}return 1/0}for(var ke=1/0,Pe=0,Be=t;Pe<Be.length;Pe+=1)ke=Math.min(ke,Be[Pe].z);return ke}var sp=Wr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,lp=Wr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,mu=Zl.VectorTileFeature.types,up=Math.cos(Math.PI/180*37.5),cc=Math.pow(2,14)/.5,ro=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new qn,this.layoutVertexArray2=new $o,this.indexArray=new En,this.programConfigurations=new Pt(e.layers,e.zoom),this.segments=new W,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};ro.prototype.populate=function(e,t,i){this.hasPattern=sc("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),p=[],d=0,_=e;d<_.length;d+=1){var E=_[d],T=E.feature,z=E.id,C=E.index,D=E.sourceLayerIndex,N=this.layers[0]._featureFilter.needGeometry,K=Ir(T,N);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),K,i)){var te=l?l.evaluate(K,{},i):void 0,ne={id:z,properties:T.properties,type:T.type,sourceLayerIndex:D,index:C,geometry:N?K.geometry:jr(T),patterns:{},sortKey:te};p.push(ne)}}l&&p.sort(function(Qe,nt){return Qe.sortKey-nt.sortKey});for(var pe=0,ae=p;pe<ae.length;pe+=1){var ge=ae[pe],ke=ge.geometry,Pe=ge.index,Be=ge.sourceLayerIndex;if(this.hasPattern){var Fe=Uu("line",this.layers,ge,this.zoom,t);this.patternFeatures.push(Fe)}else this.addFeature(ge,ke,Pe,i,{});t.featureIndex.insert(e[Pe].feature,ke,Pe,Be,this.index)}},ro.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},ro.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},ro.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ro.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ro.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,lp)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sp),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ro.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ro.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},ro.prototype.addFeature=function(e,t,i,l,p){var d=this.layers[0].layout,_=d.get("line-join").evaluate(e,{}),E=d.get("line-cap"),T=d.get("line-miter-limit"),z=d.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var C=0,D=t;C<D.length;C+=1)this.addLine(D[C],e,_,E,T,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},ro.prototype.addLine=function(e,t,i,l,p,d){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var _=0;_<e.length-1;_++)this.totalDistance+=e[_].dist(e[_+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var E=mu[t.type]==="Polygon",T=e.length;T>=2&&e[T-1].equals(e[T-2]);)T--;for(var z=0;z<T-1&&e[z].equals(e[z+1]);)z++;if(!(T<(E?3:2))){i==="bevel"&&(p=1.05);var C,D=this.overscaling<=16?122880/(512*this.overscaling):0,N=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray),K=void 0,te=void 0,ne=void 0,pe=void 0;this.e1=this.e2=-1,E&&(pe=e[z].sub(C=e[T-2])._unit()._perp());for(var ae=z;ae<T;ae++)if(!(te=ae===T-1?E?e[z+1]:void 0:e[ae+1])||!e[ae].equals(te)){pe&&(ne=pe),C&&(K=C),C=e[ae],pe=te?te.sub(C)._unit()._perp():ne;var ge=(ne=ne||pe).add(pe);ge.x===0&&ge.y===0||ge._unit();var ke=ne.x*pe.x+ne.y*pe.y,Pe=ge.x*pe.x+ge.y*pe.y,Be=Pe!==0?1/Pe:1/0,Fe=2*Math.sqrt(2-2*Pe),Qe=Pe<up&&K&&te,nt=ne.x*pe.y-ne.y*pe.x>0;if(Qe&&ae>z){var Tt=C.dist(K);if(Tt>2*D){var ct=C.sub(C.sub(K)._mult(D/Tt)._round());this.updateDistance(K,ct),this.addCurrentVertex(ct,ne,0,0,N),K=ct}}var Mt=K&&te,pt=Mt?i:E?"butt":l;if(Mt&&pt==="round"&&(Be<d?pt="miter":Be<=2&&(pt="fakeround")),pt==="miter"&&Be>p&&(pt="bevel"),pt==="bevel"&&(Be>2&&(pt="flipbevel"),Be<p&&(pt="miter")),K&&this.updateDistance(K,C),pt==="miter")ge._mult(Be),this.addCurrentVertex(C,ge,0,0,N);else if(pt==="flipbevel"){if(Be>100)ge=pe.mult(-1);else{var ir=Be*ne.add(pe).mag()/ne.sub(pe).mag();ge._perp()._mult(ir*(nt?-1:1))}this.addCurrentVertex(C,ge,0,0,N),this.addCurrentVertex(C,ge.mult(-1),0,0,N)}else if(pt==="bevel"||pt==="fakeround"){var jt=-Math.sqrt(Be*Be-1),_t=nt?jt:0,pr=nt?0:jt;if(K&&this.addCurrentVertex(C,ne,_t,pr,N),pt==="fakeround")for(var Qt=Math.round(180*Fe/Math.PI/20),_r=1;_r<Qt;_r++){var Lt=_r/Qt;if(Lt!==.5){var Ar=Lt-.5;Lt+=Lt*Ar*(Lt-1)*((1.0904+ke*(ke*(3.55645-1.43519*ke)-3.2452))*Ar*Ar+(.848013+ke*(.215638*ke-1.06021)))}var xi=pe.sub(ne)._mult(Lt)._add(ne)._unit()._mult(nt?-1:1);this.addHalfVertex(C,xi.x,xi.y,!1,nt,0,N)}te&&this.addCurrentVertex(C,pe,-_t,-pr,N)}else if(pt==="butt")this.addCurrentVertex(C,ge,0,0,N);else if(pt==="square"){var Bi=K?1:-1;this.addCurrentVertex(C,ge,Bi,Bi,N)}else pt==="round"&&(K&&(this.addCurrentVertex(C,ne,0,0,N),this.addCurrentVertex(C,ne,1,1,N,!0)),te&&(this.addCurrentVertex(C,pe,-1,-1,N,!0),this.addCurrentVertex(C,pe,0,0,N)));if(Qe&&ae<T-1){var Pi=C.dist(te);if(Pi>2*D){var wi=C.add(te.sub(C)._mult(D/Pi)._round());this.updateDistance(C,wi),this.addCurrentVertex(wi,pe,0,0,N),C=wi}}}}},ro.prototype.addCurrentVertex=function(e,t,i,l,p,d){d===void 0&&(d=!1);var _=t.y*l-t.x,E=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,d,!1,i,p),this.addHalfVertex(e,_,E,d,!0,-l,p),this.distance>cc/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,p,d))},ro.prototype.addHalfVertex=function(e,t,i,l,p,d,_){var E=.5*(this.lineClips?this.scaledDistance*(cc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(p?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(d===0?0:d<0?-1:1)|(63&E)<<2,E>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var T=_.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),_.primitiveLength++),p?this.e2=T:this.e1=T},ro.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},ro.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},at("LineBucket",ro,{omit:["layers","patternFeatures"]});var cp=new Hi({"line-cap":new vt(Z.layout_line["line-cap"]),"line-join":new dt(Z.layout_line["line-join"]),"line-miter-limit":new vt(Z.layout_line["line-miter-limit"]),"line-round-limit":new vt(Z.layout_line["line-round-limit"]),"line-sort-key":new dt(Z.layout_line["line-sort-key"])}),hc={paint:new Hi({"line-opacity":new dt(Z.paint_line["line-opacity"]),"line-color":new dt(Z.paint_line["line-color"]),"line-translate":new vt(Z.paint_line["line-translate"]),"line-translate-anchor":new vt(Z.paint_line["line-translate-anchor"]),"line-width":new dt(Z.paint_line["line-width"]),"line-gap-width":new dt(Z.paint_line["line-gap-width"]),"line-offset":new dt(Z.paint_line["line-offset"]),"line-blur":new dt(Z.paint_line["line-blur"]),"line-dasharray":new Di(Z.paint_line["line-dasharray"]),"line-pattern":new sl(Z.paint_line["line-pattern"]),"line-gradient":new to(Z.paint_line["line-gradient"])}),layout:cp},th=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new rr(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,p,d){return l=Ue({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,p,d)},t}(dt))(hc.paint.properties["line-width"].specification);th.useIntegerZoom=!0;var hp=function(e){function t(i){e.call(this,i,hc),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Hn,this.gradientVersion=(this.gradientVersion+1)%H)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=th.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new ro(i)},t.prototype.queryRadius=function(i){var l=i,p=Gl(ra("line-width",this,l),ra("line-gap-width",this,l)),d=ra("line-offset",this,l);return p/2+Math.abs(d)+Qi(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,E,T){var z=Aa(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),E.angle,T),C=T/2*Gl(this.paint.get("line-width").evaluate(l,p),this.paint.get("line-gap-width").evaluate(l,p)),D=this.paint.get("line-offset").evaluate(l,p);return D&&(d=function(N,K){for(var te=[],ne=new B(0,0),pe=0;pe<N.length;pe++){for(var ae=N[pe],ge=[],ke=0;ke<ae.length;ke++){var Pe=ae[ke],Be=ae[ke+1],Fe=ke===0?ne:Pe.sub(ae[ke-1])._unit()._perp(),Qe=ke===ae.length-1?ne:Be.sub(Pe)._unit()._perp(),nt=Fe._add(Qe)._unit();nt._mult(1/(nt.x*Qe.x+nt.y*Qe.y)),ge.push(nt._mult(K)._add(Pe))}te.push(ge)}return te}(d,D*T)),function(N,K,te){for(var ne=0;ne<K.length;ne++){var pe=K[ne];if(N.length>=3){for(var ae=0;ae<pe.length;ae++)if(Yi(N,pe[ae]))return!0}if(Mo(N,pe,te))return!0}return!1}(z,d,C)},t.prototype.isTileClipped=function(){return!0},t}(Qo);function Gl(e,t){return t>0?t+2*e:e}var pp=Wr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),rh=Wr([{name:"a_projected_pos",components:3,type:"Float32"}],4),wf=(Wr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Wr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ih=(Wr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Wr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),nh=Wr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function fp(e,t,i){return e.sections.forEach(function(l){l.text=function(p,d,_){var E=d.layout.get("text-transform").evaluate(_,{});return E==="uppercase"?p=p.toLocaleUpperCase():E==="lowercase"&&(p=p.toLocaleLowerCase()),$n.applyArabicShaping&&(p=$n.applyArabicShaping(p)),p}(l.text,t,i)}),e}Wr([{name:"triangle",components:3,type:"Uint16"}]),Wr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Wr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Wr([{type:"Float32",name:"offsetX"}]),Wr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var yu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},oh=function(e,t,i,l,p){var d,_,E=8*p-l-1,T=(1<<E)-1,z=T>>1,C=-7,D=i?p-1:0,N=i?-1:1,K=e[t+D];for(D+=N,d=K&(1<<-C)-1,K>>=-C,C+=E;C>0;d=256*d+e[t+D],D+=N,C-=8);for(_=d&(1<<-C)-1,d>>=-C,C+=l;C>0;_=256*_+e[t+D],D+=N,C-=8);if(d===0)d=1-z;else{if(d===T)return _?NaN:1/0*(K?-1:1);_+=Math.pow(2,l),d-=z}return(K?-1:1)*_*Math.pow(2,d-l)},pc=function(e,t,i,l,p,d){var _,E,T,z=8*d-p-1,C=(1<<z)-1,D=C>>1,N=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,K=l?0:d-1,te=l?1:-1,ne=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(E=isNaN(t)?1:0,_=C):(_=Math.floor(Math.log(t)/Math.LN2),t*(T=Math.pow(2,-_))<1&&(_--,T*=2),(t+=_+D>=1?N/T:N*Math.pow(2,1-D))*T>=2&&(_++,T/=2),_+D>=C?(E=0,_=C):_+D>=1?(E=(t*T-1)*Math.pow(2,p),_+=D):(E=t*Math.pow(2,D-1)*Math.pow(2,p),_=0));p>=8;e[i+K]=255&E,K+=te,E/=256,p-=8);for(_=_<<p|E,z+=p;z>0;e[i+K]=255&_,K+=te,_/=256,z-=8);e[i+K-te]|=128*ne},gu=Mr;function Mr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Mr.Varint=0,Mr.Fixed64=1,Mr.Bytes=2,Mr.Fixed32=5;var Kl=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ts(e){return e.type===Mr.Bytes?e.readVarint()+e.pos:e.pos+1}function ml(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function dp(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var p=i.pos-1;p>=e;p--)i.buf[p+l]=i.buf[p]}function mp(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function ah(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function yp(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function gp(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function _u(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function _p(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function sh(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function Sf(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function vp(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function vu(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Xl(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function lh(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function bu(e,t,i){e===1&&i.readMessage(bp,t)}function bp(e,t,i){if(e===3){var l=i.readMessage(uh,{}),p=l.width,d=l.height,_=l.left,E=l.top,T=l.advance;t.push({id:l.id,bitmap:new fl({width:p+6,height:d+6},l.bitmap),metrics:{width:p,height:d,left:_,top:E,advance:T}})}}function uh(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function xp(e){for(var t=0,i=0,l=0,p=e;l<p.length;l+=1){var d=p[l];t+=d.w*d.h,i=Math.max(i,d.w)}e.sort(function(ne,pe){return pe.h-ne.h});for(var _=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],E=0,T=0,z=0,C=e;z<C.length;z+=1)for(var D=C[z],N=_.length-1;N>=0;N--){var K=_[N];if(!(D.w>K.w||D.h>K.h)){if(D.x=K.x,D.y=K.y,T=Math.max(T,D.y+D.h),E=Math.max(E,D.x+D.w),D.w===K.w&&D.h===K.h){var te=_.pop();N<_.length&&(_[N]=te)}else D.h===K.h?(K.x+=D.w,K.w-=D.w):D.w===K.w?(K.y+=D.h,K.h-=D.h):(_.push({x:K.x+D.w,y:K.y,w:K.w-D.w,h:D.h}),K.y+=D.h,K.h-=D.h);break}}return{w:E,h:T,fill:t/(E*T)||0}}Mr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),p=l>>3,d=this.pos;this.type=7&l,e(p,t,this),this.pos===d&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=vu(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=lh(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=vu(this.buf,this.pos)+4294967296*vu(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=vu(this.buf,this.pos)+4294967296*lh(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=oh(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=oh(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(p,d,_){var E,T,z=_.buf;if(E=(112&(T=z[_.pos++]))>>4,T<128||(E|=(127&(T=z[_.pos++]))<<3,T<128)||(E|=(127&(T=z[_.pos++]))<<10,T<128)||(E|=(127&(T=z[_.pos++]))<<17,T<128)||(E|=(127&(T=z[_.pos++]))<<24,T<128)||(E|=(1&(T=z[_.pos++]))<<31,T<128))return ml(p,E,d);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Kl?function(i,l,p){return Kl.decode(i.subarray(l,p))}(this.buf,t,e):function(i,l,p){for(var d="",_=l;_<p;){var E,T,z,C=i[_],D=null,N=C>239?4:C>223?3:C>191?2:1;if(_+N>p)break;N===1?C<128&&(D=C):N===2?(192&(E=i[_+1]))==128&&(D=(31&C)<<6|63&E)<=127&&(D=null):N===3?(T=i[_+2],(192&(E=i[_+1]))==128&&(192&T)==128&&((D=(15&C)<<12|(63&E)<<6|63&T)<=2047||D>=55296&&D<=57343)&&(D=null)):N===4&&(T=i[_+2],z=i[_+3],(192&(E=i[_+1]))==128&&(192&T)==128&&(192&z)==128&&((D=(15&C)<<18|(63&E)<<12|(63&T)<<6|63&z)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,N=1):D>65535&&(D-=65536,d+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),d+=String.fromCharCode(D),_+=N}return d}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Mr.Bytes)return e.push(this.readVarint(t));var i=Ts(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Mr.Bytes)return e.push(this.readSVarint());var t=Ts(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Mr.Bytes)return e.push(this.readBoolean());var t=Ts(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Mr.Bytes)return e.push(this.readFloat());var t=Ts(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Mr.Bytes)return e.push(this.readDouble());var t=Ts(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Mr.Bytes)return e.push(this.readFixed32());var t=Ts(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Mr.Bytes)return e.push(this.readSFixed32());var t=Ts(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Mr.Bytes)return e.push(this.readFixed64());var t=Ts(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Mr.Bytes)return e.push(this.readSFixed64());var t=Ts(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Mr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Mr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Mr.Fixed32)this.pos+=4;else{if(t!==Mr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Xl(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Xl(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Xl(this.buf,-1&e,this.pos),Xl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Xl(this.buf,-1&e,this.pos),Xl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,p;if(t>=0?(l=t%4294967296|0,p=t/4294967296|0):(p=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,p=p+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(d,_,E){E.buf[E.pos++]=127&d|128,d>>>=7,E.buf[E.pos++]=127&d|128,d>>>=7,E.buf[E.pos++]=127&d|128,d>>>=7,E.buf[E.pos++]=127&d|128,E.buf[E.pos]=127&(d>>>=7)}(l,0,i),function(d,_){var E=(7&d)<<4;_.buf[_.pos++]|=E|((d>>>=3)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d)))))}(p,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,p,d){for(var _,E,T=0;T<p.length;T++){if((_=p.charCodeAt(T))>55295&&_<57344){if(!E){_>56319||T+1===p.length?(l[d++]=239,l[d++]=191,l[d++]=189):E=_;continue}if(_<56320){l[d++]=239,l[d++]=191,l[d++]=189,E=_;continue}_=E-55296<<10|_-56320|65536,E=null}else E&&(l[d++]=239,l[d++]=191,l[d++]=189,E=null);_<128?l[d++]=_:(_<2048?l[d++]=_>>6|192:(_<65536?l[d++]=_>>12|224:(l[d++]=_>>18|240,l[d++]=_>>12&63|128),l[d++]=_>>6&63|128),l[d++]=63&_|128)}return d}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&dp(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),pc(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),pc(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&dp(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,Mr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,mp,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,ah,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,_u,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,yp,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,gp,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,_p,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,sh,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Sf,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,vp,t)},writeBytesField:function(e,t){this.writeTag(e,Mr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Mr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Mr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Mr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Mr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Mr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Mr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Mr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Mr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Mr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var qu=function(e,t){var i=t.pixelRatio,l=t.version,p=t.stretchX,d=t.stretchY,_=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=p,this.stretchY=d,this.content=_,this.version=l},Wl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Wl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Wl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Wl.tlbr.get=function(){return this.tl.concat(this.br)},Wl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(qu.prototype,Wl);var xu=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var p=[];this.addImages(e,i,p),this.addImages(t,l,p);var d=xp(p),_=new Gn({width:d.w||1,height:d.h||1});for(var E in e){var T=e[E],z=i[E].paddedRect;Gn.copy(T.data,_,{x:0,y:0},{x:z.x+1,y:z.y+1},T.data)}for(var C in t){var D=t[C],N=l[C].paddedRect,K=N.x+1,te=N.y+1,ne=D.data.width,pe=D.data.height;Gn.copy(D.data,_,{x:0,y:0},{x:K,y:te},D.data),Gn.copy(D.data,_,{x:0,y:pe-1},{x:K,y:te-1},{width:ne,height:1}),Gn.copy(D.data,_,{x:0,y:0},{x:K,y:te+pe},{width:ne,height:1}),Gn.copy(D.data,_,{x:ne-1,y:0},{x:K-1,y:te},{width:1,height:pe}),Gn.copy(D.data,_,{x:0,y:0},{x:K+ne,y:te},{width:1,height:pe})}this.image=_,this.iconPositions=i,this.patternPositions=l};xu.prototype.addImages=function(e,t,i){for(var l in e){var p=e[l],d={x:0,y:0,w:p.data.width+2,h:p.data.height+2};i.push(d),t[l]=new qu(d,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},xu.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},xu.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},at("ImagePosition",qu),at("ImageAtlas",xu);var Do={horizontal:1,vertical:2,horizontalOnly:3},fc=function(){this.scale=1,this.fontStack="",this.imageName=null};fc.forText=function(e,t){var i=new fc;return i.scale=e||1,i.fontStack=t,i},fc.forImage=function(e){var t=new fc;return t.imageName=e,t};var _o=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function wp(e,t,i,l,p,d,_,E,T,z,C,D,N,K,te,ne){var pe,ae=_o.fromFeature(e,p);D===Do.vertical&&ae.verticalizePunctuation();var ge=$n.processBidirectionalText,ke=$n.processStyledBidirectionalText;if(ge&&ae.sections.length===1){pe=[];for(var Pe=0,Be=ge(ae.toString(),Ef(ae,z,d,t,l,K,te));Pe<Be.length;Pe+=1){var Fe=Be[Pe],Qe=new _o;Qe.text=Fe,Qe.sections=ae.sections;for(var nt=0;nt<Fe.length;nt++)Qe.sectionIndex.push(0);pe.push(Qe)}}else if(ke){pe=[];for(var Tt=0,ct=ke(ae.text,ae.sectionIndex,Ef(ae,z,d,t,l,K,te));Tt<ct.length;Tt+=1){var Mt=ct[Tt],pt=new _o;pt.text=Mt[0],pt.sectionIndex=Mt[1],pt.sections=ae.sections,pe.push(pt)}}else pe=function(_t,pr){for(var Qt=[],_r=_t.text,Lt=0,Ar=0,xi=pr;Ar<xi.length;Ar+=1){var Bi=xi[Ar];Qt.push(_t.substring(Lt,Bi)),Lt=Bi}return Lt<_r.length&&Qt.push(_t.substring(Lt,_r.length)),Qt}(ae,Ef(ae,z,d,t,l,K,te));var ir=[],jt={positionedLines:ir,text:ae.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(_t,pr,Qt,_r,Lt,Ar,xi,Bi,Pi,wi,Oi,yn){for(var gn=0,vo=-17,In=0,bo=0,Zi=Bi==="right"?1:Bi==="left"?0:.5,An=0,yr=0,ri=Lt;yr<ri.length;yr+=1){var qr=ri[yr];qr.trim();var br=qr.getMaxScale(),Lo=24*(br-1),io={positionedGlyphs:[],lineOffset:0};_t.positionedLines[An]=io;var hi=io.positionedGlyphs,$i=0;if(qr.length()){for(var no=0;no<qr.length();no++){var zr=qr.getSection(no),yl=qr.getSectionIndex(no),Ca=qr.getCharCode(no),gl=0,Gi=null,_l=null,Is=null,xc=24,Xu=!(Pi===Do.horizontal||!Oi&&!wa(Ca)||Oi&&(Sp[Ca]||(Ql=Ca,rt.Arabic(Ql)||rt["Arabic Supplement"](Ql)||rt["Arabic Extended-A"](Ql)||rt["Arabic Presentation Forms-A"](Ql)||rt["Arabic Presentation Forms-B"](Ql))));if(zr.imageName){var wc=_r[zr.imageName];if(!wc)continue;Is=zr.imageName,_t.iconsInText=_t.iconsInText||!0,_l=wc.paddedRect;var Yl=wc.displaySize;zr.scale=24*zr.scale/yn,gl=Lo+(24-Yl[1]*zr.scale),xc=(Gi={width:Yl[0],height:Yl[1],left:1,top:-3,advance:Xu?Yl[1]:Yl[0]}).advance;var Sc=Xu?Yl[0]*zr.scale-24*br:Yl[1]*zr.scale-24*br;Sc>0&&Sc>$i&&($i=Sc)}else{var Mp=Qt[zr.fontStack],Ec=Mp&&Mp[Ca];if(Ec&&Ec.rect)_l=Ec.rect,Gi=Ec.metrics;else{var ph=pr[zr.fontStack],Dp=ph&&ph[Ca];if(!Dp)continue;Gi=Dp.metrics}gl=24*(br-zr.scale)}Xu?(_t.verticalizable=!0,hi.push({glyph:Ca,imageName:Is,x:gn,y:vo+gl,vertical:Xu,scale:zr.scale,fontStack:zr.fontStack,sectionIndex:yl,metrics:Gi,rect:_l}),gn+=xc*zr.scale+wi):(hi.push({glyph:Ca,imageName:Is,x:gn,y:vo+gl,vertical:Xu,scale:zr.scale,fontStack:zr.fontStack,sectionIndex:yl,metrics:Gi,rect:_l}),gn+=Gi.advance*zr.scale+wi)}hi.length!==0&&(In=Math.max(gn-wi,In),dg(hi,0,hi.length-1,Zi,$i)),gn=0;var Lp=Ar*br+$i;io.lineOffset=Math.max($i,Lo),vo+=Lp,bo=Math.max(Lp,bo),++An}else vo+=Ar,++An}var Ql,fh=vo- -17,kc=kf(xi),Su=kc.horizontalAlign,Tc=kc.verticalAlign;(function(Rp,Bp,dh,mh,Op,yh,gh,_h,Fp){var Ic,Np=(Bp-dh)*Op;Ic=yh!==gh?-_h*mh- -17:(-mh*Fp+.5)*gh;for(var Ac=0,vh=Rp;Ac<vh.length;Ac+=1)for(var Wu=0,bh=vh[Ac].positionedGlyphs;Wu<bh.length;Wu+=1){var zc=bh[Wu];zc.x+=Np,zc.y+=Ic}})(_t.positionedLines,Zi,Su,Tc,In,bo,Ar,fh,Lt.length),_t.top+=-Tc*fh,_t.bottom=_t.top+fh,_t.left+=-Su*In,_t.right=_t.left+In}(jt,t,i,l,pe,_,E,T,D,z,N,ne),!function(_t){for(var pr=0,Qt=_t;pr<Qt.length;pr+=1)if(Qt[pr].positionedGlyphs.length!==0)return!1;return!0}(ir)&&jt}_o.fromFeature=function(e,t){for(var i=new _o,l=0;l<e.sections.length;l++){var p=e.sections[l];p.image?i.addImageSection(p):i.addTextSection(p,t)}return i},_o.prototype.length=function(){return this.text.length},_o.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},_o.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},_o.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},_o.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,p=e.charCodeAt(i-1)||null;t+=l&&Fs(l)&&!yu[e[i+1]]||p&&Fs(p)&&!yu[e[i-1]]||!yu[e[i]]?e[i]:yu[e[i]]}return t}(this.text)},_o.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Sp[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&Sp[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},_o.prototype.substring=function(e,t){var i=new _o;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},_o.prototype.toString=function(){return this.text},_o.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},_o.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(fc.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},_o.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(fc.forImage(t)),this.sectionIndex.push(this.sections.length-1)):yt("Reached maximum number of images 6401")}else yt("Can't add FormattedSection with an empty image.")},_o.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Sp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ga={};function yd(e,t,i,l,p,d){if(t.imageName){var _=l[t.imageName];return _?_.displaySize[0]*t.scale*24/d+p:0}var E=i[t.fontStack],T=E&&E[e];return T?T.metrics.advance*t.scale+p:0}function gd(e,t,i,l){var p=Math.pow(e-t,2);return l?e<t?p/2:2*p:p+Math.abs(i)*i}function fg(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function _d(e,t,i,l,p,d){for(var _=null,E=gd(t,i,p,d),T=0,z=l;T<z.length;T+=1){var C=z[T],D=gd(t-C.x,i,p,d)+C.badness;D<=E&&(_=C,E=D)}return{index:e,x:t,priorBreak:_,badness:E}}function Ef(e,t,i,l,p,d,_){if(d!=="point")return[];if(!e)return[];for(var E,T=[],z=function(pe,ae,ge,ke,Pe,Be){for(var Fe=0,Qe=0;Qe<pe.length();Qe++){var nt=pe.getSection(Qe);Fe+=yd(pe.getCharCode(Qe),nt,ke,Pe,ae,Be)}return Fe/Math.max(1,Math.ceil(Fe/ge))}(e,t,i,l,p,_),C=e.text.indexOf("\u200B")>=0,D=0,N=0;N<e.length();N++){var K=e.getSection(N),te=e.getCharCode(N);if(Sp[te]||(D+=yd(te,K,l,p,t,_)),N<e.length()-1){var ne=!((E=te)<11904||!(rt["Bopomofo Extended"](E)||rt.Bopomofo(E)||rt["CJK Compatibility Forms"](E)||rt["CJK Compatibility Ideographs"](E)||rt["CJK Compatibility"](E)||rt["CJK Radicals Supplement"](E)||rt["CJK Strokes"](E)||rt["CJK Symbols and Punctuation"](E)||rt["CJK Unified Ideographs Extension A"](E)||rt["CJK Unified Ideographs"](E)||rt["Enclosed CJK Letters and Months"](E)||rt["Halfwidth and Fullwidth Forms"](E)||rt.Hiragana(E)||rt["Ideographic Description Characters"](E)||rt["Kangxi Radicals"](E)||rt["Katakana Phonetic Extensions"](E)||rt.Katakana(E)||rt["Vertical Forms"](E)||rt["Yi Radicals"](E)||rt["Yi Syllables"](E)));(ga[te]||ne||K.imageName)&&T.push(_d(N+1,D,z,T,fg(te,e.getCharCode(N+1),ne&&C),!1))}}return function pe(ae){return ae?pe(ae.priorBreak).concat(ae.index):[]}(_d(e.length(),D,z,T,0,!0))}function kf(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function dg(e,t,i,l,p){if(l||p)for(var d=e[i],_=(e[i].x+d.metrics.advance*d.scale)*l,E=t;E<=i;E++)e[E].x-=_,e[E].y+=p}function vd(e,t,i,l,p,d){var _,E=e.image;if(E.content){var T=E.content,z=E.pixelRatio||1;_=[T[0]/z,T[1]/z,E.displaySize[0]-T[2]/z,E.displaySize[1]-T[3]/z]}var C,D,N,K,te=t.left*d,ne=t.right*d;i==="width"||i==="both"?(K=p[0]+te-l[3],D=p[0]+ne+l[1]):D=(K=p[0]+(te+ne-E.displaySize[0])/2)+E.displaySize[0];var pe=t.top*d,ae=t.bottom*d;return i==="height"||i==="both"?(C=p[1]+pe-l[0],N=p[1]+ae+l[2]):N=(C=p[1]+(pe+ae-E.displaySize[1])/2)+E.displaySize[1],{image:E,top:C,right:D,bottom:N,left:K,collisionPadding:_}}ga[10]=!0,ga[32]=!0,ga[38]=!0,ga[40]=!0,ga[41]=!0,ga[43]=!0,ga[45]=!0,ga[47]=!0,ga[173]=!0,ga[183]=!0,ga[8203]=!0,ga[8208]=!0,ga[8211]=!0,ga[8231]=!0;var dc=function(e){function t(i,l,p,d){e.call(this,i,l),this.angle=p,d!==void 0&&(this.segment=d)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(B);function Tf(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new rr(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,p=i.interpolationType,d=0;d<l.length&&l[d]<=e;)d++;for(var _=d=Math.max(0,d-1);_<l.length&&l[_]<e+1;)_++;_=Math.min(l.length-1,_);var E=l[d],T=l[_];return i.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:T,interpolationType:p}:{kind:"camera",minZoom:E,maxZoom:T,minSize:i.evaluate(new rr(E)),maxSize:i.evaluate(new rr(T)),interpolationType:p}}function bd(e,t,i){var l=t.uSize,p=i.lowerSize;return e.kind==="source"?p/128:e.kind==="composite"?gi(p/128,i.upperSize/128,t.uSizeT):l}function xd(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var p=e.interpolationType,d=p?xe(pn.interpolationFactor(p,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=gi(e.minSize,e.maxSize,d):i=d}return{uSizeT:i,uSize:l}}at("Anchor",dc);var mg=Object.freeze({__proto__:null,getSizeData:Tf,evaluateSizeForFeature:bd,evaluateSizeForZoom:xd,SIZE_PACK_FACTOR:128});function wd(e,t,i,l,p){if(t.segment===void 0)return!0;for(var d=t,_=t.segment+1,E=0;E>-i/2;){if(--_<0)return!1;E-=e[_].dist(d),d=e[_]}E+=e[_].dist(e[_+1]),_++;for(var T=[],z=0;E<i/2;){var C=e[_],D=e[_+1];if(!D)return!1;var N=e[_-1].angleTo(C)-C.angleTo(D);for(N=Math.abs((N+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:E,angleDelta:N}),z+=N;E-T[0].distance>l;)z-=T.shift().angleDelta;if(z>p)return!1;_++,E+=C.dist(D)}return!0}function Sd(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Ed(e,t,i){return e?.6*t*i:0}function kd(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function yg(e,t,i,l,p,d){for(var _=Ed(i,p,d),E=kd(i,l)*d,T=0,z=Sd(e)/2,C=0;C<e.length-1;C++){var D=e[C],N=e[C+1],K=D.dist(N);if(T+K>z){var te=(z-T)/K,ne=gi(D.x,N.x,te),pe=gi(D.y,N.y,te),ae=new dc(ne,pe,N.angleTo(D),C);return ae._round(),!_||wd(e,ae,E,_,t)?ae:void 0}T+=K}}function gg(e,t,i,l,p,d,_,E,T){var z=Ed(l,d,_),C=kd(l,p),D=C*_,N=e[0].x===0||e[0].x===T||e[0].y===0||e[0].y===T;return t-D<t/4&&(t=D+t/4),function K(te,ne,pe,ae,ge,ke,Pe,Be,Fe){for(var Qe=ke/2,nt=Sd(te),Tt=0,ct=ne-pe,Mt=[],pt=0;pt<te.length-1;pt++){for(var ir=te[pt],jt=te[pt+1],_t=ir.dist(jt),pr=jt.angleTo(ir);ct+pe<Tt+_t;){var Qt=((ct+=pe)-Tt)/_t,_r=gi(ir.x,jt.x,Qt),Lt=gi(ir.y,jt.y,Qt);if(_r>=0&&_r<Fe&&Lt>=0&&Lt<Fe&&ct-Qe>=0&&ct+Qe<=nt){var Ar=new dc(_r,Lt,pr,pt);Ar._round(),ae&&!wd(te,Ar,ke,ae,ge)||Mt.push(Ar)}}Tt+=_t}return Be||Mt.length||Pe||(Mt=K(te,Tt/2,pe,ae,ge,ke,Pe,!0,Fe)),Mt}(e,N?t/2*E%t:(C/2+2*d)*_*E%t,t,z,i,D,N,!1,T)}function Td(e,t,i,l,p){for(var d=[],_=0;_<e.length;_++)for(var E=e[_],T=void 0,z=0;z<E.length-1;z++){var C=E[z],D=E[z+1];C.x<t&&D.x<t||(C.x<t?C=new B(t,C.y+(t-C.x)/(D.x-C.x)*(D.y-C.y))._round():D.x<t&&(D=new B(t,C.y+(t-C.x)/(D.x-C.x)*(D.y-C.y))._round()),C.y<i&&D.y<i||(C.y<i?C=new B(C.x+(i-C.y)/(D.y-C.y)*(D.x-C.x),i)._round():D.y<i&&(D=new B(C.x+(i-C.y)/(D.y-C.y)*(D.x-C.x),i)._round()),C.x>=l&&D.x>=l||(C.x>=l?C=new B(l,C.y+(l-C.x)/(D.x-C.x)*(D.y-C.y))._round():D.x>=l&&(D=new B(l,C.y+(l-C.x)/(D.x-C.x)*(D.y-C.y))._round()),C.y>=p&&D.y>=p||(C.y>=p?C=new B(C.x+(p-C.y)/(D.y-C.y)*(D.x-C.x),p)._round():D.y>=p&&(D=new B(C.x+(p-C.y)/(D.y-C.y)*(D.x-C.x),p)._round()),T&&C.equals(T[T.length-1])||d.push(T=[C]),T.push(D)))))}return d}function Id(e,t,i,l){var p=[],d=e.image,_=d.pixelRatio,E=d.paddedRect.w-2,T=d.paddedRect.h-2,z=e.right-e.left,C=e.bottom-e.top,D=d.stretchX||[[0,E]],N=d.stretchY||[[0,T]],K=function(_r,Lt){return _r+Lt[1]-Lt[0]},te=D.reduce(K,0),ne=N.reduce(K,0),pe=E-te,ae=T-ne,ge=0,ke=te,Pe=0,Be=ne,Fe=0,Qe=pe,nt=0,Tt=ae;if(d.content&&l){var ct=d.content;ge=Ep(D,0,ct[0]),Pe=Ep(N,0,ct[1]),ke=Ep(D,ct[0],ct[2]),Be=Ep(N,ct[1],ct[3]),Fe=ct[0]-ge,nt=ct[1]-Pe,Qe=ct[2]-ct[0]-ke,Tt=ct[3]-ct[1]-Be}var Mt=function(_r,Lt,Ar,xi){var Bi=kp(_r.stretch-ge,ke,z,e.left),Pi=Tp(_r.fixed-Fe,Qe,_r.stretch,te),wi=kp(Lt.stretch-Pe,Be,C,e.top),Oi=Tp(Lt.fixed-nt,Tt,Lt.stretch,ne),yn=kp(Ar.stretch-ge,ke,z,e.left),gn=Tp(Ar.fixed-Fe,Qe,Ar.stretch,te),vo=kp(xi.stretch-Pe,Be,C,e.top),In=Tp(xi.fixed-nt,Tt,xi.stretch,ne),bo=new B(Bi,wi),Zi=new B(yn,wi),An=new B(yn,vo),yr=new B(Bi,vo),ri=new B(Pi/_,Oi/_),qr=new B(gn/_,In/_),br=t*Math.PI/180;if(br){var Lo=Math.sin(br),io=Math.cos(br),hi=[io,-Lo,Lo,io];bo._matMult(hi),Zi._matMult(hi),yr._matMult(hi),An._matMult(hi)}var $i=_r.stretch+_r.fixed,no=Lt.stretch+Lt.fixed;return{tl:bo,tr:Zi,bl:yr,br:An,tex:{x:d.paddedRect.x+1+$i,y:d.paddedRect.y+1+no,w:Ar.stretch+Ar.fixed-$i,h:xi.stretch+xi.fixed-no},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ri,pixelOffsetBR:qr,minFontScaleX:Qe/_/z,minFontScaleY:Tt/_/C,isSDF:i}};if(l&&(d.stretchX||d.stretchY))for(var pt=Ad(D,pe,te),ir=Ad(N,ae,ne),jt=0;jt<pt.length-1;jt++)for(var _t=pt[jt],pr=pt[jt+1],Qt=0;Qt<ir.length-1;Qt++)p.push(Mt(_t,ir[Qt],pr,ir[Qt+1]));else p.push(Mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:T+1}));return p}function Ep(e,t,i){for(var l=0,p=0,d=e;p<d.length;p+=1){var _=d[p];l+=Math.max(t,Math.min(i,_[1]))-Math.max(t,Math.min(i,_[0]))}return l}function Ad(e,t,i){for(var l=[{fixed:-1,stretch:0}],p=0,d=e;p<d.length;p+=1){var _=d[p],E=_[0],T=_[1],z=l[l.length-1];l.push({fixed:E-z.stretch,stretch:z.stretch}),l.push({fixed:E-z.stretch,stretch:z.stretch+(T-E)})}return l.push({fixed:t+1,stretch:i}),l}function kp(e,t,i,l){return e/t*i+l}function Tp(e,t,i,l){return e-t*i/l}var Ip=function(e,t,i,l,p,d,_,E,T,z){if(this.boxStartIndex=e.length,T){var C=d.top,D=d.bottom,N=d.collisionPadding;N&&(C-=N[1],D+=N[3]);var K=D-C;K>0&&(K=Math.max(10,K),this.circleDiameter=K)}else{var te=d.top*_-E,ne=d.bottom*_+E,pe=d.left*_-E,ae=d.right*_+E,ge=d.collisionPadding;if(ge&&(pe-=ge[0]*_,te-=ge[1]*_,ae+=ge[2]*_,ne+=ge[3]*_),z){var ke=new B(pe,te),Pe=new B(ae,te),Be=new B(pe,ne),Fe=new B(ae,ne),Qe=z*Math.PI/180;ke._rotate(Qe),Pe._rotate(Qe),Be._rotate(Qe),Fe._rotate(Qe),pe=Math.min(ke.x,Pe.x,Be.x,Fe.x),ae=Math.max(ke.x,Pe.x,Be.x,Fe.x),te=Math.min(ke.y,Pe.y,Be.y,Fe.y),ne=Math.max(ke.y,Pe.y,Be.y,Fe.y)}e.emplaceBack(t.x,t.y,pe,te,ae,ne,i,l,p)}this.boxEndIndex=e.length},mc=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=_g),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function _g(e,t){return e<t?-1:e>t?1:0}function vg(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,p=1/0,d=-1/0,_=-1/0,E=e[0],T=0;T<E.length;T++){var z=E[T];(!T||z.x<l)&&(l=z.x),(!T||z.y<p)&&(p=z.y),(!T||z.x>d)&&(d=z.x),(!T||z.y>_)&&(_=z.y)}var C=Math.min(d-l,_-p),D=C/2,N=new mc([],bg);if(C===0)return new B(l,p);for(var K=l;K<d;K+=C)for(var te=p;te<_;te+=C)N.push(new yc(K+D,te+D,D,e));for(var ne=function(ge){for(var ke=0,Pe=0,Be=0,Fe=ge[0],Qe=0,nt=Fe.length,Tt=nt-1;Qe<nt;Tt=Qe++){var ct=Fe[Qe],Mt=Fe[Tt],pt=ct.x*Mt.y-Mt.x*ct.y;Pe+=(ct.x+Mt.x)*pt,Be+=(ct.y+Mt.y)*pt,ke+=3*pt}return new yc(Pe/ke,Be/ke,0,ge)}(e),pe=N.length;N.length;){var ae=N.pop();(ae.d>ne.d||!ne.d)&&(ne=ae,i&&console.log("found best %d after %d probes",Math.round(1e4*ae.d)/1e4,pe)),ae.max-ne.d<=t||(N.push(new yc(ae.p.x-(D=ae.h/2),ae.p.y-D,D,e)),N.push(new yc(ae.p.x+D,ae.p.y-D,D,e)),N.push(new yc(ae.p.x-D,ae.p.y+D,D,e)),N.push(new yc(ae.p.x+D,ae.p.y+D,D,e)),pe+=4)}return i&&(console.log("num probes: "+pe),console.log("best distance: "+ne.d)),ne.p}function bg(e,t){return t.max-e.max}function yc(e,t,i,l){this.p=new B(e,t),this.h=i,this.d=function(p,d){for(var _=!1,E=1/0,T=0;T<d.length;T++)for(var z=d[T],C=0,D=z.length,N=D-1;C<D;N=C++){var K=z[C],te=z[N];K.y>p.y!=te.y>p.y&&p.x<(te.x-K.x)*(p.y-K.y)/(te.y-K.y)+K.x&&(_=!_),E=Math.min(E,ya(p,K,te))}return(_?1:-1)*Math.sqrt(E)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}mc.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},mc.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},mc.prototype.peek=function(){return this.data[0]},mc.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var p=e-1>>1,d=t[p];if(i(l,d)>=0)break;t[e]=d,e=p}t[e]=l},mc.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,p=t[e];e<l;){var d=1+(e<<1),_=t[d],E=d+1;if(E<this.length&&i(t[E],_)<0&&(d=E,_=t[E]),i(_,p)>=0)break;t[e]=_,e=d}t[e]=p};var If=Number.POSITIVE_INFINITY;function zd(e,t){return t[1]!==If?function(i,l,p){var d=0,_=0;switch(l=Math.abs(l),p=Math.abs(p),i){case"top-right":case"top-left":case"top":_=p-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-p}switch(i){case"top-right":case"bottom-right":case"right":d=-l;break;case"top-left":case"bottom-left":case"left":d=l}return[d,_]}(e,t[0],t[1]):function(i,l){var p=0,d=0;l<0&&(l=0);var _=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":d=_-7;break;case"bottom-right":case"bottom-left":d=7-_;break;case"bottom":d=7-l;break;case"top":d=l-7}switch(i){case"top-right":case"bottom-right":p=-_;break;case"top-left":case"bottom-left":p=_;break;case"left":p=l;break;case"right":p=-l}return[p,d]}(e,t[0])}function Af(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Pd(e,t,i,l,p,d,_,E,T,z,C,D,N,K,te){var ne=function(Pe,Be,Fe,Qe,nt,Tt,ct,Mt){for(var pt=Qe.layout.get("text-rotate").evaluate(Tt,{})*Math.PI/180,ir=[],jt=0,_t=Be.positionedLines;jt<_t.length;jt+=1)for(var pr=_t[jt],Qt=0,_r=pr.positionedGlyphs;Qt<_r.length;Qt+=1){var Lt=_r[Qt];if(Lt.rect){var Ar=Lt.rect||{},xi=4,Bi=!0,Pi=1,wi=0,Oi=(nt||Mt)&&Lt.vertical,yn=Lt.metrics.advance*Lt.scale/2;if(Mt&&Be.verticalizable&&(wi=pr.lineOffset/2-(Lt.imageName?-(24-Lt.metrics.width*Lt.scale)/2:24*(Lt.scale-1))),Lt.imageName){var gn=ct[Lt.imageName];Bi=gn.sdf,xi=1/(Pi=gn.pixelRatio)}var vo=nt?[Lt.x+yn,Lt.y]:[0,0],In=nt?[0,0]:[Lt.x+yn+Fe[0],Lt.y+Fe[1]-wi],bo=[0,0];Oi&&(bo=In,In=[0,0]);var Zi=(Lt.metrics.left-xi)*Lt.scale-yn+In[0],An=(-Lt.metrics.top-xi)*Lt.scale+In[1],yr=Zi+Ar.w*Lt.scale/Pi,ri=An+Ar.h*Lt.scale/Pi,qr=new B(Zi,An),br=new B(yr,An),Lo=new B(Zi,ri),io=new B(yr,ri);if(Oi){var hi=new B(-yn,yn- -17),$i=-Math.PI/2,no=12-yn,zr=new B(22-no,-(Lt.imageName?no:0)),yl=new(Function.prototype.bind.apply(B,[null].concat(bo)));qr._rotateAround($i,hi)._add(zr)._add(yl),br._rotateAround($i,hi)._add(zr)._add(yl),Lo._rotateAround($i,hi)._add(zr)._add(yl),io._rotateAround($i,hi)._add(zr)._add(yl)}if(pt){var Ca=Math.sin(pt),gl=Math.cos(pt),Gi=[gl,-Ca,Ca,gl];qr._matMult(Gi),br._matMult(Gi),Lo._matMult(Gi),io._matMult(Gi)}var _l=new B(0,0),Is=new B(0,0);ir.push({tl:qr,tr:br,bl:Lo,br:io,tex:Ar,writingMode:Be.writingMode,glyphOffset:vo,sectionIndex:Lt.sectionIndex,isSDF:Bi,pixelOffsetTL:_l,pixelOffsetBR:Is,minFontScaleX:0,minFontScaleY:0})}}return ir}(0,i,E,p,d,_,l,e.allowVerticalPlacement),pe=e.textSizeData,ae=null;pe.kind==="source"?(ae=[128*p.layout.get("text-size").evaluate(_,{})])[0]>32640&&yt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):pe.kind==="composite"&&((ae=[128*K.compositeTextSizes[0].evaluate(_,{},te),128*K.compositeTextSizes[1].evaluate(_,{},te)])[0]>32640||ae[1]>32640)&&yt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,ne,ae,E,d,_,z,t,T.lineStartIndex,T.lineLength,N,te);for(var ge=0,ke=C;ge<ke.length;ge+=1)D[ke[ge]]=e.text.placedSymbolArray.length-1;return 4*ne.length}function Cd(e){for(var t in e)return e[t];return null}function xg(e,t,i,l){var p=e.compareText;if(t in p){for(var d=p[t],_=d.length-1;_>=0;_--)if(l.dist(d[_])<i)return!0}else p[t]=[];return p[t].push(l),!1}var wg=Zl.VectorTileFeature.types,Sg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ap(e,t,i,l,p,d,_,E,T,z,C,D,N){var K=E?Math.min(32640,Math.round(E[0])):0,te=E?Math.min(32640,Math.round(E[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*p),d,_,(K<<1)+(T?1:0),te,16*z,16*C,256*D,256*N)}function zf(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function Eg(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(ma(i[t].text))return!0;return!1}var gc=function(e){this.layoutVertexArray=new ul,this.indexArray=new En,this.programConfigurations=e,this.segments=new W,this.dynamicLayoutVertexArray=new ea,this.opacityVertexArray=new os,this.placedSymbolArray=new u};gc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},gc.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,pp.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,rh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Sg,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},gc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},at("SymbolBuffers",gc);var ch=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new W,this.collisionVertexArray=new Rl};ch.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,wf.members,!0)},ch.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},at("CollisionBuffers",ch);var Hr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=yo([]),this.placementViewportMatrix=yo([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Tf(this.zoom,t["text-size"]),this.iconSizeData=Tf(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),p=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(d){return Do[d]})),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id}),this.sourceID=e.sourceID};Hr.prototype.createArrays=function(){this.text=new gc(new Pt(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new gc(new Pt(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new S,this.lineVertexArray=new k,this.symbolInstances=new w},Hr.prototype.calculateGlyphDependencies=function(e,t,i,l,p){for(var d=0;d<e.length;d++)if(t[e.charCodeAt(d)]=!0,(i||l)&&p){var _=yu[e.charAt(d)];_&&(t[_.charCodeAt(0)]=!0)}},Hr.prototype.populate=function(e,t,i){var l=this.layers[0],p=l.layout,d=p.get("text-font"),_=p.get("text-field"),E=p.get("icon-image"),T=(_.value.kind!=="constant"||_.value.value instanceof Nr&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&(d.value.kind!=="constant"||d.value.value.length>0),z=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,C=p.get("symbol-sort-key");if(this.features=[],T||z){for(var D=t.iconDependencies,N=t.glyphDependencies,K=t.availableImages,te=new rr(this.zoom),ne=0,pe=e;ne<pe.length;ne+=1){var ae=pe[ne],ge=ae.feature,ke=ae.id,Pe=ae.index,Be=ae.sourceLayerIndex,Fe=l._featureFilter.needGeometry,Qe=Ir(ge,Fe);if(l._featureFilter.filter(te,Qe,i)){Fe||(Qe.geometry=jr(ge));var nt=void 0;if(T){var Tt=l.getValueAndResolveTokens("text-field",Qe,i,K),ct=Nr.factory(Tt);Eg(ct)&&(this.hasRTLText=!0),(!this.hasRTLText||Vs()==="unavailable"||this.hasRTLText&&$n.isParsed())&&(nt=fp(ct,l,Qe))}var Mt=void 0;if(z){var pt=l.getValueAndResolveTokens("icon-image",Qe,i,K);Mt=pt instanceof ni?pt:ni.fromString(pt)}if(nt||Mt){var ir=this.sortFeaturesByKey?C.evaluate(Qe,{},i):void 0;if(this.features.push({id:ke,text:nt,icon:Mt,index:Pe,sourceLayerIndex:Be,geometry:Qe.geometry,properties:ge.properties,type:wg[ge.type],sortKey:ir}),Mt&&(D[Mt.name]=!0),nt){var jt=d.evaluate(Qe,{},i).join(","),_t=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Do.vertical)>=0;for(var pr=0,Qt=nt.sections;pr<Qt.length;pr+=1){var _r=Qt[pr];if(_r.image)D[_r.image.name]=!0;else{var Lt=Ml(nt.toString()),Ar=_r.fontStack||jt,xi=N[Ar]=N[Ar]||{};this.calculateGlyphDependencies(_r.text,xi,_t,this.allowVerticalPlacement,Lt)}}}}}}p.get("symbol-placement")==="line"&&(this.features=function(Bi){var Pi={},wi={},Oi=[],yn=0;function gn(hi){Oi.push(Bi[hi]),yn++}function vo(hi,$i,no){var zr=wi[hi];return delete wi[hi],wi[$i]=zr,Oi[zr].geometry[0].pop(),Oi[zr].geometry[0]=Oi[zr].geometry[0].concat(no[0]),zr}function In(hi,$i,no){var zr=Pi[$i];return delete Pi[$i],Pi[hi]=zr,Oi[zr].geometry[0].shift(),Oi[zr].geometry[0]=no[0].concat(Oi[zr].geometry[0]),zr}function bo(hi,$i,no){var zr=no?$i[0][$i[0].length-1]:$i[0][0];return hi+":"+zr.x+":"+zr.y}for(var Zi=0;Zi<Bi.length;Zi++){var An=Bi[Zi],yr=An.geometry,ri=An.text?An.text.toString():null;if(ri){var qr=bo(ri,yr),br=bo(ri,yr,!0);if(qr in wi&&br in Pi&&wi[qr]!==Pi[br]){var Lo=In(qr,br,yr),io=vo(qr,br,Oi[Lo].geometry);delete Pi[qr],delete wi[br],wi[bo(ri,Oi[io].geometry,!0)]=io,Oi[Lo].geometry=null}else qr in wi?vo(qr,br,yr):br in Pi?In(qr,br,yr):(gn(Zi),Pi[qr]=yn-1,wi[br]=yn-1)}else gn(Zi)}return Oi.filter(function(hi){return hi.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Bi,Pi){return Bi.sortKey-Pi.sortKey})}},Hr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Hr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Hr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Hr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Hr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Hr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Hr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),p=e.dist(t[e.segment]),d={},_=e.segment+1;_<t.length;_++)d[_]={x:t[_].x,y:t[_].y,tileUnitDistanceFromAnchor:l},_<t.length-1&&(l+=t[_+1].dist(t[_]));for(var E=e.segment||0;E>=0;E--)d[E]={x:t[E].x,y:t[E].y,tileUnitDistanceFromAnchor:p},E>0&&(p+=t[E-1].dist(t[E]));for(var T=0;T<t.length;T++){var z=d[T];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Hr.prototype.addSymbols=function(e,t,i,l,p,d,_,E,T,z,C,D){for(var N=e.indexArray,K=e.layoutVertexArray,te=e.segments.prepareSegment(4*t.length,K,N,this.canOverlap?d.sortKey:void 0),ne=this.glyphOffsetArray.length,pe=te.vertexLength,ae=this.allowVerticalPlacement&&_===Do.vertical?Math.PI/2:0,ge=d.text&&d.text.sections,ke=0;ke<t.length;ke++){var Pe=t[ke],Be=Pe.tl,Fe=Pe.tr,Qe=Pe.bl,nt=Pe.br,Tt=Pe.tex,ct=Pe.pixelOffsetTL,Mt=Pe.pixelOffsetBR,pt=Pe.minFontScaleX,ir=Pe.minFontScaleY,jt=Pe.glyphOffset,_t=Pe.isSDF,pr=Pe.sectionIndex,Qt=te.vertexLength,_r=jt[1];Ap(K,E.x,E.y,Be.x,_r+Be.y,Tt.x,Tt.y,i,_t,ct.x,ct.y,pt,ir),Ap(K,E.x,E.y,Fe.x,_r+Fe.y,Tt.x+Tt.w,Tt.y,i,_t,Mt.x,ct.y,pt,ir),Ap(K,E.x,E.y,Qe.x,_r+Qe.y,Tt.x,Tt.y+Tt.h,i,_t,ct.x,Mt.y,pt,ir),Ap(K,E.x,E.y,nt.x,_r+nt.y,Tt.x+Tt.w,Tt.y+Tt.h,i,_t,Mt.x,Mt.y,pt,ir),zf(e.dynamicLayoutVertexArray,E,ae),N.emplaceBack(Qt,Qt+1,Qt+2),N.emplaceBack(Qt+1,Qt+2,Qt+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(jt[0]),ke!==t.length-1&&pr===t[ke+1].sectionIndex||e.programConfigurations.populatePaintArrays(K.length,d,d.index,{},D,ge&&ge[pr])}e.placedSymbolArray.emplaceBack(E.x,E.y,ne,this.glyphOffsetArray.length-ne,pe,T,z,E.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],_,0,!1,0,C)},Hr.prototype._addCollisionDebugVertex=function(e,t,i,l,p,d){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,p,Math.round(d.x),Math.round(d.y))},Hr.prototype.addCollisionDebugVertices=function(e,t,i,l,p,d,_){var E=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),T=E.vertexLength,z=p.layoutVertexArray,C=p.collisionVertexArray,D=_.anchorX,N=_.anchorY;this._addCollisionDebugVertex(z,C,d,D,N,new B(e,t)),this._addCollisionDebugVertex(z,C,d,D,N,new B(i,t)),this._addCollisionDebugVertex(z,C,d,D,N,new B(i,l)),this._addCollisionDebugVertex(z,C,d,D,N,new B(e,l)),E.vertexLength+=4;var K=p.indexArray;K.emplaceBack(T,T+1),K.emplaceBack(T+1,T+2),K.emplaceBack(T+2,T+3),K.emplaceBack(T+3,T),E.primitiveLength+=4},Hr.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var p=e;p<t;p++){var d=this.collisionBoxArray.get(p);this.addCollisionDebugVertices(d.x1,d.y1,d.x2,d.y2,l?this.textCollisionBox:this.iconCollisionBox,d.anchorPoint,i)}},Hr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ch(xs,ih.members,js),this.iconCollisionBox=new ch(xs,ih.members,js);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Hr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,p,d,_,E,T){for(var z={},C=t;C<i;C++){var D=e.get(C);z.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},z.textFeatureIndex=D.featureIndex;break}for(var N=l;N<p;N++){var K=e.get(N);z.verticalTextBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},z.verticalTextFeatureIndex=K.featureIndex;break}for(var te=d;te<_;te++){var ne=e.get(te);z.iconBox={x1:ne.x1,y1:ne.y1,x2:ne.x2,y2:ne.y2,anchorPointX:ne.anchorPointX,anchorPointY:ne.anchorPointY},z.iconFeatureIndex=ne.featureIndex;break}for(var pe=E;pe<T;pe++){var ae=e.get(pe);z.verticalIconBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},z.verticalIconFeatureIndex=ae.featureIndex;break}return z},Hr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Hr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Hr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Hr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Hr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Hr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Hr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,p=i.vertexStartIndex;p<l;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)},Hr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],p=[],d=[],_=0;_<this.symbolInstances.length;++_){d.push(_);var E=this.symbolInstances.get(_);l.push(0|Math.round(t*E.anchorX+i*E.anchorY)),p.push(E.featureIndex)}return d.sort(function(T,z){return l[T]-l[z]||p[z]-p[T]}),d},Hr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Hr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var p=this.symbolInstances.get(l[i]);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(function(d,_,E){d>=0&&E.indexOf(d)===_&&t.addIndicesForPlacedSymbol(t.text,d)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},at("SymbolBucket",Hr,{omit:["layers","collisionBoxArray","features","compareText"]}),Hr.MAX_GLYPHS=65535,Hr.addDynamicAttributes=zf;var kg=new Hi({"symbol-placement":new vt(Z.layout_symbol["symbol-placement"]),"symbol-spacing":new vt(Z.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new vt(Z.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new dt(Z.layout_symbol["symbol-sort-key"]),"symbol-z-order":new vt(Z.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new vt(Z.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new vt(Z.layout_symbol["icon-ignore-placement"]),"icon-optional":new vt(Z.layout_symbol["icon-optional"]),"icon-rotation-alignment":new vt(Z.layout_symbol["icon-rotation-alignment"]),"icon-size":new dt(Z.layout_symbol["icon-size"]),"icon-text-fit":new vt(Z.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new vt(Z.layout_symbol["icon-text-fit-padding"]),"icon-image":new dt(Z.layout_symbol["icon-image"]),"icon-rotate":new dt(Z.layout_symbol["icon-rotate"]),"icon-padding":new vt(Z.layout_symbol["icon-padding"]),"icon-keep-upright":new vt(Z.layout_symbol["icon-keep-upright"]),"icon-offset":new dt(Z.layout_symbol["icon-offset"]),"icon-anchor":new dt(Z.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new vt(Z.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new vt(Z.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new vt(Z.layout_symbol["text-rotation-alignment"]),"text-field":new dt(Z.layout_symbol["text-field"]),"text-font":new dt(Z.layout_symbol["text-font"]),"text-size":new dt(Z.layout_symbol["text-size"]),"text-max-width":new dt(Z.layout_symbol["text-max-width"]),"text-line-height":new vt(Z.layout_symbol["text-line-height"]),"text-letter-spacing":new dt(Z.layout_symbol["text-letter-spacing"]),"text-justify":new dt(Z.layout_symbol["text-justify"]),"text-radial-offset":new dt(Z.layout_symbol["text-radial-offset"]),"text-variable-anchor":new vt(Z.layout_symbol["text-variable-anchor"]),"text-anchor":new dt(Z.layout_symbol["text-anchor"]),"text-max-angle":new vt(Z.layout_symbol["text-max-angle"]),"text-writing-mode":new vt(Z.layout_symbol["text-writing-mode"]),"text-rotate":new dt(Z.layout_symbol["text-rotate"]),"text-padding":new vt(Z.layout_symbol["text-padding"]),"text-keep-upright":new vt(Z.layout_symbol["text-keep-upright"]),"text-transform":new dt(Z.layout_symbol["text-transform"]),"text-offset":new dt(Z.layout_symbol["text-offset"]),"text-allow-overlap":new vt(Z.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new vt(Z.layout_symbol["text-ignore-placement"]),"text-optional":new vt(Z.layout_symbol["text-optional"])}),Pf={paint:new Hi({"icon-opacity":new dt(Z.paint_symbol["icon-opacity"]),"icon-color":new dt(Z.paint_symbol["icon-color"]),"icon-halo-color":new dt(Z.paint_symbol["icon-halo-color"]),"icon-halo-width":new dt(Z.paint_symbol["icon-halo-width"]),"icon-halo-blur":new dt(Z.paint_symbol["icon-halo-blur"]),"icon-translate":new vt(Z.paint_symbol["icon-translate"]),"icon-translate-anchor":new vt(Z.paint_symbol["icon-translate-anchor"]),"text-opacity":new dt(Z.paint_symbol["text-opacity"]),"text-color":new dt(Z.paint_symbol["text-color"],{runtimeType:it,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new dt(Z.paint_symbol["text-halo-color"]),"text-halo-width":new dt(Z.paint_symbol["text-halo-width"]),"text-halo-blur":new dt(Z.paint_symbol["text-halo-blur"]),"text-translate":new vt(Z.paint_symbol["text-translate"]),"text-translate-anchor":new vt(Z.paint_symbol["text-translate-anchor"])}),layout:kg},_c=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:st,this.defaultValue=e};_c.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},_c.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},_c.prototype.outputDefined=function(){return!1},_c.prototype.serialize=function(){return null},at("FormatSectionOverride",_c,{omit:["defaultValue"]});var Tg=function(e){function t(i){e.call(this,i,Pf)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var p=this.layout.get("text-writing-mode");if(p){for(var d=[],_=0,E=p;_<E.length;_+=1){var T=E[_];d.indexOf(T)<0&&d.push(T)}this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,p,d){var _=this.layout.get(i).evaluate(l,{},p,d),E=this._unevaluatedLayout._values[i];return E.isDataDriven()||Bs(E.value)||!_?_:function(T,z){return z.replace(/{([^{}]+)}/g,function(C,D){return D in T?String(T[D]):""})}(l.properties,_)},t.prototype.createBucket=function(i){return new Hr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=Pf.paint.overridableProperties;i<l.length;i+=1){var p=l[i];if(t.hasPaintOverride(this.layout,p)){var d,_=this.paint.get(p),E=new _c(_),T=new ys(E,_.property.specification);d=_.value.kind==="constant"||_.value.kind==="source"?new rl("source",T):new Za("composite",T,_.value.zoomStops,_.value._interpolationType),this.paint._values[p]=new jn(_.property,d,_.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var p=i.get("text-field"),d=Pf.paint.properties[l],_=!1,E=function(C){for(var D=0,N=C;D<N.length;D+=1)if(d.overrides&&d.overrides.hasOverride(N[D]))return void(_=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Nr)E(p.value.value.sections);else if(p.value.kind==="source"){var T=function(C){_||(C instanceof Xr&&Sr(C.value)===cr?E(C.value.sections):C instanceof Wi?E(C.sections):C.eachChild(T))},z=p.value;z._styleExpression&&T(z._styleExpression.expression)}return _},t}(Qo),Ig={paint:new Hi({"background-color":new vt(Z.paint_background["background-color"]),"background-pattern":new Di(Z.paint_background["background-pattern"]),"background-opacity":new vt(Z.paint_background["background-opacity"])})},Ag=function(e){function t(i){e.call(this,i,Ig)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Qo),zg={paint:new Hi({"raster-opacity":new vt(Z.paint_raster["raster-opacity"]),"raster-hue-rotate":new vt(Z.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new vt(Z.paint_raster["raster-brightness-min"]),"raster-brightness-max":new vt(Z.paint_raster["raster-brightness-max"]),"raster-saturation":new vt(Z.paint_raster["raster-saturation"]),"raster-contrast":new vt(Z.paint_raster["raster-contrast"]),"raster-resampling":new vt(Z.paint_raster["raster-resampling"]),"raster-fade-duration":new vt(Z.paint_raster["raster-fade-duration"])})},Pg=function(e){function t(i){e.call(this,i,zg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Qo),Cg=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Qo),Mg={circle:nc,heatmap:Zc,hillshade:Zh,fill:rp,"fill-extrusion":xf,line:hp,symbol:Tg,background:Ag,raster:Pg},Md=j.HTMLImageElement,Dd=j.HTMLCanvasElement,Ld=j.HTMLVideoElement,Rd=j.ImageData,zp=j.ImageBitmap,Zu=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};Zu.prototype.update=function(e,t,i){var l=e.width,p=e.height,d=!(this.size&&this.size[0]===l&&this.size[1]===p||i),_=this.context,E=_.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!t||t.premultiply!==!1)),d)this.size=[l,p],e instanceof Md||e instanceof Dd||e instanceof Ld||e instanceof Rd||zp&&e instanceof zp?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,e):E.texImage2D(E.TEXTURE_2D,0,this.format,l,p,0,this.format,E.UNSIGNED_BYTE,e.data);else{var T=i||{x:0,y:0},z=T.x,C=T.y;e instanceof Md||e instanceof Dd||e instanceof Ld||e instanceof Rd||zp&&e instanceof zp?E.texSubImage2D(E.TEXTURE_2D,0,z,C,E.RGBA,E.UNSIGNED_BYTE,e):E.texSubImage2D(E.TEXTURE_2D,0,z,C,l,p,E.RGBA,E.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)},Zu.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Zu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Zu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Cf=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};Cf.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},Cf.prototype.remove=function(){delete this._channel,this._callback=function(){}};var vc=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},tr(["receive","process"],this),this.invoker=new Cf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ne()?e:j};function Bd(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}vc.prototype.send=function(e,t,i,l,p){var d=this;p===void 0&&(p=!1);var _=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[_]=i);var E=Wt(this.globalScope)?void 0:[];return this.target.postMessage({id:_,type:e,hasCallback:!!i,targetMapId:l,mustQueue:p,sourceMapId:this.mapId,data:da(t,E)},E),{cancel:function(){i&&delete d.callbacks[_],d.target.postMessage({id:_,type:"<cancel>",targetMapId:l,sourceMapId:d.mapId})}}},vc.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else Ne()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},vc.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},vc.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Nn(t.error)):l(null,Nn(t.data)))}else{var p=!1,d=Wt(this.globalScope)?void 0:[],_=t.hasCallback?function(C,D){p=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:C?da(C):null,data:da(D,d)},d)}:function(C){p=!0},E=null,T=Nn(t.data);if(this.parent[t.type])E=this.parent[t.type](t.sourceMapId,T,_);else if(this.parent.getWorkerSource){var z=t.type.split(".");E=this.parent.getWorkerSource(t.sourceMapId,z[0],T.source)[z[1]](T,_)}else _(new Error("Could not find function "+t.type));!p&&E&&E.cancel&&(this.cancelCallbacks[e]=E.cancel)}},vc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var un=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};un.prototype.setNorthEast=function(e){return this._ne=e instanceof bi?new bi(e.lng,e.lat):bi.convert(e),this},un.prototype.setSouthWest=function(e){return this._sw=e instanceof bi?new bi(e.lng,e.lat):bi.convert(e),this},un.prototype.extend=function(e){var t,i,l=this._sw,p=this._ne;if(e instanceof bi)t=e,i=e;else{if(!(e instanceof un))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(un.convert(e)):this.extend(bi.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||p?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),p.lng=Math.max(i.lng,p.lng),p.lat=Math.max(i.lat,p.lat)):(this._sw=new bi(t.lng,t.lat),this._ne=new bi(i.lng,i.lat)),this},un.prototype.getCenter=function(){return new bi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},un.prototype.getSouthWest=function(){return this._sw},un.prototype.getNorthEast=function(){return this._ne},un.prototype.getNorthWest=function(){return new bi(this.getWest(),this.getNorth())},un.prototype.getSouthEast=function(){return new bi(this.getEast(),this.getSouth())},un.prototype.getWest=function(){return this._sw.lng},un.prototype.getSouth=function(){return this._sw.lat},un.prototype.getEast=function(){return this._ne.lng},un.prototype.getNorth=function(){return this._ne.lat},un.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},un.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},un.prototype.isEmpty=function(){return!(this._sw&&this._ne)},un.prototype.contains=function(e){var t=bi.convert(e),i=t.lng,l=t.lat,p=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&p},un.convert=function(e){return!e||e instanceof un?e:new un(e)};var bi=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};bi.prototype.wrap=function(){return new bi(Xe(this.lng,-180,180),this.lat)},bi.prototype.toArray=function(){return[this.lng,this.lat]},bi.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},bi.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,p=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(p,1))},bi.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new un(new bi(this.lng-i,this.lat-t),new bi(this.lng+i,this.lat+t))},bi.convert=function(e){if(e instanceof bi)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new bi(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new bi(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Od=2*Math.PI*63710088e-1;function Fd(e){return Od*Math.cos(e*Math.PI/180)}function Nd(e){return(180+e)/360}function Vd(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Ud(e,t){return e/Fd(t)}function Mf(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Gu=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};Gu.fromLngLat=function(e,t){t===void 0&&(t=0);var i=bi.convert(e);return new Gu(Nd(i.lng),Vd(i.lat),Ud(t,i.lat))},Gu.prototype.toLngLat=function(){return new bi(360*this.x-180,Mf(this.y))},Gu.prototype.toAltitude=function(){return this.z*Fd(Mf(this.y))},Gu.prototype.meterInMercatorCoordinateUnits=function(){return 1/Od*(e=Mf(this.y),1/Math.cos(e*Math.PI/180));var e};var Ku=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=hh(0,e,e,t,i)};Ku.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Ku.prototype.url=function(e,t){var i,l,p,d,_,E=(l=this.y,p=this.z,d=Bd(256*(i=this.x),256*(l=Math.pow(2,p)-l-1),p),_=Bd(256*(i+1),256*(l+1),p),d[0]+","+d[1]+","+_[0]+","+_[1]),T=function(z,C,D){for(var N,K="",te=z;te>0;te--)K+=(C&(N=1<<te-1)?1:0)+(D&N?2:0);return K}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",T).replace("{bbox-epsg-3857}",E)},Ku.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new B(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Ku.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var jd=function(e,t){this.wrap=e,this.canonical=t,this.key=hh(e,t.z,t.z,t.x,t.y)},cn=function(e,t,i,l,p){this.overscaledZ=e,this.wrap=t,this.canonical=new Ku(i,+l,+p),this.key=hh(t,e,i,l,p)};function hh(e,t,i,l,p){(e*=2)<0&&(e=-1*e-1);var d=1<<i;return(d*d*e+d*p+l).toString(36)+i.toString(36)+t.toString(36)}cn.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},cn.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new cn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new cn(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},cn.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?hh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):hh(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},cn.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},cn.prototype.children=function(e){if(this.overscaledZ>=e)return[new cn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new cn(t,this.wrap,t,i,l),new cn(t,this.wrap,t,i+1,l),new cn(t,this.wrap,t,i,l+1),new cn(t,this.wrap,t,i+1,l+1)]},cn.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},cn.prototype.wrapped=function(){return new cn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},cn.prototype.unwrapTo=function(e){return new cn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},cn.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},cn.prototype.toUnwrapped=function(){return new jd(this.wrap,this.canonical)},cn.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},cn.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Gu(e.x-this.wrap,e.y))},at("CanonicalTileID",Ku),at("OverscaledTileID",cn,{omit:["posMatrix"]});var Hl=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return yt('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var p=0;p<l;p++)this.data[this._idx(-1,p)]=this.data[this._idx(0,p)],this.data[this._idx(l,p)]=this.data[this._idx(l-1,p)],this.data[this._idx(p,-1)]=this.data[this._idx(p,0)],this.data[this._idx(p,l)]=this.data[this._idx(p,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};Hl.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},Hl.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Hl.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Hl.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},Hl.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},Hl.prototype.getPixels=function(){return new Gn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Hl.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,p=t*this.dim+this.dim,d=i*this.dim,_=i*this.dim+this.dim;switch(t){case-1:l=p-1;break;case 1:p=l+1}switch(i){case-1:d=_-1;break;case 1:_=d+1}for(var E=-t*this.dim,T=-i*this.dim,z=d;z<_;z++)for(var C=l;C<p;C++)this.data[this._idx(C,z)]=e.data[this._idx(C+E,z+T)]},at("DEMData",Hl);var Pp=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};Pp.prototype.encode=function(e){return this._stringToNumber[e]},Pp.prototype.decode=function(e){return this._numberToString[e]};var Cp=function(e,t,i,l,p){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=p},Df={geometry:{configurable:!0}};Df.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Df.geometry.set=function(e){this._geometry=e},Cp.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Cp.prototype,Df);var bc=function(){this.state={},this.stateChanges={},this.deletedStates={}};bc.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},Ue(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var p in this.deletedStates[e]={},this.state[e])p!==l&&(this.deletedStates[e][p]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var d in this.deletedStates[e][l]={},this.state[e][l])i[d]||(this.deletedStates[e][l][d]=null);else for(var _ in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][_]===null&&delete this.deletedStates[e][l][_]},bc.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},bc.prototype.getState=function(e,t){var i=String(t),l=Ue({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var p=this.deletedStates[e][t];if(p===null)return{};for(var d in p)delete l[d]}return l},bc.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},bc.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var p={};for(var d in this.stateChanges[l])this.state[l][d]||(this.state[l][d]={}),Ue(this.state[l][d],this.stateChanges[l][d]),p[d]=this.state[l][d];i[l]=p}for(var _ in this.deletedStates){this.state[_]=this.state[_]||{};var E={};if(this.deletedStates[_]===null)for(var T in this.state[_])E[T]={},this.state[_][T]={};else for(var z in this.deletedStates[_]){if(this.deletedStates[_][z]===null)this.state[_][z]={};else for(var C=0,D=Object.keys(this.deletedStates[_][z]);C<D.length;C+=1)delete this.state[_][z][D[C]];E[z]=this.state[_][z]}i[_]=i[_]||{},Ue(i[_],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var N in e)e[N].setFeatureState(i,t)};var Jl=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new fa(8192,16,0),this.grid3D=new fa(8192,16,0),this.featureIndexArray=new L,this.promoteId=t};function qd(e,t,i,l,p){return xt(e,function(d,_){var E=t instanceof Us?t.get(_):null;return E&&E.evaluate?E.evaluate(i,l,p):E})}function Zd(e){for(var t=1/0,i=1/0,l=-1/0,p=-1/0,d=0,_=e;d<_.length;d+=1){var E=_[d];t=Math.min(t,E.x),i=Math.min(i,E.y),l=Math.max(l,E.x),p=Math.max(p,E.y)}return{minX:t,minY:i,maxX:l,maxY:p}}function Dg(e,t){return t-e}Jl.prototype.insert=function(e,t,i,l,p,d){var _=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,p);for(var E=d?this.grid3D:this.grid,T=0;T<t.length;T++){for(var z=t[T],C=[1/0,1/0,-1/0,-1/0],D=0;D<z.length;D++){var N=z[D];C[0]=Math.min(C[0],N.x),C[1]=Math.min(C[1],N.y),C[2]=Math.max(C[2],N.x),C[3]=Math.max(C[3],N.y)}C[0]<8192&&C[1]<8192&&C[2]>=0&&C[3]>=0&&E.insert(_,C[0],C[1],C[2],C[3])}},Jl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Zl.VectorTile(new gu(this.rawTileData)).layers,this.sourceLayerCoder=new Pp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Jl.prototype.query=function(e,t,i,l){var p=this;this.loadVTLayers();for(var d=e.params||{},_=8192/e.tileSize/e.scale,E=Qn(d.filter),T=e.queryGeometry,z=e.queryPadding*_,C=Zd(T),D=this.grid.query(C.minX-z,C.minY-z,C.maxX+z,C.maxY+z),N=Zd(e.cameraQueryGeometry),K=this.grid3D.query(N.minX-z,N.minY-z,N.maxX+z,N.maxY+z,function(Pe,Be,Fe,Qe){return function(nt,Tt,ct,Mt,pt){for(var ir=0,jt=nt;ir<jt.length;ir+=1){var _t=jt[ir];if(Tt<=_t.x&&ct<=_t.y&&Mt>=_t.x&&pt>=_t.y)return!0}var pr=[new B(Tt,ct),new B(Tt,pt),new B(Mt,pt),new B(Mt,ct)];if(nt.length>2){for(var Qt=0,_r=pr;Qt<_r.length;Qt+=1)if(Yi(nt,_r[Qt]))return!0}for(var Lt=0;Lt<nt.length-1;Lt++)if(pl(nt[Lt],nt[Lt+1],pr))return!0;return!1}(e.cameraQueryGeometry,Pe-z,Be-z,Fe+z,Qe+z)}),te=0,ne=K;te<ne.length;te+=1)D.push(ne[te]);D.sort(Dg);for(var pe,ae={},ge=function(Pe){var Be=D[Pe];if(Be!==pe){pe=Be;var Fe=p.featureIndexArray.get(Be),Qe=null;p.loadMatchingFeature(ae,Fe.bucketIndex,Fe.sourceLayerIndex,Fe.featureIndex,E,d.layers,d.availableImages,t,i,l,function(nt,Tt,ct){return Qe||(Qe=jr(nt)),Tt.queryIntersectsFeature(T,nt,ct,Qe,p.z,e.transform,_,e.pixelPosMatrix)})}},ke=0;ke<D.length;ke++)ge(ke);return ae},Jl.prototype.loadMatchingFeature=function(e,t,i,l,p,d,_,E,T,z,C){var D=this.bucketLayerIDs[t];if(!d||function(nt,Tt){for(var ct=0;ct<nt.length;ct++)if(Tt.indexOf(nt[ct])>=0)return!0;return!1}(d,D)){var N=this.sourceLayerCoder.decode(i),K=this.vtLayers[N].feature(l);if(p.needGeometry){var te=Ir(K,!0);if(!p.filter(new rr(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!p.filter(new rr(this.tileID.overscaledZ),K))return;for(var ne=this.getId(K,N),pe=0;pe<D.length;pe++){var ae=D[pe];if(!(d&&d.indexOf(ae)<0)){var ge=E[ae];if(ge){var ke={};ne!==void 0&&z&&(ke=z.getState(ge.sourceLayer||"_geojsonTileLayer",ne));var Pe=Ue({},T[ae]);Pe.paint=qd(Pe.paint,ge.paint,K,ke,_),Pe.layout=qd(Pe.layout,ge.layout,K,ke,_);var Be=!C||C(K,ge,ke);if(Be){var Fe=new Cp(K,this.z,this.x,this.y,ne);Fe.layer=Pe;var Qe=e[ae];Qe===void 0&&(Qe=e[ae]=[]),Qe.push({featureIndex:l,feature:Fe,intersectionZ:Be})}}}}}},Jl.prototype.lookupSymbolFeatures=function(e,t,i,l,p,d,_,E){var T={};this.loadVTLayers();for(var z=Qn(p),C=0,D=e;C<D.length;C+=1)this.loadMatchingFeature(T,i,l,D[C],z,d,_,E,t);return T},Jl.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,p=i[t];l<p.length;l+=1)if(e===p[l])return!0;return!1},Jl.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},at("FeatureIndex",Jl,{omit:["rawTileData","sourceLayerCoder"]});var Tn=function(e,t){this.tileID=e,this.uid=St(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Tn.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<si.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Tn.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Tn.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(z,C){var D={};if(!C)return D;for(var N=function(){var ne=te[K],pe=ne.layerIds.map(function(ke){return C.getLayer(ke)}).filter(Boolean);if(pe.length!==0){ne.layers=pe,ne.stateDependentLayerIds&&(ne.stateDependentLayers=ne.stateDependentLayerIds.map(function(ke){return pe.filter(function(Pe){return Pe.id===ke})[0]}));for(var ae=0,ge=pe;ae<ge.length;ae+=1)D[ge[ae].id]=ne}},K=0,te=z;K<te.length;K+=1)N();return D}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var p=this.buckets[l];if(p instanceof Hr){if(this.hasSymbolBuckets=!0,!i)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var d in this.buckets){var _=this.buckets[d];if(_ instanceof Hr&&_.hasRTLText){this.hasRTLText=!0,$n.isLoading()||$n.isLoaded()||Vs()!=="deferred"||fo();break}}for(var E in this.queryPadding=0,this.buckets){var T=this.buckets[E];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(E).queryRadius(T))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Tn.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Tn.prototype.getBucket=function(e){return this.buckets[e.id]},Tn.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Zu(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Zu(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},Tn.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Tn.prototype.queryRenderedFeatures=function(e,t,i,l,p,d,_,E,T,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:p,scale:d,tileSize:this.tileSize,pixelPosMatrix:z,transform:E,params:_,queryPadding:this.queryPadding*T},e,t,i):{}},Tn.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),p=t?t.sourceLayer:"",d=l._geojsonTileLayer||l[p];if(d)for(var _=Qn(t&&t.filter),E=this.tileID.canonical,T=E.z,z=E.x,C=E.y,D={z:T,x:z,y:C},N=0;N<d.length;N++){var K=d.feature(N);if(_.needGeometry){var te=Ir(K,!0);if(!_.filter(new rr(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!_.filter(new rr(this.tileID.overscaledZ),K))continue;var ne=i.getId(K,p),pe=new Cp(K,T,z,C,ne);pe.tile=D,e.push(pe)}}},Tn.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Tn.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Tn.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=Et(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),p=!1;if(this.expirationTime>l)p=!1;else if(t)if(this.expirationTime<t)p=!0;else{var d=this.expirationTime-t;d?this.expirationTime=l+Math.max(d,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Tn.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Tn.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var p=this.buckets[l],d=p.layers[0].sourceLayer||"_geojsonTileLayer",_=i[d],E=e[d];if(_&&E&&Object.keys(E).length!==0){p.update(E,_,this.imageAtlas&&this.imageAtlas.patternPositions||{});var T=t&&t.style&&t.style.getLayer(l);T&&(this.queryPadding=Math.max(this.queryPadding,T.queryRadius(p)))}}}},Tn.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Tn.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<si.now()},Tn.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Tn.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=si.now()+e},Tn.prototype.setDependencies=function(e,t){for(var i={},l=0,p=t;l<p.length;l+=1)i[p[l]]=!0;this.dependencies[e]=i},Tn.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var p=this.dependencies[l[i]];if(p){for(var d=0,_=t;d<_.length;d+=1)if(p[_[d]])return!0}}return!1};var wu=j.performance,Gd=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},wu.mark(this._marks.start)};Gd.prototype.finish=function(){wu.mark(this._marks.end);var e=wu.getEntriesByName(this._marks.measure);return e.length===0&&(wu.measure(this._marks.measure,this._marks.start,this._marks.end),e=wu.getEntriesByName(this._marks.measure),wu.clearMarks(this._marks.start),wu.clearMarks(this._marks.end),wu.clearMeasures(this._marks.measure)),e},a.Actor=vc,a.AlphaImage=fl,a.CanonicalTileID=Ku,a.CollisionBoxArray=s,a.Color=ar,a.DEMData=Hl,a.DataConstantProperty=vt,a.DictionaryCoder=Pp,a.EXTENT=8192,a.ErrorEvent=ue,a.EvaluationParameters=rr,a.Event=re,a.Evented=ye,a.FeatureIndex=Jl,a.FillBucket=ss,a.FillExtrusionBucket=go,a.ImageAtlas=xu,a.ImagePosition=qu,a.LineBucket=ro,a.LngLat=bi,a.LngLatBounds=un,a.MercatorCoordinate=Gu,a.ONE_EM=24,a.OverscaledTileID=cn,a.Point=B,a.Point$1=B,a.Properties=Hi,a.Protobuf=gu,a.RGBAImage=Gn,a.RequestManager=Or,a.RequestPerformance=Gd,a.ResourceType=na,a.SegmentVector=W,a.SourceFeatureState=bc,a.StructArrayLayout1ui2=as,a.StructArrayLayout2f1f2i16=mo,a.StructArrayLayout2i4=rs,a.StructArrayLayout3ui6=En,a.StructArrayLayout4i8=is,a.SymbolBucket=Hr,a.Texture=Zu,a.Tile=Tn,a.Transitionable=ti,a.Uniform1f=Ke,a.Uniform1i=Oe,a.Uniform2f=et,a.Uniform3f=lt,a.Uniform4f=mt,a.UniformColor=Dt,a.UniformMatrix4f=Kt,a.UnwrappedTileID=jd,a.ValidationError=oe,a.WritingMode=Do,a.ZoomHistory=es,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=zf,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,p=new Array(e.length),d=null;e.forEach(function(_,E){t(_,function(T,z){T&&(d=T),p[E]=z,--l==0&&i(d,p)})})},a.bezier=de,a.bindAll=tr,a.browser=si,a.cacheEntryPossiblyAdded=function(e){++Eo>ia&&(e.getActor().send("enforceCacheSizeLimit",Wn),Eo=0)},a.clamp=xe,a.clearTileCache=function(e){var t=j.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=Td,a.clone=function(e){var t=new vr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=Ge,a.clone$2=function(e){var t=new vr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=nh,a.config=kt,a.create=function(){var e=new vr(16);return vr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new vr(9);return vr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new vr(4);return vr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=A,a.createExpression=ca,a.createLayout=Wr,a.createStyleLayer=function(e){return e.type==="custom"?new Cg(e):new Mg[e.type](e)},a.cross=function(e,t,i){var l=t[0],p=t[1],d=t[2],_=i[0],E=i[1],T=i[2];return e[0]=p*T-d*E,e[1]=d*_-l*T,e[2]=l*E-p*_,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var p in t)if(!e(t[p],i[p]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=Ce,a.emitValidationErrors=$a,a.endsWith=Xt,a.enforceCacheSizeLimit=function(e){So(),di&&di.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},a.evaluateSizeForFeature=bd,a.evaluateSizeForZoom=xd,a.evaluateVariableOffset=zd,a.evented=ts,a.extend=Ue,a.featureFilter=Qn,a.filterObject=qt,a.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=kf,a.getAnchorJustification=Af,a.getArrayBuffer=so,a.getImage=F,a.getJSON=function(e,t){return rn(Ue(e,{type:"json"}),t)},a.getRTLTextPluginStatus=Vs,a.getReferrer=ao,a.getVideo=function(e,t){var i,l,p=j.document.createElement("video");p.muted=!0,p.onloadstart=function(){t(null,p)};for(var d=0;d<e.length;d++){var _=j.document.createElement("source");i=e[d],l=void 0,(l=j.document.createElement("a")).href=i,(l.protocol!==j.document.location.protocol||l.host!==j.document.location.host)&&(p.crossOrigin="Anonymous"),_.src=e[d],p.appendChild(_)}return{cancel:function(){}}},a.identity=yo,a.invert=function(e,t){var i=t[0],l=t[1],p=t[2],d=t[3],_=t[4],E=t[5],T=t[6],z=t[7],C=t[8],D=t[9],N=t[10],K=t[11],te=t[12],ne=t[13],pe=t[14],ae=t[15],ge=i*E-l*_,ke=i*T-p*_,Pe=i*z-d*_,Be=l*T-p*E,Fe=l*z-d*E,Qe=p*z-d*T,nt=C*ne-D*te,Tt=C*pe-N*te,ct=C*ae-K*te,Mt=D*pe-N*ne,pt=D*ae-K*ne,ir=N*ae-K*pe,jt=ge*ir-ke*pt+Pe*Mt+Be*ct-Fe*Tt+Qe*nt;return jt?(e[0]=(E*ir-T*pt+z*Mt)*(jt=1/jt),e[1]=(p*pt-l*ir-d*Mt)*jt,e[2]=(ne*Qe-pe*Fe+ae*Be)*jt,e[3]=(N*Fe-D*Qe-K*Be)*jt,e[4]=(T*ct-_*ir-z*Tt)*jt,e[5]=(i*ir-p*ct+d*Tt)*jt,e[6]=(pe*Pe-te*Qe-ae*ke)*jt,e[7]=(C*Qe-N*Pe+K*ke)*jt,e[8]=(_*pt-E*ct+z*nt)*jt,e[9]=(l*ct-i*pt-d*nt)*jt,e[10]=(te*Fe-ne*Pe+ae*ge)*jt,e[11]=(D*Pe-C*Fe-K*ge)*jt,e[12]=(E*Tt-_*Mt-T*nt)*jt,e[13]=(i*Mt-l*Tt+p*nt)*jt,e[14]=(ne*ke-te*Be-pe*ge)*jt,e[15]=(C*Be-D*ke+N*ge)*jt,e):null},a.isChar=rt,a.isMapboxURL=li,a.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},a.makeRequest=rn,a.mapObject=xt,a.mercatorXfromLng=Nd,a.mercatorYfromLat=Vd,a.mercatorZfromAltitude=Ud,a.mul=Ru,a.multiply=vi,a.mvt=Zl,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],l=t[1],p=t[2],d=i*i+l*l+p*p;return d>0&&(d=1/Math.sqrt(d)),e[0]=t[0]*d,e[1]=t[1]*d,e[2]=t[2]*d,e},a.number=gi,a.offscreenCanvasSupported=Oo,a.ortho=function(e,t,i,l,p,d,_){var E=1/(t-i),T=1/(l-p),z=1/(d-_);return e[0]=-2*E,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*T,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*z,e[11]=0,e[12]=(t+i)*E,e[13]=(p+l)*T,e[14]=(_+d)*z,e[15]=1,e},a.parseGlyphPBF=function(e){return new gu(e).readFields(bu,[])},a.pbf=gu,a.performSymbolLayout=function(e,t,i,l,p,d,_){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var E=e.layers[0].layout,T=e.layers[0]._unevaluatedLayout._values,z={};if(e.textSizeData.kind==="composite"){var C=e.textSizeData,D=C.maxZoom;z.compositeTextSizes=[T["text-size"].possiblyEvaluate(new rr(C.minZoom),_),T["text-size"].possiblyEvaluate(new rr(D),_)]}if(e.iconSizeData.kind==="composite"){var N=e.iconSizeData,K=N.maxZoom;z.compositeIconSizes=[T["icon-size"].possiblyEvaluate(new rr(N.minZoom),_),T["icon-size"].possiblyEvaluate(new rr(K),_)]}z.layoutTextSize=T["text-size"].possiblyEvaluate(new rr(e.zoom+1),_),z.layoutIconSize=T["icon-size"].possiblyEvaluate(new rr(e.zoom+1),_),z.textMaxSize=T["text-size"].possiblyEvaluate(new rr(18));for(var te=24*E.get("text-line-height"),ne=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point",pe=E.get("text-keep-upright"),ae=E.get("text-size"),ge=function(){var Be=Pe[ke],Fe=E.get("text-font").evaluate(Be,{},_).join(","),Qe=ae.evaluate(Be,{},_),nt=z.layoutTextSize.evaluate(Be,{},_),Tt=z.layoutIconSize.evaluate(Be,{},_),ct={horizontal:{},vertical:void 0},Mt=Be.text,pt=[0,0];if(Mt){var ir=Mt.toString(),jt=24*E.get("text-letter-spacing").evaluate(Be,{},_),_t=function(yr){for(var ri=0,qr=yr;ri<qr.length;ri+=1)if(br=qr[ri].charCodeAt(0),rt.Arabic(br)||rt["Arabic Supplement"](br)||rt["Arabic Extended-A"](br)||rt["Arabic Presentation Forms-A"](br)||rt["Arabic Presentation Forms-B"](br))return!1;var br;return!0}(ir)?jt:0,pr=E.get("text-anchor").evaluate(Be,{},_),Qt=E.get("text-variable-anchor");if(!Qt){var _r=E.get("text-radial-offset").evaluate(Be,{},_);pt=_r?zd(pr,[24*_r,If]):E.get("text-offset").evaluate(Be,{},_).map(function(yr){return 24*yr})}var Lt=ne?"center":E.get("text-justify").evaluate(Be,{},_),Ar=E.get("symbol-placement"),xi=Ar==="point"?24*E.get("text-max-width").evaluate(Be,{},_):0,Bi=function(){e.allowVerticalPlacement&&Ml(ir)&&(ct.vertical=wp(Mt,t,i,p,Fe,xi,te,pr,"left",_t,pt,Do.vertical,!0,Ar,nt,Qe))};if(!ne&&Qt){for(var Pi=Lt==="auto"?Qt.map(function(yr){return Af(yr)}):[Lt],wi=!1,Oi=0;Oi<Pi.length;Oi++){var yn=Pi[Oi];if(!ct.horizontal[yn])if(wi)ct.horizontal[yn]=ct.horizontal[0];else{var gn=wp(Mt,t,i,p,Fe,xi,te,"center",yn,_t,pt,Do.horizontal,!1,Ar,nt,Qe);gn&&(ct.horizontal[yn]=gn,wi=gn.positionedLines.length===1)}}Bi()}else{Lt==="auto"&&(Lt=Af(pr));var vo=wp(Mt,t,i,p,Fe,xi,te,pr,Lt,_t,pt,Do.horizontal,!1,Ar,nt,Qe);vo&&(ct.horizontal[Lt]=vo),Bi(),Ml(ir)&&ne&&pe&&(ct.vertical=wp(Mt,t,i,p,Fe,xi,te,pr,Lt,_t,pt,Do.vertical,!1,Ar,nt,Qe))}}var In=void 0,bo=!1;if(Be.icon&&Be.icon.name){var Zi=l[Be.icon.name];Zi&&(In=function(yr,ri,qr){var br=kf(qr),Lo=ri[0]-yr.displaySize[0]*br.horizontalAlign,io=ri[1]-yr.displaySize[1]*br.verticalAlign;return{image:yr,top:io,bottom:io+yr.displaySize[1],left:Lo,right:Lo+yr.displaySize[0]}}(p[Be.icon.name],E.get("icon-offset").evaluate(Be,{},_),E.get("icon-anchor").evaluate(Be,{},_)),bo=Zi.sdf,e.sdfIcons===void 0?e.sdfIcons=Zi.sdf:e.sdfIcons!==Zi.sdf&&yt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Zi.pixelRatio!==e.pixelRatio||E.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var An=Cd(ct.horizontal)||ct.vertical;e.iconsInText=!!An&&An.iconsInText,(An||In)&&function(yr,ri,qr,br,Lo,io,hi,$i,no,zr,yl){var Ca=io.textMaxSize.evaluate(ri,{});Ca===void 0&&(Ca=hi);var gl,Gi=yr.layers[0].layout,_l=Gi.get("icon-offset").evaluate(ri,{},yl),Is=Cd(qr.horizontal),xc=hi/24,Xu=yr.tilePixelRatio*xc,wc=yr.tilePixelRatio*Ca/24,Yl=yr.tilePixelRatio*$i,Sc=yr.tilePixelRatio*Gi.get("symbol-spacing"),Mp=Gi.get("text-padding")*yr.tilePixelRatio,Ec=Gi.get("icon-padding")*yr.tilePixelRatio,ph=Gi.get("text-max-angle")/180*Math.PI,Dp=Gi.get("text-rotation-alignment")==="map"&&Gi.get("symbol-placement")!=="point",Lp=Gi.get("icon-rotation-alignment")==="map"&&Gi.get("symbol-placement")!=="point",Ql=Gi.get("symbol-placement"),fh=Sc/2,kc=Gi.get("icon-text-fit");br&&kc!=="none"&&(yr.allowVerticalPlacement&&qr.vertical&&(gl=vd(br,qr.vertical,kc,Gi.get("icon-text-fit-padding"),_l,xc)),Is&&(br=vd(br,Is,kc,Gi.get("icon-text-fit-padding"),_l,xc)));var Su=function(Lg,xh){xh.x<0||xh.x>=8192||xh.y<0||xh.y>=8192||function(Ki,Xs,Rg,Eu,Of,Wd,Vp,vl,Up,wh,jp,qp,Ff,Hd,Sh,Jd,Yd,Qd,$d,em,Ma,Zp,tm,bl,Bg){var rm,Hu,Pc,Cc,Mc,Dc=Ki.addToLineVertexArray(Xs,Rg),im=0,nm=0,om=0,am=0,Nf=-1,Vf=-1,$l={},sm=$(""),Uf=0,jf=0;if(vl._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Uf=(rm=vl.layout.get("text-offset").evaluate(Ma,{},bl).map(function(kh){return 24*kh}))[0],jf=rm[1]):(Uf=24*vl.layout.get("text-radial-offset").evaluate(Ma,{},bl),jf=If),Ki.allowVerticalPlacement&&Eu.vertical){var lm=vl.layout.get("text-rotate").evaluate(Ma,{},bl)+90;Cc=new Ip(Up,Xs,wh,jp,qp,Eu.vertical,Ff,Hd,Sh,lm),Vp&&(Mc=new Ip(Up,Xs,wh,jp,qp,Vp,Yd,Qd,Sh,lm))}if(Of){var qf=vl.layout.get("icon-rotate").evaluate(Ma,{}),um=vl.layout.get("icon-text-fit")!=="none",cm=Id(Of,qf,tm,um),Zf=Vp?Id(Vp,qf,tm,um):void 0;Pc=new Ip(Up,Xs,wh,jp,qp,Of,Yd,Qd,!1,qf),im=4*cm.length;var hm=Ki.iconSizeData,Eh=null;hm.kind==="source"?(Eh=[128*vl.layout.get("icon-size").evaluate(Ma,{})])[0]>32640&&yt(Ki.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):hm.kind==="composite"&&((Eh=[128*Zp.compositeIconSizes[0].evaluate(Ma,{},bl),128*Zp.compositeIconSizes[1].evaluate(Ma,{},bl)])[0]>32640||Eh[1]>32640)&&yt(Ki.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ki.addSymbols(Ki.icon,cm,Eh,em,$d,Ma,!1,Xs,Dc.lineStartIndex,Dc.lineLength,-1,bl),Nf=Ki.icon.placedSymbolArray.length-1,Zf&&(nm=4*Zf.length,Ki.addSymbols(Ki.icon,Zf,Eh,em,$d,Ma,Do.vertical,Xs,Dc.lineStartIndex,Dc.lineLength,-1,bl),Vf=Ki.icon.placedSymbolArray.length-1)}for(var pm in Eu.horizontal){var Gp=Eu.horizontal[pm];if(!Hu){sm=$(Gp.text);var Og=vl.layout.get("text-rotate").evaluate(Ma,{},bl);Hu=new Ip(Up,Xs,wh,jp,qp,Gp,Ff,Hd,Sh,Og)}var fm=Gp.positionedLines.length===1;if(om+=Pd(Ki,Xs,Gp,Wd,vl,Sh,Ma,Jd,Dc,Eu.vertical?Do.horizontal:Do.horizontalOnly,fm?Object.keys(Eu.horizontal):[pm],$l,Nf,Zp,bl),fm)break}Eu.vertical&&(am+=Pd(Ki,Xs,Eu.vertical,Wd,vl,Sh,Ma,Jd,Dc,Do.vertical,["vertical"],$l,Vf,Zp,bl));var Fg=Hu?Hu.boxStartIndex:Ki.collisionBoxArray.length,Ng=Hu?Hu.boxEndIndex:Ki.collisionBoxArray.length,Vg=Cc?Cc.boxStartIndex:Ki.collisionBoxArray.length,Ug=Cc?Cc.boxEndIndex:Ki.collisionBoxArray.length,jg=Pc?Pc.boxStartIndex:Ki.collisionBoxArray.length,qg=Pc?Pc.boxEndIndex:Ki.collisionBoxArray.length,Zg=Mc?Mc.boxStartIndex:Ki.collisionBoxArray.length,Gg=Mc?Mc.boxEndIndex:Ki.collisionBoxArray.length,xl=-1,Kp=function(kh,mm){return kh&&kh.circleDiameter?Math.max(kh.circleDiameter,mm):mm};xl=Kp(Hu,xl),xl=Kp(Cc,xl),xl=Kp(Pc,xl);var dm=(xl=Kp(Mc,xl))>-1?1:0;dm&&(xl*=Bg/24),Ki.glyphOffsetArray.length>=Hr.MAX_GLYPHS&&yt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ma.sortKey!==void 0&&Ki.addToSortKeyRanges(Ki.symbolInstances.length,Ma.sortKey),Ki.symbolInstances.emplaceBack(Xs.x,Xs.y,$l.right>=0?$l.right:-1,$l.center>=0?$l.center:-1,$l.left>=0?$l.left:-1,$l.vertical||-1,Nf,Vf,sm,Fg,Ng,Vg,Ug,jg,qg,Zg,Gg,wh,om,am,im,nm,dm,0,Ff,Uf,jf,xl)}(yr,xh,Lg,qr,br,Lo,gl,yr.layers[0],yr.collisionBoxArray,ri.index,ri.sourceLayerIndex,yr.index,Xu,Mp,Dp,no,Yl,Ec,Lp,_l,ri,io,zr,yl,hi)};if(Ql==="line")for(var Tc=0,Rp=Td(ri.geometry,0,0,8192,8192);Tc<Rp.length;Tc+=1)for(var Bp=Rp[Tc],dh=0,mh=gg(Bp,Sc,ph,qr.vertical||Is,br,24,wc,yr.overscaling,8192);dh<mh.length;dh+=1){var Op=mh[dh];Is&&xg(yr,Is.text,fh,Op)||Su(Bp,Op)}else if(Ql==="line-center")for(var yh=0,gh=ri.geometry;yh<gh.length;yh+=1){var _h=gh[yh];if(_h.length>1){var Fp=yg(_h,ph,qr.vertical||Is,br,24,wc);Fp&&Su(_h,Fp)}}else if(ri.type==="Polygon")for(var Ic=0,Np=ac(ri.geometry,0);Ic<Np.length;Ic+=1){var Ac=Np[Ic],vh=vg(Ac,16);Su(Ac[0],new dc(vh.x,vh.y,0))}else if(ri.type==="LineString")for(var Wu=0,bh=ri.geometry;Wu<bh.length;Wu+=1){var zc=bh[Wu];Su(zc,new dc(zc[0].x,zc[0].y,0))}else if(ri.type==="Point")for(var Lf=0,Kd=ri.geometry;Lf<Kd.length;Lf+=1)for(var Rf=0,Xd=Kd[Lf];Rf<Xd.length;Rf+=1){var Bf=Xd[Rf];Su([Bf],new dc(Bf.x,Bf.y,0))}}(e,Be,ct,In,l,z,nt,Tt,pt,bo,_)},ke=0,Pe=e.features;ke<Pe.length;ke+=1)ge();d&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,l,p){var d,_=1/Math.tan(t/2);return e[0]=_/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=_,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,p!=null&&p!==1/0?(e[10]=(p+l)*(d=1/(l-p)),e[14]=2*p*l*d):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var p=t[l];p in e&&(i[p]=e[p])}return i},a.plugin=$n,a.polygonIntersectsPolygon=mn,a.postMapLoadEvent=zn,a.postTurnstileEvent=Xn,a.potpack=xp,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=at,a.registerForPluginStateChange=function(e){return e({pluginStatus:wn,pluginURL:Un}),ts.on("pluginStateChange",e),e},a.renderColorRamp=qc,a.rotate=function(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3],E=Math.sin(i),T=Math.cos(i);return e[0]=l*T+d*E,e[1]=p*T+_*E,e[2]=l*-E+d*T,e[3]=p*-E+_*T,e},a.rotateX=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),d=t[4],_=t[5],E=t[6],T=t[7],z=t[8],C=t[9],D=t[10],N=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=d*p+z*l,e[5]=_*p+C*l,e[6]=E*p+D*l,e[7]=T*p+N*l,e[8]=z*p-d*l,e[9]=C*p-_*l,e[10]=D*p-E*l,e[11]=N*p-T*l,e},a.rotateZ=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),d=t[0],_=t[1],E=t[2],T=t[3],z=t[4],C=t[5],D=t[6],N=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=d*p+z*l,e[1]=_*p+C*l,e[2]=E*p+D*l,e[3]=T*p+N*l,e[4]=z*p-d*l,e[5]=C*p-_*l,e[6]=D*p-E*l,e[7]=N*p-T*l,e},a.scale=function(e,t,i){var l=i[0],p=i[1],d=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*p,e[5]=t[5]*p,e[6]=t[6]*p,e[7]=t[7]*p,e[8]=t[8]*d,e[9]=t[9]*d,e[10]=t[10]*d,e[11]=t[11]*d,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){Wn=e,ia=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),wn==="deferred"||wn==="loading"||wn==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Un=si.resolveURL(e),wn="deferred",Dl=t,Ns(),i||fo()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=Z,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=mg,a.transformMat3=function(e,t,i){var l=t[0],p=t[1],d=t[2];return e[0]=l*i[0]+p*i[3]+d*i[6],e[1]=l*i[1]+p*i[4]+d*i[7],e[2]=l*i[2]+p*i[5]+d*i[8],e},a.transformMat4=uu,a.translate=function(e,t,i){var l,p,d,_,E,T,z,C,D,N,K,te,ne=i[0],pe=i[1],ae=i[2];return t===e?(e[12]=t[0]*ne+t[4]*pe+t[8]*ae+t[12],e[13]=t[1]*ne+t[5]*pe+t[9]*ae+t[13],e[14]=t[2]*ne+t[6]*pe+t[10]*ae+t[14],e[15]=t[3]*ne+t[7]*pe+t[11]*ae+t[15]):(p=t[1],d=t[2],_=t[3],E=t[4],T=t[5],z=t[6],C=t[7],D=t[8],N=t[9],K=t[10],te=t[11],e[0]=l=t[0],e[1]=p,e[2]=d,e[3]=_,e[4]=E,e[5]=T,e[6]=z,e[7]=C,e[8]=D,e[9]=N,e[10]=K,e[11]=te,e[12]=l*ne+E*pe+D*ae+t[12],e[13]=p*ne+T*pe+N*ae+t[13],e[14]=d*ne+z*pe+K*ae+t[14],e[15]=_*ne+C*pe+te*ae+t[15]),e},a.triggerPluginCompletionEvent=bs,a.uniqueId=St,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=Os,a.validateStyle=ha,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=Zl,a.version="1.13.2",a.warnOnce=yt,a.webpSupported=ur,a.window=j,a.wrap=Xe}),x(["./shared"],function(a){function A(M){var F=typeof M;if(F==="number"||F==="boolean"||F==="string"||M==null)return JSON.stringify(M);if(Array.isArray(M)){for(var q="[",Y=0,re=M;Y<re.length;Y+=1)q+=A(re[Y])+",";return q+"]"}for(var ue=Object.keys(M).sort(),ye="{",Z=0;Z<ue.length;Z++)ye+=JSON.stringify(ue[Z])+":"+A(M[ue[Z]])+",";return ye+"}"}function I(M){for(var F="",q=0,Y=a.refProperties;q<Y.length;q+=1)F+="/"+A(M[Y[q]]);return F}var R=function(M){this.keyCache={},M&&this.replace(M)};R.prototype.replace=function(M){this._layerConfigs={},this._layers={},this.update(M,[])},R.prototype.update=function(M,F){for(var q=this,Y=0,re=M;Y<re.length;Y+=1){var ue=re[Y];this._layerConfigs[ue.id]=ue;var ye=this._layers[ue.id]=a.createStyleLayer(ue);ye._featureFilter=a.featureFilter(ye.filter),this.keyCache[ue.id]&&delete this.keyCache[ue.id]}for(var Z=0,oe=F;Z<oe.length;Z+=1){var ve=oe[Z];delete this.keyCache[ve],delete this._layerConfigs[ve],delete this._layers[ve]}this.familiesBySource={};for(var Ve=0,Ze=function(Ye,it){for(var Ut={},ot=0;ot<Ye.length;ot++){var er=it&&it[Ye[ot].id]||I(Ye[ot]);it&&(it[Ye[ot].id]=er);var cr=Ut[er];cr||(cr=Ut[er]=[]),cr.push(Ye[ot])}var Zt=[];for(var or in Ut)Zt.push(Ut[or]);return Zt}(a.values(this._layerConfigs),this.keyCache);Ve<Ze.length;Ve+=1){var Re=Ze[Ve].map(function(Ye){return q._layers[Ye.id]}),je=Re[0];if(je.visibility!=="none"){var ht=je.source||"",st=this.familiesBySource[ht];st||(st=this.familiesBySource[ht]={});var ze=je.sourceLayer||"_geojsonTileLayer",tt=st[ze];tt||(tt=st[ze]=[]),tt.push(Re)}}};var B=function(M){var F={},q=[];for(var Y in M){var re=M[Y],ue=F[Y]={};for(var ye in re){var Z=re[+ye];if(Z&&Z.bitmap.width!==0&&Z.bitmap.height!==0){var oe={x:0,y:0,w:Z.bitmap.width+2,h:Z.bitmap.height+2};q.push(oe),ue[ye]={rect:oe,metrics:Z.metrics}}}}var ve=a.potpack(q),Ve=new a.AlphaImage({width:ve.w||1,height:ve.h||1});for(var Ze in M){var Re=M[Ze];for(var je in Re){var ht=Re[+je];if(ht&&ht.bitmap.width!==0&&ht.bitmap.height!==0){var st=F[Ze][je].rect;a.AlphaImage.copy(ht.bitmap,Ve,{x:0,y:0},{x:st.x+1,y:st.y+1},ht.bitmap)}}}this.image=Ve,this.positions=F};a.register("GlyphAtlas",B);var G=function(M){this.tileID=new a.OverscaledTileID(M.tileID.overscaledZ,M.tileID.wrap,M.tileID.canonical.z,M.tileID.canonical.x,M.tileID.canonical.y),this.uid=M.uid,this.zoom=M.zoom,this.pixelRatio=M.pixelRatio,this.tileSize=M.tileSize,this.source=M.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=M.showCollisionBoxes,this.collectResourceTiming=!!M.collectResourceTiming,this.returnDependencies=!!M.returnDependencies,this.promoteId=M.promoteId};function j(M,F,q){for(var Y=new a.EvaluationParameters(F),re=0,ue=M;re<ue.length;re+=1)ue[re].recalculate(Y,q)}function H(M,F){var q=a.getArrayBuffer(M.request,function(Y,re,ue,ye){Y?F(Y):re&&F(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(re)),rawData:re,cacheControl:ue,expires:ye})});return function(){q.cancel(),F()}}G.prototype.parse=function(M,F,q,Y,re){var ue=this;this.status="parsing",this.data=M,this.collisionBoxArray=new a.CollisionBoxArray;var ye=new a.DictionaryCoder(Object.keys(M.layers).sort()),Z=new a.FeatureIndex(this.tileID,this.promoteId);Z.bucketLayerIDs=[];var oe,ve,Ve,Ze,Re={},je={featureIndex:Z,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},ht=F.familiesBySource[this.source];for(var st in ht){var ze=M.layers[st];if(ze){ze.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+st+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var tt=ye.encode(st),Ye=[],it=0;it<ze.length;it++){var Ut=ze.feature(it),ot=Z.getId(Ut,st);Ye.push({feature:Ut,id:ot,index:it,sourceLayerIndex:tt})}for(var er=0,cr=ht[st];er<cr.length;er+=1){var Zt=cr[er],or=Zt[0];or.minzoom&&this.zoom<Math.floor(or.minzoom)||or.maxzoom&&this.zoom>=or.maxzoom||or.visibility!=="none"&&(j(Zt,this.zoom,q),(Re[or.id]=or.createBucket({index:Z.bucketLayerIDs.length,layers:Zt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:tt,sourceID:this.source})).populate(Ye,je,this.tileID.canonical),Z.bucketLayerIDs.push(Zt.map(function(nr){return nr.id})))}}}var Jt=a.mapObject(je.glyphDependencies,function(nr){return Object.keys(nr).map(Number)});Object.keys(Jt).length?Y.send("getGlyphs",{uid:this.uid,stacks:Jt},function(nr,Gt){oe||(oe=nr,ve=Gt,Fr.call(ue))}):ve={};var ui=Object.keys(je.iconDependencies);ui.length?Y.send("getImages",{icons:ui,source:this.source,tileID:this.tileID,type:"icons"},function(nr,Gt){oe||(oe=nr,Ve=Gt,Fr.call(ue))}):Ve={};var fr=Object.keys(je.patternDependencies);function Fr(){if(oe)return re(oe);if(ve&&Ve&&Ze){var nr=new B(ve),Gt=new a.ImageAtlas(Ve,Ze);for(var ar in Re){var Ei=Re[ar];Ei instanceof a.SymbolBucket?(j(Ei.layers,this.zoom,q),a.performSymbolLayout(Ei,ve,nr.positions,Ve,Gt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ei.hasPattern&&(Ei instanceof a.LineBucket||Ei instanceof a.FillBucket||Ei instanceof a.FillExtrusionBucket)&&(j(Ei.layers,this.zoom,q),Ei.addFeatures(je,this.tileID.canonical,Gt.patternPositions))}this.status="done",re(null,{buckets:a.values(Re).filter(function(ko){return!ko.isEmpty()}),featureIndex:Z,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:nr.image,imageAtlas:Gt,glyphMap:this.returnDependencies?ve:null,iconMap:this.returnDependencies?Ve:null,glyphPositions:this.returnDependencies?nr.positions:null})}}fr.length?Y.send("getImages",{icons:fr,source:this.source,tileID:this.tileID,type:"patterns"},function(nr,Gt){oe||(oe=nr,Ze=Gt,Fr.call(ue))}):Ze={},Fr.call(this)};var de=function(M,F,q,Y){this.actor=M,this.layerIndex=F,this.availableImages=q,this.loadVectorData=Y||H,this.loading={},this.loaded={}};de.prototype.loadTile=function(M,F){var q=this,Y=M.uid;this.loading||(this.loading={});var re=!!(M&&M.request&&M.request.collectResourceTiming)&&new a.RequestPerformance(M.request),ue=this.loading[Y]=new G(M);ue.abort=this.loadVectorData(M,function(ye,Z){if(delete q.loading[Y],ye||!Z)return ue.status="done",q.loaded[Y]=ue,F(ye);var oe=Z.rawData,ve={};Z.expires&&(ve.expires=Z.expires),Z.cacheControl&&(ve.cacheControl=Z.cacheControl);var Ve={};if(re){var Ze=re.finish();Ze&&(Ve.resourceTiming=JSON.parse(JSON.stringify(Ze)))}ue.vectorTile=Z.vectorTile,ue.parse(Z.vectorTile,q.layerIndex,q.availableImages,q.actor,function(Re,je){if(Re||!je)return F(Re);F(null,a.extend({rawTileData:oe.slice(0)},je,ve,Ve))}),q.loaded=q.loaded||{},q.loaded[Y]=ue})},de.prototype.reloadTile=function(M,F){var q=this,Y=this.loaded,re=M.uid,ue=this;if(Y&&Y[re]){var ye=Y[re];ye.showCollisionBoxes=M.showCollisionBoxes;var Z=function(oe,ve){var Ve=ye.reloadCallback;Ve&&(delete ye.reloadCallback,ye.parse(ye.vectorTile,ue.layerIndex,q.availableImages,ue.actor,Ve)),F(oe,ve)};ye.status==="parsing"?ye.reloadCallback=Z:ye.status==="done"&&(ye.vectorTile?ye.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,Z):Z())}},de.prototype.abortTile=function(M,F){var q=this.loading,Y=M.uid;q&&q[Y]&&q[Y].abort&&(q[Y].abort(),delete q[Y]),F()},de.prototype.removeTile=function(M,F){var q=this.loaded,Y=M.uid;q&&q[Y]&&delete q[Y],F()};var Ce=a.window.ImageBitmap,xe=function(){this.loaded={}};function Xe(M,F){if(M.length!==0){Ue(M[0],F);for(var q=1;q<M.length;q++)Ue(M[q],!F)}}function Ue(M,F){for(var q=0,Y=0,re=M.length,ue=re-1;Y<re;ue=Y++)q+=(M[Y][0]-M[ue][0])*(M[ue][1]+M[Y][1]);q>=0!=!!F&&M.reverse()}xe.prototype.loadTile=function(M,F){var q=M.uid,Y=M.encoding,re=M.rawImageData,ue=Ce&&re instanceof Ce?this.getImageData(re):re,ye=new a.DEMData(q,ue,Y);this.loaded=this.loaded||{},this.loaded[q]=ye,F(null,ye)},xe.prototype.getImageData=function(M){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(M.width,M.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=M.width,this.offscreenCanvas.height=M.height,this.offscreenCanvasContext.drawImage(M,0,0,M.width,M.height);var F=this.offscreenCanvasContext.getImageData(-1,-1,M.width+2,M.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:F.width,height:F.height},F.data)},xe.prototype.removeTile=function(M){var F=this.loaded,q=M.uid;F&&F[q]&&delete F[q]};var Bt=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,St=function(M){this._feature=M,this.extent=a.EXTENT,this.type=M.type,this.properties=M.tags,"id"in M&&!isNaN(M.id)&&(this.id=parseInt(M.id,10))};St.prototype.loadGeometry=function(){if(this._feature.type===1){for(var M=[],F=0,q=this._feature.geometry;F<q.length;F+=1){var Y=q[F];M.push([new a.Point$1(Y[0],Y[1])])}return M}for(var re=[],ue=0,ye=this._feature.geometry;ue<ye.length;ue+=1){for(var Z=[],oe=0,ve=ye[ue];oe<ve.length;oe+=1){var Ve=ve[oe];Z.push(new a.Point$1(Ve[0],Ve[1]))}re.push(Z)}return re},St.prototype.toGeoJSON=function(M,F,q){return Bt.call(this,M,F,q)};var ut=function(M){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=M.length,this._features=M};ut.prototype.feature=function(M){return new St(this._features[M])};var We=a.vectorTile.VectorTileFeature,tr=Xt;function Xt(M,F){this.options=F||{},this.features=M,this.length=M.length}function xt(M,F){this.id=typeof M.id=="number"?M.id:void 0,this.type=M.type,this.rawGeometry=M.type===1?[M.geometry]:M.geometry,this.properties=M.tags,this.extent=F||4096}Xt.prototype.feature=function(M){return new xt(this.features[M],this.options.extent)},xt.prototype.loadGeometry=function(){var M=this.rawGeometry;this.geometry=[];for(var F=0;F<M.length;F++){for(var q=M[F],Y=[],re=0;re<q.length;re++)Y.push(new a.Point$1(q[re][0],q[re][1]));this.geometry.push(Y)}return this.geometry},xt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var M=this.geometry,F=1/0,q=-1/0,Y=1/0,re=-1/0,ue=0;ue<M.length;ue++)for(var ye=M[ue],Z=0;Z<ye.length;Z++){var oe=ye[Z];F=Math.min(F,oe.x),q=Math.max(q,oe.x),Y=Math.min(Y,oe.y),re=Math.max(re,oe.y)}return[F,Y,q,re]},xt.prototype.toGeoJSON=We.prototype.toGeoJSON;var qt=Rt,Ge=tr;function Rt(M){var F=new a.pbf;return function(q,Y){for(var re in q.layers)Y.writeMessage(3,yt,q.layers[re])}(M,F),F.finish()}function yt(M,F){var q;F.writeVarintField(15,M.version||1),F.writeStringField(1,M.name||""),F.writeVarintField(5,M.extent||4096);var Y={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<M.length;q++)Y.feature=M.feature(q),F.writeMessage(2,gt,Y);var re=Y.keys;for(q=0;q<re.length;q++)F.writeStringField(3,re[q]);var ue=Y.values;for(q=0;q<ue.length;q++)F.writeMessage(4,Wt,ue[q])}function gt(M,F){var q=M.feature;q.id!==void 0&&F.writeVarintField(1,q.id),F.writeMessage(2,Le,M),F.writeVarintField(3,q.type),F.writeMessage(4,mr,q)}function Le(M,F){var q=M.feature,Y=M.keys,re=M.values,ue=M.keycache,ye=M.valuecache;for(var Z in q.properties){var oe=ue[Z];oe===void 0&&(Y.push(Z),ue[Z]=oe=Y.length-1),F.writeVarint(oe);var ve=q.properties[Z],Ve=typeof ve;Ve!=="string"&&Ve!=="boolean"&&Ve!=="number"&&(ve=JSON.stringify(ve));var Ze=Ve+":"+ve,Re=ye[Ze];Re===void 0&&(re.push(ve),ye[Ze]=Re=re.length-1),F.writeVarint(Re)}}function Ne(M,F){return(F<<3)+(7&M)}function Et(M){return M<<1^M>>31}function mr(M,F){for(var q=M.loadGeometry(),Y=M.type,re=0,ue=0,ye=q.length,Z=0;Z<ye;Z++){var oe=q[Z],ve=1;Y===1&&(ve=oe.length),F.writeVarint(Ne(1,ve));for(var Ve=Y===3?oe.length-1:oe.length,Ze=0;Ze<Ve;Ze++){Ze===1&&Y!==1&&F.writeVarint(Ne(2,Ve-1));var Re=oe[Ze].x-re,je=oe[Ze].y-ue;F.writeVarint(Et(Re)),F.writeVarint(Et(je)),re+=Re,ue+=je}Y===3&&F.writeVarint(Ne(7,1))}}function Wt(M,F){var q=typeof M;q==="string"?F.writeStringField(1,M):q==="boolean"?F.writeBooleanField(7,M):q==="number"&&(M%1!=0?F.writeDoubleField(3,M):M<0?F.writeSVarintField(6,M):F.writeVarintField(5,M))}function qe(M,F,q,Y){$e(M,q,Y),$e(F,2*q,2*Y),$e(F,2*q+1,2*Y+1)}function $e(M,F,q){var Y=M[F];M[F]=M[q],M[q]=Y}function lr(M,F,q,Y){var re=M-q,ue=F-Y;return re*re+ue*ue}qt.fromVectorTileJs=Rt,qt.fromGeojsonVt=function(M,F){F=F||{};var q={};for(var Y in M)q[Y]=new tr(M[Y].features,F),q[Y].name=Y,q[Y].version=F.version,q[Y].extent=F.extent;return Rt({layers:q})},qt.GeoJSONWrapper=Ge;var gr=function(M){return M[0]},pi=function(M){return M[1]},ii=function(M,F,q,Y,re){F===void 0&&(F=gr),q===void 0&&(q=pi),Y===void 0&&(Y=64),re===void 0&&(re=Float64Array),this.nodeSize=Y,this.points=M;for(var ue=M.length<65536?Uint16Array:Uint32Array,ye=this.ids=new ue(M.length),Z=this.coords=new re(2*M.length),oe=0;oe<M.length;oe++)ye[oe]=oe,Z[2*oe]=F(M[oe]),Z[2*oe+1]=q(M[oe]);(function ve(Ve,Ze,Re,je,ht,st){if(!(ht-je<=Re)){var ze=je+ht>>1;(function tt(Ye,it,Ut,ot,er,cr){for(;er>ot;){if(er-ot>600){var Zt=er-ot+1,or=Ut-ot+1,Jt=Math.log(Zt),ui=.5*Math.exp(2*Jt/3),fr=.5*Math.sqrt(Jt*ui*(Zt-ui)/Zt)*(or-Zt/2<0?-1:1);tt(Ye,it,Ut,Math.max(ot,Math.floor(Ut-or*ui/Zt+fr)),Math.min(er,Math.floor(Ut+(Zt-or)*ui/Zt+fr)),cr)}var Fr=it[2*Ut+cr],nr=ot,Gt=er;for(qe(Ye,it,ot,Ut),it[2*er+cr]>Fr&&qe(Ye,it,ot,er);nr<Gt;){for(qe(Ye,it,nr,Gt),nr++,Gt--;it[2*nr+cr]<Fr;)nr++;for(;it[2*Gt+cr]>Fr;)Gt--}it[2*ot+cr]===Fr?qe(Ye,it,ot,Gt):qe(Ye,it,++Gt,er),Gt<=Ut&&(ot=Gt+1),Ut<=Gt&&(er=Gt-1)}})(Ve,Ze,ze,je,ht,st%2),ve(Ve,Ze,Re,je,ze-1,st+1),ve(Ve,Ze,Re,ze+1,ht,st+1)}})(ye,Z,Y,0,ye.length-1,0)};ii.prototype.range=function(M,F,q,Y){return function(re,ue,ye,Z,oe,ve,Ve){for(var Ze,Re,je=[0,re.length-1,0],ht=[];je.length;){var st=je.pop(),ze=je.pop(),tt=je.pop();if(ze-tt<=Ve)for(var Ye=tt;Ye<=ze;Ye++)Re=ue[2*Ye+1],(Ze=ue[2*Ye])>=ye&&Ze<=oe&&Re>=Z&&Re<=ve&&ht.push(re[Ye]);else{var it=Math.floor((tt+ze)/2);Re=ue[2*it+1],(Ze=ue[2*it])>=ye&&Ze<=oe&&Re>=Z&&Re<=ve&&ht.push(re[it]);var Ut=(st+1)%2;(st===0?ye<=Ze:Z<=Re)&&(je.push(tt),je.push(it-1),je.push(Ut)),(st===0?oe>=Ze:ve>=Re)&&(je.push(it+1),je.push(ze),je.push(Ut))}}return ht}(this.ids,this.coords,M,F,q,Y,this.nodeSize)},ii.prototype.within=function(M,F,q){return function(Y,re,ue,ye,Z,oe){for(var ve=[0,Y.length-1,0],Ve=[],Ze=Z*Z;ve.length;){var Re=ve.pop(),je=ve.pop(),ht=ve.pop();if(je-ht<=oe)for(var st=ht;st<=je;st++)lr(re[2*st],re[2*st+1],ue,ye)<=Ze&&Ve.push(Y[st]);else{var ze=Math.floor((ht+je)/2),tt=re[2*ze],Ye=re[2*ze+1];lr(tt,Ye,ue,ye)<=Ze&&Ve.push(Y[ze]);var it=(Re+1)%2;(Re===0?ue-Z<=tt:ye-Z<=Ye)&&(ve.push(ht),ve.push(ze-1),ve.push(it)),(Re===0?ue+Z>=tt:ye+Z>=Ye)&&(ve.push(ze+1),ve.push(je),ve.push(it))}}return Ve}(this.ids,this.coords,M,F,q,this.nodeSize)};var Zr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(M){return M}},Gr=function(M){this.options=ei(Object.create(Zr),M),this.trees=new Array(this.options.maxZoom+1)};function si(M,F,q,Y,re){return{x:M,y:F,zoom:1/0,id:q,parentId:-1,numPoints:Y,properties:re}}function kt(M,F){var q=M.geometry.coordinates,Y=q[1];return{x:Ht(q[0]),y:It(Y),zoom:1/0,index:F,parentId:-1}}function ur(M){return{type:"Feature",id:M.id,properties:wt(M),geometry:{type:"Point",coordinates:[(Y=M.x,360*(Y-.5)),(F=M.y,q=(180-360*F)*Math.PI/180,360*Math.atan(Math.exp(q))/Math.PI-90)]}};var F,q,Y}function wt(M){var F=M.numPoints,q=F>=1e4?Math.round(F/1e3)+"k":F>=1e3?Math.round(F/100)/10+"k":F;return ei(ei({},M.properties),{cluster:!0,cluster_id:M.id,point_count:F,point_count_abbreviated:q})}function Ht(M){return M/360+.5}function It(M){var F=Math.sin(M*Math.PI/180),q=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return q<0?0:q>1?1:q}function ei(M,F){for(var q in F)M[q]=F[q];return M}function Or(M){return M.x}function li(M){return M.y}function _n(M,F,q,Y,re,ue){var ye=re-q,Z=ue-Y;if(ye!==0||Z!==0){var oe=((M-q)*ye+(F-Y)*Z)/(ye*ye+Z*Z);oe>1?(q=re,Y=ue):oe>0&&(q+=ye*oe,Y+=Z*oe)}return(ye=M-q)*ye+(Z=F-Y)*Z}function Si(M,F,q,Y){var re={id:M===void 0?null:M,type:F,geometry:q,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ue){var ye=ue.geometry,Z=ue.type;if(Z==="Point"||Z==="MultiPoint"||Z==="LineString")tn(ue,ye);else if(Z==="Polygon"||Z==="MultiLineString")for(var oe=0;oe<ye.length;oe++)tn(ue,ye[oe]);else if(Z==="MultiPolygon")for(oe=0;oe<ye.length;oe++)for(var ve=0;ve<ye[oe].length;ve++)tn(ue,ye[oe][ve])}(re),re}function tn(M,F){for(var q=0;q<F.length;q+=3)M.minX=Math.min(M.minX,F[q]),M.minY=Math.min(M.minY,F[q+1]),M.maxX=Math.max(M.maxX,F[q]),M.maxY=Math.max(M.maxY,F[q+1])}function wr(M,F,q,Y){if(F.geometry){var re=F.geometry.coordinates,ue=F.geometry.type,ye=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),Z=[],oe=F.id;if(q.promoteId?oe=F.properties[q.promoteId]:q.generateId&&(oe=Y||0),ue==="Point")fi(re,Z);else if(ue==="MultiPoint")for(var ve=0;ve<re.length;ve++)fi(re[ve],Z);else if(ue==="LineString")Fi(re,Z,ye,!1);else if(ue==="MultiLineString"){if(q.lineMetrics){for(ve=0;ve<re.length;ve++)Fi(re[ve],Z=[],ye,!1),M.push(Si(oe,"LineString",Z,F.properties));return}Ni(re,Z,ye,!1)}else if(ue==="Polygon")Ni(re,Z,ye,!0);else{if(ue!=="MultiPolygon"){if(ue==="GeometryCollection"){for(ve=0;ve<F.geometry.geometries.length;ve++)wr(M,{id:oe,geometry:F.geometry.geometries[ve],properties:F.properties},q,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ve=0;ve<re.length;ve++){var Ve=[];Ni(re[ve],Ve,ye,!0),Z.push(Ve)}}M.push(Si(oe,ue,Z,F.properties))}}function fi(M,F){F.push(di(M[0])),F.push(oo(M[1])),F.push(0)}function Fi(M,F,q,Y){for(var re,ue,ye=0,Z=0;Z<M.length;Z++){var oe=di(M[Z][0]),ve=oo(M[Z][1]);F.push(oe),F.push(ve),F.push(0),Z>0&&(ye+=Y?(re*ve-oe*ue)/2:Math.sqrt(Math.pow(oe-re,2)+Math.pow(ve-ue,2))),re=oe,ue=ve}var Ve=F.length-3;F[2]=1,function Ze(Re,je,ht,st){for(var ze,tt=st,Ye=ht-je>>1,it=ht-je,Ut=Re[je],ot=Re[je+1],er=Re[ht],cr=Re[ht+1],Zt=je+3;Zt<ht;Zt+=3){var or=_n(Re[Zt],Re[Zt+1],Ut,ot,er,cr);if(or>tt)ze=Zt,tt=or;else if(or===tt){var Jt=Math.abs(Zt-Ye);Jt<it&&(ze=Zt,it=Jt)}}tt>st&&(ze-je>3&&Ze(Re,je,ze,st),Re[ze+2]=tt,ht-ze>3&&Ze(Re,ze,ht,st))}(F,0,Ve,q),F[Ve+2]=1,F.size=Math.abs(ye),F.start=0,F.end=F.size}function Ni(M,F,q,Y){for(var re=0;re<M.length;re++){var ue=[];Fi(M[re],ue,q,Y),F.push(ue)}}function di(M){return M/360+.5}function oo(M){var F=Math.sin(M*Math.PI/180),q=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return q<0?0:q>1?1:q}function Xi(M,F,q,Y,re,ue,ye,Z){if(Y/=F,ue>=(q/=F)&&ye<Y)return M;if(ye<q||ue>=Y)return null;for(var oe=[],ve=0;ve<M.length;ve++){var Ve=M[ve],Ze=Ve.geometry,Re=Ve.type,je=re===0?Ve.minX:Ve.minY,ht=re===0?Ve.maxX:Ve.maxY;if(je>=q&&ht<Y)oe.push(Ve);else if(!(ht<q||je>=Y)){var st=[];if(Re==="Point"||Re==="MultiPoint")vn(Ze,st,q,Y,re);else if(Re==="LineString")Xn(Ze,st,q,Y,re,!1,Z.lineMetrics);else if(Re==="MultiLineString")zn(Ze,st,q,Y,re,!1);else if(Re==="Polygon")zn(Ze,st,q,Y,re,!0);else if(Re==="MultiPolygon")for(var ze=0;ze<Ze.length;ze++){var tt=[];zn(Ze[ze],tt,q,Y,re,!0),tt.length&&st.push(tt)}if(st.length){if(Z.lineMetrics&&Re==="LineString"){for(ze=0;ze<st.length;ze++)oe.push(Si(Ve.id,Re,st[ze],Ve.tags));continue}Re!=="LineString"&&Re!=="MultiLineString"||(st.length===1?(Re="LineString",st=st[0]):Re="MultiLineString"),Re!=="Point"&&Re!=="MultiPoint"||(Re=st.length===3?"Point":"MultiPoint"),oe.push(Si(Ve.id,Re,st,Ve.tags))}}}return oe.length?oe:null}function vn(M,F,q,Y,re){for(var ue=0;ue<M.length;ue+=3){var ye=M[ue+re];ye>=q&&ye<=Y&&(F.push(M[ue]),F.push(M[ue+1]),F.push(M[ue+2]))}}function Xn(M,F,q,Y,re,ue,ye){for(var Z,oe,ve=Bo(M),Ve=re===0?ia:So,Ze=M.start,Re=0;Re<M.length-3;Re+=3){var je=M[Re],ht=M[Re+1],st=M[Re+2],ze=M[Re+3],tt=M[Re+4],Ye=re===0?je:ht,it=re===0?ze:tt,Ut=!1;ye&&(Z=Math.sqrt(Math.pow(je-ze,2)+Math.pow(ht-tt,2))),Ye<q?it>q&&(oe=Ve(ve,je,ht,ze,tt,q),ye&&(ve.start=Ze+Z*oe)):Ye>Y?it<Y&&(oe=Ve(ve,je,ht,ze,tt,Y),ye&&(ve.start=Ze+Z*oe)):Wn(ve,je,ht,st),it<q&&Ye>=q&&(oe=Ve(ve,je,ht,ze,tt,q),Ut=!0),it>Y&&Ye<=Y&&(oe=Ve(ve,je,ht,ze,tt,Y),Ut=!0),!ue&&Ut&&(ye&&(ve.end=Ze+Z*oe),F.push(ve),ve=Bo(M)),ye&&(Ze+=Z)}var ot=M.length-3;je=M[ot],ht=M[ot+1],st=M[ot+2],(Ye=re===0?je:ht)>=q&&Ye<=Y&&Wn(ve,je,ht,st),ot=ve.length-3,ue&&ot>=3&&(ve[ot]!==ve[0]||ve[ot+1]!==ve[1])&&Wn(ve,ve[0],ve[1],ve[2]),ve.length&&F.push(ve)}function Bo(M){var F=[];return F.size=M.size,F.start=M.start,F.end=M.end,F}function zn(M,F,q,Y,re,ue){for(var ye=0;ye<M.length;ye++)Xn(M[ye],F,q,Y,re,ue,!1)}function Wn(M,F,q,Y){M.push(F),M.push(q),M.push(Y)}function ia(M,F,q,Y,re,ue){var ye=(ue-F)/(Y-F);return M.push(ue),M.push(q+(re-q)*ye),M.push(1),ye}function So(M,F,q,Y,re,ue){var ye=(ue-q)/(re-q);return M.push(F+(Y-F)*ye),M.push(ue),M.push(1),ye}function Pn(M,F){for(var q=[],Y=0;Y<M.length;Y++){var re,ue=M[Y],ye=ue.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")re=Cn(ue.geometry,F);else if(ye==="MultiLineString"||ye==="Polygon"){re=[];for(var Z=0;Z<ue.geometry.length;Z++)re.push(Cn(ue.geometry[Z],F))}else if(ye==="MultiPolygon")for(re=[],Z=0;Z<ue.geometry.length;Z++){for(var oe=[],ve=0;ve<ue.geometry[Z].length;ve++)oe.push(Cn(ue.geometry[Z][ve],F));re.push(oe)}q.push(Si(ue.id,ye,re,ue.tags))}return q}function Cn(M,F){var q=[];q.size=M.size,M.start!==void 0&&(q.start=M.start,q.end=M.end);for(var Y=0;Y<M.length;Y+=3)q.push(M[Y]+F,M[Y+1],M[Y+2]);return q}function Eo(M,F){if(M.transformed)return M;var q,Y,re,ue=1<<M.z,ye=M.x,Z=M.y;for(q=0;q<M.features.length;q++){var oe=M.features[q],ve=oe.geometry,Ve=oe.type;if(oe.geometry=[],Ve===1)for(Y=0;Y<ve.length;Y+=2)oe.geometry.push(Oo(ve[Y],ve[Y+1],F,ue,ye,Z));else for(Y=0;Y<ve.length;Y++){var Ze=[];for(re=0;re<ve[Y].length;re+=2)Ze.push(Oo(ve[Y][re],ve[Y][re+1],F,ue,ye,Z));oe.geometry.push(Ze)}}return M.transformed=!0,M}function Oo(M,F,q,Y,re,ue){return[Math.round(q*(M*Y-re)),Math.round(q*(F*Y-ue))]}function na(M,F,q,Y,re){for(var ue=F===re.maxZoom?0:re.tolerance/((1<<F)*re.extent),ye={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:Y,z:F,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Z=0;Z<M.length;Z++){ye.numFeatures++,Fo(ye,M[Z],ue,re);var oe=M[Z].minX,ve=M[Z].minY,Ve=M[Z].maxX,Ze=M[Z].maxY;oe<ye.minX&&(ye.minX=oe),ve<ye.minY&&(ye.minY=ve),Ve>ye.maxX&&(ye.maxX=Ve),Ze>ye.maxY&&(ye.maxY=Ze)}return ye}function Fo(M,F,q,Y){var re=F.geometry,ue=F.type,ye=[];if(ue==="Point"||ue==="MultiPoint")for(var Z=0;Z<re.length;Z+=3)ye.push(re[Z]),ye.push(re[Z+1]),M.numPoints++,M.numSimplified++;else if(ue==="LineString")ao(ye,re,M,q,!1,!1);else if(ue==="MultiLineString"||ue==="Polygon")for(Z=0;Z<re.length;Z++)ao(ye,re[Z],M,q,ue==="Polygon",Z===0);else if(ue==="MultiPolygon")for(var oe=0;oe<re.length;oe++){var ve=re[oe];for(Z=0;Z<ve.length;Z++)ao(ye,ve[Z],M,q,!0,Z===0)}if(ye.length){var Ve=F.tags||null;if(ue==="LineString"&&Y.lineMetrics){for(var Ze in Ve={},F.tags)Ve[Ze]=F.tags[Ze];Ve.mapbox_clip_start=re.start/re.size,Ve.mapbox_clip_end=re.end/re.size}var Re={geometry:ye,type:ue==="Polygon"||ue==="MultiPolygon"?3:ue==="LineString"||ue==="MultiLineString"?2:1,tags:Ve};F.id!==null&&(Re.id=F.id),M.features.push(Re)}}function ao(M,F,q,Y,re,ue){var ye=Y*Y;if(Y>0&&F.size<(re?ye:Y))q.numPoints+=F.length/3;else{for(var Z=[],oe=0;oe<F.length;oe+=3)(Y===0||F[oe+2]>ye)&&(q.numSimplified++,Z.push(F[oe]),Z.push(F[oe+1])),q.numPoints++;re&&function(ve,Ve){for(var Ze=0,Re=0,je=ve.length,ht=je-2;Re<je;ht=Re,Re+=2)Ze+=(ve[Re]-ve[ht])*(ve[Re+1]+ve[ht+1]);if(Ze>0===Ve)for(Re=0,je=ve.length;Re<je/2;Re+=2){var st=ve[Re],ze=ve[Re+1];ve[Re]=ve[je-2-Re],ve[Re+1]=ve[je-1-Re],ve[je-2-Re]=st,ve[je-1-Re]=ze}}(Z,ue),M.push(Z)}}function Kr(M,F){var q=(F=this.options=function(re,ue){for(var ye in ue)re[ye]=ue[ye];return re}(Object.create(this.options),F)).debug;if(q&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");var Y=function(re,ue){var ye=[];if(re.type==="FeatureCollection")for(var Z=0;Z<re.features.length;Z++)wr(ye,re.features[Z],ue,Z);else wr(ye,re.type==="Feature"?re:{geometry:re},ue);return ye}(M,F);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Y=function(re,ue){var ye=ue.buffer/ue.extent,Z=re,oe=Xi(re,1,-1-ye,ye,0,-1,2,ue),ve=Xi(re,1,1-ye,2+ye,0,-1,2,ue);return(oe||ve)&&(Z=Xi(re,1,-ye,1+ye,0,-1,2,ue)||[],oe&&(Z=Pn(oe,1).concat(Z)),ve&&(Z=Z.concat(Pn(ve,-1)))),Z}(Y,F)).length&&this.splitTile(Y,0,0,0),q&&(Y.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function mi(M,F,q){return 32*((1<<M)*q+F)+M}function rn(M,F){var q=M.tileID.canonical;if(!this._geoJSONIndex)return F(null,null);var Y=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!Y)return F(null,null);var re=new ut(Y.features),ue=qt(re);ue.byteOffset===0&&ue.byteLength===ue.buffer.byteLength||(ue=new Uint8Array(ue)),F(null,{vectorTile:re,rawData:ue.buffer})}Gr.prototype.load=function(M){var F=this.options,q=F.log,Y=F.minZoom,re=F.maxZoom,ue=F.nodeSize;q&&console.time("total time");var ye="prepare "+M.length+" points";q&&console.time(ye),this.points=M;for(var Z=[],oe=0;oe<M.length;oe++)M[oe].geometry&&Z.push(kt(M[oe],oe));this.trees[re+1]=new ii(Z,Or,li,ue,Float32Array),q&&console.timeEnd(ye);for(var ve=re;ve>=Y;ve--){var Ve=+Date.now();Z=this._cluster(Z,ve),this.trees[ve]=new ii(Z,Or,li,ue,Float32Array),q&&console.log("z%d: %d clusters in %dms",ve,Z.length,+Date.now()-Ve)}return q&&console.timeEnd("total time"),this},Gr.prototype.getClusters=function(M,F){var q=((M[0]+180)%360+360)%360-180,Y=Math.max(-90,Math.min(90,M[1])),re=M[2]===180?180:((M[2]+180)%360+360)%360-180,ue=Math.max(-90,Math.min(90,M[3]));if(M[2]-M[0]>=360)q=-180,re=180;else if(q>re){var ye=this.getClusters([q,Y,180,ue],F),Z=this.getClusters([-180,Y,re,ue],F);return ye.concat(Z)}for(var oe=this.trees[this._limitZoom(F)],ve=[],Ve=0,Ze=oe.range(Ht(q),It(ue),Ht(re),It(Y));Ve<Ze.length;Ve+=1){var Re=oe.points[Ze[Ve]];ve.push(Re.numPoints?ur(Re):this.points[Re.index])}return ve},Gr.prototype.getChildren=function(M){var F=this._getOriginId(M),q=this._getOriginZoom(M),Y="No cluster with the specified id.",re=this.trees[q];if(!re)throw new Error(Y);var ue=re.points[F];if(!ue)throw new Error(Y);for(var ye=this.options.radius/(this.options.extent*Math.pow(2,q-1)),Z=[],oe=0,ve=re.within(ue.x,ue.y,ye);oe<ve.length;oe+=1){var Ve=re.points[ve[oe]];Ve.parentId===M&&Z.push(Ve.numPoints?ur(Ve):this.points[Ve.index])}if(Z.length===0)throw new Error(Y);return Z},Gr.prototype.getLeaves=function(M,F,q){var Y=[];return this._appendLeaves(Y,M,F=F||10,q=q||0,0),Y},Gr.prototype.getTile=function(M,F,q){var Y=this.trees[this._limitZoom(M)],re=Math.pow(2,M),ue=this.options,ye=ue.radius/ue.extent,Z=(q-ye)/re,oe=(q+1+ye)/re,ve={features:[]};return this._addTileFeatures(Y.range((F-ye)/re,Z,(F+1+ye)/re,oe),Y.points,F,q,re,ve),F===0&&this._addTileFeatures(Y.range(1-ye/re,Z,1,oe),Y.points,re,q,re,ve),F===re-1&&this._addTileFeatures(Y.range(0,Z,ye/re,oe),Y.points,-1,q,re,ve),ve.features.length?ve:null},Gr.prototype.getClusterExpansionZoom=function(M){for(var F=this._getOriginZoom(M)-1;F<=this.options.maxZoom;){var q=this.getChildren(M);if(F++,q.length!==1)break;M=q[0].properties.cluster_id}return F},Gr.prototype._appendLeaves=function(M,F,q,Y,re){for(var ue=0,ye=this.getChildren(F);ue<ye.length;ue+=1){var Z=ye[ue],oe=Z.properties;if(oe&&oe.cluster?re+oe.point_count<=Y?re+=oe.point_count:re=this._appendLeaves(M,oe.cluster_id,q,Y,re):re<Y?re++:M.push(Z),M.length===q)break}return re},Gr.prototype._addTileFeatures=function(M,F,q,Y,re,ue){for(var ye=0,Z=M;ye<Z.length;ye+=1){var oe=F[Z[ye]],ve=oe.numPoints,Ve={type:1,geometry:[[Math.round(this.options.extent*(oe.x*re-q)),Math.round(this.options.extent*(oe.y*re-Y))]],tags:ve?wt(oe):this.points[oe.index].properties},Ze=void 0;ve?Ze=oe.id:this.options.generateId?Ze=oe.index:this.points[oe.index].id&&(Ze=this.points[oe.index].id),Ze!==void 0&&(Ve.id=Ze),ue.features.push(Ve)}},Gr.prototype._limitZoom=function(M){return Math.max(this.options.minZoom,Math.min(+M,this.options.maxZoom+1))},Gr.prototype._cluster=function(M,F){for(var q=[],Y=this.options,re=Y.reduce,ue=Y.minPoints,ye=Y.radius/(Y.extent*Math.pow(2,F)),Z=0;Z<M.length;Z++){var oe=M[Z];if(!(oe.zoom<=F)){oe.zoom=F;for(var ve=this.trees[F+1],Ve=ve.within(oe.x,oe.y,ye),Ze=oe.numPoints||1,Re=Ze,je=0,ht=Ve;je<ht.length;je+=1){var st=ve.points[ht[je]];st.zoom>F&&(Re+=st.numPoints||1)}if(Re>=ue){for(var ze=oe.x*Ze,tt=oe.y*Ze,Ye=re&&Ze>1?this._map(oe,!0):null,it=(Z<<5)+(F+1)+this.points.length,Ut=0,ot=Ve;Ut<ot.length;Ut+=1){var er=ve.points[ot[Ut]];if(!(er.zoom<=F)){er.zoom=F;var cr=er.numPoints||1;ze+=er.x*cr,tt+=er.y*cr,er.parentId=it,re&&(Ye||(Ye=this._map(oe,!0)),re(Ye,this._map(er)))}}oe.parentId=it,q.push(si(ze/Re,tt/Re,it,Re,Ye))}else if(q.push(oe),Re>1)for(var Zt=0,or=Ve;Zt<or.length;Zt+=1){var Jt=ve.points[or[Zt]];Jt.zoom<=F||(Jt.zoom=F,q.push(Jt))}}}return q},Gr.prototype._getOriginId=function(M){return M-this.points.length>>5},Gr.prototype._getOriginZoom=function(M){return(M-this.points.length)%32},Gr.prototype._map=function(M,F){if(M.numPoints)return F?ei({},M.properties):M.properties;var q=this.points[M.index].properties,Y=this.options.map(q);return F&&Y===q?ei({},Y):Y},Kr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Kr.prototype.splitTile=function(M,F,q,Y,re,ue,ye){for(var Z=[M,F,q,Y],oe=this.options,ve=oe.debug;Z.length;){Y=Z.pop(),q=Z.pop(),F=Z.pop(),M=Z.pop();var Ve=1<<F,Ze=mi(F,q,Y),Re=this.tiles[Ze];if(!Re&&(ve>1&&console.time("creation"),Re=this.tiles[Ze]=na(M,F,q,Y,oe),this.tileCoords.push({z:F,x:q,y:Y}),ve)){ve>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,q,Y,Re.numFeatures,Re.numPoints,Re.numSimplified),console.timeEnd("creation"));var je="z"+F;this.stats[je]=(this.stats[je]||0)+1,this.total++}if(Re.source=M,re){if(F===oe.maxZoom||F===re)continue;var ht=1<<re-F;if(q!==Math.floor(ue/ht)||Y!==Math.floor(ye/ht))continue}else if(F===oe.indexMaxZoom||Re.numPoints<=oe.indexMaxPoints)continue;if(Re.source=null,M.length!==0){ve>1&&console.time("clipping");var st,ze,tt,Ye,it,Ut,ot=.5*oe.buffer/oe.extent,er=.5-ot,cr=.5+ot,Zt=1+ot;st=ze=tt=Ye=null,it=Xi(M,Ve,q-ot,q+cr,0,Re.minX,Re.maxX,oe),Ut=Xi(M,Ve,q+er,q+Zt,0,Re.minX,Re.maxX,oe),M=null,it&&(st=Xi(it,Ve,Y-ot,Y+cr,1,Re.minY,Re.maxY,oe),ze=Xi(it,Ve,Y+er,Y+Zt,1,Re.minY,Re.maxY,oe),it=null),Ut&&(tt=Xi(Ut,Ve,Y-ot,Y+cr,1,Re.minY,Re.maxY,oe),Ye=Xi(Ut,Ve,Y+er,Y+Zt,1,Re.minY,Re.maxY,oe),Ut=null),ve>1&&console.timeEnd("clipping"),Z.push(st||[],F+1,2*q,2*Y),Z.push(ze||[],F+1,2*q,2*Y+1),Z.push(tt||[],F+1,2*q+1,2*Y),Z.push(Ye||[],F+1,2*q+1,2*Y+1)}}},Kr.prototype.getTile=function(M,F,q){var Y=this.options,re=Y.extent,ue=Y.debug;if(M<0||M>24)return null;var ye=1<<M,Z=mi(M,F=(F%ye+ye)%ye,q);if(this.tiles[Z])return Eo(this.tiles[Z],re);ue>1&&console.log("drilling down to z%d-%d-%d",M,F,q);for(var oe,ve=M,Ve=F,Ze=q;!oe&&ve>0;)ve--,Ve=Math.floor(Ve/2),Ze=Math.floor(Ze/2),oe=this.tiles[mi(ve,Ve,Ze)];return oe&&oe.source?(ue>1&&console.log("found parent tile z%d-%d-%d",ve,Ve,Ze),ue>1&&console.time("drilling down"),this.splitTile(oe.source,ve,Ve,Ze,M,F,q),ue>1&&console.timeEnd("drilling down"),this.tiles[Z]?Eo(this.tiles[Z],re):null):null};var so=function(M){function F(q,Y,re,ue){M.call(this,q,Y,re,rn),ue&&(this.loadGeoJSON=ue)}return M&&(F.__proto__=M),(F.prototype=Object.create(M&&M.prototype)).constructor=F,F.prototype.loadData=function(q,Y){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Y,this._pendingLoadDataParams=q,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},F.prototype._loadData=function(){var q=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Y=this._pendingCallback,re=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ue=!!(re&&re.request&&re.request.collectResourceTiming)&&new a.RequestPerformance(re.request);this.loadGeoJSON(re,function(ye,Z){if(ye||!Z)return Y(ye);if(typeof Z!="object")return Y(new Error("Input data given to '"+re.source+"' is not a valid GeoJSON object."));(function Re(je,ht){var st,ze=je&&je.type;if(ze==="FeatureCollection")for(st=0;st<je.features.length;st++)Re(je.features[st],ht);else if(ze==="GeometryCollection")for(st=0;st<je.geometries.length;st++)Re(je.geometries[st],ht);else if(ze==="Feature")Re(je.geometry,ht);else if(ze==="Polygon")Xe(je.coordinates,ht);else if(ze==="MultiPolygon")for(st=0;st<je.coordinates.length;st++)Xe(je.coordinates[st],ht);return je})(Z,!0);try{if(re.filter){var oe=a.createExpression(re.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(oe.result==="error")throw new Error(oe.value.map(function(Re){return Re.key+": "+Re.message}).join(", "));var ve=Z.features.filter(function(Re){return oe.value.evaluate({zoom:0},Re)});Z={type:"FeatureCollection",features:ve}}q._geoJSONIndex=re.cluster?new Gr(function(Re){var je=Re.superclusterOptions,ht=Re.clusterProperties;if(!ht||!je)return je;for(var st={},ze={},tt={accumulated:null,zoom:0},Ye={properties:null},it=Object.keys(ht),Ut=0,ot=it;Ut<ot.length;Ut+=1){var er=ot[Ut],cr=ht[er],Zt=cr[0],or=a.createExpression(cr[1]),Jt=a.createExpression(typeof Zt=="string"?[Zt,["accumulated"],["get",er]]:Zt);st[er]=or.value,ze[er]=Jt.value}return je.map=function(ui){Ye.properties=ui;for(var fr={},Fr=0,nr=it;Fr<nr.length;Fr+=1){var Gt=nr[Fr];fr[Gt]=st[Gt].evaluate(tt,Ye)}return fr},je.reduce=function(ui,fr){Ye.properties=fr;for(var Fr=0,nr=it;Fr<nr.length;Fr+=1){var Gt=nr[Fr];tt.accumulated=ui[Gt],ui[Gt]=ze[Gt].evaluate(tt,Ye)}},je}(re)).load(Z.features):function(Re,je){return new Kr(Re,je)}(Z,re.geojsonVtOptions)}catch(Re){return Y(Re)}q.loaded={};var Ve={};if(ue){var Ze=ue.finish();Ze&&(Ve.resourceTiming={},Ve.resourceTiming[re.source]=JSON.parse(JSON.stringify(Ze)))}Y(null,Ve)})}},F.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},F.prototype.reloadTile=function(q,Y){var re=this.loaded;return re&&re[q.uid]?M.prototype.reloadTile.call(this,q,Y):this.loadTile(q,Y)},F.prototype.loadGeoJSON=function(q,Y){if(q.request)a.getJSON(q.request,Y);else{if(typeof q.data!="string")return Y(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."));try{return Y(null,JSON.parse(q.data))}catch{return Y(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."))}}},F.prototype.removeSource=function(q,Y){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Y()},F.prototype.getClusterExpansionZoom=function(q,Y){try{Y(null,this._geoJSONIndex.getClusterExpansionZoom(q.clusterId))}catch(re){Y(re)}},F.prototype.getClusterChildren=function(q,Y){try{Y(null,this._geoJSONIndex.getChildren(q.clusterId))}catch(re){Y(re)}},F.prototype.getClusterLeaves=function(q,Y){try{Y(null,this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset))}catch(re){Y(re)}},F}(de),xr=function(M){var F=this;this.self=M,this.actor=new a.Actor(M,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:de,geojson:so},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(q,Y){if(F.workerSourceTypes[q])throw new Error('Worker source with name "'+q+'" already registered.');F.workerSourceTypes[q]=Y},this.self.registerRTLTextPlugin=function(q){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=q.applyArabicShaping,a.plugin.processBidirectionalText=q.processBidirectionalText,a.plugin.processStyledBidirectionalText=q.processStyledBidirectionalText}};return xr.prototype.setReferrer=function(M,F){this.referrer=F},xr.prototype.setImages=function(M,F,q){for(var Y in this.availableImages[M]=F,this.workerSources[M]){var re=this.workerSources[M][Y];for(var ue in re)re[ue].availableImages=F}q()},xr.prototype.setLayers=function(M,F,q){this.getLayerIndex(M).replace(F),q()},xr.prototype.updateLayers=function(M,F,q){this.getLayerIndex(M).update(F.layers,F.removedIds),q()},xr.prototype.loadTile=function(M,F,q){this.getWorkerSource(M,F.type,F.source).loadTile(F,q)},xr.prototype.loadDEMTile=function(M,F,q){this.getDEMWorkerSource(M,F.source).loadTile(F,q)},xr.prototype.reloadTile=function(M,F,q){this.getWorkerSource(M,F.type,F.source).reloadTile(F,q)},xr.prototype.abortTile=function(M,F,q){this.getWorkerSource(M,F.type,F.source).abortTile(F,q)},xr.prototype.removeTile=function(M,F,q){this.getWorkerSource(M,F.type,F.source).removeTile(F,q)},xr.prototype.removeDEMTile=function(M,F){this.getDEMWorkerSource(M,F.source).removeTile(F)},xr.prototype.removeSource=function(M,F,q){if(this.workerSources[M]&&this.workerSources[M][F.type]&&this.workerSources[M][F.type][F.source]){var Y=this.workerSources[M][F.type][F.source];delete this.workerSources[M][F.type][F.source],Y.removeSource!==void 0?Y.removeSource(F,q):q()}},xr.prototype.loadWorkerSource=function(M,F,q){try{this.self.importScripts(F.url),q()}catch(Y){q(Y.toString())}},xr.prototype.syncRTLPluginState=function(M,F,q){try{a.plugin.setState(F);var Y=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&Y!=null){this.self.importScripts(Y);var re=a.plugin.isParsed();q(re?void 0:new Error("RTL Text Plugin failed to import scripts from "+Y),re)}}catch(ue){q(ue.toString())}},xr.prototype.getAvailableImages=function(M){var F=this.availableImages[M];return F||(F=[]),F},xr.prototype.getLayerIndex=function(M){var F=this.layerIndexes[M];return F||(F=this.layerIndexes[M]=new R),F},xr.prototype.getWorkerSource=function(M,F,q){var Y=this;return this.workerSources[M]||(this.workerSources[M]={}),this.workerSources[M][F]||(this.workerSources[M][F]={}),this.workerSources[M][F][q]||(this.workerSources[M][F][q]=new this.workerSourceTypes[F]({send:function(re,ue,ye){Y.actor.send(re,ue,ye,M)}},this.getLayerIndex(M),this.getAvailableImages(M))),this.workerSources[M][F][q]},xr.prototype.getDEMWorkerSource=function(M,F){return this.demWorkerSources[M]||(this.demWorkerSources[M]={}),this.demWorkerSources[M][F]||(this.demWorkerSources[M][F]=new xe),this.demWorkerSources[M][F]},xr.prototype.enforceCacheSizeLimit=function(M,F){a.enforceCacheSizeLimit(F)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new xr(self)),xr}),x(["./shared"],function(a){var A=a.createCommonjsModule(function(n){function s(m){return!o(m)}function o(m){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,k,P=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(P);try{k=new Worker(L),S=!0}catch{S=!1}return k&&k.terminate(),URL.revokeObjectURL(L),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var k=S.getContext("2d");if(!k)return!1;var P=k.getImageData(0,0,1,1);return P&&P.width===S.width}()?(u[w=m&&m.failIfMajorPerformanceCaveat]===void 0&&(u[w]=function(S){var k=function(L){var X=document.createElement("canvas"),W=Object.create(s.webGLContextAttributes);return W.failIfMajorPerformanceCaveat=L,X.probablySupportsContext?X.probablySupportsContext("webgl",W)||X.probablySupportsContext("experimental-webgl",W):X.supportsContext?X.supportsContext("webgl",W)||X.supportsContext("experimental-webgl",W):X.getContext("webgl",W)||X.getContext("experimental-webgl",W)}(S);if(!k)return!1;var P=k.createShader(k.VERTEX_SHADER);return!(!P||k.isContextLost())&&(k.shaderSource(P,"void main() {}"),k.compileShader(P),k.getShaderParameter(P,k.COMPILE_STATUS)===!0)}(w)),u[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var u={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),I={create:function(n,s,o){var u=a.window.document.createElement(n);return s!==void 0&&(u.className=s),o&&o.appendChild(u),u},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},R=a.window.document&&a.window.document.documentElement.style;function B(n){if(!R)return n[0];for(var s=0;s<n.length;s++)if(n[s]in R)return n[s];return n[0]}var G,j=B(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);I.disableDrag=function(){R&&j&&(G=R[j],R[j]="none")},I.enableDrag=function(){R&&j&&(R[j]=G)};var H=B(["transform","WebkitTransform"]);I.setTransform=function(n,s){n.style[H]=s};var de=!1;try{var Ce=Object.defineProperty({},"passive",{get:function(){de=!0}});a.window.addEventListener("test",Ce,Ce),a.window.removeEventListener("test",Ce,Ce)}catch{de=!1}I.addEventListener=function(n,s,o,u){u===void 0&&(u={}),n.addEventListener(s,o,"passive"in u&&de?u:u.capture)},I.removeEventListener=function(n,s,o,u){u===void 0&&(u={}),n.removeEventListener(s,o,"passive"in u&&de?u:u.capture)};var xe=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",xe,!0)};function Xe(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}I.suppressClick=function(){a.window.addEventListener("click",xe,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",xe,!0)},0)},I.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},I.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),u=[],m=0;m<s.length;m++)u.push(new a.Point(s[m].clientX-o.left-n.clientLeft,s[m].clientY-o.top-n.clientTop));return u},I.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},I.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var Ue=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var u=0,m=this.requestors;u<m.length;u+=1){var w=m[u];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,u){this._validate(o,u)&&(this.images[o]=u)},s.prototype._validate=function(o,u){var m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),m=!1),this._validateContent(u.content,u)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),m=!1),m},s.prototype._validateStretch=function(o,u){if(!o)return!0;for(var m=0,w=0,S=o;w<S.length;w+=1){var k=S[w];if(k[0]<m||k[1]<k[0]||u<k[1])return!1;m=k[1]}return!0},s.prototype._validateContent=function(o,u){return!(o&&(o.length!==4||o[0]<0||u.data.width<o[0]||o[1]<0||u.data.height<o[1]||o[2]<0||u.data.width<o[2]||o[3]<0||u.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,u){u.version=this.images[o].version+1,this.images[o]=u,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,u){var m=!0;if(!this.isLoaded())for(var w=0,S=o;w<S.length;w+=1)this.images[S[w]]||(m=!1);this.isLoaded()||m?this._notify(o,u):this.requestors.push({ids:o,callback:u})},s.prototype._notify=function(o,u){for(var m={},w=0,S=o;w<S.length;w+=1){var k=S[w];this.images[k]||this.fire(new a.Event("styleimagemissing",{id:k}));var P=this.images[k];P?m[k]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:Boolean(P.userImage&&P.userImage.render)}:a.warnOnce('Image "'+k+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}u(null,m)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var u=this.patterns[o],m=this.getImage(o);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{var w={w:m.data.width+2,h:m.data.height+2,x:0,y:0},S=new a.ImagePosition(w,m);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var u in this.patterns)o.push(this.patterns[u].bin);var m=a.potpack(o),w=m.w,S=m.h,k=this.atlasImage;for(var P in k.resize({width:w||1,height:S||1}),this.patterns){var L=this.patterns[P].bin,X=L.x+1,W=L.y+1,J=this.images[P].data,ee=J.width,ie=J.height;a.RGBAImage.copy(J,k,{x:0,y:0},{x:X,y:W},{width:ee,height:ie}),a.RGBAImage.copy(J,k,{x:0,y:ie-1},{x:X,y:W-1},{width:ee,height:1}),a.RGBAImage.copy(J,k,{x:0,y:0},{x:X,y:W+ie},{width:ee,height:1}),a.RGBAImage.copy(J,k,{x:ee-1,y:0},{x:X-1,y:W},{width:1,height:ie}),a.RGBAImage.copy(J,k,{x:0,y:0},{x:X+ee,y:W},{width:1,height:ie})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var u=0,m=o;u<m.length;u+=1){var w=m[u];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var S=this.images[w];Xe(S)&&this.updateImage(w,S)}}},s}(a.Evented),Bt=We,St=We,ut=1e20;function We(n,s,o,u,m,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=u||.25,this.fontFamily=m||"sans-serif",this.fontWeight=w||"normal",this.radius=o||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function tr(n,s,o,u,m,w,S){for(var k=0;k<s;k++){for(var P=0;P<o;P++)u[P]=n[P*s+k];for(Xt(u,m,w,S,o),P=0;P<o;P++)n[P*s+k]=m[P]}for(P=0;P<o;P++){for(k=0;k<s;k++)u[k]=n[P*s+k];for(Xt(u,m,w,S,s),k=0;k<s;k++)n[P*s+k]=Math.sqrt(m[k])}}function Xt(n,s,o,u,m){o[0]=0,u[0]=-ut,u[1]=+ut;for(var w=1,S=0;w<m;w++){for(var k=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);k<=u[S];)S--,k=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);o[++S]=w,u[S]=k,u[S+1]=+ut}for(w=0,S=0;w<m;w++){for(;u[S+1]<w;)S++;s[w]=(w-o[S])*(w-o[S])+n[o[S]]}}We.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),u=0;u<this.size*this.size;u++){var m=s.data[4*u+3]/255;this.gridOuter[u]=m===1?0:m===0?ut:Math.pow(Math.max(0,.5-m),2),this.gridInner[u]=m===1?ut:m===0?0:Math.pow(Math.max(0,m-.5),2)}for(tr(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),tr(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),u=0;u<this.size*this.size;u++)o[u]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[u]-this.gridInner[u])/this.radius+this.cutoff))));return o},Bt.default=St;var xt=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};xt.prototype.setURL=function(n){this.url=n},xt.prototype.getGlyphs=function(n,s){var o=this,u=[];for(var m in n)for(var w=0,S=n[m];w<S.length;w+=1)u.push({stack:m,id:S[w]});a.asyncAll(u,function(k,P){var L=k.stack,X=k.id,W=o.entries[L];W||(W=o.entries[L]={glyphs:{},requests:{},ranges:{}});var J=W.glyphs[X];if(J===void 0){if(J=o._tinySDF(W,L,X))return W.glyphs[X]=J,void P(null,{stack:L,id:X,glyph:J});var ee=Math.floor(X/256);if(256*ee>65535)P(new Error("glyphs > 65535 not supported"));else if(W.ranges[ee])P(null,{stack:L,id:X,glyph:J});else{var ie=W.requests[ee];ie||(ie=W.requests[ee]=[],xt.loadGlyphRange(L,ee,o.url,o.requestManager,function(se,$){if($){for(var le in $)o._doesCharSupportLocalGlyph(+le)||(W.glyphs[+le]=$[+le]);W.ranges[ee]=!0}for(var me=0,be=ie;me<be.length;me+=1)(0,be[me])(se,$);delete W.requests[ee]})),ie.push(function(se,$){se?P(se):$&&P(null,{stack:L,id:X,glyph:$[X]||null})})}}else P(null,{stack:L,id:X,glyph:J})},function(k,P){if(k)s(k);else if(P){for(var L={},X=0,W=P;X<W.length;X+=1){var J=W[X],ee=J.stack,ie=J.id,se=J.glyph;(L[ee]||(L[ee]={}))[ie]=se&&{id:se.id,bitmap:se.bitmap.clone(),metrics:se.metrics}}s(null,L)}})},xt.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},xt.prototype._tinySDF=function(n,s,o){var u=this.localIdeographFontFamily;if(u&&this._doesCharSupportLocalGlyph(o)){var m=n.tinySDF;if(!m){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),m=n.tinySDF=new xt.TinySDF(24,3,8,.25,u,w)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},m.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},xt.loadGlyphRange=function(n,s,o,u,m){var w=256*s,S=w+255,k=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",w+"-"+S),a.ResourceType.Glyphs);a.getArrayBuffer(k,function(P,L){if(P)m(P);else if(L){for(var X={},W=0,J=a.parseGlyphPBF(L);W<J.length;W+=1){var ee=J[W];X[ee.id]=ee}m(null,X)}})},xt.TinySDF=Bt;var qt=function(){this.specification=a.styleSpec.light.position};qt.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},qt.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var Ge=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new qt,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),Rt=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(Ge),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,u){if(u===void 0&&(u={}),!this._validate(a.validateLight,o,u))for(var m in o){var w=o[m];a.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),w):this._transitionable.setValue(m,w)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,u,m){return(!m||m.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),yt=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};yt.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},yt.prototype.getDashRanges=function(n,s,o){var u=[],m=n.length%2==1?-n[n.length-1]*o:0,w=n[0]*o,S=!0;u.push({left:m,right:w,isDash:S,zeroLength:n[0]===0});for(var k=n[0],P=1;P<n.length;P++){var L=n[P];u.push({left:m=k*o,right:w=(k+=L)*o,isDash:S=!S,zeroLength:L===0})}return u},yt.prototype.addRoundDash=function(n,s,o){for(var u=s/2,m=-o;m<=o;m++)for(var w=this.width*(this.nextRow+o+m),S=0,k=n[S],P=0;P<this.width;P++){P/k.right>1&&(k=n[++S]);var L=Math.abs(P-k.left),X=Math.abs(P-k.right),W=Math.min(L,X),J=void 0,ee=m/o*(u+1);if(k.isDash){var ie=u-Math.abs(ee);J=Math.sqrt(W*W+ie*ie)}else J=u-Math.sqrt(W*W+ee*ee);this.data[w+P]=Math.max(0,Math.min(255,J+128))}},yt.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],u=n[s+1];o.zeroLength?n.splice(s,1):u&&u.isDash===o.isDash&&(u.left=o.left,n.splice(s,1))}var m=n[0],w=n[n.length-1];m.isDash===w.isDash&&(m.left=w.left-this.width,w.right=m.right+this.width);for(var S=this.width*this.nextRow,k=0,P=n[k],L=0;L<this.width;L++){L/P.right>1&&(P=n[++k]);var X=Math.abs(L-P.left),W=Math.abs(L-P.right),J=Math.min(X,W);this.data[S+L]=Math.max(0,Math.min(255,(P.isDash?J:-J)+128))}},yt.prototype.addDash=function(n,s){var o=s?7:0,u=2*o+1;if(this.nextRow+u>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var m=0,w=0;w<n.length;w++)m+=n[w];if(m!==0){var S=this.width/m,k=this.getDashRanges(n,this.width,S);s?this.addRoundDash(k,S,o):this.addRegularDash(k)}var P={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:m};return this.nextRow+=u,this.dirty=!0,P},yt.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var gt=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var u=this.workerPool.acquire(this.id),m=0;m<u.length;m++){var w=new n.Actor(u[m],o,this.id);w.name="Worker "+m,this.actors.push(w)}};function Le(n,s,o){var u=function(m,w){if(m)return o(m);if(w){var S=a.pick(a.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(S.vectorLayers=w.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(k){return k.id})),S.tiles=s.canonicalizeTileset(S,n.url),o(null,S)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),u):a.browser.frame(function(){return u(null,n)})}gt.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(u,m){u.send(n,s,m)},o=o||function(){})},gt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},gt.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},gt.Actor=a.Actor;var Ne=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};Ne.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},Ne.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),u=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),m=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<m&&n.y>=u&&n.y<w};var Et=function(n){function s(o,u,m,w){if(n.call(this),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(u,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Le(this._options,this.map._requestManager,function(u,m){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new a.ErrorEvent(u)):m&&(a.extend(o,m),m.bounds&&(o.tileBounds=new Ne(m.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(m.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(m.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var u=this;return this.setSourceProperty(function(){u._options.tiles=o}),this},s.prototype.setUrl=function(o){var u=this;return this.setSourceProperty(function(){u.url=o,u._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,u){var m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(m,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(k,P){return delete o.request,o.aborted?u(null):k&&k.status!==404?u(k):(P&&P.resourceTiming&&(o.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&o.setExpiryData(P),o.loadVectorData(P,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=u:o.request=o.actor.send("reloadTile",w,S.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",w,S.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),mr=function(n){function s(o,u,m,w){n.call(this),this.id=o,this.dispatcher=m,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},u),a.extend(this,a.pick(u,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Le(this._options,this.map._requestManager,function(u,m){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new a.ErrorEvent(u)):m&&(a.extend(o,m),m.bounds&&(o.tileBounds=new Ne(m.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(m.tiles),a.postMapLoadEvent(m.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,u){var m=this,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(S,k){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(S)o.state="errored",u(S);else if(k){m.map._refreshExpiredTiles&&o.setExpiryData(k),delete k.cacheControl,delete k.expires;var P=m.map.painter.context,L=P.gl;o.texture=m.map.painter.getTileTexture(k.width),o.texture?o.texture.update(k,{useMipmap:!0}):(o.texture=new a.Texture(P,k,L.RGBA,{useMipmap:!0}),o.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),P.extTextureFilterAnisotropic&&L.texParameterf(L.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(m.dispatcher),u(null)}})},s.prototype.abortTile=function(o,u){o.request&&(o.request.cancel(),delete o.request),u()},s.prototype.unloadTile=function(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Wt=function(n){function s(o,u,m,w){n.call(this,o,u,m,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,u){var m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(S,k){S&&(o.state="errored",u(S)),k&&(o.dem=k,o.needsHillshadePrepare=!0,o.state="loaded",u(null))}o.request=a.getImage(this.map._requestManager.transformRequest(m,a.ResourceType.Tile),function(S,k){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(S)o.state="errored",u(S);else if(k){this.map._refreshExpiredTiles&&o.setExpiryData(k),delete k.cacheControl,delete k.expires;var P=a.window.ImageBitmap&&k instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?k:a.browser.getImageData(k,1),L={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:P,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",L,w.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var u=o.canonical,m=Math.pow(2,u.z),w=(u.x-1+m)%m,S=u.x===0?o.wrap-1:o.wrap,k=(u.x+1+m)%m,P=u.x+1===m?o.wrap+1:o.wrap,L={};return L[new a.OverscaledTileID(o.overscaledZ,S,u.z,w,u.y).key]={backfilled:!1},L[new a.OverscaledTileID(o.overscaledZ,P,u.z,k,u.y).key]={backfilled:!1},u.y>0&&(L[new a.OverscaledTileID(o.overscaledZ,S,u.z,w,u.y-1).key]={backfilled:!1},L[new a.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},L[new a.OverscaledTileID(o.overscaledZ,P,u.z,k,u.y-1).key]={backfilled:!1}),u.y+1<m&&(L[new a.OverscaledTileID(o.overscaledZ,S,u.z,w,u.y+1).key]={backfilled:!1},L[new a.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},L[new a.OverscaledTileID(o.overscaledZ,P,u.z,k,u.y+1).key]={backfilled:!1}),L},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(mr),qe=function(n){function s(o,u,m,w){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(w),this._data=u.data,this._options=a.extend({},u),this._collectResourceTiming=u.collectResourceTiming,this._resourceTiming=[],u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;var S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*S,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?Math.min(u.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:a.EXTENT,radius:(u.clusterRadius||50)*S,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(u){if(u)o.fire(new a.ErrorEvent(u));else{var m={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(m.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",m))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var u=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(m){if(m)u.fire(new a.ErrorEvent(m));else{var w={dataType:"source",sourceDataType:"content"};u._collectResourceTiming&&u._resourceTiming&&u._resourceTiming.length>0&&(w.resourceTiming=u._resourceTiming,u._resourceTiming=[]),u.fire(new a.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(o,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},u),this},s.prototype.getClusterChildren=function(o,u){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},u),this},s.prototype.getClusterLeaves=function(o,u,m,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:u,offset:m},w),this},s.prototype._updateWorkerData=function(o){var u=this;this._loaded=!1;var m=a.extend({},this.workerOptions),w=this._data;typeof w=="string"?(m.request=this.map._requestManager.transformRequest(a.browser.resolveURL(w),a.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(w),this.actor.send(this.type+".loadData",m,function(S,k){u._removed||k&&k.abandoned||(u._loaded=!0,k&&k.resourceTiming&&k.resourceTiming[u.id]&&(u._resourceTiming=k.resourceTiming[u.id].slice(0)),u.actor.send(u.type+".coalesce",{source:m.source},null),o(S))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,u){var m=this,w=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(w,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,k){return delete o.request,o.unloadVectorData(),o.aborted?u(null):S?u(S):(o.loadVectorData(k,m.map.painter,w==="reloadTile"),u(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),$e=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),lr=function(n){function s(o,u,m,w){n.call(this),this.id=o,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,u){var m=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(w,S){m._loaded=!0,w?m.fire(new a.ErrorEvent(w)):S&&(m.image=S,o&&(m.coordinates=o),u&&u(),m._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var u=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){u.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var u=this;this.coordinates=o;var m=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var k=1/0,P=1/0,L=-1/0,X=-1/0,W=0,J=S;W<J.length;W+=1){var ee=J[W];k=Math.min(k,ee.x),P=Math.min(P,ee.y),L=Math.max(L,ee.x),X=Math.max(X,ee.y)}var ie=Math.max(L-k,X-P),se=Math.max(0,Math.floor(-Math.log(ie)/Math.LN2)),$=Math.pow(2,se);return new a.CanonicalTileID(se,Math.floor((k+L)/2*$),Math.floor((P+X)/2*$))}(m),this.minzoom=this.maxzoom=this.tileID.z;var w=m.map(function(S){return u.tileID.getTilePoint(S)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,u=o.gl;for(var m in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,$e.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[m];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),gr=function(n){function s(o,u,m,w){n.call(this,o,u,m,w),this.roundZoom=!0,this.type="video",this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var u=this.options;this.urls=[];for(var m=0,w=u.urls;m<w.length;m+=1)this.urls.push(this.map._requestManager.transformRequest(w[m],a.ResourceType.Source).url);a.getVideo(this.urls,function(S,k){o._loaded=!0,S?o.fire(new a.ErrorEvent(S)):k&&(o.video=k,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+u.start(0)+" and "+u.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,u=o.gl;for(var m in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,$e.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[m];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(lr),pi=function(n){function s(o,u,m,w){n.call(this,o,u,m,w),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(k){return typeof k!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var u=this.map.painter.context,m=u.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,$e.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(u,this.canvas,m.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,u=[this.canvas.width,this.canvas.height];o<u.length;o+=1){var m=u[o];if(isNaN(m)||m<=0)return!0}return!1},s}(lr),ii={vector:Et,raster:mr,"raster-dem":Wt,geojson:qe,video:gr,image:lr,canvas:pi};function Zr(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function Gr(n,s,o,u,m,w){var S=function(se,$,le){if(se)for(var me=0,be=se;me<be.length;me+=1){var Te=$[be[me]];if(Te&&Te.source===le&&Te.type==="fill-extrusion")return!0}else for(var Ee in $){var Ae=$[Ee];if(Ae.source===le&&Ae.type==="fill-extrusion")return!0}return!1}(m&&m.layers,s,n.id),k=w.maxPitchScaleFactor(),P=n.tilesIn(u,k,S);P.sort(si);for(var L=[],X=0,W=P;X<W.length;X+=1){var J=W[X];L.push({wrappedTileID:J.tileID.wrapped().key,queryResults:J.tile.queryRenderedFeatures(s,o,n._state,J.queryGeometry,J.cameraQueryGeometry,J.scale,m,w,k,Zr(n.transform,J.tileID))})}var ee=function(se){for(var $={},le={},me=0,be=se;me<be.length;me+=1){var Te=be[me],Ee=Te.queryResults,Ae=Te.wrappedTileID,Oe=le[Ae]=le[Ae]||{};for(var Ke in Ee)for(var et=Ee[Ke],lt=Oe[Ke]=Oe[Ke]||{},mt=$[Ke]=$[Ke]||[],Dt=0,zt=et;Dt<zt.length;Dt+=1){var Kt=zt[Dt];lt[Kt.featureIndex]||(lt[Kt.featureIndex]=!0,mt.push(Kt))}}return $}(L);for(var ie in ee)ee[ie].forEach(function(se){var $=se.feature,le=n.getFeatureState($.layer["source-layer"],$.id);$.source=$.layer.source,$.layer["source-layer"]&&($.sourceLayer=$.layer["source-layer"]),$.state=le});return ee}function si(n,s){var o=n.tileID,u=s.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}var kt=function(n,s){this.max=n,this.onRemove=s,this.reset()};kt.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var u=o[s];u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value)}return this.data={},this.order=[],this},kt.prototype.add=function(n,s,o){var u=this,m=n.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);var w={value:s,timeout:void 0};if(o!==void 0&&(w.timeout=setTimeout(function(){u.remove(n,w)},o)),this.data[m].push(w),this.order.push(m),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},kt.prototype.has=function(n){return n.wrapped().key in this.data},kt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},kt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},kt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},kt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},kt.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,u=s===void 0?0:this.data[o].indexOf(s),m=this.data[o][u];return this.data[o].splice(u,1),m.timeout&&clearTimeout(m.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(m.value),this.order.splice(this.order.indexOf(o),1),this},kt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},kt.prototype.filter=function(n){var s=[];for(var o in this.data)for(var u=0,m=this.data[o];u<m.length;u+=1){var w=m[u];n(w.value)||s.push(w)}for(var S=0,k=s;S<k.length;S+=1){var P=k[S];this.remove(P.value.tileID,P)}};var ur=function(n,s,o){this.context=n;var u=n.gl;this.buffer=u.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};ur.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ur.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},ur.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var wt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Ht=function(n,s,o,u){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=u,this.context=n;var m=n.gl;this.buffer=m.createBuffer(),n.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Ht.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Ht.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},Ht.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var u=s.attributes[this.attributes[o].name];u!==void 0&&n.enableVertexAttribArray(u)}},Ht.prototype.setVertexAttribPointers=function(n,s,o){for(var u=0;u<this.attributes.length;u++){var m=this.attributes[u],w=s.attributes[m.name];w!==void 0&&n.vertexAttribPointer(w,m.components,n[wt[m.type]],!1,this.itemSize,m.offset+this.itemSize*(o||0))}},Ht.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var It=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};It.prototype.get=function(){return this.current},It.prototype.set=function(n){},It.prototype.getDefault=function(){return this.default},It.prototype.setDefault=function(){this.set(this.default)};var ei=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(It),Or=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(It),li=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(It),_n=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(It),Si=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(It),tn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(It),wr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(It),fi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(It),Fi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(It),Ni=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(It),di=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(It),oo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(It),Xi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}},s}(It),vn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(It),Xn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(It),Bo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(It),zn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}},s}(It),Wn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(It),ia=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(It),So=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(It),Pn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(It),Cn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(It),Eo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(It),Oo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(It),na=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(It),Fo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(It),ao=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(It),Kr=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(It),mi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(It),rn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(It),so=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(It),xr=function(n){function s(o,u){n.call(this,o),this.context=o,this.parent=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(It),M=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(xr),F=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(xr),q=function(n,s,o,u){this.context=n,this.width=s,this.height=o;var m=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new M(n,m),u&&(this.depthAttachment=new F(n,m))};q.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var Y=function(n,s,o){this.func=n,this.mask=s,this.range=o};Y.ReadOnly=!1,Y.ReadWrite=!0,Y.disabled=new Y(519,Y.ReadOnly,[0,1]);var re=function(n,s,o,u,m,w){this.test=n,this.ref=s,this.mask=o,this.fail=u,this.depthFail=m,this.pass=w};re.disabled=new re({func:519,mask:0},0,0,7680,7680,7680);var ue=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};ue.disabled=new ue(ue.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),ue.unblended=new ue(ue.Replace,a.Color.transparent,[!0,!0,!0,!0]),ue.alphaBlended=new ue([1,771],a.Color.transparent,[!0,!0,!0,!0]);var ye=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};ye.disabled=new ye(!1,1029,2305),ye.backCCW=new ye(!0,1029,2305);var Z=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ei(this),this.clearDepth=new Or(this),this.clearStencil=new li(this),this.colorMask=new _n(this),this.depthMask=new Si(this),this.stencilMask=new tn(this),this.stencilFunc=new wr(this),this.stencilOp=new fi(this),this.stencilTest=new Fi(this),this.depthRange=new Ni(this),this.depthTest=new di(this),this.depthFunc=new oo(this),this.blend=new Xi(this),this.blendFunc=new vn(this),this.blendColor=new Xn(this),this.blendEquation=new Bo(this),this.cullFace=new zn(this),this.cullFaceSide=new Wn(this),this.frontFace=new ia(this),this.program=new So(this),this.activeTexture=new Pn(this),this.viewport=new Cn(this),this.bindFramebuffer=new Eo(this),this.bindRenderbuffer=new Oo(this),this.bindTexture=new na(this),this.bindVertexBuffer=new Fo(this),this.bindElementBuffer=new ao(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Kr(this),this.pixelStoreUnpack=new mi(this),this.pixelStoreUnpackPremultiplyAlpha=new rn(this),this.pixelStoreUnpackFlipY=new so(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};Z.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Z.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Z.prototype.createIndexBuffer=function(n,s){return new ur(this,n,s)},Z.prototype.createVertexBuffer=function(n,s,o){return new Ht(this,n,s,o)},Z.prototype.createRenderbuffer=function(n,s,o){var u=this.gl,m=u.createRenderbuffer();return this.bindRenderbuffer.set(m),u.renderbufferStorage(u.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),m},Z.prototype.createFramebuffer=function(n,s,o){return new q(this,n,s,o)},Z.prototype.clear=function(n){var s=n.color,o=n.depth,u=this.gl,m=0;s&&(m|=u.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u.clear(m)},Z.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},Z.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},Z.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},Z.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,ue.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},Z.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var oe=function(n){function s(o,u,m){var w=this;n.call(this),this.id=o,this.dispatcher=m,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(S,k,P,L){var X=new ii[k.type](S,k,P,L);if(X.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+X.id);return a.bindAll(["load","abort","unload","serialize","prepare"],X),X}(o,u,m,this),this._tiles={},this._cache=new kt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var u=this._tiles[o];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,u){return this._source.loadTile(o,u)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var u in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var m=this._tiles[u];m.upload(o),m.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(ve).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var u=this,m=[];for(var w in this._tiles)this._isIdRenderable(w,o)&&m.push(this._tiles[w]);return o?m.sort(function(S,k){var P=S.tileID,L=k.tileID,X=new a.Point(P.canonical.x,P.canonical.y)._rotate(u.transform.angle),W=new a.Point(L.canonical.x,L.canonical.y)._rotate(u.transform.angle);return P.overscaledZ-L.overscaledZ||W.y-X.y||W.x-X.x}).map(function(S){return S.tileID.key}):m.map(function(S){return S.tileID}).sort(ve).map(function(S){return S.key})},s.prototype.hasRenderableParent=function(o){var u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)},s.prototype._isIdRenderable=function(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,u){var m=this._tiles[o];m&&(m.state!=="loading"&&(m.state=u),this._loadTile(m,this._tileLoaded.bind(this,m,o,u)))},s.prototype._tileLoaded=function(o,u,m,w){if(w)return o.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),m==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var u=this.getRenderableIds(),m=0;m<u.length;m++){var w=u[m];if(o.neighboringTiles&&o.neighboringTiles[w]){var S=this.getTileByID(w);k(o,S),k(S,o)}}function k(P,L){P.needsHillshadePrepare=!0;var X=L.tileID.canonical.x-P.tileID.canonical.x,W=L.tileID.canonical.y-P.tileID.canonical.y,J=Math.pow(2,P.tileID.canonical.z),ee=L.tileID.key;X===0&&W===0||Math.abs(W)>1||(Math.abs(X)>1&&(Math.abs(X+J)===1?X+=J:Math.abs(X-J)===1&&(X-=J)),L.dem&&P.dem&&(P.dem.backfillBorder(L.dem,X,W),P.neighboringTiles&&P.neighboringTiles[ee]&&(P.neighboringTiles[ee].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,u,m,w){for(var S in this._tiles){var k=this._tiles[S];if(!(w[S]||!k.hasData()||k.tileID.overscaledZ<=u||k.tileID.overscaledZ>m)){for(var P=k.tileID;k&&k.tileID.overscaledZ>u+1;){var L=k.tileID.scaledTo(k.tileID.overscaledZ-1);(k=this._tiles[L.key])&&k.hasData()&&(P=L)}for(var X=P;X.overscaledZ>u;)if(o[(X=X.scaledTo(X.overscaledZ-1)).key]){w[P.key]=P;break}}}},s.prototype.findLoadedParent=function(o,u){if(o.key in this._loadedParentTiles){var m=this._loadedParentTiles[o.key];return m&&m.tileID.overscaledZ>=u?m:null}for(var w=o.overscaledZ-1;w>=u;w--){var S=o.scaledTo(w),k=this._getLoadedTile(S);if(k)return k}},s.prototype._getLoadedTile=function(o){var u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var u=Math.ceil(o.width/this._source.tileSize)+1,m=Math.ceil(o.height/this._source.tileSize)+1,w=Math.floor(u*m*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)},s.prototype.handleWrapJump=function(o){var u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){var m={};for(var w in this._tiles){var S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),m[S.tileID.key]=S}for(var k in this._tiles=m,this._timers)clearTimeout(this._timers[k]),delete this._timers[k];for(var P in this._tiles)this._setTileReloadTimer(P,this._tiles[P])}},s.prototype.update=function(o){var u=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var m;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?m=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Oe){return new a.OverscaledTileID(Oe.canonical.z,Oe.wrap,Oe.canonical.z,Oe.canonical.x,Oe.canonical.y)}):(m=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(m=m.filter(function(Oe){return u._source.hasTile(Oe)}))):m=[];var w=o.coveringZoomLevel(this._source),S=Math.max(w-s.maxOverzooming,this._source.minzoom),k=Math.max(w+s.maxUnderzooming,this._source.minzoom),P=this._updateRetainedTiles(m,w);if(Ve(this._source.type)){for(var L={},X={},W=0,J=Object.keys(P);W<J.length;W+=1){var ee=J[W],ie=P[ee],se=this._tiles[ee];if(se&&!(se.fadeEndTime&&se.fadeEndTime<=a.browser.now())){var $=this.findLoadedParent(ie,S);$&&(this._addTile($.tileID),L[$.tileID.key]=$.tileID),X[ee]=ie}}for(var le in this._retainLoadedChildren(X,w,k,P),L)P[le]||(this._coveredTiles[le]=!0,P[le]=L[le])}for(var me in P)this._tiles[me].clearFadeHold();for(var be=0,Te=a.keysDifference(this._tiles,P);be<Te.length;be+=1){var Ee=Te[be],Ae=this._tiles[Ee];Ae.hasSymbolBuckets&&!Ae.holdingForFade()?Ae.setHoldDuration(this.map._fadeDuration):Ae.hasSymbolBuckets&&!Ae.symbolFadeFinished()||this._removeTile(Ee)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,u){for(var m={},w={},S=Math.max(u-s.maxOverzooming,this._source.minzoom),k=Math.max(u+s.maxUnderzooming,this._source.minzoom),P={},L=0,X=o;L<X.length;L+=1){var W=X[L],J=this._addTile(W);m[W.key]=W,J.hasData()||u<this._source.maxzoom&&(P[W.key]=W)}this._retainLoadedChildren(P,u,k,m);for(var ee=0,ie=o;ee<ie.length;ee+=1){var se=ie[ee],$=this._tiles[se.key];if(!$.hasData()){if(u+1>this._source.maxzoom){var le=se.children(this._source.maxzoom)[0],me=this.getTile(le);if(me&&me.hasData()){m[le.key]=le;continue}}else{var be=se.children(this._source.maxzoom);if(m[be[0].key]&&m[be[1].key]&&m[be[2].key]&&m[be[3].key])continue}for(var Te=$.wasRequested(),Ee=se.overscaledZ-1;Ee>=S;--Ee){var Ae=se.scaledTo(Ee);if(w[Ae.key]||(w[Ae.key]=!0,!($=this.getTile(Ae))&&Te&&($=this._addTile(Ae)),$&&(m[Ae.key]=Ae,Te=$.wasRequested(),$.hasData())))break}}}return m},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var u=[],m=void 0,w=this._tiles[o].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){m=this._loadedParentTiles[w.key];break}u.push(w.key);var S=w.scaledTo(w.overscaledZ-1);if(m=this._getLoadedTile(S))break;w=S}for(var k=0,P=u;k<P.length;k+=1)this._loadedParentTiles[P[k]]=m}},s.prototype._addTile=function(o){var u=this._tiles[o.key];if(u)return u;(u=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));var m=Boolean(u);return m||(u=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))),u?(u.uses++,this._tiles[o.key]=u,m||this._source.fire(new a.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null},s.prototype._setTileReloadTimer=function(o,u){var m=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var w=u.getExpiryTimeout();w&&(this._timers[o]=setTimeout(function(){m._reloadTile(o,"expired"),delete m._timers[o]},w))},s.prototype._removeTile=function(o){var u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,u,m){var w=this,S=[],k=this.transform;if(!k)return S;for(var P=m?k.getCameraQueryGeometry(o):o,L=o.map(function(Ee){return k.pointCoordinate(Ee)}),X=P.map(function(Ee){return k.pointCoordinate(Ee)}),W=this.getIds(),J=1/0,ee=1/0,ie=-1/0,se=-1/0,$=0,le=X;$<le.length;$+=1){var me=le[$];J=Math.min(J,me.x),ee=Math.min(ee,me.y),ie=Math.max(ie,me.x),se=Math.max(se,me.y)}for(var be=function(Ee){var Ae=w._tiles[W[Ee]];if(!Ae.holdingForFade()){var Oe=Ae.tileID,Ke=Math.pow(2,k.zoom-Ae.tileID.overscaledZ),et=u*Ae.queryPadding*a.EXTENT/Ae.tileSize/Ke,lt=[Oe.getTilePoint(new a.MercatorCoordinate(J,ee)),Oe.getTilePoint(new a.MercatorCoordinate(ie,se))];if(lt[0].x-et<a.EXTENT&&lt[0].y-et<a.EXTENT&&lt[1].x+et>=0&&lt[1].y+et>=0){var mt=L.map(function(zt){return Oe.getTilePoint(zt)}),Dt=X.map(function(zt){return Oe.getTilePoint(zt)});S.push({tile:Ae,tileID:Oe,queryGeometry:mt,cameraQueryGeometry:Dt,scale:Ke})}}},Te=0;Te<W.length;Te++)be(Te);return S},s.prototype.getVisibleCoordinates=function(o){for(var u=this,m=this.getRenderableIds(o).map(function(P){return u._tiles[P].tileID}),w=0,S=m;w<S.length;w+=1){var k=S[w];k.posMatrix=this.transform.calculatePosMatrix(k.toUnwrapped())}return m},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ve(this._source.type))for(var o in this._tiles){var u=this._tiles[o];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,u,m){this._state.updateState(o=o||"_geojsonTileLayer",u,m)},s.prototype.removeFeatureState=function(o,u,m){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,m)},s.prototype.getFeatureState=function(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)},s.prototype.setDependencies=function(o,u,m){var w=this._tiles[o];w&&w.setDependencies(u,m)},s.prototype.reloadTilesForDependencies=function(o,u){for(var m in this._tiles)this._tiles[m].hasDependency(o,u)&&this._reloadTile(m,"reloading");this._cache.filter(function(w){return!w.hasDependency(o,u)})},s}(a.Evented);function ve(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),u=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||u-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Ve(n){return n==="raster"||n==="image"||n==="video"}function Ze(){return new a.window.Worker(Ia.workerUrl)}oe.maxOverzooming=10,oe.maxUnderzooming=3;var Re="mapboxgl_preloaded_worker_pool",je=function(){this.active={}};je.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<je.workerCount;)this.workers.push(new Ze);return this.active[n]=!0,this.workers.slice()},je.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},je.prototype.isPreloaded=function(){return!!this.active[Re]},je.prototype.numActive=function(){return Object.keys(this.active).length};var ht,st=Math.floor(a.browser.hardwareConcurrency/2);function ze(){return ht||(ht=new je),ht}function tt(n,s){var o={};for(var u in n)u!=="ref"&&(o[u]=n[u]);return a.refProperties.forEach(function(m){m in s&&(o[m]=s[m])}),o}function Ye(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var u=0;u<n.length;u++)"ref"in n[u]&&(n[u]=tt(n[u],s[n[u].ref]));return n}je.workerCount=Math.max(Math.min(st,6),1);var it={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ut(n,s,o){o.push({command:it.addSource,args:[n,s[n]]})}function ot(n,s,o){s.push({command:it.removeSource,args:[n]}),o[n]=!0}function er(n,s,o,u){ot(n,o,u),Ut(n,s,o)}function cr(n,s,o){var u;for(u in n[o])if(n[o].hasOwnProperty(u)&&u!=="data"&&!a.deepEqual(n[o][u],s[o][u]))return!1;for(u in s[o])if(s[o].hasOwnProperty(u)&&u!=="data"&&!a.deepEqual(n[o][u],s[o][u]))return!1;return!0}function Zt(n,s,o,u,m,w){var S;for(S in s=s||{},n=n||{})n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[u,S,s[S],m]}));for(S in s)s.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[u,S,s[S],m]}))}function or(n){return n.id}function Jt(n,s){return n[s.id]=s,n}var ui=function(n,s){this.reset(n,s)};ui.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ui.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],u=n*this.paddedLength+this.padding;o<u&&s<this._distances.length;)o=this._distances[++s];var m=s-1,w=this._distances[m],S=o-w,k=S>0?(u-w)/S:0;return this.points[m].mult(1-k).add(this.points[s].mult(k))};var fr=function(n,s,o){var u=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var w=0;w<this.xCellCount*this.yCellCount;w++)u.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Fr(n,s,o,u,m){var w=a.create();return s?(a.scale(w,w,[1/m,1/m,1]),o||a.rotateZ(w,w,u.angle)):a.multiply(w,u.labelPlaneMatrix,n),w}function nr(n,s,o,u,m){if(s){var w=a.clone(n);return a.scale(w,w,[m,m,1]),o||a.rotateZ(w,w,-u.angle),w}return u.glCoordMatrix}function Gt(n,s){var o=[n.x,n.y,0,1];Er(o,o,s);var u=o[3];return{point:new a.Point(o[0]/u,o[1]/u),signedDistanceFromCamera:u}}function ar(n,s){return .5+n/s*.5}function Ei(n,s){var o=n[0]/n[3],u=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&u>=-s[1]&&u<=s[1]}function ko(n,s,o,u,m,w,S,k){var P=u?n.textSizeData:n.iconSizeData,L=a.evaluateSizeForZoom(P,o.transform.zoom),X=[256/o.width*2+1,256/o.height*2+1],W=u?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;W.clear();for(var J=n.lineVertexArray,ee=u?n.text.placedSymbolArray:n.icon.placedSymbolArray,ie=o.transform.width/o.transform.height,se=!1,$=0;$<ee.length;$++){var le=ee.get($);if(le.hidden||le.writingMode===a.WritingMode.vertical&&!se)Xr(le.numGlyphs,W);else{se=!1;var me=[le.anchorX,le.anchorY,0,1];if(a.transformMat4(me,me,s),Ei(me,X)){var be=ar(o.transform.cameraToCenterDistance,me[3]),Te=a.evaluateSizeForFeature(P,L,le),Ee=S?Te/be:Te*be,Ae=new a.Point(le.anchorX,le.anchorY),Oe=Gt(Ae,m).point,Ke={},et=_a(le,Ee,!1,k,s,m,w,n.glyphOffsetArray,J,W,Oe,Ae,Ke,ie);se=et.useVertical,(et.notEnoughRoom||se||et.needsFlipping&&_a(le,Ee,!0,k,s,m,w,n.glyphOffsetArray,J,W,Oe,Ae,Ke,ie).notEnoughRoom)&&Xr(le.numGlyphs,W)}else Xr(le.numGlyphs,W)}}u?n.text.dynamicLayoutVertexBuffer.updateData(W):n.icon.dynamicLayoutVertexBuffer.updateData(W)}function Nr(n,s,o,u,m,w,S,k,P,L,X){var W=k.glyphStartIndex+k.numGlyphs,J=k.lineStartIndex,ee=k.lineStartIndex+k.lineLength,ie=s.getoffsetX(k.glyphStartIndex),se=s.getoffsetX(W-1),$=Sr(n*ie,o,u,m,w,S,k.segment,J,ee,P,L,X);if(!$)return null;var le=Sr(n*se,o,u,m,w,S,k.segment,J,ee,P,L,X);return le?{first:$,last:le}:null}function ni(n,s,o,u){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*u?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function _a(n,s,o,u,m,w,S,k,P,L,X,W,J,ee){var ie,se=s/24,$=n.lineOffsetX*se,le=n.lineOffsetY*se;if(n.numGlyphs>1){var me=n.glyphStartIndex+n.numGlyphs,be=n.lineStartIndex,Te=n.lineStartIndex+n.lineLength,Ee=Nr(se,k,$,le,o,X,W,n,P,w,J);if(!Ee)return{notEnoughRoom:!0};var Ae=Gt(Ee.first.point,S).point,Oe=Gt(Ee.last.point,S).point;if(u&&!o){var Ke=ni(n.writingMode,Ae,Oe,ee);if(Ke)return Ke}ie=[Ee.first];for(var et=n.glyphStartIndex+1;et<me-1;et++)ie.push(Sr(se*k.getoffsetX(et),$,le,o,X,W,n.segment,be,Te,P,w,J));ie.push(Ee.last)}else{if(u&&!o){var lt=Gt(W,m).point,mt=n.lineStartIndex+n.segment+1,Dt=new a.Point(P.getx(mt),P.gety(mt)),zt=Gt(Dt,m),Kt=zt.signedDistanceFromCamera>0?zt.point:No(W,Dt,lt,1,m),ft=ni(n.writingMode,lt,Kt,ee);if(ft)return ft}var Ft=Sr(se*k.getoffsetX(n.glyphStartIndex),$,le,o,X,W,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,P,w,J);if(!Ft)return{notEnoughRoom:!0};ie=[Ft]}for(var Nt=0,Q=ie;Nt<Q.length;Nt+=1){var Me=Q[Nt];a.addDynamicAttributes(L,Me.point,Me.angle)}return{}}function No(n,s,o,u,m){var w=Gt(n.add(n.sub(s)._unit()),m).point,S=o.sub(w);return o.add(S._mult(u/S.mag()))}function Sr(n,s,o,u,m,w,S,k,P,L,X,W){var J=u?n-s:n+s,ee=J>0?1:-1,ie=0;u&&(ee*=-1,ie=Math.PI),ee<0&&(ie+=Math.PI);for(var se=ee>0?k+S:k+S+1,$=m,le=m,me=0,be=0,Te=Math.abs(J),Ee=[];me+be<=Te;){if((se+=ee)<k||se>=P)return null;if(le=$,Ee.push($),($=W[se])===void 0){var Ae=new a.Point(L.getx(se),L.gety(se)),Oe=Gt(Ae,X);if(Oe.signedDistanceFromCamera>0)$=W[se]=Oe.point;else{var Ke=se-ee;$=No(me===0?w:new a.Point(L.getx(Ke),L.gety(Ke)),Ae,le,Te-me+1,X)}}me+=be,be=le.dist($)}var et=(Te-me)/be,lt=$.sub(le),mt=lt.mult(et)._add(le);mt._add(lt._unit()._perp()._mult(o*ee));var Dt=ie+Math.atan2($.y-le.y,$.x-le.x);return Ee.push(mt),{point:mt,angle:Dt,path:Ee}}fr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},fr.prototype.insert=function(n,s,o,u,m){this._forEachCell(s,o,u,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(m)},fr.prototype.insertCircle=function(n,s,o,u){this._forEachCell(s-u,o-u,s+u,o+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(u)},fr.prototype._insertBoxCell=function(n,s,o,u,m,w){this.boxCells[m].push(w)},fr.prototype._insertCircleCell=function(n,s,o,u,m,w){this.circleCells[m].push(w)},fr.prototype._query=function(n,s,o,u,m,w){if(o<0||n>this.width||u<0||s>this.height)return!m&&[];var S=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=u){if(m)return!0;for(var k=0;k<this.boxKeys.length;k++)S.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(var P=0;P<this.circleKeys.length;P++){var L=this.circles[3*P],X=this.circles[3*P+1],W=this.circles[3*P+2];S.push({key:this.circleKeys[P],x1:L-W,y1:X-W,x2:L+W,y2:X+W})}return w?S.filter(w):S}return this._forEachCell(n,s,o,u,this._queryCell,S,{hitTest:m,seenUids:{box:{},circle:{}}},w),m?S.length>0:S},fr.prototype._queryCircle=function(n,s,o,u,m){var w=n-o,S=n+o,k=s-o,P=s+o;if(S<0||w>this.width||P<0||k>this.height)return!u&&[];var L=[];return this._forEachCell(w,k,S,P,this._queryCellCircle,L,{hitTest:u,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},m),u?L.length>0:L},fr.prototype.query=function(n,s,o,u,m){return this._query(n,s,o,u,!1,m)},fr.prototype.hitTest=function(n,s,o,u,m){return this._query(n,s,o,u,!0,m)},fr.prototype.hitTestCircle=function(n,s,o,u){return this._queryCircle(n,s,o,!0,u)},fr.prototype._queryCell=function(n,s,o,u,m,w,S,k){var P=S.seenUids,L=this.boxCells[m];if(L!==null)for(var X=this.bboxes,W=0,J=L;W<J.length;W+=1){var ee=J[W];if(!P.box[ee]){P.box[ee]=!0;var ie=4*ee;if(n<=X[ie+2]&&s<=X[ie+3]&&o>=X[ie+0]&&u>=X[ie+1]&&(!k||k(this.boxKeys[ee]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[ee],x1:X[ie],y1:X[ie+1],x2:X[ie+2],y2:X[ie+3]})}}}var se=this.circleCells[m];if(se!==null)for(var $=this.circles,le=0,me=se;le<me.length;le+=1){var be=me[le];if(!P.circle[be]){P.circle[be]=!0;var Te=3*be;if(this._circleAndRectCollide($[Te],$[Te+1],$[Te+2],n,s,o,u)&&(!k||k(this.circleKeys[be]))){if(S.hitTest)return w.push(!0),!0;var Ee=$[Te],Ae=$[Te+1],Oe=$[Te+2];w.push({key:this.circleKeys[be],x1:Ee-Oe,y1:Ae-Oe,x2:Ee+Oe,y2:Ae+Oe})}}}},fr.prototype._queryCellCircle=function(n,s,o,u,m,w,S,k){var P=S.circle,L=S.seenUids,X=this.boxCells[m];if(X!==null)for(var W=this.bboxes,J=0,ee=X;J<ee.length;J+=1){var ie=ee[J];if(!L.box[ie]){L.box[ie]=!0;var se=4*ie;if(this._circleAndRectCollide(P.x,P.y,P.radius,W[se+0],W[se+1],W[se+2],W[se+3])&&(!k||k(this.boxKeys[ie])))return w.push(!0),!0}}var $=this.circleCells[m];if($!==null)for(var le=this.circles,me=0,be=$;me<be.length;me+=1){var Te=be[me];if(!L.circle[Te]){L.circle[Te]=!0;var Ee=3*Te;if(this._circlesCollide(le[Ee],le[Ee+1],le[Ee+2],P.x,P.y,P.radius)&&(!k||k(this.circleKeys[Te])))return w.push(!0),!0}}},fr.prototype._forEachCell=function(n,s,o,u,m,w,S,k){for(var P=this._convertToXCellCoord(n),L=this._convertToYCellCoord(s),X=this._convertToXCellCoord(o),W=this._convertToYCellCoord(u),J=P;J<=X;J++)for(var ee=L;ee<=W;ee++)if(m.call(this,n,s,o,u,this.xCellCount*ee+J,w,S,k))return},fr.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},fr.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},fr.prototype._circlesCollide=function(n,s,o,u,m,w){var S=u-n,k=m-s,P=o+w;return P*P>S*S+k*k},fr.prototype._circleAndRectCollide=function(n,s,o,u,m,w,S){var k=(w-u)/2,P=Math.abs(n-(u+k));if(P>k+o)return!1;var L=(S-m)/2,X=Math.abs(s-(m+L));if(X>L+o)return!1;if(P<=k||X<=L)return!0;var W=P-k,J=X-L;return W*W+J*J<=o*o};var Vo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Xr(n,s){for(var o=0;o<n;o++){var u=s.length;s.resize(u+4),s.float32.set(Vo,3*u)}}function Er(n,s,o){var u=s[0],m=s[1];return n[0]=o[0]*u+o[4]*m+o[12],n[1]=o[1]*u+o[5]*m+o[13],n[3]=o[3]*u+o[7]*m+o[15],n}var yi=function(n,s,o){s===void 0&&(s=new fr(n.width+200,n.height+200,25)),o===void 0&&(o=new fr(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Pr(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}yi.prototype.placeCollisionBox=function(n,s,o,u,m){var w=this.projectAndGetPerspectiveRatio(u,n.anchorPointX,n.anchorPointY),S=o*w.perspectiveRatio,k=n.x1*S+w.point.x,P=n.y1*S+w.point.y,L=n.x2*S+w.point.x,X=n.y2*S+w.point.y;return!this.isInsideGrid(k,P,L,X)||!s&&this.grid.hitTest(k,P,L,X,m)?{box:[],offscreen:!1}:{box:[k,P,L,X],offscreen:this.isOffscreen(k,P,L,X)}},yi.prototype.placeCollisionCircles=function(n,s,o,u,m,w,S,k,P,L,X,W,J){var ee=[],ie=new a.Point(s.anchorX,s.anchorY),se=Gt(ie,w),$=ar(this.transform.cameraToCenterDistance,se.signedDistanceFromCamera),le=(L?m/$:m*$)/a.ONE_EM,me=Gt(ie,S).point,be=Nr(le,u,s.lineOffsetX*le,s.lineOffsetY*le,!1,me,ie,s,o,S,{}),Te=!1,Ee=!1,Ae=!0;if(be){for(var Oe=.5*W*$+J,Ke=new a.Point(-100,-100),et=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),lt=new ui,mt=be.first,Dt=be.last,zt=[],Kt=mt.path.length-1;Kt>=1;Kt--)zt.push(mt.path[Kt]);for(var ft=1;ft<Dt.path.length;ft++)zt.push(Dt.path[ft]);var Ft=2.5*Oe;if(k){var Nt=zt.map(function(Mo){return Gt(Mo,k)});zt=Nt.some(function(Mo){return Mo.signedDistanceFromCamera<=0})?[]:Nt.map(function(Mo){return Mo.point})}var Q=[];if(zt.length>0){for(var Me=zt[0].clone(),Vt=zt[0].clone(),At=1;At<zt.length;At++)Me.x=Math.min(Me.x,zt[At].x),Me.y=Math.min(Me.y,zt[At].y),Vt.x=Math.max(Vt.x,zt[At].x),Vt.y=Math.max(Vt.y,zt[At].y);Q=Me.x>=Ke.x&&Vt.x<=et.x&&Me.y>=Ke.y&&Vt.y<=et.y?[zt]:Vt.x<Ke.x||Me.x>et.x||Vt.y<Ke.y||Me.y>et.y?[]:a.clipLine([zt],Ke.x,Ke.y,et.x,et.y)}for(var Pt=0,ci=Q;Pt<ci.length;Pt+=1){var Tr;lt.reset(ci[Pt],.25*Oe),Tr=lt.length<=.5*Oe?1:Math.ceil(lt.paddedLength/Ft)+1;for(var zi=0;zi<Tr;zi++){var _i=zi/Math.max(Tr-1,1),jr=lt.lerp(_i),Ir=jr.x+100,Ji=jr.y+100;ee.push(Ir,Ji,Oe,0);var Li=Ir-Oe,mn=Ji-Oe,qi=Ir+Oe,kn=Ji+Oe;if(Ae=Ae&&this.isOffscreen(Li,mn,qi,kn),Ee=Ee||this.isInsideGrid(Li,mn,qi,kn),!n&&this.grid.hitTestCircle(Ir,Ji,Oe,X)&&(Te=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Te}}}}return{circles:!P&&Te||!Ee?[]:ee,offscreen:Ae,collisionDetected:Te}},yi.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,u=1/0,m=-1/0,w=-1/0,S=0,k=n;S<k.length;S+=1){var P=k[S],L=new a.Point(P.x+100,P.y+100);o=Math.min(o,L.x),u=Math.min(u,L.y),m=Math.max(m,L.x),w=Math.max(w,L.y),s.push(L)}for(var X={},W={},J=0,ee=this.grid.query(o,u,m,w).concat(this.ignoredGrid.query(o,u,m,w));J<ee.length;J+=1){var ie=ee[J],se=ie.key;if(X[se.bucketInstanceId]===void 0&&(X[se.bucketInstanceId]={}),!X[se.bucketInstanceId][se.featureIndex]){var $=[new a.Point(ie.x1,ie.y1),new a.Point(ie.x2,ie.y1),new a.Point(ie.x2,ie.y2),new a.Point(ie.x1,ie.y2)];a.polygonIntersectsPolygon(s,$)&&(X[se.bucketInstanceId][se.featureIndex]=!0,W[se.bucketInstanceId]===void 0&&(W[se.bucketInstanceId]=[]),W[se.bucketInstanceId].push(se.featureIndex))}}return W},yi.prototype.insertCollisionBox=function(n,s,o,u,m){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:u,collisionGroupID:m},n[0],n[1],n[2],n[3])},yi.prototype.insertCollisionCircles=function(n,s,o,u,m){for(var w=s?this.ignoredGrid:this.grid,S={bucketInstanceId:o,featureIndex:u,collisionGroupID:m},k=0;k<n.length;k+=4)w.insertCircle(S,n[k],n[k+1],n[k+2])},yi.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var u=[s,o,0,1];return Er(u,u,n),{point:new a.Point((u[0]/u[3]+1)/2*this.transform.width+100,(-u[1]/u[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/u[3]*.5}},yi.prototype.isOffscreen=function(n,s,o,u){return o<100||n>=this.screenRightBoundary||u<100||s>this.screenBottomBoundary},yi.prototype.isInsideGrid=function(n,s,o,u){return o>=0&&n<this.gridRightBoundary&&u>=0&&s<this.gridBottomBoundary},yi.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var Wi=function(n,s,o,u){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):u&&o?1:0,this.placed=o};Wi.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Mn=function(n,s,o,u,m){this.text=new Wi(n?n.text:null,s,o,m),this.icon=new Wi(n?n.icon:null,s,u,m)};Mn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ps=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},oi=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},Dn=function(n,s,o,u,m){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=u,this.tileID=m},Vi=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function ai(n,s,o,u,m){var w=a.getAnchorAlignment(n),S=-(w.horizontalAlign-.5)*s,k=-(w.verticalAlign-.5)*o,P=a.evaluateVariableOffset(n,u);return new a.Point(S+P[0]*m,k+P[1]*m)}function bn(n,s,o,u,m,w){var S=n.x1,k=n.x2,P=n.y1,L=n.y2,X=n.anchorPointX,W=n.anchorPointY,J=new a.Point(s,o);return u&&J._rotate(m?w:-w),{x1:S+J.x,y1:P+J.y,x2:k+J.x,y2:L+J.y,anchorPointX:X,anchorPointY:W}}Vi.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var Ui=function(n,s,o,u){this.transform=n.clone(),this.collisionIndex=new yi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Vi(o),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}};function Uo(n,s,o,u,m){n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0)}Ui.prototype.getBucketParts=function(n,s,o,u){var m=o.getBucket(s),w=o.latestFeatureIndex;if(m&&w&&s.id===m.layerIds[0]){var S=o.collisionBoxArray,k=m.layers[0].layout,P=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),L=o.tileSize/a.EXTENT,X=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),W=k.get("text-pitch-alignment")==="map",J=k.get("text-rotation-alignment")==="map",ee=Pr(o,1,this.transform.zoom),ie=Fr(X,W,J,this.transform,ee),se=null;if(W){var $=nr(X,W,J,this.transform,ee);se=a.multiply([],this.transform.labelPlaneMatrix,$)}this.retainedQueryData[m.bucketInstanceId]=new Dn(m.bucketInstanceId,w,m.sourceLayerIndex,m.index,o.tileID);var le={bucket:m,layout:k,posMatrix:X,textLabelPlaneMatrix:ie,labelToScreenMatrix:se,scale:P,textPixelRatio:L,holdingForFade:o.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(u)for(var me=0,be=m.sortKeyRanges;me<be.length;me+=1){var Te=be[me];n.push({sortKey:Te.sortKey,symbolInstanceStart:Te.symbolInstanceStart,symbolInstanceEnd:Te.symbolInstanceEnd,parameters:le})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:le})}},Ui.prototype.attemptAnchorPlacement=function(n,s,o,u,m,w,S,k,P,L,X,W,J,ee,ie){var se,$=[W.textOffset0,W.textOffset1],le=ai(n,o,u,$,m),me=this.collisionIndex.placeCollisionBox(bn(s,le.x,le.y,w,S,this.transform.angle),X,k,P,L.predicate);if(!ie||this.collisionIndex.placeCollisionBox(bn(ie,le.x,le.y,w,S,this.transform.angle),X,k,P,L.predicate).box.length!==0)return me.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&(se=this.prevPlacement.variableOffsets[W.crossTileID].anchor),this.variableOffsets[W.crossTileID]={textOffset:$,width:o,height:u,anchor:n,textBoxScale:m,prevAnchor:se},this.markUsedJustification(J,n,W,ee),J.allowVerticalPlacement&&(this.markUsedOrientation(J,ee,W),this.placedOrientations[W.crossTileID]=ee),{shift:le,placedGlyphBoxes:me}):void 0},Ui.prototype.placeLayerBucketPart=function(n,s,o){var u=this,m=n.parameters,w=m.bucket,S=m.layout,k=m.posMatrix,P=m.textLabelPlaneMatrix,L=m.labelToScreenMatrix,X=m.textPixelRatio,W=m.holdingForFade,J=m.collisionBoxArray,ee=m.partiallyEvaluatedTextSize,ie=m.collisionGroup,se=S.get("text-optional"),$=S.get("icon-optional"),le=S.get("text-allow-overlap"),me=S.get("icon-allow-overlap"),be=S.get("text-rotation-alignment")==="map",Te=S.get("text-pitch-alignment")==="map",Ee=S.get("icon-text-fit")!=="none",Ae=S.get("symbol-z-order")==="viewport-y",Oe=le&&(me||!w.hasIconData()||$),Ke=me&&(le||!w.hasTextData()||se);!w.collisionArrays&&J&&w.deserializeCollisionBoxes(J);var et=function(ft,Ft){if(!s[ft.crossTileID])if(W)u.placements[ft.crossTileID]=new Ps(!1,!1,!1);else{var Nt,Q=!1,Me=!1,Vt=!0,At=null,Pt={box:null,offscreen:null},ci={box:null,offscreen:null},Tr=null,zi=null,_i=0,jr=0,Ir=0;Ft.textFeatureIndex?_i=Ft.textFeatureIndex:ft.useRuntimeCollisionCircles&&(_i=ft.featureIndex),Ft.verticalTextFeatureIndex&&(jr=Ft.verticalTextFeatureIndex);var Ji=Ft.textBox;if(Ji){var Li=function(vr){var yo=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!vr&&u.prevPlacement){var vi=u.prevPlacement.placedOrientations[ft.crossTileID];vi&&(u.placedOrientations[ft.crossTileID]=vi,u.markUsedOrientation(w,yo=vi,ft))}return yo},mn=function(vr,yo){if(w.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Ft.verticalTextBox)for(var vi=0,Ss=w.writingModes;vi<Ss.length&&(Ss[vi]===a.WritingMode.vertical?(Pt=yo(),ci=Pt):Pt=vr(),!(Pt&&Pt.box&&Pt.box.length));vi+=1);else Pt=vr()};if(S.get("text-variable-anchor")){var qi=S.get("text-variable-anchor");if(u.prevPlacement&&u.prevPlacement.variableOffsets[ft.crossTileID]){var kn=u.prevPlacement.variableOffsets[ft.crossTileID];qi.indexOf(kn.anchor)>0&&(qi=qi.filter(function(vr){return vr!==kn.anchor})).unshift(kn.anchor)}var Mo=function(vr,yo,vi){for(var Ss=vr.x2-vr.x1,Ru=vr.y2-vr.y1,uu=ft.textBoxScale,nc=Ee&&!me?yo:null,Zs={box:[],offscreen:!1},Bu=le?2*qi.length:qi.length,Gs=0;Gs<Bu;++Gs){var Bl=u.attemptAnchorPlacement(qi[Gs%qi.length],vr,Ss,Ru,uu,be,Te,X,k,ie,Gs>=qi.length,ft,w,vi,nc);if(Bl&&(Zs=Bl.placedGlyphBoxes)&&Zs.box&&Zs.box.length){Q=!0,At=Bl.shift;break}}return Zs};mn(function(){return Mo(Ji,Ft.iconBox,a.WritingMode.horizontal)},function(){var vr=Ft.verticalTextBox;return w.allowVerticalPlacement&&!(Pt&&Pt.box&&Pt.box.length)&&ft.numVerticalGlyphVertices>0&&vr?Mo(vr,Ft.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Pt&&(Q=Pt.box,Vt=Pt.offscreen);var cl=Li(Pt&&Pt.box);if(!Q&&u.prevPlacement){var qs=u.prevPlacement.variableOffsets[ft.crossTileID];qs&&(u.variableOffsets[ft.crossTileID]=qs,u.markUsedJustification(w,qs.anchor,ft,cl))}}else{var ln=function(vr,yo){var vi=u.collisionIndex.placeCollisionBox(vr,le,X,k,ie.predicate);return vi&&vi.box&&vi.box.length&&(u.markUsedOrientation(w,yo,ft),u.placedOrientations[ft.crossTileID]=yo),vi};mn(function(){return ln(Ji,a.WritingMode.horizontal)},function(){var vr=Ft.verticalTextBox;return w.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&vr?ln(vr,a.WritingMode.vertical):{box:null,offscreen:null}}),Li(Pt&&Pt.box&&Pt.box.length)}}if(Q=(Nt=Pt)&&Nt.box&&Nt.box.length>0,Vt=Nt&&Nt.offscreen,ft.useRuntimeCollisionCircles){var ya=w.text.placedSymbolArray.get(ft.centerJustifiedTextSymbolIndex),hl=a.evaluateSizeForFeature(w.textSizeData,ee,ya),Yi=S.get("text-padding");Tr=u.collisionIndex.placeCollisionCircles(le,ya,w.lineVertexArray,w.glyphOffsetArray,hl,k,P,L,o,Te,ie.predicate,ft.collisionCircleDiameter,Yi),Q=le||Tr.circles.length>0&&!Tr.collisionDetected,Vt=Vt&&Tr.offscreen}if(Ft.iconFeatureIndex&&(Ir=Ft.iconFeatureIndex),Ft.iconBox){var pl=function(vr){var yo=Ee&&At?bn(vr,At.x,At.y,be,Te,u.transform.angle):vr;return u.collisionIndex.placeCollisionBox(yo,me,X,k,ie.predicate)};Me=ci&&ci.box&&ci.box.length&&Ft.verticalIconBox?(zi=pl(Ft.verticalIconBox)).box.length>0:(zi=pl(Ft.iconBox)).box.length>0,Vt=Vt&&zi.offscreen}var ra=se||ft.numHorizontalGlyphVertices===0&&ft.numVerticalGlyphVertices===0,Qi=$||ft.numIconVertices===0;if(ra||Qi?Qi?ra||(Me=Me&&Q):Q=Me&&Q:Me=Q=Me&&Q,Q&&Nt&&Nt.box&&u.collisionIndex.insertCollisionBox(Nt.box,S.get("text-ignore-placement"),w.bucketInstanceId,ci&&ci.box&&jr?jr:_i,ie.ID),Me&&zi&&u.collisionIndex.insertCollisionBox(zi.box,S.get("icon-ignore-placement"),w.bucketInstanceId,Ir,ie.ID),Tr&&(Q&&u.collisionIndex.insertCollisionCircles(Tr.circles,S.get("text-ignore-placement"),w.bucketInstanceId,_i,ie.ID),o)){var Aa=w.bucketInstanceId,za=u.collisionCircleArrays[Aa];za===void 0&&(za=u.collisionCircleArrays[Aa]=new oi);for(var ws=0;ws<Tr.circles.length;ws+=4)za.circles.push(Tr.circles[ws+0]),za.circles.push(Tr.circles[ws+1]),za.circles.push(Tr.circles[ws+2]),za.circles.push(Tr.collisionDetected?1:0)}u.placements[ft.crossTileID]=new Ps(Q||Oe,Me||Ke,Vt||w.justReloaded),s[ft.crossTileID]=!0}};if(Ae)for(var lt=w.getSortedSymbolIndexes(this.transform.angle),mt=lt.length-1;mt>=0;--mt){var Dt=lt[mt];et(w.symbolInstances.get(Dt),w.collisionArrays[Dt])}else for(var zt=n.symbolInstanceStart;zt<n.symbolInstanceEnd;zt++)et(w.symbolInstances.get(zt),w.collisionArrays[zt]);if(o&&w.bucketInstanceId in this.collisionCircleArrays){var Kt=this.collisionCircleArrays[w.bucketInstanceId];a.invert(Kt.invProjMatrix,k),Kt.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},Ui.prototype.markUsedJustification=function(n,s,o,u){var m;m=u===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];w<S.length;w+=1){var k=S[w];k>=0&&(n.text.placedSymbolArray.get(k).crossTileID=m>=0&&k!==m?0:o.crossTileID)}},Ui.prototype.markUsedOrientation=function(n,s,o){for(var u=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,m=s===a.WritingMode.vertical?s:0,w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];w<S.length;w+=1)n.text.placedSymbolArray.get(S[w]).placedOrientation=u;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=m)},Ui.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var u=s?s.symbolFadeChange(n):1,m=s?s.opacities:{},w=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(var k in this.placements){var P=this.placements[k],L=m[k];L?(this.opacities[k]=new Mn(L,u,P.text,P.icon),o=o||P.text!==L.text.placed||P.icon!==L.icon.placed):(this.opacities[k]=new Mn(null,u,P.text,P.icon,P.skipFade),o=o||P.text||P.icon)}for(var X in m){var W=m[X];if(!this.opacities[X]){var J=new Mn(W,u,!1,!1);J.isHidden()||(this.opacities[X]=J,o=o||W.text.placed||W.icon.placed)}}for(var ee in w)this.variableOffsets[ee]||!this.opacities[ee]||this.opacities[ee].isHidden()||(this.variableOffsets[ee]=w[ee]);for(var ie in S)this.placedOrientations[ie]||!this.opacities[ie]||this.opacities[ie].isHidden()||(this.placedOrientations[ie]=S[ie]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},Ui.prototype.updateLayerOpacities=function(n,s){for(var o={},u=0,m=s;u<m.length;u+=1){var w=m[u],S=w.getBucket(n);S&&w.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,o,w.collisionBoxArray)}},Ui.prototype.updateBucketOpacities=function(n,s,o){var u=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var m=n.layers[0].layout,w=new Mn(null,0,!1,!1,!0),S=m.get("text-allow-overlap"),k=m.get("icon-allow-overlap"),P=m.get("text-variable-anchor"),L=m.get("text-rotation-alignment")==="map",X=m.get("text-pitch-alignment")==="map",W=m.get("icon-text-fit")!=="none",J=new Mn(null,0,S&&(k||!n.hasIconData()||m.get("icon-optional")),k&&(S||!n.hasTextData()||m.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var ee=function(le,me,be){for(var Te=0;Te<me/4;Te++)le.opacityVertexArray.emplaceBack(be)},ie=function(le){var me=n.symbolInstances.get(le),be=me.numHorizontalGlyphVertices,Te=me.numVerticalGlyphVertices,Ee=me.crossTileID,Ae=u.opacities[Ee];s[Ee]?Ae=w:Ae||(u.opacities[Ee]=Ae=J),s[Ee]=!0;var Oe=me.numIconVertices>0,Ke=u.placedOrientations[me.crossTileID],et=Ke===a.WritingMode.vertical,lt=Ke===a.WritingMode.horizontal||Ke===a.WritingMode.horizontalOnly;if(be>0||Te>0){var mt=ls(Ae.text);ee(n.text,be,et?aa:mt),ee(n.text,Te,lt?aa:mt);var Dt=Ae.text.isHidden();[me.rightJustifiedTextSymbolIndex,me.centerJustifiedTextSymbolIndex,me.leftJustifiedTextSymbolIndex].forEach(function(Pt){Pt>=0&&(n.text.placedSymbolArray.get(Pt).hidden=Dt||et?1:0)}),me.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(me.verticalPlacedTextSymbolIndex).hidden=Dt||lt?1:0);var zt=u.variableOffsets[me.crossTileID];zt&&u.markUsedJustification(n,zt.anchor,me,Ke);var Kt=u.placedOrientations[me.crossTileID];Kt&&(u.markUsedJustification(n,"left",me,Kt),u.markUsedOrientation(n,Kt,me))}if(Oe){var ft=ls(Ae.icon),Ft=!(W&&me.verticalPlacedIconSymbolIndex&&et);me.placedIconSymbolIndex>=0&&(ee(n.icon,me.numIconVertices,Ft?ft:aa),n.icon.placedSymbolArray.get(me.placedIconSymbolIndex).hidden=Ae.icon.isHidden()),me.verticalPlacedIconSymbolIndex>=0&&(ee(n.icon,me.numVerticalIconVertices,Ft?aa:ft),n.icon.placedSymbolArray.get(me.verticalPlacedIconSymbolIndex).hidden=Ae.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Nt=n.collisionArrays[le];if(Nt){var Q=new a.Point(0,0);if(Nt.textBox||Nt.verticalTextBox){var Me=!0;if(P){var Vt=u.variableOffsets[Ee];Vt?(Q=ai(Vt.anchor,Vt.width,Vt.height,Vt.textOffset,Vt.textBoxScale),L&&Q._rotate(X?u.transform.angle:-u.transform.angle)):Me=!1}Nt.textBox&&Uo(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Me||et,Q.x,Q.y),Nt.verticalTextBox&&Uo(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Me||lt,Q.x,Q.y)}var At=Boolean(!lt&&Nt.verticalIconBox);Nt.iconBox&&Uo(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,At,W?Q.x:0,W?Q.y:0),Nt.verticalIconBox&&Uo(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!At,W?Q.x:0,W?Q.y:0)}}},se=0;se<n.symbolInstances.length;se++)ie(se);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var $=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=$.invProjMatrix,n.placementViewportMatrix=$.viewportMatrix,n.collisionCircleArray=$.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Ui.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ui.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Ui.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Ui.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},Ui.prototype.setStale=function(){this.stale=!0};var jo=Math.pow(2,25),Ys=Math.pow(2,24),Ci=Math.pow(2,17),Na=Math.pow(2,16),qo=Math.pow(2,9),kl=Math.pow(2,8),oa=Math.pow(2,1);function ls(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*jo+s*Ys+o*Ci+s*Na+o*qo+s*kl+o*oa+s}var aa=0,Cs=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Cs.prototype.continuePlacement=function(n,s,o,u,m){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,u,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(S,k){return S.sortKey-k.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,m())return!0;return!1};var Ln=function(n,s,o,u,m,w,S){this.placement=new Ui(n,m,w,S),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=u,this._done=!1};Ln.prototype.isDone=function(){return this._done},Ln.prototype.continuePlacement=function(n,s,o){for(var u=this,m=a.browser.now(),w=function(){var P=a.browser.now()-m;return!u._forceFullPlacement&&P>2};this._currentPlacementIndex>=0;){var S=s[n[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=k)&&(!S.maxzoom||S.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new Cs(S)),this._inProgressLayer.continuePlacement(o[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ln.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Zo=512/a.EXTENT/2,va=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var u=0;u<s.length;u++){var m=s.get(u),w=m.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:m.crossTileID,coord:this.getScaledCoordinates(m,n)})}};va.prototype.getScaledCoordinates=function(n,s){var o=Zo/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},va.prototype.findMatches=function(n,s,o){for(var u=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),m=0;m<n.length;m++){var w=n.get(m);if(!w.crossTileID){var S=this.indexedSymbolInstances[w.key];if(S)for(var k=this.getScaledCoordinates(w,s),P=0,L=S;P<L.length;P+=1){var X=L[P];if(Math.abs(X.coord.x-k.x)<=u&&Math.abs(X.coord.y-k.y)<=u&&!o[X.crossTileID]){o[X.crossTileID]=!0,w.crossTileID=X.crossTileID;break}}}}};var Rn=function(){this.maxCrossTileID=0};Rn.prototype.generate=function(){return++this.maxCrossTileID};var lo=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};lo.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var u=this.indexes[o],m={};for(var w in u){var S=u[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),m[S.tileID.key]=S}this.indexes[o]=m}this.lng=n},lo.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var u=0;u<s.symbolInstances.length;u++)s.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var m=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var S=this.indexes[w];if(Number(w)>n.overscaledZ)for(var k in S){var P=S[k];P.tileID.isChildOf(n)&&P.findMatches(s.symbolInstances,n,m)}else{var L=S[n.scaledTo(Number(w)).key];L&&L.findMatches(s.symbolInstances,n,m)}}for(var X=0;X<s.symbolInstances.length;X++){var W=s.symbolInstances.get(X);W.crossTileID||(W.crossTileID=o.generate(),m[W.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new va(n,s.symbolInstances,s.bucketInstanceId),!0},lo.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var u=0,m=s.indexedSymbolInstances[o];u<m.length;u+=1)delete this.usedCrossTileIDs[n][m[u].crossTileID]},lo.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var u=this.indexes[o];for(var m in u)n[u[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,u[m]),delete u[m],s=!0)}return s};var _e=function(){this.layerIndexes={},this.crossTileIDs=new Rn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};_e.prototype.addLayer=function(n,s,o){var u=this.layerIndexes[n.id];u===void 0&&(u=this.layerIndexes[n.id]=new lo);var m=!1,w={};u.handleWrapJump(o);for(var S=0,k=s;S<k.length;S+=1){var P=k[S],L=P.getBucket(n);L&&n.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(P.tileID,L,this.crossTileIDs)&&(m=!0),w[L.bucketInstanceId]=!0)}return u.removeStaleBuckets(w)&&(m=!0),m},_e.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(u){s[u]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var nn=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},Ti=a.pick(it,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Br=a.pick(it,["setCenter","setZoom","setBearing","setPitch"]),Bn=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var u,m=a.styleSpec.$root[o];m.required&&(u=o==="version"?s:m.type==="array"?[]:{})!=null&&(n[o]=u)}return n}(),Hn=function(n){function s(o,u){var m=this;u===void 0&&(u={}),n.call(this),this.map=o,this.dispatcher=new gt(ze(),this),this.imageManager=new Ue,this.imageManager.setEventedParent(this),this.glyphManager=new xt(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new yt(256,512),this.crossTileSymbolIndex=new _e,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(S){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(k,P){if(a.triggerPluginCompletionEvent(k),P&&P.every(function(X){return X}))for(var L in w.sourceCaches)w.sourceCaches[L].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var k=m.sourceCaches[S.sourceId];if(k){var P=k.getSource();if(P&&P.vectorLayerIds)for(var L in m._layers){var X=m._layers[L];X.source===P.id&&m._validateLayer(X)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,u){var m=this;u===void 0&&(u={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var w=typeof u.validate=="boolean"?u.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,u.accessToken);var S=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(S,function(k,P){m._request=null,k?m.fire(new a.ErrorEvent(k)):P&&m._load(P,w)})},s.prototype.loadJSON=function(o,u){var m=this;u===void 0&&(u={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){m._request=null,m._load(o,u.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Bn,!1)},s.prototype._load=function(o,u){if(!u||!nn(this,a.validateStyle(o))){for(var m in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(m,o.sources[m],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var w=Ye(this.stylesheet.layers);this._order=w.map(function(L){return L.id}),this._layers={},this._serializedLayers={};for(var S=0,k=w;S<k.length;S+=1){var P=k[S];(P=a.createStyleLayer(P)).setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Rt(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var u=this;this._spriteRequest=function(m,w,S){var k,P,L,X=a.browser.devicePixelRatio>1?"@2x":"",W=a.getJSON(w.transformRequest(w.normalizeSpriteURL(m,X,".json"),a.ResourceType.SpriteJSON),function(ie,se){W=null,L||(L=ie,k=se,ee())}),J=a.getImage(w.transformRequest(w.normalizeSpriteURL(m,X,".png"),a.ResourceType.SpriteImage),function(ie,se){J=null,L||(L=ie,P=se,ee())});function ee(){if(L)S(L);else if(k&&P){var ie=a.browser.getImageData(P),se={};for(var $ in k){var le=k[$],me=le.width,be=le.height,Te=le.x,Ee=le.y,Ae=le.sdf,Oe=le.pixelRatio,Ke=le.stretchX,et=le.stretchY,lt=le.content,mt=new a.RGBAImage({width:me,height:be});a.RGBAImage.copy(ie,mt,{x:Te,y:Ee},{x:0,y:0},{width:me,height:be}),se[$]={data:mt,pixelRatio:Oe,sdf:Ae,stretchX:Ke,stretchY:et,content:lt}}S(null,se)}}return{cancel:function(){W&&(W.cancel(),W=null),J&&(J.cancel(),J=null)}}}(o,this.map._requestManager,function(m,w){if(u._spriteRequest=null,m)u.fire(new a.ErrorEvent(m));else if(w)for(var S in w)u.imageManager.addImage(S,w[S]);u.imageManager.setLoaded(!0),u._availableImages=u.imageManager.listImages(),u.dispatcher.broadcast("setImages",u._availableImages),u.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var u=this.sourceCaches[o.source];if(u){var m=o.sourceLayer;if(m){var w=u.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(m)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+m+'" does not exist on source "'+w.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var u=[],m=0,w=o;m<w.length;m+=1){var S=this._layers[w[m]];S.type!=="custom"&&u.push(S.serialize())}return u},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var u in this._layers)if(this._layers[u].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var u=this._changed;if(this._changed){var m=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var S in(m.length||w.length)&&this._updateWorkerLayers(m,w),this._updatedSources){var k=this._updatedSources[S];k==="reload"?this._reloadSource(S):k==="clear"&&this._clearSource(S)}for(var P in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var L={};for(var X in this.sourceCaches){var W=this.sourceCaches[X];L[X]=W.used,W.used=!1}for(var J=0,ee=this._order;J<ee.length;J+=1){var ie=this._layers[ee[J]];ie.recalculate(o,this._availableImages),!ie.isHidden(o.zoom)&&ie.source&&(this.sourceCaches[ie.source].used=!0)}for(var se in L){var $=this.sourceCaches[se];L[se]!==$.used&&$.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:se}))}this.light.recalculate(o),this.z=o.zoom,u&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:u})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var u=this;if(this._checkLoaded(),nn(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Ye(o.layers);var m=function(S,k){if(!S)return[{command:it.setStyle,args:[k]}];var P=[];try{if(!a.deepEqual(S.version,k.version))return[{command:it.setStyle,args:[k]}];a.deepEqual(S.center,k.center)||P.push({command:it.setCenter,args:[k.center]}),a.deepEqual(S.zoom,k.zoom)||P.push({command:it.setZoom,args:[k.zoom]}),a.deepEqual(S.bearing,k.bearing)||P.push({command:it.setBearing,args:[k.bearing]}),a.deepEqual(S.pitch,k.pitch)||P.push({command:it.setPitch,args:[k.pitch]}),a.deepEqual(S.sprite,k.sprite)||P.push({command:it.setSprite,args:[k.sprite]}),a.deepEqual(S.glyphs,k.glyphs)||P.push({command:it.setGlyphs,args:[k.glyphs]}),a.deepEqual(S.transition,k.transition)||P.push({command:it.setTransition,args:[k.transition]}),a.deepEqual(S.light,k.light)||P.push({command:it.setLight,args:[k.light]});var L={},X=[];(function(J,ee,ie,se){var $;for($ in ee=ee||{},J=J||{})J.hasOwnProperty($)&&(ee.hasOwnProperty($)||ot($,ie,se));for($ in ee)ee.hasOwnProperty($)&&(J.hasOwnProperty($)?a.deepEqual(J[$],ee[$])||(J[$].type==="geojson"&&ee[$].type==="geojson"&&cr(J,ee,$)?ie.push({command:it.setGeoJSONSourceData,args:[$,ee[$].data]}):er($,ee,ie,se)):Ut($,ee,ie))})(S.sources,k.sources,X,L);var W=[];S.layers&&S.layers.forEach(function(J){L[J.source]?P.push({command:it.removeLayer,args:[J.id]}):W.push(J)}),P=P.concat(X),function(J,ee,ie){ee=ee||[];var se,$,le,me,be,Te,Ee,Ae=(J=J||[]).map(or),Oe=ee.map(or),Ke=J.reduce(Jt,{}),et=ee.reduce(Jt,{}),lt=Ae.slice(),mt=Object.create(null);for(se=0,$=0;se<Ae.length;se++)et.hasOwnProperty(le=Ae[se])?$++:(ie.push({command:it.removeLayer,args:[le]}),lt.splice(lt.indexOf(le,$),1));for(se=0,$=0;se<Oe.length;se++)lt[lt.length-1-se]!==(le=Oe[Oe.length-1-se])&&(Ke.hasOwnProperty(le)?(ie.push({command:it.removeLayer,args:[le]}),lt.splice(lt.lastIndexOf(le,lt.length-$),1)):$++,ie.push({command:it.addLayer,args:[et[le],Te=lt[lt.length-se]]}),lt.splice(lt.length-se,0,le),mt[le]=!0);for(se=0;se<Oe.length;se++)if(me=Ke[le=Oe[se]],be=et[le],!mt[le]&&!a.deepEqual(me,be))if(a.deepEqual(me.source,be.source)&&a.deepEqual(me["source-layer"],be["source-layer"])&&a.deepEqual(me.type,be.type)){for(Ee in Zt(me.layout,be.layout,ie,le,null,it.setLayoutProperty),Zt(me.paint,be.paint,ie,le,null,it.setPaintProperty),a.deepEqual(me.filter,be.filter)||ie.push({command:it.setFilter,args:[le,be.filter]}),a.deepEqual(me.minzoom,be.minzoom)&&a.deepEqual(me.maxzoom,be.maxzoom)||ie.push({command:it.setLayerZoomRange,args:[le,be.minzoom,be.maxzoom]}),me)me.hasOwnProperty(Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&(Ee.indexOf("paint.")===0?Zt(me[Ee],be[Ee],ie,le,Ee.slice(6),it.setPaintProperty):a.deepEqual(me[Ee],be[Ee])||ie.push({command:it.setLayerProperty,args:[le,Ee,be[Ee]]}));for(Ee in be)be.hasOwnProperty(Ee)&&!me.hasOwnProperty(Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&(Ee.indexOf("paint.")===0?Zt(me[Ee],be[Ee],ie,le,Ee.slice(6),it.setPaintProperty):a.deepEqual(me[Ee],be[Ee])||ie.push({command:it.setLayerProperty,args:[le,Ee,be[Ee]]}))}else ie.push({command:it.removeLayer,args:[le]}),Te=lt[lt.lastIndexOf(le)+1],ie.push({command:it.addLayer,args:[be,Te]})}(W,k.layers,P)}catch(J){console.warn("Unable to compute style diff:",J),P=[{command:it.setStyle,args:[k]}]}return P}(this.serialize(),o).filter(function(S){return!(S.command in Br)});if(m.length===0)return!1;var w=m.filter(function(S){return!(S.command in Ti)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(S){return S.command}).join(", ")+".");return m.forEach(function(S){S.command!=="setTransition"&&u[S.command].apply(u,S.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,u){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,u),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,u){this.imageManager.updateImage(o,u)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,u,m){var w=this;if(m===void 0&&(m={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(u).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,u,null,m))){this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);var S=this.sourceCaches[o]=new oe(o,u,this.dispatcher);S.style=this,S.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:S.serialize(),sourceId:o}}),S.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var u in this._layers)if(this._layers[u].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+u+'" is using it.')));var m=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],m.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),m.setEventedParent(null),m.clearTiles(),m.onRemove&&m.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,u){this._checkLoaded(),this.sourceCaches[o].getSource().setData(u),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,u,m){m===void 0&&(m={}),this._checkLoaded();var w=o.id;if(this.getLayer(w))this.fire(new a.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var S;if(o.type==="custom"){if(nn(this,a.validateCustomStyleLayer(o)))return;S=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.clone$1(o),o=a.extend(o,{source:w})),this._validate(a.validateStyle.layer,"layers."+w,o,{arrayIndex:-1},m))return;S=a.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize()}var k=u?this._order.indexOf(u):this._order.length;if(u&&k===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.')));else{if(this._order.splice(k,0,w),this._layerOrderChanged=!0,this._layers[w]=S,this._removedLayers[w]&&S.source&&S.type!=="custom"){var P=this._removedLayers[w];delete this._removedLayers[w],P.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},s.prototype.moveLayer=function(o,u){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==u){var m=this._order.indexOf(o);this._order.splice(m,1);var w=u?this._order.indexOf(u):this._order.length;u&&w===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.'))):(this._order.splice(w,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var u=this._layers[o];if(u){u.setEventedParent(null);var m=this._order.indexOf(o);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,u,m){this._checkLoaded();var w=this.getLayer(o);w?w.minzoom===u&&w.maxzoom===m||(u!=null&&(w.minzoom=u),m!=null&&(w.maxzoom=m),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,u,m){m===void 0&&(m={}),this._checkLoaded();var w=this.getLayer(o);if(w){if(!a.deepEqual(w.filter,u))return u==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,"layers."+w.id+".filter",u,null,m)||(w.filter=a.clone$1(u),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,u,m,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getLayoutProperty(u),m)||(S.setLayoutProperty(u,m,w),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,u){var m=this.getLayer(o);if(m)return m.getLayoutProperty(u);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,u,m,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getPaintProperty(u),m)||(S.setPaintProperty(u,m,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,u){return this.getLayer(o).getPaintProperty(u)},s.prototype.setFeatureState=function(o,u){this._checkLoaded();var m=o.source,w=o.sourceLayer,S=this.sourceCaches[m];if(S!==void 0){var k=S.getSource().type;k==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):k!=="vector"||w?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(w,o.id,u)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,u){this._checkLoaded();var m=o.source,w=this.sourceCaches[m];if(w!==void 0){var S=w.getSource().type,k=S==="vector"?o.sourceLayer:void 0;S!=="vector"||k?u&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(k,o.id,u):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var u=o.source,m=o.sourceLayer,w=this.sourceCaches[u];if(w!==void 0){if(w.getSource().type!=="vector"||m)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(m,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var u=this,m=function(Ke){return u._layers[Ke].type==="fill-extrusion"},w={},S=[],k=this._order.length-1;k>=0;k--){var P=this._order[k];if(m(P)){w[P]=k;for(var L=0,X=o;L<X.length;L+=1){var W=X[L][P];if(W)for(var J=0,ee=W;J<ee.length;J+=1)S.push(ee[J])}}}S.sort(function(Ke,et){return et.intersectionZ-Ke.intersectionZ});for(var ie=[],se=this._order.length-1;se>=0;se--){var $=this._order[se];if(m($))for(var le=S.length-1;le>=0;le--){var me=S[le].feature;if(w[me.layer.id]<se)break;ie.push(me),S.pop()}else for(var be=0,Te=o;be<Te.length;be+=1){var Ee=Te[be][$];if(Ee)for(var Ae=0,Oe=Ee;Ae<Oe.length;Ae+=1)ie.push(Oe[Ae].feature)}}return ie},s.prototype.queryRenderedFeatures=function(o,u,m){u&&u.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);var w={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,k=u.layers;S<k.length;S+=1){var P=k[S],L=this._layers[P];if(!L)return this.fire(new a.ErrorEvent(new Error("The layer '"+P+"' does not exist in the map's style and cannot be queried for features."))),[];w[L.source]=!0}}var X=[];for(var W in u.availableImages=this._availableImages,this.sourceCaches)u.layers&&!w[W]||X.push(Gr(this.sourceCaches[W],this._layers,this._serializedLayers,o,u,m));return this.placement&&X.push(function(J,ee,ie,se,$,le,me){for(var be={},Te=le.queryRenderedSymbols(se),Ee=[],Ae=0,Oe=Object.keys(Te).map(Number);Ae<Oe.length;Ae+=1)Ee.push(me[Oe[Ae]]);Ee.sort(si);for(var Ke=function(){var zt=lt[et],Kt=zt.featureIndex.lookupSymbolFeatures(Te[zt.bucketInstanceId],ee,zt.bucketIndex,zt.sourceLayerIndex,$.filter,$.layers,$.availableImages,J);for(var ft in Kt){var Ft=be[ft]=be[ft]||[],Nt=Kt[ft];Nt.sort(function(Vt,At){var Pt=zt.featureSortOrder;if(Pt){var ci=Pt.indexOf(Vt.featureIndex);return Pt.indexOf(At.featureIndex)-ci}return At.featureIndex-Vt.featureIndex});for(var Q=0,Me=Nt;Q<Me.length;Q+=1)Ft.push(Me[Q])}},et=0,lt=Ee;et<lt.length;et+=1)Ke();var mt=function(zt){be[zt].forEach(function(Kt){var ft=Kt.feature,Ft=ie[J[zt].source].getFeatureState(ft.layer["source-layer"],ft.id);ft.source=ft.layer.source,ft.layer["source-layer"]&&(ft.sourceLayer=ft.layer["source-layer"]),ft.state=Ft})};for(var Dt in be)mt(Dt);return be}(this._layers,this._serializedLayers,this.sourceCaches,o,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(X)},s.prototype.querySourceFeatures=function(o,u){u&&u.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);var m=this.sourceCaches[o];return m?function(w,S){for(var k=w.getRenderableIds().map(function(ee){return w.getTileByID(ee)}),P=[],L={},X=0;X<k.length;X++){var W=k[X],J=W.tileID.canonical.key;L[J]||(L[J]=!0,W.querySourceFeatures(P,S))}return P}(m,u):[]},s.prototype.addSourceType=function(o,u,m){return s.getSourceType(o)?m(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},m):m(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,u){u===void 0&&(u={}),this._checkLoaded();var m=this.light.getLight(),w=!1;for(var S in o)if(!a.deepEqual(o[S],m[S])){w=!0;break}if(w){var k={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(k)}},s.prototype._validate=function(o,u,m,w,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&nn(this,o.call(a.validateStyle,a.extend({key:u,style:this.serialize(),value:m,styleSpec:a.styleSpec},w)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var u in this.sourceCaches)this.sourceCaches[u].clearTiles(),this.sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var u in this.sourceCaches)this.sourceCaches[u].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,u,m,w,S){S===void 0&&(S=!1);for(var k=!1,P=!1,L={},X=0,W=this._order;X<W.length;X+=1){var J=this._layers[W[X]];if(J.type==="symbol"){if(!L[J.source]){var ee=this.sourceCaches[J.source];L[J.source]=ee.getRenderableIds(!0).map(function(me){return ee.getTileByID(me)}).sort(function(me,be){return be.tileID.overscaledZ-me.tileID.overscaledZ||(me.tileID.isLessThan(be.tileID)?-1:1)})}var ie=this.crossTileSymbolIndex.addLayer(J,L[J.source],o.center.lng);k=k||ie}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new Ln(o,this._order,S,u,m,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),P=!0),k&&this.pauseablePlacement.placement.setStale()),P||k)for(var se=0,$=this._order;se<$.length;se+=1){var le=this._layers[$[se]];le.type==="symbol"&&this.placement.updateLayerOpacities(le,L[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,u,m){this.imageManager.getImages(u.icons,m),this._updateTilesForChangedImages();var w=this.sourceCaches[u.source];w&&w.setDependencies(u.tileID.key,u.type,u.icons)},s.prototype.getGlyphs=function(o,u,m){this.glyphManager.getGlyphs(u.stacks,m)},s.prototype.getResource=function(o,u,m){return a.makeRequest(u,m)},s}(a.Evented);Hn.getSourceType=function(n){return ii[n]},Hn.setSourceType=function(n,s){ii[n]=s},Hn.registerForPluginStateChange=a.registerForPluginStateChange;var gi=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),To=dr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),us=dr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Pu=dr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ms=dr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Ds=dr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Qs=dr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Tl=dr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),$s=dr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Jn=dr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),sa=dr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Go=dr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Io=dr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ls=dr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),cs=dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),pn=dr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Il=dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),uo=dr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),co=dr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Va=dr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ao=dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ko=dr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Ua=dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ja=dr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Yn=dr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),tu=dr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),la=dr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function dr(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=s.match(/attribute ([\w]+) ([\w]+)/g),m=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(m):m,k={};return{fragmentSource:n=n.replace(o,function(P,L,X,W,J){return k[J]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_`+J+`
varying `+X+" "+W+" "+J+`;
#else
uniform `+X+" "+W+" u_"+J+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+J+`
    `+X+" "+W+" "+J+" = u_"+J+`;
#endif
`}),vertexSource:s=s.replace(o,function(P,L,X,W,J){var ee=W==="float"?"vec2":"vec4",ie=J.match(/color/)?"color":ee;return k[J]?L==="define"?`
#ifndef HAS_UNIFORM_u_`+J+`
uniform lowp float u_`+J+`_t;
attribute `+X+" "+ee+" a_"+J+`;
varying `+X+" "+W+" "+J+`;
#else
uniform `+X+" "+W+" u_"+J+`;
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_`+J+`
    `+J+" = a_"+J+`;
#else
    `+X+" "+W+" "+J+" = u_"+J+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+J+`
    `+J+" = unpack_mix_"+ie+"(a_"+J+", u_"+J+`_t);
#else
    `+X+" "+W+" "+J+" = u_"+J+`;
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_`+J+`
uniform lowp float u_`+J+`_t;
attribute `+X+" "+ee+" a_"+J+`;
#else
uniform `+X+" "+W+" u_"+J+`;
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_`+J+`
    `+X+" "+W+" "+J+" = a_"+J+`;
#else
    `+X+" "+W+" "+J+" = u_"+J+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+J+`
    `+X+" "+W+" "+J+" = unpack_mix_"+ie+"(a_"+J+", u_"+J+`_t);
#else
    `+X+" "+W+" "+J+" = u_"+J+`;
#endif
`}),staticAttributes:u,staticUniforms:S}}var qa=Object.freeze({__proto__:null,prelude:To,background:us,backgroundPattern:Pu,circle:Ms,clippingMask:Ds,heatmap:Qs,heatmapTexture:Tl,collisionBox:$s,collisionCircle:Jn,debug:sa,fill:Go,fillOutline:Io,fillOutlinePattern:Ls,fillPattern:cs,fillExtrusion:pn,fillExtrusionPattern:Il,hillshadePrepare:uo,hillshade:co,line:Va,lineGradient:Ao,linePattern:Ko,lineSDF:Ua,raster:ja,symbolIcon:Yn,symbolSDF:tu,symbolTextAndIcon:la}),el=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function hs(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var u=n[o].split(" ");s.push(u.pop())}return s}el.prototype.bind=function(n,s,o,u,m,w,S,k){this.context=n;for(var P=this.boundPaintVertexBuffers.length!==u.length,L=0;!P&&L<u.length;L++)this.boundPaintVertexBuffers[L]!==u[L]&&(P=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!P&&this.boundIndexBuffer===m&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===k?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),m&&m.dynamicDraw&&m.bind(),k&&k.bind()):this.freshBind(s,o,u,m,w,S,k)},el.prototype.freshBind=function(n,s,o,u,m,w,S){var k,P=n.numAttributes,L=this.context,X=L.gl;if(L.extVertexArrayObject)this.vao&&this.destroy(),this.vao=L.extVertexArrayObject.createVertexArrayOES(),L.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=u,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{k=L.currentNumAttributes||0;for(var W=P;W<k;W++)X.disableVertexAttribArray(W)}s.enableAttributes(X,n);for(var J=0,ee=o;J<ee.length;J+=1)ee[J].enableAttributes(X,n);w&&w.enableAttributes(X,n),S&&S.enableAttributes(X,n),s.bind(),s.setVertexAttribPointers(X,n,m);for(var ie=0,se=o;ie<se.length;ie+=1){var $=se[ie];$.bind(),$.setVertexAttribPointers(X,n,m)}w&&(w.bind(),w.setVertexAttribPointers(X,n,m)),u&&u.bind(),S&&(S.bind(),S.setVertexAttribPointers(X,n,m)),L.currentNumAttributes=P},el.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var rc=function(n,s,o,u,m,w){var S=n.gl;this.program=S.createProgram();for(var k=hs(o.staticAttributes),P=u?u.getBinderAttributes():[],L=k.concat(P),X=o.staticUniforms?hs(o.staticUniforms):[],W=u?u.getBinderUniforms():[],J=[],ee=0,ie=X.concat(W);ee<ie.length;ee+=1){var se=ie[ee];J.indexOf(se)<0&&J.push(se)}var $=u?u.defines():[];w&&$.push("#define OVERDRAW_INSPECTOR;");var le=$.concat(To.fragmentSource,o.fragmentSource).join(`
`),me=$.concat(To.vertexSource,o.vertexSource).join(`
`),be=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(be,le),S.compileShader(be),S.attachShader(this.program,be);var Te=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(Te,me),S.compileShader(Te),S.attachShader(this.program,Te),this.attributes={};var Ee={};this.numAttributes=L.length;for(var Ae=0;Ae<this.numAttributes;Ae++)L[Ae]&&(S.bindAttribLocation(this.program,Ae,L[Ae]),this.attributes[L[Ae]]=Ae);S.linkProgram(this.program),S.deleteShader(Te),S.deleteShader(be);for(var Oe=0;Oe<J.length;Oe++){var Ke=J[Oe];if(Ke&&!Ee[Ke]){var et=S.getUniformLocation(this.program,Ke);et&&(Ee[Ke]=et)}}this.fixedUniforms=m(n,Ee),this.binderUniforms=u?u.getUniforms(n,Ee):[]}}};function ru(n,s,o){var u=1/Pr(o,1,s.transform.tileZoom),m=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,s.transform.tileZoom)/m,S=w*(o.tileID.canonical.x+o.tileID.wrap*m),k=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,k>>16],u_pixel_coord_lower:[65535&S,65535&k]}}rc.prototype.draw=function(n,s,o,u,m,w,S,k,P,L,X,W,J,ee,ie,se){var $,le=n.gl;if(!this.failedToCreate){for(var me in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(u),n.setColorMode(m),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[me].set(S[me]);ee&&ee.setUniforms(n,this.binderUniforms,W,{zoom:J});for(var be=($={},$[le.LINES]=2,$[le.TRIANGLES]=3,$[le.LINE_STRIP]=1,$)[s],Te=0,Ee=X.get();Te<Ee.length;Te+=1){var Ae=Ee[Te],Oe=Ae.vaos||(Ae.vaos={});(Oe[k]||(Oe[k]=new el)).bind(n,this,P,ee?ee.getPaintVertexBuffers():[],L,Ae.vertexOffset,ie,se),le.drawElements(s,Ae.primitiveLength*be,le.UNSIGNED_SHORT,Ae.primitiveOffset*be*2)}}};var ps=function(n,s,o,u){var m=s.style.light,w=m.properties.get("position"),S=[w.x,w.y,w.z],k=a.create$1();m.properties.get("anchor")==="viewport"&&a.fromRotation(k,-s.transform.angle),a.transformMat3(S,S,k);var P=m.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+o,u_opacity:u}},zo=function(n,s,o,u,m,w,S){return a.extend(ps(n,s,o,u),ru(w,s,S),{u_height_factor:-Math.pow(2,m.overscaledZ)/S.tileSize/8})},ba=function(n){return{u_matrix:n}},Po=function(n,s,o,u){return a.extend(ba(n),ru(o,s,u))},tl=function(n,s){return{u_matrix:n,u_world:s}},iu=function(n,s,o,u,m){return a.extend(Po(n,s,o,u),{u_world:m})},Al=function(n,s,o,u){var m,w,S=n.transform;if(u.paint.get("circle-pitch-alignment")==="map"){var k=Pr(o,1,S.zoom);m=!0,w=[k,k]}else m=!1,w=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:w}},ho=function(n,s,o){var u=Pr(o,1,s.zoom),m=Math.pow(2,s.zoom-o.tileID.overscaledZ),w=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[s.pixelsToGLUnits[0]/(u*m),s.pixelsToGLUnits[1]/(u*m)],u_overscale_factor:w}},nu=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},On=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},fn=function(n){return{u_matrix:n}},ua=function(n,s,o,u){return{u_matrix:n,u_extrude_scale:Pr(s,1,o),u_intensity:u}},Rs=function(n,s,o){var u=n.transform;return{u_matrix:fs(n,s,o),u_ratio:1/Pr(s,1,u.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},kr=function(n,s,o,u){return a.extend(Rs(n,s,o),{u_image:0,u_image_height:u})},ou=function(n,s,o,u){var m=n.transform,w=Xo(s,m);return{u_matrix:fs(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Pr(s,1,m.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[w,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Cu=function(n,s,o,u,m){var w=n.lineAtlas,S=Xo(s,n.transform),k=o.layout.get("line-cap")==="round",P=w.getDash(u.from,k),L=w.getDash(u.to,k),X=P.width*m.fromScale,W=L.width*m.toScale;return a.extend(Rs(n,s,o),{u_patternscale_a:[S/X,-P.height/2],u_patternscale_b:[S/W,-L.height/2],u_sdfgamma:w.width/(256*Math.min(X,W)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:L.y,u_mix:m.t})};function Xo(n,s){return 1/Pr(n,1,s.tileZoom)}function fs(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Mu=function(n,s,o,u,m){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(S=m.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=m.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:ds(m.paint.get("raster-hue-rotate"))};var w,S};function ds(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var ms,ys=function(n,s,o,u,m,w,S,k,P,L){var X=m.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:X.cameraToCenterDistance,u_pitch:X.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:X.width/X.height,u_fade_change:m.options.fadeDuration?m.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:k,u_is_text:+P,u_pitch_with_map:+u,u_texsize:L,u_texture:0}},Bs=function(n,s,o,u,m,w,S,k,P,L,X){var W=m.transform;return a.extend(ys(n,s,o,u,m,w,S,k,P,L),{u_gamma_scale:u?Math.cos(W._pitch)*W.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+X})},ca=function(n,s,o,u,m,w,S,k,P,L){return a.extend(Bs(n,s,o,u,m,w,S,k,!0,P,!0),{u_texsize_icon:L,u_texture_icon:1})},rl=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},Za=function(n,s,o,u,m,w){return a.extend(function(S,k,P,L){var X=P.imageManager.getPattern(S.from.toString()),W=P.imageManager.getPattern(S.to.toString()),J=P.imageManager.getPixelSize(),ee=J.width,ie=J.height,se=Math.pow(2,L.tileID.overscaledZ),$=L.tileSize*Math.pow(2,P.transform.tileZoom)/se,le=$*(L.tileID.canonical.x+L.tileID.wrap*se),me=$*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:X.tl,u_pattern_br_a:X.br,u_pattern_tl_b:W.tl,u_pattern_br_b:W.br,u_texsize:[ee,ie],u_mix:k.t,u_pattern_size_a:X.displaySize,u_pattern_size_b:W.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/Pr(L,1,P.transform.tileZoom),u_pixel_coord_upper:[le>>16,me>>16],u_pixel_coord_lower:[65535&le,65535&me]}}(u,w,o,m),{u_matrix:n,u_opacity:s})},Ga={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function Wo(n,s,o,u,m,w,S){for(var k=n.context,P=k.gl,L=n.useProgram("collisionBox"),X=[],W=0,J=0,ee=0;ee<u.length;ee++){var ie=u[ee],se=s.getTile(ie),$=se.getBucket(o);if($){var le=ie.posMatrix;m[0]===0&&m[1]===0||(le=n.translatePosMatrix(ie.posMatrix,se,m,w));var me=S?$.textCollisionBox:$.iconCollisionBox,be=$.collisionCircleArray;if(be.length>0){var Te=a.create(),Ee=le;a.mul(Te,$.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(Te,Te,$.placementViewportMatrix),X.push({circleArray:be,circleOffset:J,transform:Ee,invTransform:Te}),J=W+=be.length/4}me&&L.draw(k,P.LINES,Y.disabled,re.disabled,n.colorModeForRenderPass(),ye.disabled,ho(le,n.transform,se),o.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,null,n.transform.zoom,null,null,me.collisionVertexBuffer)}}if(S&&X.length){var Ae=n.useProgram("collisionCircle"),Oe=new a.StructArrayLayout2f1f2i16;Oe.resize(4*W),Oe._trim();for(var Ke=0,et=0,lt=X;et<lt.length;et+=1)for(var mt=lt[et],Dt=0;Dt<mt.circleArray.length/4;Dt++){var zt=4*Dt,Kt=mt.circleArray[zt+0],ft=mt.circleArray[zt+1],Ft=mt.circleArray[zt+2],Nt=mt.circleArray[zt+3];Oe.emplace(Ke++,Kt,ft,Ft,Nt,0),Oe.emplace(Ke++,Kt,ft,Ft,Nt,1),Oe.emplace(Ke++,Kt,ft,Ft,Nt,2),Oe.emplace(Ke++,Kt,ft,Ft,Nt,3)}(!ms||ms.length<2*W)&&(ms=function(Tr){var zi=2*Tr,_i=new a.StructArrayLayout3ui6;_i.resize(zi),_i._trim();for(var jr=0;jr<zi;jr++){var Ir=6*jr;_i.uint16[Ir+0]=4*jr+0,_i.uint16[Ir+1]=4*jr+1,_i.uint16[Ir+2]=4*jr+2,_i.uint16[Ir+3]=4*jr+2,_i.uint16[Ir+4]=4*jr+3,_i.uint16[Ir+5]=4*jr+0}return _i}(W));for(var Q=k.createIndexBuffer(ms,!0),Me=k.createVertexBuffer(Oe,a.collisionCircleLayout.members,!0),Vt=0,At=X;Vt<At.length;Vt+=1){var Pt=At[Vt],ci=nu(Pt.transform,Pt.invTransform,n.transform);Ae.draw(k,P.TRIANGLES,Y.disabled,re.disabled,n.colorModeForRenderPass(),ye.disabled,ci,o.id,Me,Q,a.SegmentVector.simpleSegment(0,2*Pt.circleOffset,Pt.circleArray.length,Pt.circleArray.length/2),null,n.transform.zoom,null,null,null)}Me.destroy(),Q.destroy()}}var Co=a.identity(new Float32Array(16));function gs(n,s,o,u,m,w){var S=a.getAnchorAlignment(n),k=-(S.horizontalAlign-.5)*s,P=-(S.verticalAlign-.5)*o,L=a.evaluateVariableOffset(n,u);return new a.Point((k/m+L[0])*w,(P/m+L[1])*w)}function il(n,s,o,u,m,w,S,k,P,L,X){var W=n.text.placedSymbolArray,J=n.text.dynamicLayoutVertexArray,ee=n.icon.dynamicLayoutVertexArray,ie={};J.clear();for(var se=0;se<W.length;se++){var $=W.get(se),le=$.hidden||!$.crossTileID||n.allowVerticalPlacement&&!$.placedOrientation?null:u[$.crossTileID];if(le){var me=new a.Point($.anchorX,$.anchorY),be=Gt(me,o?k:S),Te=ar(w.cameraToCenterDistance,be.signedDistanceFromCamera),Ee=m.evaluateSizeForFeature(n.textSizeData,L,$)*Te/a.ONE_EM;o&&(Ee*=n.tilePixelRatio/P);for(var Ae=gs(le.anchor,le.width,le.height,le.textOffset,le.textBoxScale,Ee),Oe=o?Gt(me.add(Ae),S).point:be.point.add(s?Ae.rotate(-w.angle):Ae),Ke=n.allowVerticalPlacement&&$.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,et=0;et<$.numGlyphs;et++)a.addDynamicAttributes(J,Oe,Ke);X&&$.associatedIconIndex>=0&&(ie[$.associatedIconIndex]={shiftedAnchor:Oe,angle:Ke})}else Xr($.numGlyphs,J)}if(X){ee.clear();for(var lt=n.icon.placedSymbolArray,mt=0;mt<lt.length;mt++){var Dt=lt.get(mt);if(Dt.hidden)Xr(Dt.numGlyphs,ee);else{var zt=ie[mt];if(zt)for(var Kt=0;Kt<Dt.numGlyphs;Kt++)a.addDynamicAttributes(ee,zt.shiftedAnchor,zt.angle);else Xr(Dt.numGlyphs,ee)}}n.icon.dynamicLayoutVertexBuffer.updateData(ee)}n.text.dynamicLayoutVertexBuffer.updateData(J)}function zl(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function Ka(n,s,o,u,m,w,S,k,P,L,X,W){for(var J=n.context,ee=J.gl,ie=n.transform,se=k==="map",$=P==="map",le=se&&o.layout.get("symbol-placement")!=="point",me=se&&!$&&!le,be=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Te=!1,Ee=n.depthModeForSublayer(0,Y.ReadOnly),Ae=o.layout.get("text-variable-anchor"),Oe=[],Ke=0,et=u;Ke<et.length;Ke+=1){var lt=et[Ke],mt=s.getTile(lt),Dt=mt.getBucket(o);if(Dt){var zt=m?Dt.text:Dt.icon;if(zt&&zt.segments.get().length){var Kt=zt.programConfigurations.get(o.id),ft=m||Dt.sdfIcons,Ft=m?Dt.textSizeData:Dt.iconSizeData,Nt=$||ie.pitch!==0,Q=n.useProgram(zl(ft,m,Dt),Kt),Me=a.evaluateSizeForZoom(Ft,ie.zoom),Vt=void 0,At=[0,0],Pt=void 0,ci=void 0,Tr=null,zi=void 0;if(m)Pt=mt.glyphAtlasTexture,ci=ee.LINEAR,Vt=mt.glyphAtlasTexture.size,Dt.iconsInText&&(At=mt.imageAtlasTexture.size,Tr=mt.imageAtlasTexture,zi=Nt||n.options.rotating||n.options.zooming||Ft.kind==="composite"||Ft.kind==="camera"?ee.LINEAR:ee.NEAREST);else{var _i=o.layout.get("icon-size").constantOr(0)!==1||Dt.iconsNeedLinear;Pt=mt.imageAtlasTexture,ci=ft||n.options.rotating||n.options.zooming||_i||Nt?ee.LINEAR:ee.NEAREST,Vt=mt.imageAtlasTexture.size}var jr=Pr(mt,1,n.transform.zoom),Ir=Fr(lt.posMatrix,$,se,n.transform,jr),Ji=nr(lt.posMatrix,$,se,n.transform,jr),Li=Ae&&Dt.hasTextData(),mn=o.layout.get("icon-text-fit")!=="none"&&Li&&Dt.hasIconData();le&&ko(Dt,lt.posMatrix,n,m,Ir,Ji,$,L);var qi=n.translatePosMatrix(lt.posMatrix,mt,w,S),kn=le||m&&Ae||mn?Co:Ir,Mo=n.translatePosMatrix(Ji,mt,w,S,!0),cl=ft&&o.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0,qs={program:Q,buffers:zt,uniformValues:ft?Dt.iconsInText?ca(Ft.kind,Me,me,$,n,qi,kn,Mo,Vt,At):Bs(Ft.kind,Me,me,$,n,qi,kn,Mo,m,Vt,!0):ys(Ft.kind,Me,me,$,n,qi,kn,Mo,m,Vt),atlasTexture:Pt,atlasTextureIcon:Tr,atlasInterpolation:ci,atlasInterpolationIcon:zi,isSDF:ft,hasHalo:cl};if(be&&Dt.canOverlap){Te=!0;for(var ln=0,ya=zt.segments.get();ln<ya.length;ln+=1){var hl=ya[ln];Oe.push({segments:new a.SegmentVector([hl]),sortKey:hl.sortKey,state:qs})}}else Oe.push({segments:zt.segments,sortKey:0,state:qs})}}}Te&&Oe.sort(function(za,ws){return za.sortKey-ws.sortKey});for(var Yi=0,pl=Oe;Yi<pl.length;Yi+=1){var ra=pl[Yi],Qi=ra.state;if(J.activeTexture.set(ee.TEXTURE0),Qi.atlasTexture.bind(Qi.atlasInterpolation,ee.CLAMP_TO_EDGE),Qi.atlasTextureIcon&&(J.activeTexture.set(ee.TEXTURE1),Qi.atlasTextureIcon&&Qi.atlasTextureIcon.bind(Qi.atlasInterpolationIcon,ee.CLAMP_TO_EDGE)),Qi.isSDF){var Aa=Qi.uniformValues;Qi.hasHalo&&(Aa.u_is_halo=1,_s(Qi.buffers,ra.segments,o,n,Qi.program,Ee,X,W,Aa)),Aa.u_is_halo=0}_s(Qi.buffers,ra.segments,o,n,Qi.program,Ee,X,W,Qi.uniformValues)}}function _s(n,s,o,u,m,w,S,k,P){var L=u.context;m.draw(L,L.gl.TRIANGLES,w,S,k,ye.disabled,P,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,u.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function xn(n,s,o,u,m,w,S){var k,P,L,X,W,J=n.context.gl,ee=o.paint.get("fill-pattern"),ie=ee&&ee.constantOr(1),se=o.getCrossfadeParameters();S?(P=ie&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",k=J.LINES):(P=ie?"fillPattern":"fill",k=J.TRIANGLES);for(var $=0,le=u;$<le.length;$+=1){var me=le[$],be=s.getTile(me);if(!ie||be.patternsLoaded()){var Te=be.getBucket(o);if(Te){var Ee=Te.programConfigurations.get(o.id),Ae=n.useProgram(P,Ee);ie&&(n.context.activeTexture.set(J.TEXTURE0),be.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Ee.updatePaintBuffers(se));var Oe=ee.constantOr(null);if(Oe&&be.imageAtlas){var Ke=be.imageAtlas,et=Ke.patternPositions[Oe.to.toString()],lt=Ke.patternPositions[Oe.from.toString()];et&&lt&&Ee.setConstantPatternPositions(et,lt)}var mt=n.translatePosMatrix(me.posMatrix,be,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(S){X=Te.indexBuffer2,W=Te.segments2;var Dt=[J.drawingBufferWidth,J.drawingBufferHeight];L=P==="fillOutlinePattern"&&ie?iu(mt,n,se,be,Dt):tl(mt,Dt)}else X=Te.indexBuffer,W=Te.segments,L=ie?Po(mt,n,se,be):ba(mt);Ae.draw(n.context,k,m,n.stencilModeForClipping(me),w,ye.disabled,L,o.id,Te.layoutVertexBuffer,X,W,o.paint,n.transform.zoom,Ee)}}}}function Ho(n,s,o,u,m,w,S){for(var k=n.context,P=k.gl,L=o.paint.get("fill-extrusion-pattern"),X=L.constantOr(1),W=o.getCrossfadeParameters(),J=o.paint.get("fill-extrusion-opacity"),ee=0,ie=u;ee<ie.length;ee+=1){var se=ie[ee],$=s.getTile(se),le=$.getBucket(o);if(le){var me=le.programConfigurations.get(o.id),be=n.useProgram(X?"fillExtrusionPattern":"fillExtrusion",me);X&&(n.context.activeTexture.set(P.TEXTURE0),$.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),me.updatePaintBuffers(W));var Te=L.constantOr(null);if(Te&&$.imageAtlas){var Ee=$.imageAtlas,Ae=Ee.patternPositions[Te.to.toString()],Oe=Ee.patternPositions[Te.from.toString()];Ae&&Oe&&me.setConstantPatternPositions(Ae,Oe)}var Ke=n.translatePosMatrix(se.posMatrix,$,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),et=o.paint.get("fill-extrusion-vertical-gradient"),lt=X?zo(Ke,n,et,J,se,W,$):ps(Ke,n,et,J);be.draw(k,k.gl.TRIANGLES,m,w,S,ye.backCCW,lt,o.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,o.paint,n.transform.zoom,me)}}}function Qn(n,s,o,u,m,w){var S=n.context,k=S.gl,P=s.fbo;if(P){var L=n.useProgram("hillshade");S.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,P.colorAttachment.get());var X=function(W,J,ee){var ie=ee.paint.get("hillshade-shadow-color"),se=ee.paint.get("hillshade-highlight-color"),$=ee.paint.get("hillshade-accent-color"),le=ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);ee.paint.get("hillshade-illumination-anchor")==="viewport"&&(le-=W.transform.angle);var me,be,Te,Ee=!W.options.moving;return{u_matrix:W.transform.calculatePosMatrix(J.tileID.toUnwrapped(),Ee),u_image:0,u_latrange:(me=J.tileID,be=Math.pow(2,me.canonical.z),Te=me.canonical.y,[new a.MercatorCoordinate(0,Te/be).toLngLat().lat,new a.MercatorCoordinate(0,(Te+1)/be).toLngLat().lat]),u_light:[ee.paint.get("hillshade-exaggeration"),le],u_shadow:ie,u_highlight:se,u_accent:$}}(n,s,o);L.draw(S,k.TRIANGLES,u,m,w,ye.disabled,X,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Xa(n,s,o,u,m,w){var S=n.context,k=S.gl,P=s.dem;if(P&&P.data){var L=P.dim,X=P.stride,W=P.getPixels();if(S.activeTexture.set(k.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(X),s.demTexture){var J=s.demTexture;J.update(W,{premultiply:!1}),J.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(S,W,k.RGBA,{premultiply:!1}),s.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);S.activeTexture.set(k.TEXTURE0);var ee=s.fbo;if(!ee){var ie=new a.Texture(S,{width:L,height:L,data:null},k.RGBA);ie.bind(k.LINEAR,k.CLAMP_TO_EDGE),(ee=s.fbo=S.createFramebuffer(L,L,!0)).colorAttachment.set(ie.texture)}S.bindFramebuffer.set(ee.framebuffer),S.viewport.set([0,0,L,L]),n.useProgram("hillshadePrepare").draw(S,k.TRIANGLES,u,m,w,ye.disabled,function(se,$){var le=$.stride,me=a.create();return a.ortho(me,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(me,me,[0,-a.EXTENT,0]),{u_matrix:me,u_image:1,u_dimension:[le,le],u_zoom:se.overscaledZ,u_unpack:$.getUnpackVector()}}(s.tileID,P),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function nl(n,s,o,u,m){var w=u.paint.get("raster-fade-duration");if(w>0){var S=a.browser.now(),k=(S-n.timeAdded)/w,P=s?(S-s.timeAdded)/w:-1,L=o.getSource(),X=m.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),W=!s||Math.abs(s.tileID.overscaledZ-X)>Math.abs(n.tileID.overscaledZ-X),J=W&&n.refreshedUponExpiration?1:a.clamp(W?k:1-P,0,1);return n.refreshedUponExpiration&&k>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}var Wa=new a.Color(1,0,0,1),ic=new a.Color(0,1,0,1),au=new a.Color(0,0,1,1),xa=new a.Color(1,0,1,1),Ha=new a.Color(0,1,1,1);function Pl(n,s,o,u){Ya(n,0,s+o/2,n.transform.width,o,u)}function Ja(n,s,o,u){Ya(n,s-o/2,0,o,n.transform.height,u)}function Ya(n,s,o,u,m,w){var S=n.context,k=S.gl;k.enable(k.SCISSOR_TEST),k.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,u*a.browser.devicePixelRatio,m*a.browser.devicePixelRatio),S.clear({color:w}),k.disable(k.SCISSOR_TEST)}function su(n,s,o){var u=n.context,m=u.gl,w=o.posMatrix,S=n.useProgram("debug"),k=Y.disabled,P=re.disabled,L=n.colorModeForRenderPass();u.activeTexture.set(m.TEXTURE0),n.emptyTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),S.draw(u,m.LINE_STRIP,k,P,L,ye.disabled,On(w,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var X=s.getTileByID(o.key).latestRawTileData,W=Math.floor((X&&X.byteLength||0)/1024),J=s.getTile(o).tileSize,ee=512/Math.min(J,512)*(o.overscaledZ/n.transform.zoom)*.5,ie=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(ie+=" => "+o.overscaledZ),function(se,$){se.initDebugOverlayCanvas();var le=se.debugOverlayCanvas,me=se.context.gl,be=se.debugOverlayCanvas.getContext("2d");be.clearRect(0,0,le.width,le.height),be.shadowColor="white",be.shadowBlur=2,be.lineWidth=1.5,be.strokeStyle="white",be.textBaseline="top",be.font="bold 36px Open Sans, sans-serif",be.fillText($,5,5),be.strokeText($,5,5),se.debugOverlayTexture.update(le),se.debugOverlayTexture.bind(me.LINEAR,me.CLAMP_TO_EDGE)}(n,ie+" "+W+"kb"),S.draw(u,m.TRIANGLES,k,P,ue.alphaBlended,ye.disabled,On(w,a.Color.transparent,ee),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var Qa={symbol:function(n,s,o,u,m){if(n.renderPass==="translucent"){var w=re.disabled,S=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(k,P,L,X,W,J,ee){for(var ie=P.transform,se=W==="map",$=J==="map",le=0,me=k;le<me.length;le+=1){var be=me[le],Te=X.getTile(be),Ee=Te.getBucket(L);if(Ee&&Ee.text&&Ee.text.segments.get().length){var Ae=a.evaluateSizeForZoom(Ee.textSizeData,ie.zoom),Oe=Pr(Te,1,P.transform.zoom),Ke=Fr(be.posMatrix,$,se,P.transform,Oe),et=L.layout.get("icon-text-fit")!=="none"&&Ee.hasIconData();if(Ae){var lt=Math.pow(2,ie.zoom-Te.tileID.overscaledZ);il(Ee,se,$,ee,a.symbolSize,ie,Ke,be.posMatrix,lt,Ae,et)}}}}(u,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),m),o.paint.get("icon-opacity").constantOr(1)!==0&&Ka(n,s,o,u,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),w,S),o.paint.get("text-opacity").constantOr(1)!==0&&Ka(n,s,o,u,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),w,S),s.map.showCollisionBoxes&&(Wo(n,s,o,u,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Wo(n,s,o,u,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,u){if(n.renderPass==="translucent"){var m=o.paint.get("circle-opacity"),w=o.paint.get("circle-stroke-width"),S=o.paint.get("circle-stroke-opacity"),k=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(m.constantOr(1)!==0||w.constantOr(1)!==0&&S.constantOr(1)!==0){for(var P=n.context,L=P.gl,X=n.depthModeForSublayer(0,Y.ReadOnly),W=re.disabled,J=n.colorModeForRenderPass(),ee=[],ie=0;ie<u.length;ie++){var se=u[ie],$=s.getTile(se),le=$.getBucket(o);if(le){var me=le.programConfigurations.get(o.id),be={programConfiguration:me,program:n.useProgram("circle",me),layoutVertexBuffer:le.layoutVertexBuffer,indexBuffer:le.indexBuffer,uniformValues:Al(n,se,$,o)};if(k)for(var Te=0,Ee=le.segments.get();Te<Ee.length;Te+=1){var Ae=Ee[Te];ee.push({segments:new a.SegmentVector([Ae]),sortKey:Ae.sortKey,state:be})}else ee.push({segments:le.segments,sortKey:0,state:be})}}k&&ee.sort(function(mt,Dt){return mt.sortKey-Dt.sortKey});for(var Oe=0,Ke=ee;Oe<Ke.length;Oe+=1){var et=Ke[Oe],lt=et.state;lt.program.draw(P,L.TRIANGLES,X,W,J,ye.disabled,lt.uniformValues,o.id,lt.layoutVertexBuffer,lt.indexBuffer,et.segments,o.paint,n.transform.zoom,lt.programConfiguration)}}}},heatmap:function(n,s,o,u){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var m=n.context,w=m.gl,S=re.disabled,k=new ue([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(ee,ie,se){var $=ee.gl;ee.activeTexture.set($.TEXTURE1),ee.viewport.set([0,0,ie.width/4,ie.height/4]);var le=se.heatmapFbo;if(le)$.bindTexture($.TEXTURE_2D,le.colorAttachment.get()),ee.bindFramebuffer.set(le.framebuffer);else{var me=$.createTexture();$.bindTexture($.TEXTURE_2D,me),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MAG_FILTER,$.LINEAR),le=se.heatmapFbo=ee.createFramebuffer(ie.width/4,ie.height/4,!1),function(be,Te,Ee,Ae){var Oe=be.gl;Oe.texImage2D(Oe.TEXTURE_2D,0,Oe.RGBA,Te.width/4,Te.height/4,0,Oe.RGBA,be.extRenderToTextureHalfFloat?be.extTextureHalfFloat.HALF_FLOAT_OES:Oe.UNSIGNED_BYTE,null),Ae.colorAttachment.set(Ee)}(ee,ie,me,le)}})(m,n,o),m.clear({color:a.Color.transparent});for(var P=0;P<u.length;P++){var L=u[P];if(!s.hasRenderableParent(L)){var X=s.getTile(L),W=X.getBucket(o);if(W){var J=W.programConfigurations.get(o.id);n.useProgram("heatmap",J).draw(m,w.TRIANGLES,Y.disabled,S,k,ye.disabled,ua(L.posMatrix,X,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,o.paint,n.transform.zoom,J)}}}m.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(ee,ie){var se=ee.context,$=se.gl,le=ie.heatmapFbo;if(le){se.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,le.colorAttachment.get()),se.activeTexture.set($.TEXTURE1);var me=ie.colorRampTexture;me||(me=ie.colorRampTexture=new a.Texture(se,ie.colorRamp,$.RGBA)),me.bind($.LINEAR,$.CLAMP_TO_EDGE),ee.useProgram("heatmapTexture").draw(se,$.TRIANGLES,Y.disabled,re.disabled,ee.colorModeForRenderPass(),ye.disabled,function(be,Te,Ee,Ae){var Oe=a.create();a.ortho(Oe,0,be.width,be.height,0,0,1);var Ke=be.context.gl;return{u_matrix:Oe,u_world:[Ke.drawingBufferWidth,Ke.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Te.paint.get("heatmap-opacity")}}(ee,ie),ie.id,ee.viewportBuffer,ee.quadTriangleIndexBuffer,ee.viewportSegments,ie.paint,ee.transform.zoom)}}(n,o))},line:function(n,s,o,u){if(n.renderPass==="translucent"){var m=o.paint.get("line-opacity"),w=o.paint.get("line-width");if(m.constantOr(1)!==0&&w.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,Y.ReadOnly),k=n.colorModeForRenderPass(),P=o.paint.get("line-dasharray"),L=o.paint.get("line-pattern"),X=L.constantOr(1),W=o.paint.get("line-gradient"),J=o.getCrossfadeParameters(),ee=X?"linePattern":P?"lineSDF":W?"lineGradient":"line",ie=n.context,se=ie.gl,$=!0,le=0,me=u;le<me.length;le+=1){var be=me[le],Te=s.getTile(be);if(!X||Te.patternsLoaded()){var Ee=Te.getBucket(o);if(Ee){var Ae=Ee.programConfigurations.get(o.id),Oe=n.context.program.get(),Ke=n.useProgram(ee,Ae),et=$||Ke.program!==Oe,lt=L.constantOr(null);if(lt&&Te.imageAtlas){var mt=Te.imageAtlas,Dt=mt.patternPositions[lt.to.toString()],zt=mt.patternPositions[lt.from.toString()];Dt&&zt&&Ae.setConstantPatternPositions(Dt,zt)}var Kt=X?ou(n,Te,o,J):P?Cu(n,Te,o,P,J):W?kr(n,Te,o,Ee.lineClipsArray.length):Rs(n,Te,o);if(X)ie.activeTexture.set(se.TEXTURE0),Te.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),Ae.updatePaintBuffers(J);else if(P&&(et||n.lineAtlas.dirty))ie.activeTexture.set(se.TEXTURE0),n.lineAtlas.bind(ie);else if(W){var ft=Ee.gradients[o.id],Ft=ft.texture;if(o.gradientVersion!==ft.version){var Nt=256;if(o.stepInterpolant){var Q=s.getSource().maxzoom,Me=be.canonical.z===Q?Math.ceil(1<<n.transform.maxZoom-be.canonical.z):1;Nt=a.clamp(a.nextPowerOfTwo(Ee.maxLineLength/a.EXTENT*1024*Me),256,ie.maxTextureSize)}ft.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Nt,image:ft.gradient||void 0,clips:Ee.lineClipsArray}),ft.texture?ft.texture.update(ft.gradient):ft.texture=new a.Texture(ie,ft.gradient,se.RGBA),ft.version=o.gradientVersion,Ft=ft.texture}ie.activeTexture.set(se.TEXTURE0),Ft.bind(o.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}Ke.draw(ie,se.TRIANGLES,S,n.stencilModeForClipping(be),k,ye.disabled,Kt,o.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,o.paint,n.transform.zoom,Ae,Ee.layoutVertexBuffer2),$=!1}}}}},fill:function(n,s,o,u){var m=o.paint.get("fill-color"),w=o.paint.get("fill-opacity");if(w.constantOr(1)!==0){var S=n.colorModeForRenderPass(),k=o.paint.get("fill-pattern"),P=n.opaquePassEnabledForLayer()&&!k.constantOr(1)&&m.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===P){var L=n.depthModeForSublayer(1,n.renderPass==="opaque"?Y.ReadWrite:Y.ReadOnly);xn(n,s,o,u,L,S,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var X=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,Y.ReadOnly);xn(n,s,o,u,X,S,!0)}}},"fill-extrusion":function(n,s,o,u){var m=o.paint.get("fill-extrusion-opacity");if(m!==0&&n.renderPass==="translucent"){var w=new Y(n.context.gl.LEQUAL,Y.ReadWrite,n.depthRangeFor3D);if(m!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Ho(n,s,o,u,w,re.disabled,ue.disabled),Ho(n,s,o,u,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();Ho(n,s,o,u,w,re.disabled,S)}}},hillshade:function(n,s,o,u){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var m=n.context,w=n.depthModeForSublayer(0,Y.ReadOnly),S=n.colorModeForRenderPass(),k=n.renderPass==="translucent"?n.stencilConfigForOverlap(u):[{},u],P=k[0],L=0,X=k[1];L<X.length;L+=1){var W=X[L],J=s.getTile(W);J.needsHillshadePrepare&&n.renderPass==="offscreen"?Xa(n,J,o,w,re.disabled,S):n.renderPass==="translucent"&&Qn(n,J,o,w,P[W.overscaledZ],S)}m.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,u){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&u.length)for(var m=n.context,w=m.gl,S=s.getSource(),k=n.useProgram("raster"),P=n.colorModeForRenderPass(),L=S instanceof lr?[{},u]:n.stencilConfigForOverlap(u),X=L[0],W=L[1],J=W[W.length-1].overscaledZ,ee=!n.options.moving,ie=0,se=W;ie<se.length;ie+=1){var $=se[ie],le=n.depthModeForSublayer($.overscaledZ-J,o.paint.get("raster-opacity")===1?Y.ReadWrite:Y.ReadOnly,w.LESS),me=s.getTile($),be=n.transform.calculatePosMatrix($.toUnwrapped(),ee);me.registerFadeDuration(o.paint.get("raster-fade-duration"));var Te=s.findLoadedParent($,0),Ee=nl(me,Te,s,o,n.transform),Ae=void 0,Oe=void 0,Ke=o.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;m.activeTexture.set(w.TEXTURE0),me.texture.bind(Ke,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),m.activeTexture.set(w.TEXTURE1),Te?(Te.texture.bind(Ke,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),Ae=Math.pow(2,Te.tileID.overscaledZ-me.tileID.overscaledZ),Oe=[me.tileID.canonical.x*Ae%1,me.tileID.canonical.y*Ae%1]):me.texture.bind(Ke,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var et=Mu(be,Oe||[0,0],Ae||1,Ee,o);S instanceof lr?k.draw(m,w.TRIANGLES,le,re.disabled,P,ye.disabled,et,o.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):k.draw(m,w.TRIANGLES,le,X[$.overscaledZ],P,ye.disabled,et,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var u=o.paint.get("background-color"),m=o.paint.get("background-opacity");if(m!==0){var w=n.context,S=w.gl,k=n.transform,P=k.tileSize,L=o.paint.get("background-pattern");if(!n.isPatternMissing(L)){var X=!L&&u.a===1&&m===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===X){var W=re.disabled,J=n.depthModeForSublayer(0,X==="opaque"?Y.ReadWrite:Y.ReadOnly),ee=n.colorModeForRenderPass(),ie=n.useProgram(L?"backgroundPattern":"background"),se=k.coveringTiles({tileSize:P});L&&(w.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var $=o.getCrossfadeParameters(),le=0,me=se;le<me.length;le+=1){var be=me[le],Te=n.transform.calculatePosMatrix(be.toUnwrapped()),Ee=L?Za(Te,m,n,L,{tileID:be,tileSize:P},$):rl(Te,m,u);ie.draw(w,S.TRIANGLES,J,W,ee,ye.disabled,Ee,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var u=0;u<o.length;u++)su(n,s,o[u])},custom:function(n,s,o){var u=n.context,m=o.implementation;if(n.renderPass==="offscreen"){var w=m.prerender;w&&(n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),w.call(m,u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),u.setStencilMode(re.disabled);var S=m.renderingMode==="3d"?new Y(n.context.gl.LEQUAL,Y.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,Y.ReadOnly);u.setDepthMode(S),m.render(u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState(),u.bindFramebuffer.set(null)}}},Cr=function(n,s){this.context=new Z(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=oe.maxUnderzooming+oe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _e,this.gpuTimers={}};Cr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,u=this.style._order;o<u.length;o+=1)this.style._layers[u[o]].resize()},Cr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,gi.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,gi.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var u=new a.StructArrayLayout4i8;u.emplaceBack(0,0,0,0),u.emplaceBack(a.EXTENT,0,a.EXTENT,0),u.emplaceBack(0,a.EXTENT,0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(u,$e.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var m=new a.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(m,gi.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var k=this.context.gl;this.stencilClearMode=new re({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)},Cr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,Y.disabled,this.stencilClearMode,ue.disabled,ye.disabled,fn(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Cr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,u=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(ue.disabled),o.setDepthMode(Y.disabled);var m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,S=s;w<S.length;w+=1){var k=S[w],P=this._tileClippingMaskIDs[k.key]=this.nextStencilID++;m.draw(o,u.TRIANGLES,Y.disabled,new re({func:u.ALWAYS,mask:0},P,255,u.KEEP,u.KEEP,u.REPLACE),ue.disabled,ye.disabled,fn(k.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Cr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new re({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Cr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new re({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Cr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,u=n.sort(function(P,L){return L.overscaledZ-P.overscaledZ}),m=u[u.length-1].overscaledZ,w=u[0].overscaledZ-m+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var S={},k=0;k<w;k++)S[k+m]=new re({func:o.GEQUAL,mask:255},k+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[S,u]}return[(s={},s[m]=re.disabled,s),u]},Cr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new ue([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ue.unblended:ue.alphaBlended},Cr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return Y.disabled;var u=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Y(o||this.context.gl.LEQUAL,s,[u,u])},Cr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Cr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var u=this.style._order,m=this.style.sourceCaches;for(var w in m){var S=m[w];S.used&&S.prepare(this.context)}var k,P,L={},X={},W={};for(var J in m){var ee=m[J];L[J]=ee.getVisibleCoordinates(),X[J]=L[J].slice().reverse(),W[J]=ee.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var ie=0;ie<u.length;ie++)if(this.style._layers[u[ie]].is3D()){this.opaquePassCutoff=ie;break}this.renderPass="offscreen";for(var se=0,$=u;se<$.length;se+=1){var le=this.style._layers[$[se]];if(le.hasOffscreenPass()&&!le.isHidden(this.transform.zoom)){var me=X[le.source];(le.type==="custom"||me.length)&&this.renderLayer(this,m[le.source],le,me)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){var be=this.style._layers[u[this.currentLayer]],Te=m[be.source],Ee=L[be.source];this._renderTileClippingMasks(be,Ee),this.renderLayer(this,Te,be,Ee)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){var Ae=this.style._layers[u[this.currentLayer]],Oe=m[Ae.source],Ke=(Ae.type==="symbol"?W:X)[Ae.source];this._renderTileClippingMasks(Ae,L[Ae.source]),this.renderLayer(this,Oe,Ae,Ke)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(et){et.source&&!et.isHidden(o.transform.zoom)&&(et.source!==(P&&P.id)&&(P=o.style.sourceCaches[et.source]),(!k||k.getSource().maxzoom<P.getSource().maxzoom)&&(k=P))}),k&&Qa.debug(this,k,k.getVisibleCoordinates())),this.options.showPadding&&function(et){var lt=et.transform.padding;Pl(et,et.transform.height-(lt.top||0),3,Wa),Pl(et,lt.bottom||0,3,ic),Ja(et,lt.left||0,3,au),Ja(et,et.transform.width-(lt.right||0),3,xa);var mt=et.transform.centerPoint;(function(Dt,zt,Kt,ft){Ya(Dt,zt-1,Kt-10,2,20,ft),Ya(Dt,zt-10,Kt-1,20,2,ft)})(et,mt.x,et.transform.height-mt.y,Ha)}(this),this.context.setDefault()},Cr.prototype.renderLayer=function(n,s,o,u){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||u.length)&&(this.id=o.id,this.gpuTimingStart(o),Qa[o.type](n,s,o,u,this.style.placement.variableOffsets),this.gpuTimingEnd())},Cr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Cr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Cr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Cr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var u=n[o],m=this.context.extTimerQuery,w=m.getQueryObjectEXT(u.query,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(u.query),s[o]=w}return s},Cr.prototype.translatePosMatrix=function(n,s,o,u,m){if(!o[0]&&!o[1])return n;var w=m?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(w){var S=Math.sin(w),k=Math.cos(w);o=[o[0]*k-o[1]*S,o[0]*S+o[1]*k]}var P=[m?o[0]:Pr(s,o[0],this.transform.zoom),m?o[1]:Pr(s,o[1],this.transform.zoom),0],L=new Float32Array(16);return a.translate(L,n,P),L},Cr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Cr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Cr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Cr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new rc(this.context,n,qa[n],s,Ga[n],this._showOverdrawInspector)),this.cache[o]},Cr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Cr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Cr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Cr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ol=function(n,s){this.points=n,this.planes=s};ol.fromInvProjectionMatrix=function(n,s,o){var u=Math.pow(2,o),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return a.transformMat4([],S,n)}).map(function(S){return a.scale$1([],S,1/S[3]/s*u)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var k=a.sub([],m[S[0]],m[S[1]]),P=a.sub([],m[S[2]],m[S[1]]),L=a.normalize([],a.cross([],k,P)),X=-a.dot(L,m[S[1]]);return L.concat(X)});return new ol(m,w)};var Fn=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};Fn.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),u=a.clone$2(this.max),m=0;m<s.length;m++)o[m]=s[m]?this.min[m]:this.center[m],u[m]=s[m]?this.center[m]:this.max[m];return u[2]=this.max[2],new Fn(o,u)},Fn.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},Fn.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},Fn.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,u=0;u<n.planes.length;u++){for(var m=n.planes[u],w=0,S=0;S<s.length;S++)w+=a.dot$1(m,s[S])>=0;if(w===0)return 0;w!==s.length&&(o=!1)}if(o)return 2;for(var k=0;k<3;k++){for(var P=Number.MAX_VALUE,L=-Number.MAX_VALUE,X=0;X<n.points.length;X++){var W=n.points[X][k]-this.min[k];P=Math.min(P,W),L=Math.max(L,W)}if(L<0||P>this.max[k]-this.min[k])return 0}return 1};var on=function(n,s,o,u){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=u};on.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},on.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),u=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,u)},on.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},on.prototype.clone=function(){return new on(this.top,this.bottom,this.left,this.right)},on.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Yt=function(n,s,o,u,m){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=m===void 0||m,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o==null?0:o,this._maxPitch=u==null?60:u,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new on,this._posMatrixCache={},this._alignedPosMatrixCache={}},Vr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Yt.prototype.clone=function(){var n=new Yt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Vr.minZoom.get=function(){return this._minZoom},Vr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Vr.maxZoom.get=function(){return this._maxZoom},Vr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Vr.minPitch.get=function(){return this._minPitch},Vr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Vr.maxPitch.get=function(){return this._maxPitch},Vr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Vr.renderWorldCopies.get=function(){return this._renderWorldCopies},Vr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Vr.worldSize.get=function(){return this.tileSize*this.scale},Vr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Vr.size.get=function(){return new a.Point(this.width,this.height)},Vr.bearing.get=function(){return-this.angle/Math.PI*180},Vr.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Vr.pitch.get=function(){return this._pitch/Math.PI*180},Vr.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},Vr.fov.get=function(){return this._fov/Math.PI*180},Vr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Vr.zoom.get=function(){return this._zoom},Vr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},Vr.center.get=function(){return this._center},Vr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Vr.padding.get=function(){return this._edgeInsets.toJSON()},Vr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Vr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Yt.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},Yt.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},Yt.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},Yt.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),u=this.pointCoordinate(new a.Point(this.width,0)),m=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),S=Math.floor(Math.min(o.x,u.x,m.x,w.x)),k=Math.floor(Math.max(o.x,u.x,m.x,w.x)),P=S-1;P<=k+1;P++)P!==0&&s.push(new a.UnwrappedTileID(P,n));return s},Yt.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var u=a.MercatorCoordinate.fromLngLat(this.center),m=Math.pow(2,s),w=[m*u.x,m*u.y,0],S=ol.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),k=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(k=s);var P=function(et){return{aabb:new Fn([et*m,0,0],[(et+1)*m,m,0]),zoom:0,x:0,y:0,wrap:et,fullyVisible:!1}},L=[],X=[],W=s,J=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var ee=1;ee<=3;ee++)L.push(P(-ee)),L.push(P(ee));for(L.push(P(0));L.length>0;){var ie=L.pop(),se=ie.x,$=ie.y,le=ie.fullyVisible;if(!le){var me=ie.aabb.intersects(S);if(me===0)continue;le=me===2}var be=ie.aabb.distanceX(w),Te=ie.aabb.distanceY(w),Ee=Math.max(Math.abs(be),Math.abs(Te));if(ie.zoom===W||Ee>3+(1<<W-ie.zoom)-2&&ie.zoom>=k)X.push({tileID:new a.OverscaledTileID(ie.zoom===W?J:ie.zoom,ie.wrap,ie.zoom,se,$),distanceSq:a.sqrLen([w[0]-.5-se,w[1]-.5-$])});else for(var Ae=0;Ae<4;Ae++){var Oe=(se<<1)+Ae%2,Ke=($<<1)+(Ae>>1);L.push({aabb:ie.aabb.quadrant(Ae),zoom:ie.zoom+1,x:Oe,y:Ke,wrap:ie.wrap,fullyVisible:le})}}return X.sort(function(et,lt){return et.distanceSq-lt.distanceSq}).map(function(et){return et.tileID})},Yt.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},Vr.unmodified.get=function(){return this._unmodified},Yt.prototype.zoomScale=function(n){return Math.pow(2,n)},Yt.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},Yt.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},Yt.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Vr.point.get=function(){return this.project(this.center)},Yt.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),u=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(n),w=new a.MercatorCoordinate(m.x-(o.x-u.x),m.y-(o.y-u.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},Yt.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},Yt.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},Yt.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},Yt.prototype.coordinateLocation=function(n){return n.toLngLat()},Yt.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var u=s[3],m=o[3],w=s[1]/u,S=o[1]/m,k=s[2]/u,P=o[2]/m,L=k===P?0:(0-k)/(P-k);return new a.MercatorCoordinate(a.number(s[0]/u,o[0]/m,L)/this.worldSize,a.number(w,S,L)/this.worldSize)},Yt.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},Yt.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},Yt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Yt.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Yt.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,u=s?this._alignedPosMatrixCache:this._posMatrixCache;if(u[o])return u[o];var m=n.canonical,w=this.worldSize/this.zoomScale(m.z),S=m.x+Math.pow(2,m.z)*n.wrap,k=a.identity(new Float64Array(16));return a.translate(k,k,[S*w,m.y*w,0]),a.scale(k,k,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(k,s?this.alignedProjMatrix:this.projMatrix,k),u[o]=new Float32Array(k),u[o]},Yt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Yt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,u,m=-90,w=90,S=-180,k=180,P=this.size,L=this._unmodified;if(this.latRange){var X=this.latRange;m=a.mercatorYfromLat(X[1])*this.worldSize,n=(w=a.mercatorYfromLat(X[0])*this.worldSize)-m<P.y?P.y/(w-m):0}if(this.lngRange){var W=this.lngRange;S=a.mercatorXfromLng(W[0])*this.worldSize,s=(k=a.mercatorXfromLng(W[1])*this.worldSize)-S<P.x?P.x/(k-S):0}var J=this.point,ee=Math.max(s||0,n||0);if(ee)return this.center=this.unproject(new a.Point(s?(k+S)/2:J.x,n?(w+m)/2:J.y)),this.zoom+=this.scaleZoom(ee),this._unmodified=L,void(this._constraining=!1);if(this.latRange){var ie=J.y,se=P.y/2;ie-se<m&&(u=m+se),ie+se>w&&(u=w-se)}if(this.lngRange){var $=J.x,le=P.x/2;$-le<S&&(o=S+le),$+le>k&&(o=k-le)}o===void 0&&u===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:J.x,u!==void 0?u:J.y))),this._unmodified=L,this._constraining=!1}},Yt.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),u=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),m=this.point,w=m.x,S=m.y,k=1.01*(Math.cos(Math.PI/2-this._pitch)*u+this.cameraToCenterDistance),P=this.height/50,L=new Float64Array(16);a.perspective(L,this._fov,this.width/this.height,P,k),L[8]=2*-n.x/this.width,L[9]=2*n.y/this.height,a.scale(L,L,[1,-1,1]),a.translate(L,L,[0,0,-this.cameraToCenterDistance]),a.rotateX(L,L,this._pitch),a.rotateZ(L,L,this.angle),a.translate(L,L,[-w,-S,0]),this.mercatorMatrix=a.scale([],L,[this.worldSize,this.worldSize,this.worldSize]),a.scale(L,L,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=L,this.invProjMatrix=a.invert([],this.projMatrix);var X=this.width%2/2,W=this.height%2/2,J=Math.cos(this.angle),ee=Math.sin(this.angle),ie=w-Math.round(w)+J*X+ee*W,se=S-Math.round(S)+J*W+ee*X,$=new Float64Array(L);if(a.translate($,$,[ie>.5?ie-1:ie,se>.5?se-1:se,0]),this.alignedProjMatrix=$,L=a.create(),a.scale(L,L,[this.width/2,-this.height/2,1]),a.translate(L,L,[1,-1,0]),this.labelPlaneMatrix=L,L=a.create(),a.scale(L,L,[1,-1,1]),a.translate(L,L,[-1,-1,0]),a.scale(L,L,[2/this.width,2/this.height,1]),this.glCoordMatrix=L,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(L=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=L,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Yt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},Yt.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},Yt.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,u=s.y,m=s.x,w=s.y,S=0,k=n;S<k.length;S+=1){var P=k[S];o=Math.min(o,P.x),u=Math.min(u,P.y),m=Math.max(m,P.x),w=Math.max(w,P.y)}return[new a.Point(o,u),new a.Point(m,u),new a.Point(m,w),new a.Point(o,w),new a.Point(o,u)]},Object.defineProperties(Yt.prototype,Vr);var an=function(n){var s,o,u,m;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,u=null,m=function(){u=null,o&&(s(),u=setTimeout(m,300),o=!1)},function(){return o=!0,u||m(),u})};an.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},an.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},an.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,u=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,u),w=Math.round(s.lng*m)/m,S=Math.round(s.lat*m)/m,k=this._map.getBearing(),P=this._map.getPitch(),L="";if(L+=n?"/"+w+"/"+S+"/"+o:o+"/"+S+"/"+w,(k||P)&&(L+="/"+Math.round(10*k)/10),P&&(L+="/"+Math.round(P)),this._hashName){var X=this._hashName,W=!1,J=a.window.location.hash.slice(1).split("&").map(function(ee){var ie=ee.split("=")[0];return ie===X?(W=!0,ie+"="+L):ee}).filter(function(ee){return ee});return W||J.push(X+"="+L),"#"+J.join("&")}return"#"+L},an.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(u){return u.split("=")}).forEach(function(u){u[0]===s._hashName&&(n=u)}),(n&&n[1]||"").split("/")):o.split("/")},an.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},an.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var Cl={linearity:.3,easing:a.bezier(0,0,.3,1)},vs=a.extend({deceleration:2500,maxSpeed:1400},Cl),ha=a.extend({deceleration:20,maxSpeed:1400},Cl),Os=a.extend({deceleration:1e3,maxSpeed:360},Cl),Du=a.extend({deceleration:1e3,maxSpeed:90},Cl),pa=function(n){this._map=n,this.clear()};function $a(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function fa(n,s,o){var u=o.maxSpeed,m=o.linearity,w=o.deceleration,S=a.clamp(n*m/(s/1e3),-u,u),k=Math.abs(S)/(w*m);return{easing:o.easing,duration:1e3*k,amount:S*(k/2)}}pa.prototype.clear=function(){this._inertiaBuffer=[]},pa.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},pa.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},pa.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,u=this._inertiaBuffer;o<u.length;o+=1){var m=u[o].settings;s.zoom+=m.zoomDelta||0,s.bearing+=m.bearingDelta||0,s.pitch+=m.pitchDelta||0,m.panDelta&&s.pan._add(m.panDelta),m.around&&(s.around=m.around),m.pinchAround&&(s.pinchAround=m.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(s.pan.mag()){var k=fa(s.pan.mag(),w,a.extend({},vs,n||{}));S.offset=s.pan.mult(k.amount/s.pan.mag()),S.center=this._map.transform.center,$a(S,k)}if(s.zoom){var P=fa(s.zoom,w,ha);S.zoom=this._map.transform.zoom+P.amount,$a(S,P)}if(s.bearing){var L=fa(s.bearing,w,Os);S.bearing=this._map.transform.bearing+a.clamp(L.amount,-179,179),$a(S,L)}if(s.pitch){var X=fa(s.pitch,w,Du);S.pitch=this._map.transform.pitch+X.amount,$a(S,X)}if(S.zoom||S.bearing){var W=s.pinchAround===void 0?s.around:s.pinchAround;S.around=W?this._map.unproject(W):this._map.getCenter()}return this.clear(),a.extend(S,{noMoveStart:!0})}};var Ii=function(n){function s(u,m,w,S){S===void 0&&(S={});var k=I.mousePos(m.getCanvasContainer(),w),P=m.unproject(k);n.call(this,u,a.extend({point:k,lngLat:P,originalEvent:w},S)),this._defaultPrevented=!1,this.target=m}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),Jo=function(n){function s(u,m,w){var S=u==="touchend"?w.changedTouches:w.touches,k=I.touchPos(m.getCanvasContainer(),S),P=k.map(function(W){return m.unproject(W)}),L=k.reduce(function(W,J,ee,ie){return W.add(J.div(ie.length))},new a.Point(0,0)),X=m.unproject(L);n.call(this,u,{points:k,point:L,lngLats:P,lngLat:X,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),lu=function(n){function s(u,m,w){n.call(this,u,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),Ur=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};Ur.prototype.reset=function(){delete this._mousedownPos},Ur.prototype.wheel=function(n){return this._firePreventable(new lu(n.type,this._map,n))},Ur.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new Ii(n.type,this._map,n))},Ur.prototype.mouseup=function(n){this._map.fire(new Ii(n.type,this._map,n))},Ur.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Ii(n.type,this._map,n))},Ur.prototype.dblclick=function(n){return this._firePreventable(new Ii(n.type,this._map,n))},Ur.prototype.mouseover=function(n){this._map.fire(new Ii(n.type,this._map,n))},Ur.prototype.mouseout=function(n){this._map.fire(new Ii(n.type,this._map,n))},Ur.prototype.touchstart=function(n){return this._firePreventable(new Jo(n.type,this._map,n))},Ur.prototype.touchmove=function(n){this._map.fire(new Jo(n.type,this._map,n))},Ur.prototype.touchend=function(n){this._map.fire(new Jo(n.type,this._map,n))},Ur.prototype.touchcancel=function(n){this._map.fire(new Jo(n.type,this._map,n))},Ur.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},Ur.prototype.isEnabled=function(){return!0},Ur.prototype.isActive=function(){return!1},Ur.prototype.enable=function(){},Ur.prototype.disable=function(){};var at=function(n){this._map=n};at.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},at.prototype.mousemove=function(n){this._map.fire(new Ii(n.type,this._map,n))},at.prototype.mousedown=function(){this._delayContextMenu=!0},at.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ii("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},at.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Ii(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},at.prototype.isEnabled=function(){return!0},at.prototype.isActive=function(){return!1},at.prototype.enable=function(){},at.prototype.disable=function(){};var Mi=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function al(n,s){for(var o={},u=0;u<n.length;u++)o[n[u].identifier]=s[u];return o}Mi.prototype.isEnabled=function(){return!!this._enabled},Mi.prototype.isActive=function(){return!!this._active},Mi.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Mi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Mi.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(I.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},Mi.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var u=this._startPos;this._lastPos=o,this._box||(this._box=I.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var m=Math.min(u.x,o.x),w=Math.max(u.x,o.x),S=Math.min(u.y,o.y),k=Math.max(u.y,o.y);I.setTransform(this._box,"translate("+m+"px,"+S+"px)"),this._box.style.width=w-m+"px",this._box.style.height=k-S+"px"}}},Mi.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var u=this._startPos,m=s;if(this.reset(),I.suppressClick(),u.x!==m.x||u.y!==m.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(u,m,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},Mi.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},Mi.prototype.blur=function(){this.reset()},Mi.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(I.remove(this._box),this._box=null),I.enableDrag(),delete this._startPos,delete this._lastPos},Mi.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var Yo=function(n){this.reset(),this.numTouches=n.numTouches};Yo.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Yo.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(u){for(var m=new a.Point(0,0),w=0,S=u;w<S.length;w+=1)m._add(S[w]);return m.div(u.length)}(s),this.touches=al(o,s)))},Yo.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var u=al(o,s);for(var m in this.touches){var w=u[m];(!w||w.dist(this.touches[m])>30)&&(this.aborted=!0)}}},Yo.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var u=!this.aborted&&this.centroid;if(this.reset(),u)return u}};var da=function(n){this.singleTap=new Yo(n),this.numTaps=n.numTaps,this.reset()};da.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},da.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},da.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},da.prototype.touchend=function(n,s,o){var u=this.singleTap.touchend(n,s,o);if(u){var m=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(u)<30;if(m&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}};var Nn=function(){this._zoomIn=new da({numTouches:1,numTaps:2}),this._zoomOut=new da({numTouches:2,numTaps:1}),this.reset()};Nn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Nn.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},Nn.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},Nn.prototype.touchend=function(n,s,o){var u=this,m=this._zoomIn.touchend(n,s,o),w=this._zoomOut.touchend(n,s,o);return m?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(m)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}}):void 0},Nn.prototype.touchcancel=function(){this.reset()},Nn.prototype.enable=function(){this._enabled=!0},Nn.prototype.disable=function(){this._enabled=!1,this.reset()},Nn.prototype.isEnabled=function(){return this._enabled},Nn.prototype.isActive=function(){return this._active};var es={0:1,2:2},rt=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};rt.prototype.blur=function(){this.reset()},rt.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},rt.prototype._correctButton=function(n,s){return!1},rt.prototype._move=function(n,s){return{}},rt.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=I.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},rt.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(u,m){var w=es[m];return u.buttons===void 0||(u.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},rt.prototype.mouseupWindow=function(n){this._lastPoint&&I.mouseButton(n)===this._eventButton&&(this._moved&&I.suppressClick(),this.reset())},rt.prototype.enable=function(){this._enabled=!0},rt.prototype.disable=function(){this._enabled=!1,this.reset()},rt.prototype.isEnabled=function(){return this._enabled},rt.prototype.isActive=function(){return this._active};var Ml=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,u){n.prototype.mousedown.call(this,o,u),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,u){return u===0&&!o.ctrlKey},s.prototype._move=function(o,u){return{around:u,panDelta:u.sub(o)}},s}(rt),wa=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},s.prototype._move=function(o,u){var m=.8*(u.x-o.x);if(m)return this._active=!0,{bearingDelta:m}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(rt),Fs=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},s.prototype._move=function(o,u){var m=-.5*(u.y-o.y);if(m)return this._active=!0,{pitchDelta:m}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(rt),po=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};po.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},po.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},po.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},po.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},po.prototype.touchcancel=function(){this.reset()},po.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var u=al(o,s),m=new a.Point(0,0),w=new a.Point(0,0),S=0;for(var k in u){var P=u[k],L=this._touches[k];L&&(m._add(P),w._add(P.sub(L)),S++,u[k]=P)}if(this._touches=u,!(S<this._minTouches)&&w.mag()){var X=w.div(S);if(this._sum._add(X),!(this._sum.mag()<this._clickTolerance))return{around:m.div(S),panDelta:X}}},po.prototype.enable=function(){this._enabled=!0},po.prototype.disable=function(){this._enabled=!1,this.reset()},po.prototype.isEnabled=function(){return this._enabled},po.prototype.isActive=function(){return this._active};var Vn=function(){this.reset()};function ma(n,s,o){for(var u=0;u<n.length;u++)if(n[u].identifier===o)return s[u]}function Dl(n,s){return Math.log(n/s)/Math.LN2}Vn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Vn.prototype._start=function(n){},Vn.prototype._move=function(n,s,o){return{}},Vn.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Vn.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var u=this._firstTwoTouches,m=u[1],w=ma(o,s,u[0]),S=ma(o,s,m);if(w&&S){var k=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],k,n)}}},Vn.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var u=this._firstTwoTouches,m=u[1],w=ma(o,s,u[0]),S=ma(o,s,m);w&&S||(this._active&&I.suppressClick(),this.reset())}},Vn.prototype.touchcancel=function(){this.reset()},Vn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Vn.prototype.disable=function(){this._enabled=!1,this.reset()},Vn.prototype.isEnabled=function(){return this._enabled},Vn.prototype.isActive=function(){return this._active};var wn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,u){var m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Dl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Dl(this._distance,m),pinchAround:u}},s}(Vn);function Un(n,s){return 180*n.angleWith(s)/Math.PI}var bs=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,u){var m=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Un(this._vector,m),pinchAround:u}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var u=25/(Math.PI*this._minDiameter)*360,m=Un(o,this._startVector);return Math.abs(m)<u},s}(Vn);function Ns(n){return Math.abs(n.y)>Math.abs(n.x)}var ts=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,Ns(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,u,m){var w=o[0].sub(this._lastPoints[0]),S=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,S,m.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,u,m){if(this._valid!==void 0)return this._valid;var w=o.mag()>=2,S=u.mag()>=2;if(w||S){if(!w||!S)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;var k=o.y>0==u.y>0;return Ns(o)&&Ns(u)&&k}},s}(Vn),Vs={panStep:100,bearingStep:15,pitchStep:10},fo=function(){var n=Vs;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function $n(n){return n*(2-n)}fo.prototype.blur=function(){this.reset()},fo.prototype.reset=function(){this._active=!1},fo.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,u=0,m=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?u=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?u=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?m=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?m=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(u=0,m=0),{cameraAnimation:function(k){var P=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:$n,zoom:o?Math.round(P)+o*(n.shiftKey?2:1):P,bearing:k.getBearing()+u*s._bearingStep,pitch:k.getPitch()+m*s._pitchStep,offset:[-w*s._panStep,-S*s._panStep],center:k.getCenter()},{originalEvent:n})}}}},fo.prototype.enable=function(){this._enabled=!0},fo.prototype.disable=function(){this._enabled=!1,this.reset()},fo.prototype.isEnabled=function(){return this._enabled},fo.prototype.isActive=function(){return this._active},fo.prototype.disableRotation=function(){this._rotationDisabled=!0},fo.prototype.enableRotation=function(){this._rotationDisabled=!1};var rr=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};rr.prototype.setZoomRate=function(n){this._defaultZoomRate=n},rr.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},rr.prototype.isEnabled=function(){return!!this._enabled},rr.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},rr.prototype.isZooming=function(){return!!this._zooming},rr.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},rr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},rr.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),u=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(u*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},rr.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},rr.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=I.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},rr.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,u=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&u!==0&&(u=1/u);var m=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(m*u))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,S=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,k=this._startZoom,P=this._easing,L=!1;if(this._type==="wheel"&&k&&P){var X=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),W=P(X);w=a.number(k,S,W),X<1?this._frameId||(this._frameId=!0):L=!0}else w=S,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},rr.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,u=(a.browser.now()-o.start)/o.duration,m=o.easing(u+.01)-o.easing(u),w=.27/Math.sqrt(m*m+1e-4)*.01,S=Math.sqrt(.0729-w*w);s=a.bezier(w,S,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},rr.prototype.blur=function(){this.reset()},rr.prototype.reset=function(){this._active=!1};var Ai=function(n,s){this._clickZoom=n,this._tapZoom=s};Ai.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ai.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ai.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ai.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ji=function(){this.reset()};ji.prototype.reset=function(){this._active=!1},ji.prototype.blur=function(){this.reset()},ji.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},ji.prototype.enable=function(){this._enabled=!0},ji.prototype.disable=function(){this._enabled=!1,this.reset()},ji.prototype.isEnabled=function(){return this._enabled},ji.prototype.isActive=function(){return this._active};var ti=function(){this._tap=new da({numTouches:1,numTaps:1}),this.reset()};ti.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ti.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},ti.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var u=s[0],m=u.y-this._swipePoint.y;return this._swipePoint=u,n.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(n,s,o)},ti.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},ti.prototype.touchcancel=function(){this.reset()},ti.prototype.enable=function(){this._enabled=!0},ti.prototype.disable=function(){this._enabled=!1,this.reset()},ti.prototype.isEnabled=function(){return this._enabled},ti.prototype.isActive=function(){return this._active};var eo=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};eo.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},eo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},eo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},eo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Sa=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};Sa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Sa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Sa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Sa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Sn=function(n,s,o,u){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0};Sn.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Sn.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Sn.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Sn.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Sn.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Sn.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var jn=function(n){return n.zoom||n.drag||n.pitch||n.rotate},Us=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function vt(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var dt=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new pa(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var u=0,m=this._listeners;u<m.length;u+=1){var w=m[u],S=w[0];I.addEventListener(S,w[1],S===a.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};dt.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],u=o[0];I.removeEventListener(u,o[1],u===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},dt.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new Ur(s,n));var u=s.boxZoom=new Mi(s,n);this._add("boxZoom",u);var m=new Nn,w=new ji;s.doubleClickZoom=new Ai(w,m),this._add("tapZoom",m),this._add("clickZoom",w);var S=new ti;this._add("tapDragZoom",S);var k=s.touchPitch=new ts;this._add("touchPitch",k);var P=new wa(n),L=new Fs(n);s.dragRotate=new Sa(n,P,L),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);var X=new Ml(n),W=new po(n);s.dragPan=new eo(o,X,W),this._add("mousePan",X),this._add("touchPan",W,["touchZoom","touchRotate"]);var J=new bs,ee=new wn;s.touchZoomRotate=new Sn(o,ee,J,S),this._add("touchRotate",J,["touchPan","touchZoom"]),this._add("touchZoom",ee,["touchPan","touchRotate"]);var ie=s.scrollZoom=new rr(s,this);this._add("scrollZoom",ie,["mousePan"]);var se=s.keyboard=new fo;this._add("keyboard",se),this._add("blockableMapEvent",new at(s));for(var $=0,le=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];$<le.length;$+=1){var me=le[$];n.interactive&&n[me]&&s[me].enable(n[me])}},dt.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},dt.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},dt.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},dt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},dt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},dt.prototype.isMoving=function(){return Boolean(jn(this._eventsInProgress))||this.isZooming()},dt.prototype._blockedByActive=function(n,s,o){for(var u in n)if(u!==o&&(!s||s.indexOf(u)<0))return!0;return!1},dt.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},dt.prototype._getMapTouches=function(n){for(var s=[],o=0,u=n;o<u.length;o+=1){var m=u[o];this._el.contains(m.target)&&s.push(m)}return s},dt.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,u={needsRenderFrame:!1},m={},w={},S=n.touches?this._getMapTouches(n.touches):void 0,k=S?I.touchPos(this._el,S):I.mousePos(this._el,n),P=0,L=this._handlers;P<L.length;P+=1){var X=L[P],W=X.handlerName,J=X.handler,ee=X.allowed;if(J.isEnabled()){var ie=void 0;this._blockedByActive(w,ee,W)?J.reset():J[s||n.type]&&(ie=J[s||n.type](n,k,S),this.mergeHandlerResult(u,m,ie,W,o),ie&&ie.needsRenderFrame&&this._triggerRenderFrame()),(ie||J.isActive())&&(w[W]=J)}}var se={};for(var $ in this._previousActiveHandlers)w[$]||(se[$]=o);this._previousActiveHandlers=w,(Object.keys(se).length||vt(u))&&(this._changes.push([u,m,se]),this._triggerRenderFrame()),(Object.keys(w).length||vt(u))&&this._map._stop(!0),this._updatingCamera=!1;var le=u.cameraAnimation;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},dt.prototype.mergeHandlerResult=function(n,s,o,u,m){if(o){a.extend(n,o);var w={handlerName:u,originalEvent:o.originalEvent||m};o.zoomDelta!==void 0&&(s.zoom=w),o.panDelta!==void 0&&(s.drag=w),o.pitchDelta!==void 0&&(s.pitch=w),o.bearingDelta!==void 0&&(s.rotate=w)}},dt.prototype._applyChanges=function(){for(var n={},s={},o={},u=0,m=this._changes;u<m.length;u+=1){var w=m[u],S=w[0],k=w[1],P=w[2];S.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),a.extend(s,k),a.extend(o,P)}this._updateMapTransform(n,s,o),this._changes=[]},dt.prototype._updateMapTransform=function(n,s,o){var u=this._map,m=u.transform;if(!vt(n))return this._fireEvents(s,o,!0);var w=n.panDelta,S=n.zoomDelta,k=n.bearingDelta,P=n.pitchDelta,L=n.around,X=n.pinchAround;X!==void 0&&(L=X),u._stop(!0),L=L||u.transform.centerPoint;var W=m.pointLocation(w?L.sub(w):L);k&&(m.bearing+=k),P&&(m.pitch+=P),S&&(m.zoom+=S),m.setLocationAtPoint(W,L),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},dt.prototype._fireEvents=function(n,s,o){var u=this,m=jn(this._eventsInProgress),w=jn(n),S={};for(var k in n)this._eventsInProgress[k]||(S[k+"start"]=n[k].originalEvent),this._eventsInProgress[k]=n[k];for(var P in!m&&w&&this._fireEvent("movestart",w.originalEvent),S)this._fireEvent(P,S[P]);for(var L in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(L,n[L].originalEvent);var X,W={};for(var J in this._eventsInProgress){var ee=this._eventsInProgress[J],ie=ee.handlerName,se=ee.originalEvent;this._handlersById[ie].isActive()||(delete this._eventsInProgress[J],W[J+"end"]=X=s[ie]||se)}for(var $ in W)this._fireEvent($,W[$]);var le=jn(this._eventsInProgress);if(o&&(m||w)&&!le){this._updatingCamera=!0;var me=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),be=function(Te){return Te!==0&&-u._bearingSnap<Te&&Te<u._bearingSnap};me?(be(me.bearing||this._map.getBearing())&&(me.bearing=0),this._map.easeTo(me,{originalEvent:X})):(this._map.fire(new a.Event("moveend",{originalEvent:X})),be(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},dt.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},dt.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new Us("renderFrame",{timeStamp:s})),n._applyChanges()})},dt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var sl=function(n){function s(o,u){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,u){return this.jumpTo({center:o},u)},s.prototype.panBy=function(o,u,m){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},u),m)},s.prototype.panTo=function(o,u,m){return this.easeTo(a.extend({center:o},u),m)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,u){return this.jumpTo({zoom:o},u),this},s.prototype.zoomTo=function(o,u,m){return this.easeTo(a.extend({zoom:o},u),m)},s.prototype.zoomIn=function(o,u){return this.zoomTo(this.getZoom()+1,o,u),this},s.prototype.zoomOut=function(o,u){return this.zoomTo(this.getZoom()-1,o,u),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,u){return this.jumpTo({bearing:o},u),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,u){return this.jumpTo({padding:o},u),this},s.prototype.rotateTo=function(o,u,m){return this.easeTo(a.extend({bearing:o},u),m)},s.prototype.resetNorth=function(o,u){return this.rotateTo(0,a.extend({duration:1e3},o),u),this},s.prototype.resetNorthPitch=function(o,u){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),u),this},s.prototype.snapToNorth=function(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,u){return this.jumpTo({pitch:o},u),this},s.prototype.cameraForBounds=function(o,u){o=a.LngLatBounds.convert(o);var m=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),m,u)},s.prototype._cameraForBoxAndBearing=function(o,u,m,w){var S={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var k=w.padding;w.padding={top:k,bottom:k,right:k,left:k}}w.padding=a.extend(S,w.padding);var P=this.transform,L=P.padding,X=P.project(a.LngLat.convert(o)),W=P.project(a.LngLat.convert(u)),J=X.rotate(-m*Math.PI/180),ee=W.rotate(-m*Math.PI/180),ie=new a.Point(Math.max(J.x,ee.x),Math.max(J.y,ee.y)),se=new a.Point(Math.min(J.x,ee.x),Math.min(J.y,ee.y)),$=ie.sub(se),le=(P.width-(L.left+L.right+w.padding.left+w.padding.right))/$.x,me=(P.height-(L.top+L.bottom+w.padding.top+w.padding.bottom))/$.y;if(!(me<0||le<0)){var be=Math.min(P.scaleZoom(P.scale*Math.min(le,me)),w.maxZoom),Te=typeof w.offset.x=="number"?new a.Point(w.offset.x,w.offset.y):a.Point.convert(w.offset),Ee=new a.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(m*Math.PI/180),Ae=Te.add(Ee).mult(P.scale/P.zoomScale(be));return{center:P.unproject(X.add(W).div(2).sub(Ae)),zoom:be,bearing:m}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,u,m){return this._fitInternal(this.cameraForBounds(o,u),u,m)},s.prototype.fitScreenCoordinates=function(o,u,m,w,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(u)),m,w),w,S)},s.prototype._fitInternal=function(o,u,m){return o?(delete(u=a.extend(o,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this},s.prototype.jumpTo=function(o,u){this.stop();var m=this.transform,w=!1,S=!1,k=!1;return"zoom"in o&&m.zoom!==+o.zoom&&(w=!0,m.zoom=+o.zoom),o.center!==void 0&&(m.center=a.LngLat.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(S=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(k=!0,m.pitch=+o.pitch),o.padding==null||m.isPaddingEqual(o.padding)||(m.padding=o.padding),this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),w&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),S&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),k&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u))},s.prototype.easeTo=function(o,u){var m=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var w=this.transform,S=this.getZoom(),k=this.getBearing(),P=this.getPitch(),L=this.getPadding(),X="zoom"in o?+o.zoom:S,W="bearing"in o?this._normalizeBearing(o.bearing,k):k,J="pitch"in o?+o.pitch:P,ee="padding"in o?o.padding:w.padding,ie=a.Point.convert(o.offset),se=w.centerPoint.add(ie),$=w.pointLocation(se),le=a.LngLat.convert(o.center||$);this._normalizeCenter(le);var me,be,Te=w.project($),Ee=w.project(le).sub(Te),Ae=w.zoomScale(X-S);o.around&&(me=a.LngLat.convert(o.around),be=w.locationPoint(me));var Oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||X!==S,this._rotating=this._rotating||k!==W,this._pitching=this._pitching||J!==P,this._padding=!w.isPaddingEqual(ee),this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,Oe),this._ease(function(Ke){if(m._zooming&&(w.zoom=a.number(S,X,Ke)),m._rotating&&(w.bearing=a.number(k,W,Ke)),m._pitching&&(w.pitch=a.number(P,J,Ke)),m._padding&&(w.interpolatePadding(L,ee,Ke),se=w.centerPoint.add(ie)),me)w.setLocationAtPoint(me,be);else{var et=w.zoomScale(w.zoom-S),lt=X>S?Math.min(2,Ae):Math.max(.5,Ae),mt=Math.pow(lt,1-Ke),Dt=w.unproject(Te.add(Ee.mult(Ke*mt)).mult(et));w.setLocationAtPoint(w.renderWorldCopies?Dt.wrap():Dt,se)}m._fireMoveEvents(u)},function(Ke){m._afterEase(u,Ke)},o),this},s.prototype._prepareEase=function(o,u,m){m===void 0&&(m={}),this._moving=!0,u||m.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!m.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,u){if(!this._easeId||!u||this._easeId!==u){delete this._easeId;var m=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new a.Event("zoomend",o)),w&&this.fire(new a.Event("rotateend",o)),S&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,u){var m=this;if(!o.essential&&a.browser.prefersReducedMotion){var w=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,u)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var S=this.transform,k=this.getZoom(),P=this.getBearing(),L=this.getPitch(),X=this.getPadding(),W="zoom"in o?a.clamp(+o.zoom,S.minZoom,S.maxZoom):k,J="bearing"in o?this._normalizeBearing(o.bearing,P):P,ee="pitch"in o?+o.pitch:L,ie="padding"in o?o.padding:S.padding,se=S.zoomScale(W-k),$=a.Point.convert(o.offset),le=S.centerPoint.add($),me=S.pointLocation(le),be=a.LngLat.convert(o.center||me);this._normalizeCenter(be);var Te=S.project(me),Ee=S.project(be).sub(Te),Ae=o.curve,Oe=Math.max(S.width,S.height),Ke=Oe/se,et=Ee.mag();if("minZoom"in o){var lt=a.clamp(Math.min(o.minZoom,k,W),S.minZoom,S.maxZoom),mt=Oe/S.zoomScale(lt-k);Ae=Math.sqrt(mt/et*2)}var Dt=Ae*Ae;function zt(At){var Pt=(Ke*Ke-Oe*Oe+(At?-1:1)*Dt*Dt*et*et)/(2*(At?Ke:Oe)*Dt*et);return Math.log(Math.sqrt(Pt*Pt+1)-Pt)}function Kt(At){return(Math.exp(At)-Math.exp(-At))/2}function ft(At){return(Math.exp(At)+Math.exp(-At))/2}var Ft=zt(0),Nt=function(At){return ft(Ft)/ft(Ft+Ae*At)},Q=function(At){return Oe*((ft(Ft)*(Kt(Pt=Ft+Ae*At)/ft(Pt))-Kt(Ft))/Dt)/et;var Pt},Me=(zt(1)-Ft)/Ae;if(Math.abs(et)<1e-6||!isFinite(Me)){if(Math.abs(Oe-Ke)<1e-6)return this.easeTo(o,u);var Vt=Ke<Oe?-1:1;Me=Math.abs(Math.log(Ke/Oe))/Ae,Q=function(){return 0},Nt=function(At){return Math.exp(Vt*Ae*At)}}return o.duration="duration"in o?+o.duration:1e3*Me/("screenSpeed"in o?+o.screenSpeed/Ae:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=P!==J,this._pitching=ee!==L,this._padding=!S.isPaddingEqual(ie),this._prepareEase(u,!1),this._ease(function(At){var Pt=At*Me,ci=1/Nt(Pt);S.zoom=At===1?W:k+S.scaleZoom(ci),m._rotating&&(S.bearing=a.number(P,J,At)),m._pitching&&(S.pitch=a.number(L,ee,At)),m._padding&&(S.interpolatePadding(X,ie,At),le=S.centerPoint.add($));var Tr=At===1?be:S.unproject(Te.add(Ee.mult(Q(Pt))).mult(ci));S.setLocationAtPoint(S.renderWorldCopies?Tr.wrap():Tr,le),m._fireMoveEvents(u)},function(){return m._afterEase(u)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,u)}if(!o){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(o,u,m){m.animate===!1||m.duration===0?(o(1),u()):(this._easeStart=a.browser.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,u){o=a.wrap(o,-180,180);var m=Math.abs(o-u);return Math.abs(o-360-u)<m&&(o-=360),Math.abs(o+360-u)<m&&(o+=360),o},s.prototype._normalizeCenter=function(o){var u=this.transform;if(u.renderWorldCopies&&!u.lngRange){var m=o.lng-u.center.lng;o.lng+=m>180?-360:m<-180?360:0}},s}(a.Evented),Di=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Di.prototype.getDefaultPosition=function(){return"bottom-right"},Di.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=I.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=I.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Di.prototype.onRemove=function(){I.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Di.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},Di.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Di.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(u,m,w){return m.value&&(u+=m.key+"="+m.value+(w<s.length-1?"&":"")),u},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},Di.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Di.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(k){return typeof k!="string"?"":k})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var u in o){var m=o[u];if(m.used){var w=m.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(k,P){return k.length-P.length});var S=(n=n.filter(function(k,P){for(var L=P+1;L<n.length;L++)if(n[L].indexOf(k)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Di.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var to=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};to.prototype.onAdd=function(n){this._map=n,this._container=I.create("div","mapboxgl-ctrl");var s=I.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},to.prototype.onRemove=function(){I.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},to.prototype.getDefaultPosition=function(){return"bottom-left"},to.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},to.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},to.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var Hi=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Hi.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},Hi.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,u=s?this._queue.concat(s):this._queue;o<u.length;o+=1){var m=u[o];if(m.id===n)return void(m.cancelled=!0)}},Hi.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,u=s;o<u.length;o+=1){var m=u[o];if(!m.cancelled&&(m.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Hi.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Qo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Ea=a.window.HTMLImageElement,ll=a.window.HTMLElement,hr=a.window.ImageBitmap,Wr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ka=function(n){function s(u){var m=this;if((u=a.extend({},Wr,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new Yt(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies);if(n.call(this,w,u),this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=u.collectResourceTiming,this._renderTaskQueue=new Hi,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Qo,u.locale),this._clickTolerance=u.clickTolerance,this._requestManager=new a.RequestManager(u.transformRequest,u.accessToken),typeof u.container=="string"){if(this._container=a.window.document.getElementById(u.container),!this._container)throw new Error("Container '"+u.container+"' not found.")}else{if(!(u.container instanceof ll))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return m._update(!1)}),this.on("moveend",function(){return m._update(!1)}),this.on("zoom",function(){return m._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new dt(this,u),this._hash=u.hash&&new an(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,a.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Di({customAttribution:u.customAttribution})),this.addControl(new to,u.logoPosition),this.on("style.load",function(){m.transform.unmodified&&m.jumpTo(m.style.stylesheet)}),this.on("data",function(S){m._update(S.dataType==="style"),m.fire(new a.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){m.fire(new a.Event(S.dataType+"dataloading",S))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(u,m){if(m===void 0&&(m=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=u.onAdd(this);this._controls.push(u);var S=this._controlPositions[m];return m.indexOf("bottom")!==-1?S.insertBefore(w,S.firstChild):S.appendChild(w),this},s.prototype.removeControl=function(u){if(!u||!u.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var m=this._controls.indexOf(u);return m>-1&&this._controls.splice(m,1),u.onRemove(this),this},s.prototype.hasControl=function(u){return this._controls.indexOf(u)>-1},s.prototype.resize=function(u){var m=this._containerDimensions(),w=m[0],S=m[1];if(w===this.transform.width&&S===this.transform.height)return this;this._resizeCanvas(w,S),this.transform.resize(w,S),this.painter.resize(w,S);var k=!this._moving;return k&&this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),this.fire(new a.Event("resize",u)),k&&this.fire(new a.Event("moveend",u)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(u){return this.transform.setMaxBounds(a.LngLatBounds.convert(u)),this._update()},s.prototype.setMinZoom=function(u){if((u=u==null?-2:u)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u&&this.setZoom(u),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(u){if((u=u==null?22:u)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u&&this.setZoom(u),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(u){if((u=u==null?0:u)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u&&this.setPitch(u),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(u){if((u=u==null?60:u)>60)throw new Error("maxPitch must be less than or equal to 60");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u&&this.setPitch(u),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(u){return this.transform.renderWorldCopies=u,this._update()},s.prototype.project=function(u){return this.transform.locationPoint(a.LngLat.convert(u))},s.prototype.unproject=function(u){return this.transform.pointLocation(a.Point.convert(u))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(u,m,w){var S,k=this;if(u==="mouseenter"||u==="mouseover"){var P=!1;return{layer:m,listener:w,delegates:{mousemove:function(X){var W=k.getLayer(m)?k.queryRenderedFeatures(X.point,{layers:[m]}):[];W.length?P||(P=!0,w.call(k,new Ii(u,k,X.originalEvent,{features:W}))):P=!1},mouseout:function(){P=!1}}}}if(u==="mouseleave"||u==="mouseout"){var L=!1;return{layer:m,listener:w,delegates:{mousemove:function(X){(k.getLayer(m)?k.queryRenderedFeatures(X.point,{layers:[m]}):[]).length?L=!0:L&&(L=!1,w.call(k,new Ii(u,k,X.originalEvent)))},mouseout:function(X){L&&(L=!1,w.call(k,new Ii(u,k,X.originalEvent)))}}}}return{layer:m,listener:w,delegates:(S={},S[u]=function(X){var W=k.getLayer(m)?k.queryRenderedFeatures(X.point,{layers:[m]}):[];W.length&&(X.features=W,w.call(k,X),delete X.features)},S)}},s.prototype.on=function(u,m,w){if(w===void 0)return n.prototype.on.call(this,u,m);var S=this._createDelegatedListener(u,m,w);for(var k in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(S),S.delegates)this.on(k,S.delegates[k]);return this},s.prototype.once=function(u,m,w){if(w===void 0)return n.prototype.once.call(this,u,m);var S=this._createDelegatedListener(u,m,w);for(var k in S.delegates)this.once(k,S.delegates[k]);return this},s.prototype.off=function(u,m,w){var S=this;return w===void 0?n.prototype.off.call(this,u,m):(this._delegatedListeners&&this._delegatedListeners[u]&&function(k){for(var P=k[u],L=0;L<P.length;L++){var X=P[L];if(X.layer===m&&X.listener===w){for(var W in X.delegates)S.off(W,X.delegates[W]);return P.splice(L,1),S}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(u,m){if(!this.style)return[];var w;if(m!==void 0||u===void 0||u instanceof a.Point||Array.isArray(u)||(m=u,u=void 0),m=m||{},(u=u||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof u[0]=="number")w=[a.Point.convert(u)];else{var S=a.Point.convert(u[0]),k=a.Point.convert(u[1]);w=[S,new a.Point(k.x,S.y),k,new a.Point(S.x,k.y),S]}return this.style.queryRenderedFeatures(w,m,this.transform)},s.prototype.querySourceFeatures=function(u,m){return this.style.querySourceFeatures(u,m)},s.prototype.setStyle=function(u,m){return(m=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},m)).diff!==!1&&m.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&u?(this._diffStyle(u,m),this):(this._localIdeographFontFamily=m.localIdeographFontFamily,this._updateStyle(u,m))},s.prototype._getUIString=function(u){var m=this._locale[u];if(m==null)throw new Error("Missing UI string '"+u+"'");return m},s.prototype._updateStyle=function(u,m){return this.style&&(this.style.setEventedParent(null),this.style._remove()),u?(this.style=new Hn(this,m||{}),this.style.setEventedParent(this,{style:this.style}),typeof u=="string"?this.style.loadURL(u):this.style.loadJSON(u),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Hn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(u,m){var w=this;if(typeof u=="string"){var S=this._requestManager.normalizeStyleURL(u),k=this._requestManager.transformRequest(S,a.ResourceType.Style);a.getJSON(k,function(P,L){P?w.fire(new a.ErrorEvent(P)):L&&w._updateDiff(L,m)})}else typeof u=="object"&&this._updateDiff(u,m)},s.prototype._updateDiff=function(u,m){try{this.style.setState(u)&&this._update(!0)}catch(w){a.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(u,m)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(u,m){return this._lazyInitEmptyStyle(),this.style.addSource(u,m),this._update(!0)},s.prototype.isSourceLoaded=function(u){var m=this.style&&this.style.sourceCaches[u];if(m!==void 0)return m.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+u+"'")))},s.prototype.areTilesLoaded=function(){var u=this.style&&this.style.sourceCaches;for(var m in u){var w=u[m]._tiles;for(var S in w){var k=w[S];if(k.state!=="loaded"&&k.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(u,m,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(u,m,w)},s.prototype.removeSource=function(u){return this.style.removeSource(u),this._update(!0)},s.prototype.getSource=function(u){return this.style.getSource(u)},s.prototype.addImage=function(u,m,w){w===void 0&&(w={});var S=w.pixelRatio;S===void 0&&(S=1);var k=w.sdf;k===void 0&&(k=!1);var P=w.stretchX,L=w.stretchY,X=w.content;if(this._lazyInitEmptyStyle(),m instanceof Ea||hr&&m instanceof hr){var W=a.browser.getImageData(m);this.style.addImage(u,{data:new a.RGBAImage({width:W.width,height:W.height},W.data),pixelRatio:S,stretchX:P,stretchY:L,content:X,sdf:k,version:0})}else{if(m.width===void 0||m.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var J=m;this.style.addImage(u,{data:new a.RGBAImage({width:m.width,height:m.height},new Uint8Array(m.data)),pixelRatio:S,stretchX:P,stretchY:L,content:X,sdf:k,version:0,userImage:J}),J.onAdd&&J.onAdd(this,u)}},s.prototype.updateImage=function(u,m){var w=this.style.getImage(u);if(!w)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=m instanceof Ea||hr&&m instanceof hr?a.browser.getImageData(m):m,k=S.width,P=S.height,L=S.data;return k===void 0||P===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):k!==w.data.width||P!==w.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(L,!(m instanceof Ea||hr&&m instanceof hr)),void this.style.updateImage(u,w))},s.prototype.hasImage=function(u){return u?!!this.style.getImage(u):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(u){this.style.removeImage(u)},s.prototype.loadImage=function(u,m){a.getImage(this._requestManager.transformRequest(u,a.ResourceType.Image),m)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(u,m){return this._lazyInitEmptyStyle(),this.style.addLayer(u,m),this._update(!0)},s.prototype.moveLayer=function(u,m){return this.style.moveLayer(u,m),this._update(!0)},s.prototype.removeLayer=function(u){return this.style.removeLayer(u),this._update(!0)},s.prototype.getLayer=function(u){return this.style.getLayer(u)},s.prototype.setLayerZoomRange=function(u,m,w){return this.style.setLayerZoomRange(u,m,w),this._update(!0)},s.prototype.setFilter=function(u,m,w){return w===void 0&&(w={}),this.style.setFilter(u,m,w),this._update(!0)},s.prototype.getFilter=function(u){return this.style.getFilter(u)},s.prototype.setPaintProperty=function(u,m,w,S){return S===void 0&&(S={}),this.style.setPaintProperty(u,m,w,S),this._update(!0)},s.prototype.getPaintProperty=function(u,m){return this.style.getPaintProperty(u,m)},s.prototype.setLayoutProperty=function(u,m,w,S){return S===void 0&&(S={}),this.style.setLayoutProperty(u,m,w,S),this._update(!0)},s.prototype.getLayoutProperty=function(u,m){return this.style.getLayoutProperty(u,m)},s.prototype.setLight=function(u,m){return m===void 0&&(m={}),this._lazyInitEmptyStyle(),this.style.setLight(u,m),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(u,m){return this.style.setFeatureState(u,m),this._update()},s.prototype.removeFeatureState=function(u,m){return this.style.removeFeatureState(u,m),this._update()},s.prototype.getFeatureState=function(u){return this.style.getFeatureState(u)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var u=0,m=0;return this._container&&(u=this._container.clientWidth||400,m=this._container.clientHeight||300),[u,m]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=I.create("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();var m=this._canvasContainer=I.create("div","mapboxgl-canvas-container",u);this._interactive&&m.classList.add("mapboxgl-interactive"),this._canvas=I.create("canvas","mapboxgl-canvas",m),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var S=this._controlContainer=I.create("div","mapboxgl-control-container",u),k=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(P){k[P]=I.create("div","mapboxgl-ctrl-"+P,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(u,m){var w=a.browser.devicePixelRatio||1;this._canvas.width=w*u,this._canvas.height=w*m,this._canvas.style.width=u+"px",this._canvas.style.height=m+"px"},s.prototype._setupPainter=function(){var u=a.extend({},A.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),m=this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);m?(this.painter=new Cr(m,this.transform),a.webpSupported.testSupport(m)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:u}))},s.prototype._contextRestored=function(u){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:u}))},s.prototype._onMapScroll=function(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(u){return this._update(),this._renderTaskQueue.add(u)},s.prototype._cancelRenderFrame=function(u){this._renderTaskQueue.remove(u)},s.prototype._render=function(u){var m,w=this,S=0,k=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(m=k.createQueryEXT(),k.beginQueryEXT(k.TIME_ELAPSED_EXT,m),S=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(u),!this._removed){var P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var L=this.transform.zoom,X=a.browser.now();this.style.zoomHistory.update(L,X);var W=new a.EvaluationParameters(L,{now:X,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),J=W.crossFadingFactor();J===1&&J===this._crossFadingFactor||(P=!0,this._crossFadingFactor=J),this.style.update(W)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var ee=a.browser.now()-S;k.endQueryEXT(k.TIME_ELAPSED_EXT,m),setTimeout(function(){var $=k.getQueryObjectEXT(m,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(m),w.fire(new a.Event("gpu-timing-frame",{cpuTime:ee,gpuTime:$}))},50)}if(this.listens("gpu-timing-layer")){var ie=this.painter.collectGpuTimers();setTimeout(function(){var $=w.painter.queryGpuTimers(ie);w.fire(new a.Event("gpu-timing-layer",{layerTimes:$}))},50)}var se=this._sourcesDirty||this._styleDirty||this._placementDirty;return se||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||se||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var u=0,m=this._controls;u<m.length;u+=1)m[u].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),rs(this._canvasContainer),rs(this._controlContainer),rs(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var u=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(m){u._frame=null,u._render(m)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(u){this._trackResize&&this.resize({originalEvent:u})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(u){this._showPadding!==u&&(this._showPadding=u,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(u){this._vertices=u,this._update()},s.prototype._setCacheLimits=function(u,m){a.setCacheLimits(u,m)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}(sl);function rs(n){n.parentNode&&n.parentNode.removeChild(n)}var is={showCompass:!0,showZoom:!0,visualizePitch:!1},ns=function(n){var s=this;this.options=a.extend({},is,n),this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),I.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),I.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=I.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ns.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},ns.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},ns.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qn(this._map,this._compass,this.options.visualizePitch)),this._container},ns.prototype.onRemove=function(){I.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ns.prototype._createButton=function(n,s){var o=I.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},ns.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var qn=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new wa({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new Fs({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),I.addEventListener(s,"mousedown",this.mousedown),I.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),I.addEventListener(s,"touchmove",this.touchmove),I.addEventListener(s,"touchend",this.touchend),I.addEventListener(s,"touchcancel",this.reset)};function $o(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var u=new a.LngLat(n.lng-360,n.lat),m=new a.LngLat(n.lng+360,n.lat),w=o.locationPoint(n).distSqr(s);o.locationPoint(u).distSqr(s)<w?n=u:o.locationPoint(m).distSqr(s)<w&&(n=m)}for(;Math.abs(n.lng-o.center.lng)>180;){var S=o.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}qn.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),I.disableDrag()},qn.prototype.move=function(n,s){var o=this.map,u=this.mouseRotate.mousemoveWindow(n,s);if(u&&u.bearingDelta&&o.setBearing(o.getBearing()+u.bearingDelta),this.mousePitch){var m=this.mousePitch.mousemoveWindow(n,s);m&&m.pitchDelta&&o.setPitch(o.getPitch()+m.pitchDelta)}},qn.prototype.off=function(){var n=this.element;I.removeEventListener(n,"mousedown",this.mousedown),I.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),I.removeEventListener(n,"touchmove",this.touchmove),I.removeEventListener(n,"touchend",this.touchend),I.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},qn.prototype.offTemp=function(){I.enableDrag(),I.removeEventListener(a.window,"mousemove",this.mousemove),I.removeEventListener(a.window,"mouseup",this.mouseup)},qn.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),I.mousePos(this.element,n)),I.addEventListener(a.window,"mousemove",this.mousemove),I.addEventListener(a.window,"mouseup",this.mouseup)},qn.prototype.mousemove=function(n){this.move(n,I.mousePos(this.element,n))},qn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},qn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=I.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},qn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=I.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},qn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},qn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Zn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ul(n,s,o){var u=n.classList;for(var m in Zn)u.remove("mapboxgl-"+o+"-anchor-"+m);u.add("mapboxgl-"+o+"-anchor-"+s)}var ea,os=function(n){function s(o,u){if(n.call(this),(o instanceof a.window.HTMLElement||u)&&(o=a.extend({element:o},u)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=I.create("div"),this._element.setAttribute("aria-label","Map marker");var m=I.createNS("http://www.w3.org/2000/svg","svg");m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height","41px"),m.setAttributeNS(null,"width","27px"),m.setAttributeNS(null,"viewBox","0 0 27 41");var w=I.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var S=I.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");var k=I.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");for(var P=0,L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];P<L.length;P+=1){var X=L[P],W=I.createNS("http://www.w3.org/2000/svg","ellipse");W.setAttributeNS(null,"opacity","0.04"),W.setAttributeNS(null,"cx","10.5"),W.setAttributeNS(null,"cy","5.80029008"),W.setAttributeNS(null,"rx",X.rx),W.setAttributeNS(null,"ry",X.ry),k.appendChild(W)}var J=I.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"fill",this._color);var ee=I.createNS("http://www.w3.org/2000/svg","path");ee.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),J.appendChild(ee);var ie=I.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"opacity","0.25"),ie.setAttributeNS(null,"fill","#000000");var se=I.createNS("http://www.w3.org/2000/svg","path");se.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ie.appendChild(se);var $=I.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");var le=I.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");var me=I.createNS("http://www.w3.org/2000/svg","circle");me.setAttributeNS(null,"fill","#000000"),me.setAttributeNS(null,"opacity","0.25"),me.setAttributeNS(null,"cx","5.5"),me.setAttributeNS(null,"cy","5.5"),me.setAttributeNS(null,"r","5.4999962");var be=I.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#FFFFFF"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962"),le.appendChild(me),le.appendChild(be),S.appendChild(k),S.appendChild(J),S.appendChild(ie),S.appendChild($),S.appendChild(le),m.appendChild(S),m.setAttributeNS(null,"height",41*this._scale+"px"),m.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(m),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Te){Te.preventDefault()}),this._element.addEventListener("mousedown",function(Te){Te.preventDefault()}),ul(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),I.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var u=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(24.6+u)],"bottom-right":[-u,-1*(24.6+u)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var u=o.code,m=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&m!==32&&m!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var u=o.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=$o(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(u="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),I.setTransform(this._element,Zn[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+m+" "+u)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var u=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),Ll={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},xs=0,mo=!1,Rl=function(n){function s(o){n.call(this),this.options=a.extend({},Ll,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var u;return this._map=o,this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),u=this._setupUI,ea!==void 0?u(ea):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(m){u(ea=m.state!=="denied")}):u(ea=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),I.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,xs=0,mo=!1},s.prototype._isOutOfMapMaxBounds=function(o){var u=this._map.getMaxBounds(),m=o.coords;return u&&(m.longitude<u.getWest()||m.longitude>u.getEast()||m.latitude<u.getSouth()||m.latitude>u.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var u=new a.LngLat(o.coords.longitude,o.coords.latitude),m=o.coords.accuracy,w=this._map.getBearing(),S=a.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(m),S,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var u=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,u=this._map.unproject([0,o]),m=this._map.unproject([1,o]),w=u.distanceTo(m),S=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&mo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var u=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=I.create("button","mapboxgl-ctrl-geolocate",this._container),I.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=I.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new os(this._dotElement),this._circleElement=I.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new os({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||u._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(u._watchState="BACKGROUND",u._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),u._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),u.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":xs--,mo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++xs>1?(o={maximumAge:6e5,timeout:0},mo=!0):(o=this.options.positionOptions,mo=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),En={maxWidth:100,unit:"metric"},sn=function(n){this.options=a.extend({},En,n),a.bindAll(["_onMove","setUnit"],this)};function ta(n,s,o){var u=o&&o.maxWidth||100,m=n._container.clientHeight/2,w=n.unproject([0,m]),S=n.unproject([u,m]),k=w.distanceTo(S);if(o&&o.unit==="imperial"){var P=3.2808*k;P>5280?Ta(s,u,P/5280,n._getUIString("ScaleControl.Miles")):Ta(s,u,P,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Ta(s,u,k/1852,n._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Ta(s,u,k/1e3,n._getUIString("ScaleControl.Kilometers")):Ta(s,u,k,n._getUIString("ScaleControl.Meters"))}function Ta(n,s,o,u){var m,w,S,k=(m=o,(w=Math.pow(10,(""+Math.floor(m)).length-1))*(S=(S=m/w)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(P){var L=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*L)/L}(S)));n.style.width=s*(k/o)+"px",n.innerHTML=k+"&nbsp;"+u}sn.prototype.getDefaultPosition=function(){return"bottom-left"},sn.prototype._onMove=function(){ta(this._map,this._container,this.options)},sn.prototype.onAdd=function(n){return this._map=n,this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},sn.prototype.onRemove=function(){I.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},sn.prototype.setUnit=function(n){this.options.unit=n,ta(this._map,this._container,this.options)};var dn=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};dn.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},dn.prototype.onRemove=function(){I.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},dn.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},dn.prototype._setupUI=function(){var n=this._fullscreenButton=I.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);I.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},dn.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},dn.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},dn.prototype._isFullscreen=function(){return this._fullscreen},dn.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},dn.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Lu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},js=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),as=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(Lu),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&I.remove(this._content),this._container&&(I.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var u,m=a.window.document.createDocumentFragment(),w=a.window.document.createElement("body");for(w.innerHTML=o;u=w.firstChild;)m.appendChild(u);return this.setDOMContent(m)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=I.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=I.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var u=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=I.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=I.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(W){return u._container.classList.add(W)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=$o(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var m=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),w=this.options.anchor,S=function W(J){if(J){if(typeof J=="number"){var ee=Math.round(Math.sqrt(.5*Math.pow(J,2)));return{center:new a.Point(0,0),top:new a.Point(0,J),"top-left":new a.Point(ee,ee),"top-right":new a.Point(-ee,ee),bottom:new a.Point(0,-J),"bottom-left":new a.Point(ee,-ee),"bottom-right":new a.Point(-ee,-ee),left:new a.Point(J,0),right:new a.Point(-J,0)}}if(J instanceof a.Point||Array.isArray(J)){var ie=a.Point.convert(J);return{center:ie,top:ie,"top-left":ie,"top-right":ie,bottom:ie,"bottom-left":ie,"bottom-right":ie,left:ie,right:ie}}return{center:a.Point.convert(J.center||[0,0]),top:a.Point.convert(J.top||[0,0]),"top-left":a.Point.convert(J["top-left"]||[0,0]),"top-right":a.Point.convert(J["top-right"]||[0,0]),bottom:a.Point.convert(J.bottom||[0,0]),"bottom-left":a.Point.convert(J["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(J["bottom-right"]||[0,0]),left:a.Point.convert(J.left||[0,0]),right:a.Point.convert(J.right||[0,0])}}return W(new a.Point(0,0))}(this.options.offset);if(!w){var k,P=this._container.offsetWidth,L=this._container.offsetHeight;k=m.y+S.bottom.y<L?["top"]:m.y>this._map.transform.height-L?["bottom"]:[],m.x<P/2?k.push("left"):m.x>this._map.transform.width-P/2&&k.push("right"),w=k.length===0?"bottom":k.join("-")}var X=m.add(S[w]).round();I.setTransform(this._container,Zn[w]+" translate("+X.x+"px,"+X.y+"px)"),ul(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(js);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),Ia={version:a.version,supported:A,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:ka,NavigationControl:ns,GeolocateControl:Rl,AttributionControl:Di,ScaleControl:sn,FullscreenControl:dn,Popup:as,Marker:os,Style:Hn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){ze().acquire(Re)},clearPrewarmedResources:function(){var n=ht;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(Re),ht=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return je.workerCount},set workerCount(n){je.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return Ia}),v})})(Ph);const j0=Ph.exports;function dy(c){let h;const f=c[15].default,y=Fc(f,c,c[14],null);return{c(){y&&y.c()},l(v){y&&y.l(v)},m(v,x){y&&y.m(v,x),h=!0},p(v,x){y&&y.p&&(!h||x&16384)&&Nc(y,f,v,v[14],h?Uc(f,v[14],x,null):Vc(v[14]),null)},i(v){h||(bt(y,v),h=!0)},o(v){Ot(y,v),h=!1},d(v){y&&y.d(v)}}}function q0(c){let h,f,y,v=c[0]&&dy(c);return{c(){h=ce("div"),v&&v.c(),this.h()},l(x){h=he(x,"DIV",{class:!0,id:!0});var a=fe(h);v&&v.l(a),a.forEach(O),this.h()},h(){U(h,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),U(h,"id",c[1]),Lc(()=>c[16].call(h))},m(x,a){Ie(x,h,a),v&&v.m(h,null),f=Rc(h,c[16].bind(h)),c[17](h),y=!0},p(x,[a]){x[0]?v?(v.p(x,a),a&1&&bt(v,1)):(v=dy(x),v.c(),bt(v,1),v.m(h,null)):v&&(As(),Ot(v,1,1,()=>{v=null}),zs()),(!y||a&2)&&U(h,"id",x[1])},i(x){y||(bt(v),y=!0)},o(x){Ot(v),y=!1},d(x){x&&O(h),v&&v.d(),f(),c[17](null)}}}function Z0(c,h,f){let{$$slots:y={},$$scope:v}=h,{map:x}=h,{id:a="map"}=h,{location:A={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=h,{style:I="https://raw.githubusercontent.com/nisra-explore/map_tiles/main/basemap_styles/style-omt.json"}=h,{interactive:R=!0}=h,{minzoom:B=0}=h,{maxzoom:G=14}=h,{zoom:j=null}=h,{scrollzoom:H=!0}=h,{geolocate:de=!0}=h,{zoomcontrol:Ce=!0}=h,{options:xe={}}=h,Xe,Ue;Uy("map",{getMap:()=>x}),A.bounds?xe={...xe,bounds:A.bounds}:A.lon&&A.lat&&(xe={...xe,center:[A.lon,A.lat]},A.zoom&&(xe.zoom=A.zoom)),Vy(()=>{const We=document.createElement("link");return We.rel="stylesheet",We.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",We.onload=()=>{f(0,x=new Ph.exports.Map({container:Xe,style:I,minZoom:B,maxZoom:G,interactive:R,...xe})),Ce&&x.addControl(new Ph.exports.NavigationControl({showCompass:!1})),H||x.scrollZoom.disable(),de&&x.addControl(new Ph.exports.GeolocateControl),x.on("load",()=>{f(4,j=x.getZoom())}),x.on("zoom",()=>{f(4,j=x.getZoom())})},document.head.appendChild(We),()=>{x.remove(),We.parentNode.removeChild(We)}});function Bt(){let We=document.getElementsByClassName("mapboxgl-canvas");We[0]&&(We[0].style.width="100%",x.resize())}function St(){Ue=this.clientWidth,f(2,Ue)}function ut(We){eu[We?"unshift":"push"](()=>{Xe=We,f(3,Xe)})}return c.$$set=We=>{"map"in We&&f(0,x=We.map),"id"in We&&f(1,a=We.id),"location"in We&&f(6,A=We.location),"style"in We&&f(7,I=We.style),"interactive"in We&&f(8,R=We.interactive),"minzoom"in We&&f(9,B=We.minzoom),"maxzoom"in We&&f(10,G=We.maxzoom),"zoom"in We&&f(4,j=We.zoom),"scrollzoom"in We&&f(11,H=We.scrollzoom),"geolocate"in We&&f(12,de=We.geolocate),"zoomcontrol"in We&&f(13,Ce=We.zoomcontrol),"options"in We&&f(5,xe=We.options),"$$scope"in We&&f(14,v=We.$$scope)},c.$$.update=()=>{c.$$.dirty&4&&Ue&&Bt()},[x,a,Ue,Xe,j,xe,A,I,R,B,G,H,de,Ce,v,y,St,ut]}class G0 extends Ba{constructor(h){super(),Oa(this,h,Z0,q0,Fa,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function my(c){let h;const f=c[11].default,y=Fc(f,c,c[10],null);return{c(){y&&y.c()},l(v){y&&y.l(v)},m(v,x){y&&y.m(v,x),h=!0},p(v,x){y&&y.p&&(!h||x&1024)&&Nc(y,f,v,v[10],h?Uc(f,v[10],x,null):Vc(v[10]),null)},i(v){h||(bt(y,v),h=!0)},o(v){Ot(y,v),h=!1},d(v){y&&y.d(v)}}}function K0(c){let h,f,y=c[0]&&my(c);return{c(){y&&y.c(),h=ki()},l(v){y&&y.l(v),h=ki()},m(v,x){y&&y.m(v,x),Ie(v,h,x),f=!0},p(v,[x]){v[0]?y?(y.p(v,x),x&1&&bt(y,1)):(y=my(v),y.c(),bt(y,1),y.m(h.parentNode,h)):y&&(As(),Ot(y,1,1,()=>{y=null}),zs())},i(v){f||(bt(y),f=!0)},o(v){Ot(y),f=!1},d(v){y&&y.d(v),v&&O(h)}}}function X0(c,h,f){let{$$slots:y={},$$scope:v}=h,{id:x}=h,{type:a}=h,{url:A=null}=h,{props:I={}}=h,{data:R=null}=h,{layer:B=null}=h,{promoteId:G=null}=h,{minzoom:j=null}=h,{maxzoom:H=null}=h,de=!1;const{getMap:Ce}=Lh("map"),xe=Ce();xe.getSource(x)&&xe.removeSource(x);function Xe(){xe.isSourceLoaded(x)?(f(0,de=!0),console.log(x+" loaded!")):setTimeout(()=>{console.log("..."),Xe()},500)}function Ue(){xe.isStyleLoaded(x)?(Bt(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),Ue()},500)}j&&(I.minzoom=j),H&&(I.maxzoom=H),B&&G?(I.promoteId={},I.promoteId[B]=G):G&&(I.promoteId=G);function Bt(){console.log(x+" map source loading..."),a=="geojson"?R?(xe.addSource(x,{type:a,data:R,...I}),Xe()):A&&(xe.addSource(x,{type:a,data:A,...I}),Xe()):a=="vector"&&(xe.addSource(x,{type:a,tiles:[A],...I}),Xe())}Ue();function St(){xe.getSource(x).setData(R)}return c.$$set=ut=>{"id"in ut&&f(2,x=ut.id),"type"in ut&&f(3,a=ut.type),"url"in ut&&f(4,A=ut.url),"props"in ut&&f(1,I=ut.props),"data"in ut&&f(5,R=ut.data),"layer"in ut&&f(6,B=ut.layer),"promoteId"in ut&&f(7,G=ut.promoteId),"minzoom"in ut&&f(8,j=ut.minzoom),"maxzoom"in ut&&f(9,H=ut.maxzoom),"$$scope"in ut&&f(10,v=ut.$$scope)},c.$$.update=()=>{c.$$.dirty&33&&de&&R&&St()},[de,I,x,a,A,R,B,G,j,H,v,y]}class pg extends Ba{constructor(h){super(),Oa(this,h,X0,K0,Fa,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function W0(c,h,f){const{Popup:y}=j0,v=jy(),x=new y({closeButton:!1,closeOnClick:!1});let{id:a}=h,{source:A}=h,{sourceLayer:I=null}=h,{type:R}=h,{filter:B=null}=h,{layout:G={}}=h,{paint:j={}}=h,{data:H=null}=h,{code:de=null}=h,{name:Ce="name"}=h,{colorCode:xe=null}=h,{click:Xe=!1}=h,{ignoreClick:Ue=!1}=h,{clickCenter:Bt=!1}=h,{selected:St=null}=h,{hover:ut=!1}=h,{hovered:We=null}=h,{highlight:tr=!1}=h,{highlightKey:Xt="highlighted"}=h,{highlighted:xt=[]}=h,{order:qt=null}=h,{maxzoom:Ge=null}=h,{minzoom:Rt=null}=h,{isChild:yt=!1}=h;const{getMap:gt}=Lh("map"),Le=gt();let Ne=null,Et=null,mr=[];Le.getLayer(a)&&Le.removeLayer(a);let Wt={id:a,type:R,source:A,paint:j,layout:G};B&&(Wt.filter=B),I&&(Wt["source-layer"]=I),Ge&&(Wt.maxzoom=Ge),Rt&&(Wt.minzoom=Rt),Le.addLayer(Wt,qt);function qe(){console.log("updating colors..."),H.forEach($e=>{Le.setFeatureState({source:A,sourceLayer:I,id:$e[de]},{color:$e[xe]})})}return Xe&&Le.on("click",a,$e=>{if($e.features.length>0&&!Ue){let lr=$e.features[0].id;if(yt&&xt.includes(lr)||!yt&&St!=lr){if(f(0,St=lr),v("select",{code:St}),Ne&&Le.setFeatureState({source:A,sourceLayer:I,id:Ne},{selected:!1}),Le.setFeatureState({source:A,sourceLayer:I,id:St},{selected:!0}),Bt){let gr=centroid($e.features[0].toJSON().geometry);Le.flyTo({center:gr.geometry.coordinates})}f(24,Ne=St)}}}),ut&&(Le.on("mousemove",a,$e=>{if($e.features.length>0){let lr=$e.features[0].id;We&&Le.setFeatureState({source:A,sourceLayer:I,id:We},{hovered:!1}),yt&&xt.includes(lr)||!yt&&St!=lr?(f(1,We=f(25,Et=lr)),Le.setFeatureState({source:A,sourceLayer:I,id:We},{hovered:!0}),Le.getCanvas().style.cursor="pointer",x.setLngLat($e.lngLat).setHTML(`<strong>${$e.features[0].properties[Ce]?$e.features[0].properties[Ce]:$e.features[0].properties[de]}</strong>`).addTo(Le)):x.remove()}}),Le.on("mouseleave",a,$e=>{We&&Le.setFeatureState({source:A,sourceLayer:I,id:We},{hovered:!1}),f(1,We=f(25,Et=null)),Le.getCanvas().style.cursor="",x.remove()})),c.$$set=$e=>{"id"in $e&&f(2,a=$e.id),"source"in $e&&f(3,A=$e.source),"sourceLayer"in $e&&f(4,I=$e.sourceLayer),"type"in $e&&f(5,R=$e.type),"filter"in $e&&f(6,B=$e.filter),"layout"in $e&&f(7,G=$e.layout),"paint"in $e&&f(8,j=$e.paint),"data"in $e&&f(9,H=$e.data),"code"in $e&&f(10,de=$e.code),"name"in $e&&f(11,Ce=$e.name),"colorCode"in $e&&f(12,xe=$e.colorCode),"click"in $e&&f(13,Xe=$e.click),"ignoreClick"in $e&&f(14,Ue=$e.ignoreClick),"clickCenter"in $e&&f(15,Bt=$e.clickCenter),"selected"in $e&&f(0,St=$e.selected),"hover"in $e&&f(16,ut=$e.hover),"hovered"in $e&&f(1,We=$e.hovered),"highlight"in $e&&f(17,tr=$e.highlight),"highlightKey"in $e&&f(18,Xt=$e.highlightKey),"highlighted"in $e&&f(19,xt=$e.highlighted),"order"in $e&&f(20,qt=$e.order),"maxzoom"in $e&&f(21,Ge=$e.maxzoom),"minzoom"in $e&&f(22,Rt=$e.minzoom),"isChild"in $e&&f(23,yt=$e.isChild)},c.$$.update=()=>{c.$$.dirty[0]&4096&&xe&&qe(),c.$$.dirty[0]&68026392&&tr&&xt!=mr&&(mr[0]&&mr.forEach($e=>{let lr={};lr[Xt]=!1,Le.setFeatureState({source:A,sourceLayer:I,id:$e},lr)}),f(26,mr=xt),xt[0]&&xt.forEach($e=>{let lr={};lr[Xt]=!0,Le.setFeatureState({source:A,sourceLayer:I,id:$e},lr)})),c.$$.dirty[0]&16777241&&St!=Ne&&(Ne&&Le.setFeatureState({source:A,sourceLayer:I,id:Ne},{selected:!1}),St&&Le.setFeatureState({source:A,sourceLayer:I,id:St},{selected:!0}),f(24,Ne=St)),c.$$.dirty[0]&33619994&&ut&&We!=Et&&(Et&&Le.setFeatureState({source:A,sourceLayer:I,id:Et},{hovered:!1}),We&&Le.setFeatureState({source:A,sourceLayer:I,id:We},{hovered:!0}),f(25,Et=We))},[St,We,a,A,I,R,B,G,j,H,de,Ce,xe,Xe,Ue,Bt,ut,tr,Xt,xt,qt,Ge,Rt,yt,Ne,Et,mr]}class Oc extends Ba{constructor(h){super(),Oa(this,h,W0,null,Fa,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function yy(c,h,f){const y=c.slice();return y[33]=h[f],y[35]=f,y}function gy(c,h,f){const y=c.slice();return y[36]=h[f],y[35]=f,y}function _y(c,h,f){const y=c.slice();return y[38]=h[f],y}function vy(c,h,f){const y=c.slice();return y[38]=h[f],y}function by(c,h,f){const y=c.slice();return y[36]=h[f],y[35]=f,y}function xy(c){let h,f,y,v,x,a,A=" &gt; ",I,R,B,G,j,H=c[1].name+"",de,Ce,xe,Xe,Ue,Bt,St,ut,We,tr,Xt,xt,qt,Ge,Rt,yt,gt,Le,Ne,Et,mr,Wt,qe,$e,lr,gr,pi,ii,Zr,Gr,si,kt,ur,wt,Ht,It,ei,Or,li,_n,Si,tn,wr,fi,Fi,Ni,di,oo=" &#x24D8; ",Xi,vn,Xn,Bo,zn,Wn,ia,So,Pn,Cn=c[1].data.population.value[2021].all.toLocaleString()+"",Eo,Oo,na,Fo,ao,Kr,mi,rn,so,xr,M=" &#x24D8; ",F,q,Y,re,ue,ye,Z,oe,ve,Ve=c[1].data.households.value[2021].all_households.toLocaleString()+"",Ze,Re,je,ht,st,ze,tt,Ye,it,Ut,ot=" &#x24D8; ",er,cr,Zt,or,Jt,ui,fr,Fr,nr,Gt,ar,Ei,ko,Nr,ni,_a,No,Sr,Vo,Xr,Er,yi,Pr,Wi,Mn=" &#x24D8; ",Ps,oi,Dn,Vi,ai,bn,Ui,Uo,jo,Ys,Ci,Na,qo,kl,oa,ls=c[1].name+"",aa,Cs,Ln,Zo,va,Rn,lo,_e,nn,Ti,Br,Bn,Hn,gi,To,us,Pu,Ms,Ds=c[1].name+"",Qs,Tl,$s,Jn,sa,Go,Io,Ls,cs,pn=" &#x24D8; ",Il,uo,co,Va,Ao,Ko,Ua,ja,Yn,tu,la,dr,qa,el,hs,rc=" &#x24D8; ",ru,ps,zo,ba,Po,tl,iu,Al,ho,nu,On,fn,ua,Rs,kr,ou=" &#x24D8; ",Cu,Xo,fs,Mu,ds,ms,ys,Bs,ca,rl,Za,Ga,Wo,Co,gs,il=c[1].name+"",zl,Ka,_s,xn,Ho,Qn,Xa,nl,Wa,ic=" &#x24D8; ",au,xa,Ha,Pl,Ja,Ya,su,Qa,Cr,ol,Fn,on,Yt,Vr,an,Cl=" &#x24D8; ",vs,ha,Os,Du,pa,$a,fa,Ii,Jo,lu,Ur,at,Mi,al,Yo,da=" &#x24D8; ",Nn,es,rt,Ml,wa,Fs,po,Vn,ma,Dl,wn,Un,bs,Ns,ts,Vs=c[1].name+"",fo,$n,rr,Ai,ji,ti,eo,Sa,Sn,jn=" &#x24D8; ",Us,vt,dt,sl,Di,to,Hi,Qo,Ea,ll,hr,Wr,ka,rs,is,ns=" &#x24D8; ",qn,$o,Zn,ul,ea,os,Ll,xs,mo,Rl,En,sn,ta,Ta,dn,Lu=" &#x24D8; ",js,as,Ia,n,s,o,u,m,w,S,k,P,L;function X(Q,Me){return Q[1].parents[0]?J0:H0}let W=X(c),J=W(c),ee=c[1].type!="ew"&&Sy(c);gt=new U0({props:{options:c[0],group:"typestr",search:!0}}),gt.$on("select",c[14]);function ie(Q,Me){return Q[1].type=="ew"||Q[1].type=="ctry"?Q0:Y0}let se=ie(c),$=se(c);function le(Q,Me){return Q[1].data.population.value.change.all==0?o1:Q[1].data.population.value.change.all>0?n1:i1}let me=le(c),be=me(c),Te=c[1].type!="ew"&&Ey(c),Ee=c[4]&&Ty(c),Ae=c[1].type!="ew"&c[10]&&Iy(c),Oe=c[4]&&Ay(c);Gt=new qv({props:{data:c[1]&&c[12](["age","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null}});let Ke=!c[9]&&c[11]&&zy(c);function et(Q,Me){if(Q[9])return y1;if(Q[4])return m1;if(Q[10])return d1}let lt=et(c),mt=lt&&lt(c);Sr=new Ws({props:{data:c[1]&&c[12](["population","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),jo=new Ws({props:{data:c[1]&&c[12](["hh_size","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}});function Dt(Q){c[24](Q)}let zt={location:{bounds:c[1].bounds},options:{fitBoundsOptions:{padding:20}},style:Jg,$$slots:{default:[v1]},$$scope:{ctx:c}};c[6]!==void 0&&(zt.map=c[6]),Zo=new G0({props:zt}),eu.push(()=>Xg(Zo,"map",Dt));let Kt=c[1].parents[0]&&By(c);function ft(Q,Me){return Q[2].children[0]?x1:b1}let Ft=ft(c),Nt=Ft(c);return Yn=new Ws({props:{data:c[1]&&c[12](["cob","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),ho=new Ws({props:{data:c[1]&&c[12](["passport","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),ca=new Ws({props:{data:c[1]&&c[12](["natid","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Cr=new Ws({props:{data:c[1]&&c[12](["mainlang","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Jo=new Ws({props:{data:c[1]&&c[12](["irish","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),ma=new Ws({props:{data:c[1]&&c[12](["ulster","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Ea=new Ws({props:{data:c[1]&&c[12](["religion","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),mo=new Ws({props:{data:c[1]&&c[12](["religion_or_religion_brought_up_in","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),w=new Ws({props:{data:c[1]&&c[12](["ethnic","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),{c(){h=ce("div"),f=ce("div"),y=ce("span"),v=ce("a"),x=we("Home"),a=new qy(!1),I=He(),J.c(),R=He(),B=ce("br"),G=He(),j=ce("span"),de=we(H),Ce=He(),xe=ce("div"),Xe=we(`Click for :\r
		\r
			`),Ue=ce("button"),Bt=we("No comparison"),St=He(),ee&&ee.c(),ut=He(),We=ce("button"),tr=we("2011 Census comparison"),Xt=He(),xt=ce("div"),qt=ce("div"),Ge=ce("b"),Rt=we("Search for your Local Government District:"),yt=He(),Jr(gt.$$.fragment),Le=He(),Ne=ce("script"),Et=we(`// Share button\r
			// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
			\r
			\r
 				function copyToClipboard(text) {\r
					var inputc = document.body.appendChild(document.createElement("input"));\r
					inputc.value = window.location.href;\r
					inputc.select();\r
					document.execCommand('copy');\r
					inputc.parentNode.removeChild(inputc);\r
					alert("URL Copied.");\r
					\r
				}\r
\r
\r
\r
			\r
			\r
				(function (win, doc) {\r
					const testButton = doc.createElement('button');\r
					testButton.setAttribute('type','share');\r
					if (testButton.type != 'share') {\r
					win.addEventListener('click', function(ev) {\r
						ev = ev || win.event;\r
						let target = ev.target;\r
						let button = target.closest('button[type="share"]');\r
						if (button) {\r
						const title = "Share URL";\r
						const url = win.location.href;\r
						if (navigator.share) {\r
							navigator.share({ title: title, url: url });\r
						} else {\r
							copyToClipboard();\r
						}\r
						}\r
					});\r
				}\r
			}(this, this.document));`),mr=He(),Wt=ce("div"),qe=ce("button"),$e=we("Print / PDF"),lr=He(),gr=ce("button"),pi=we("Menu"),ii=He(),Zr=ce("button"),Gr=we("Share"),si=He(),kt=ce("div"),ur=ce("h2"),wt=we("Census 2021"),Ht=He(),It=ce("div"),ei=ce("div"),Or=ce("h3"),li=we("Overview"),_n=He(),$.c(),Si=He(),be.c(),tn=He(),wr=ce("div"),fi=ce("div"),Fi=ce("div"),Ni=we("Population  "),di=ce("span"),Xi=He(),vn=ce("div"),Xn=ce("div"),Bo=we("Population is based on the number of usual residents.  A usual resident is anyone who, on 21 March 2021 is in the UK, and staying in the UK for a period of 3 months or more; or has a permanent UK address and is outside the UK and is staying outside the UK for less than 12 months.      "),zn=ce("a"),Wn=ce("strong"),ia=we("Statistical bulletins"),So=He(),Pn=ce("span"),Eo=we(Cn),Oo=ce("br"),na=He(),Te&&Te.c(),Fo=He(),Ee&&Ee.c(),ao=He(),Kr=ce("div"),mi=ce("div"),rn=ce("div"),so=we("Households"),xr=ce("span"),F=He(),q=ce("div"),Y=ce("div"),re=we("A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area.      "),ue=ce("a"),ye=ce("strong"),Z=we("Statistical bulletins"),oe=He(),ve=ce("span"),Ze=we(Ve),Re=ce("br"),je=He(),Ae&&Ae.c(),ht=He(),Oe&&Oe.c(),st=He(),ze=ce("div"),tt=ce("div"),Ye=ce("div"),it=we("Broad age bands (years) "),Ut=ce("span"),er=He(),cr=ce("div"),Zt=ce("div"),or=we("A grouping of ages where a person\u2019s age is their age at their last birthday on or prior to census day.      "),Jt=ce("a"),ui=ce("strong"),fr=we("Statistical bulletins"),Fr=He(),nr=ce("div"),Jr(Gt.$$.fragment),ar=He(),Ke&&Ke.c(),Ei=He(),mt&&mt.c(),ko=He(),Nr=ce("div"),ni=ce("div"),_a=we("Sex"),No=He(),Jr(Sr.$$.fragment),Vo=He(),Xr=ce("div"),Er=ce("div"),yi=ce("div"),Pr=we("Household size"),Wi=ce("span"),Ps=He(),oi=ce("div"),Dn=ce("div"),Vi=we("The number of usual residents in the household.      "),ai=ce("a"),bn=ce("strong"),Ui=we("Statistical bulletins"),Uo=He(),Jr(jo.$$.fragment),Ys=He(),Ci=ce("div"),Na=ce("div"),qo=ce("h3"),kl=we("Explore "),oa=ce("span"),aa=we(ls),Cs=He(),Ln=ce("div"),Jr(Zo.$$.fragment),Rn=He(),lo=ce("div"),_e=ce("span"),Kt&&Kt.c(),nn=He(),Ti=ce("div"),Br=ce("span"),Bn=ce("ul"),Nt.c(),gi=He(),To=ce("div"),us=ce("h2"),Pu=we("Country of Birth and Nationality Statistics "),Ms=ce("span"),Qs=we(Ds),Tl=we(" - Census 2021"),$s=He(),Jn=ce("div"),sa=ce("div"),Go=ce("div"),Io=ce("div"),Ls=we("Country of birth"),cs=ce("span"),Il=He(),uo=ce("div"),co=ce("div"),Va=we("The country in which a person was born.  "),Ao=ce("a"),Ko=ce("strong"),Ua=we("Statistical bulletins"),ja=He(),Jr(Yn.$$.fragment),tu=He(),la=ce("div"),dr=ce("div"),qa=ce("div"),el=we("Passport(s) held"),hs=ce("span"),ru=He(),ps=ce("div"),zo=ce("div"),ba=we("Passport or passports that an individual holds.   "),Po=ce("a"),tl=ce("strong"),iu=we("Statistical bulletins"),Al=He(),Jr(ho.$$.fragment),nu=He(),On=ce("div"),fn=ce("div"),ua=ce("div"),Rs=we("National identity (person based)"),kr=ce("span"),Cu=He(),Xo=ce("div"),fs=ce("div"),Mu=we("The nationality or nationalities that the person identifies with.  "),ds=ce("a"),ms=ce("strong"),ys=we("Statistical bulletins"),Bs=He(),Jr(ca.$$.fragment),Za=He(),Ga=ce("div"),Wo=ce("h2"),Co=we("Language Statistics "),gs=ce("span"),zl=we(il),Ka=we(" - Census 2021"),_s=He(),xn=ce("div"),Ho=ce("div"),Qn=ce("div"),Xa=ce("div"),nl=we("Main language"),Wa=ce("span"),au=He(),xa=ce("div"),Ha=ce("div"),Pl=we("Person's main language as declared in the Census. Statistics for all language questions are restricted to persons aged 3 and over.    "),Ja=ce("a"),Ya=ce("strong"),su=we("Statistical bulletins"),Qa=He(),Jr(Cr.$$.fragment),ol=He(),Fn=ce("div"),on=ce("div"),Yt=ce("div"),Vr=we("Knowledge of Irish"),an=ce("span"),vs=He(),ha=ce("div"),Os=ce("div"),Du=we("A person has some ability in Irish if they can understand, speak, read or write Irish. Statistics for all language questions are restricted to persons aged 3 and over.  "),pa=ce("a"),$a=ce("strong"),fa=we("Statistical bulletins"),Ii=He(),Jr(Jo.$$.fragment),lu=He(),Ur=ce("div"),at=ce("div"),Mi=ce("div"),al=we("Knowledge of Ulster-Scots"),Yo=ce("span"),Nn=He(),es=ce("div"),rt=ce("div"),Ml=we("A person has some ability in Ulster-Scots if they can understand, speak, read or write Ulster-Scots. Statistics for all language questions are restricted to persons aged 3 and over.  "),wa=ce("a"),Fs=ce("strong"),po=we("Statistical bulletins"),Vn=He(),Jr(ma.$$.fragment),wn=He(),Un=ce("div"),bs=ce("h2"),Ns=we("Religion and Ethnicity Statistics "),ts=ce("span"),fo=we(Vs),$n=we(" - Census 2021"),rr=He(),Ai=ce("div"),ji=ce("div"),ti=ce("div"),eo=ce("div"),Sa=we("Religion"),Sn=ce("span"),Us=He(),vt=ce("div"),dt=ce("div"),sl=we("Religion, religious denomination or body the person indicated they belong to.    "),Di=ce("a"),to=ce("strong"),Hi=we("Statistical bulletins"),Qo=He(),Jr(Ea.$$.fragment),ll=He(),hr=ce("div"),Wr=ce("div"),ka=ce("div"),rs=we("Religion, Religion brought up"),is=ce("span"),qn=He(),$o=ce("div"),Zn=ce("div"),ul=we("The religious group the person belongs to or for people with no current religion their religious group of upbringing. People with no current religion and no religion of upbringing are labelled 'None'.    "),ea=ce("a"),os=ce("strong"),Ll=we("Statistical bulletins"),xs=He(),Jr(mo.$$.fragment),Rl=He(),En=ce("div"),sn=ce("div"),ta=ce("div"),Ta=we("Ethnic group"),dn=ce("span"),js=He(),as=ce("div"),Ia=ce("div"),n=we("Person\u2019s ethnic group as declared in the Census.  "),s=ce("a"),o=ce("strong"),u=we("Statistical bulletins"),m=He(),Jr(w.$$.fragment),this.h()},l(Q){h=he(Q,"DIV",{class:!0});var Me=fe(h);f=he(Me,"DIV",{});var Vt=fe(f);y=he(Vt,"SPAN",{class:!0});var At=fe(y);v=he(At,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var Pt=fe(v);x=Se(Pt,"Home"),Pt.forEach(O),a=Zy(At,!1),I=Je(At),J.l(At),R=Je(At),At.forEach(O),B=he(Vt,"BR",{}),G=Je(Vt),j=he(Vt,"SPAN",{class:!0});var ci=fe(j);de=Se(ci,H),ci.forEach(O),Ce=Je(Vt),xe=he(Vt,"DIV",{class:!0,style:!0});var Tr=fe(xe);Xe=Se(Tr,`Click for :\r
		\r
			`),Ue=he(Tr,"BUTTON",{class:!0});var zi=fe(Ue);Bt=Se(zi,"No comparison"),zi.forEach(O),St=Je(Tr),ee&&ee.l(Tr),ut=Je(Tr),We=he(Tr,"BUTTON",{class:!0});var _i=fe(We);tr=Se(_i,"2011 Census comparison"),_i.forEach(O),Tr.forEach(O),Vt.forEach(O),Xt=Je(Me),xt=he(Me,"DIV",{});var jr=fe(xt);qt=he(jr,"DIV",{style:!0,class:!0});var Ir=fe(qt);Ge=he(Ir,"B",{});var Ji=fe(Ge);Rt=Se(Ji,"Search for your Local Government District:"),Ji.forEach(O),yt=Je(Ir),Yr(gt.$$.fragment,Ir),Le=Je(Ir),Ne=he(Ir,"SCRIPT",{});var Li=fe(Ne);Et=Se(Li,`// Share button\r
			// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
			\r
			\r
 				function copyToClipboard(text) {\r
					var inputc = document.body.appendChild(document.createElement("input"));\r
					inputc.value = window.location.href;\r
					inputc.select();\r
					document.execCommand('copy');\r
					inputc.parentNode.removeChild(inputc);\r
					alert("URL Copied.");\r
					\r
				}\r
\r
\r
\r
			\r
			\r
				(function (win, doc) {\r
					const testButton = doc.createElement('button');\r
					testButton.setAttribute('type','share');\r
					if (testButton.type != 'share') {\r
					win.addEventListener('click', function(ev) {\r
						ev = ev || win.event;\r
						let target = ev.target;\r
						let button = target.closest('button[type="share"]');\r
						if (button) {\r
						const title = "Share URL";\r
						const url = win.location.href;\r
						if (navigator.share) {\r
							navigator.share({ title: title, url: url });\r
						} else {\r
							copyToClipboard();\r
						}\r
						}\r
					});\r
				}\r
			}(this, this.document));`),Li.forEach(O),mr=Je(Ir),Wt=he(Ir,"DIV",{width:!0});var mn=fe(Wt);qe=he(mn,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var qi=fe(qe);$e=Se(qi,"Print / PDF"),qi.forEach(O),lr=Je(mn),gr=he(mn,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var kn=fe(gr);pi=Se(kn,"Menu"),kn.forEach(O),ii=Je(mn),Zr=he(mn,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var Mo=fe(Zr);Gr=Se(Mo,"Share"),Mo.forEach(O),mn.forEach(O),Ir.forEach(O),jr.forEach(O),Me.forEach(O),si=Je(Q),kt=he(Q,"DIV",{});var cl=fe(kt);ur=he(cl,"H2",{style:!0,class:!0});var qs=fe(ur);wt=Se(qs,"Census 2021"),qs.forEach(O),cl.forEach(O),Ht=Je(Q),It=he(Q,"DIV",{id:!0,class:!0});var ln=fe(It);ei=he(ln,"DIV",{class:!0,style:!0});var ya=fe(ei);Or=he(ya,"H3",{style:!0,class:!0});var hl=fe(Or);li=Se(hl,"Overview"),hl.forEach(O),_n=Je(ya),$.l(ya),Si=Je(ya),be.l(ya),ya.forEach(O),tn=Je(ln),wr=he(ln,"DIV",{class:!0});var Yi=fe(wr);fi=he(Yi,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var pl=fe(fi);Fi=he(pl,"DIV",{class:!0,style:!0});var ra=fe(Fi);Ni=Se(ra,"Population  "),di=he(ra,"SPAN",{style:!0});var Qi=fe(di);Qi.forEach(O),ra.forEach(O),pl.forEach(O),Xi=Je(Yi),vn=he(Yi,"DIV",{class:!0,id:!0});var Aa=fe(vn);Xn=he(Aa,"DIV",{class:!0});var za=fe(Xn);Bo=Se(za,"Population is based on the number of usual residents.  A usual resident is anyone who, on 21 March 2021 is in the UK, and staying in the UK for a period of 3 months or more; or has a permanent UK address and is outside the UK and is staying outside the UK for less than 12 months.      "),zn=he(za,"A",{href:!0,class:!0});var ws=fe(zn);Wn=he(ws,"STRONG",{});var vr=fe(Wn);ia=Se(vr,"Statistical bulletins"),vr.forEach(O),ws.forEach(O),za.forEach(O),Aa.forEach(O),So=Je(Yi),Pn=he(Yi,"SPAN",{class:!0,style:!0});var yo=fe(Pn);Eo=Se(yo,Cn),yo.forEach(O),Oo=he(Yi,"BR",{}),na=Je(Yi),Te&&Te.l(Yi),Fo=Je(Yi),Ee&&Ee.l(Yi),Yi.forEach(O),ao=Je(ln),Kr=he(ln,"DIV",{class:!0});var vi=fe(Kr);mi=he(vi,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Ss=fe(mi);rn=he(Ss,"DIV",{class:!0,style:!0});var Ru=fe(rn);so=Se(Ru,"Households"),xr=he(Ru,"SPAN",{style:!0});var uu=fe(xr);uu.forEach(O),Ru.forEach(O),Ss.forEach(O),F=Je(vi),q=he(vi,"DIV",{class:!0,id:!0});var nc=fe(q);Y=he(nc,"DIV",{class:!0});var Zs=fe(Y);re=Se(Zs,"A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area.      "),ue=he(Zs,"A",{href:!0,class:!0});var Bu=fe(ue);ye=he(Bu,"STRONG",{});var Gs=fe(ye);Z=Se(Gs,"Statistical bulletins"),Gs.forEach(O),Bu.forEach(O),Zs.forEach(O),nc.forEach(O),oe=Je(vi),ve=he(vi,"SPAN",{class:!0,style:!0});var Bl=fe(ve);Ze=Se(Bl,Ve),Bl.forEach(O),Re=he(vi,"BR",{}),je=Je(vi),Ae&&Ae.l(vi),ht=Je(vi),Oe&&Oe.l(vi),vi.forEach(O),st=Je(ln),ze=he(ln,"DIV",{class:!0});var Pa=fe(ze);tt=he(Pa,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var fl=fe(tt);Ye=he(fl,"DIV",{class:!0,style:!0});var Gn=fe(Ye);it=Se(Gn,"Broad age bands (years) "),Ut=he(Gn,"SPAN",{style:!0});var vf=fe(Ut);vf.forEach(O),Gn.forEach(O),fl.forEach(O),er=Je(Pa),cr=he(Pa,"DIV",{class:!0,id:!0});var qc=fe(cr);Zt=he(qc,"DIV",{class:!0});var Zc=fe(Zt);or=Se(Zc,"A grouping of ages where a person\u2019s age is their age at their last birthday on or prior to census day.      "),Jt=he(Zc,"A",{href:!0,class:!0});var qh=fe(Jt);ui=he(qh,"STRONG",{});var Zh=fe(ui);fr=Se(Zh,"Statistical bulletins"),Zh.forEach(O),qh.forEach(O),Zc.forEach(O),qc.forEach(O),Fr=Je(Pa),nr=he(Pa,"DIV",{class:!0,style:!0});var Gh=fe(nr);Yr(Gt.$$.fragment,Gh),Gh.forEach(O),ar=Je(Pa),Ke&&Ke.l(Pa),Ei=Je(Pa),mt&&mt.l(Pa),Pa.forEach(O),ko=Je(ln),Nr=he(ln,"DIV",{class:!0});var cu=fe(Nr);ni=he(cu,"DIV",{class:!0,style:!0});var Kh=fe(ni);_a=Se(Kh,"Sex"),Kh.forEach(O),No=Je(cu),Yr(Sr.$$.fragment,cu),cu.forEach(O),Vo=Je(ln),Xr=he(ln,"DIV",{class:!0});var Ks=fe(Xr);Er=he(Ks,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Gc=fe(Er);yi=he(Gc,"DIV",{class:!0,style:!0});var Es=fe(yi);Pr=Se(Es,"Household size"),Wi=he(Es,"SPAN",{style:!0});var Ou=fe(Wi);Ou.forEach(O),Es.forEach(O),Gc.forEach(O),Ps=Je(Ks),oi=he(Ks,"DIV",{class:!0,id:!0});var Xh=fe(oi);Dn=he(Xh,"DIV",{class:!0});var Kc=fe(Dn);Vi=Se(Kc,"The number of usual residents in the household.      "),ai=he(Kc,"A",{href:!0,class:!0});var Wh=fe(ai);bn=he(Wh,"STRONG",{});var Hh=fe(bn);Ui=Se(Hh,"Statistical bulletins"),Hh.forEach(O),Wh.forEach(O),Kc.forEach(O),Xh.forEach(O),Uo=Je(Ks),Yr(jo.$$.fragment,Ks),Ks.forEach(O),ln.forEach(O),Ys=Je(Q),Ci=he(Q,"DIV",{class:!0});var dl=fe(Ci);Na=he(dl,"DIV",{style:!0});var Jh=fe(Na);qo=he(Jh,"H3",{class:!0});var Xc=fe(qo);kl=Se(Xc,"Explore "),oa=he(Xc,"SPAN",{style:!0});var oc=fe(oa);aa=Se(oc,ls),oc.forEach(O),Xc.forEach(O),Jh.forEach(O),Cs=Je(dl),Ln=he(dl,"DIV",{id:!0,style:!0,class:!0});var Yh=fe(Ln);Yr(Zo.$$.fragment,Yh),Yh.forEach(O),Rn=Je(dl),lo=he(dl,"DIV",{});var Ol=fe(lo);_e=he(Ol,"SPAN",{});var Qh=fe(_e);Kt&&Kt.l(Qh),Qh.forEach(O),Ol.forEach(O),nn=Je(dl),Ti=he(dl,"DIV",{});var Ri=fe(Ti);Br=he(Ri,"SPAN",{});var Fu=fe(Br);Bn=he(Fu,"UL",{style:!0});var Wc=fe(Bn);Nt.l(Wc),Wc.forEach(O),Fu.forEach(O),Ri.forEach(O),dl.forEach(O),gi=Je(Q),To=he(Q,"DIV",{style:!0});var Nu=fe(To);us=he(Nu,"H2",{class:!0});var hu=fe(us);Pu=Se(hu,"Country of Birth and Nationality Statistics "),Ms=he(hu,"SPAN",{class:!0});var Fl=fe(Ms);Qs=Se(Fl,Ds),Tl=Se(Fl," - Census 2021"),Fl.forEach(O),hu.forEach(O),Nu.forEach(O),$s=Je(Q),Jn=he(Q,"DIV",{class:!0});var Nl=fe(Jn);sa=he(Nl,"DIV",{class:!0});var Vl=fe(sa);Go=he(Vl,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var pu=fe(Go);Io=he(pu,"DIV",{class:!0,style:!0});var Vu=fe(Io);Ls=Se(Vu,"Country of birth"),cs=he(Vu,"SPAN",{style:!0});var Hc=fe(cs);Hc.forEach(O),Vu.forEach(O),pu.forEach(O),Il=Je(Vl),uo=he(Vl,"DIV",{class:!0,id:!0});var $h=fe(uo);co=he($h,"DIV",{class:!0});var Ul=fe(co);Va=Se(Ul,"The country in which a person was born.  "),Ao=he(Ul,"A",{href:!0,class:!0});var ep=fe(Ao);Ko=he(ep,"STRONG",{});var ac=fe(Ko);Ua=Se(ac,"Statistical bulletins"),ac.forEach(O),ep.forEach(O),Ul.forEach(O),$h.forEach(O),ja=Je(Vl),Yr(Yn.$$.fragment,Vl),Vl.forEach(O),tu=Je(Nl),la=he(Nl,"DIV",{class:!0});var fu=fe(la);dr=he(fu,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var sc=fe(dr);qa=he(sc,"DIV",{class:!0,style:!0});var Uu=fe(qa);el=Se(Uu,"Passport(s) held"),hs=he(Uu,"SPAN",{style:!0});var ss=fe(hs);ss.forEach(O),Uu.forEach(O),sc.forEach(O),ru=Je(fu),ps=he(fu,"DIV",{class:!0,id:!0});var tp=fe(ps);zo=he(tp,"DIV",{class:!0});var Jc=fe(zo);ba=Se(Jc,"Passport or passports that an individual holds.   "),Po=he(Jc,"A",{href:!0,class:!0});var rp=fe(Po);tl=he(rp,"STRONG",{});var ip=fe(tl);iu=Se(ip,"Statistical bulletins"),ip.forEach(O),rp.forEach(O),Jc.forEach(O),tp.forEach(O),Al=Je(fu),Yr(ho.$$.fragment,fu),fu.forEach(O),nu=Je(Nl),On=he(Nl,"DIV",{class:!0});var jl=fe(On);fn=he(jl,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ql=fe(fn);ua=he(ql,"DIV",{class:!0,style:!0});var Yc=fe(ua);Rs=Se(Yc,"National identity (person based)"),kr=he(Yc,"SPAN",{style:!0});var bf=fe(kr);bf.forEach(O),Yc.forEach(O),ql.forEach(O),Cu=Je(jl),Xo=he(jl,"DIV",{class:!0,id:!0});var Qc=fe(Xo);fs=he(Qc,"DIV",{class:!0});var lc=fe(fs);Mu=Se(lc,"The nationality or nationalities that the person identifies with.  "),ds=he(lc,"A",{href:!0,class:!0});var np=fe(ds);ms=he(np,"STRONG",{});var op=fe(ms);ys=Se(op,"Statistical bulletins"),op.forEach(O),np.forEach(O),lc.forEach(O),Qc.forEach(O),Bs=Je(jl),Yr(ca.$$.fragment,jl),jl.forEach(O),Nl.forEach(O),Za=Je(Q),Ga=he(Q,"DIV",{style:!0});var Zl=fe(Ga);Wo=he(Zl,"H2",{class:!0});var $c=fe(Wo);Co=Se($c,"Language Statistics "),gs=he($c,"SPAN",{class:!0});var ju=fe(gs);zl=Se(ju,il),Ka=Se(ju," - Census 2021"),ju.forEach(O),$c.forEach(O),Zl.forEach(O),_s=Je(Q),xn=he(Q,"DIV",{class:!0});var ks=fe(xn);Ho=he(ks,"DIV",{class:!0});var go=fe(Ho);Qn=he(go,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ap=fe(Qn);Xa=he(ap,"DIV",{class:!0,style:!0});var eh=fe(Xa);nl=Se(eh,"Main language"),Wa=he(eh,"SPAN",{style:!0});var xf=fe(Wa);xf.forEach(O),eh.forEach(O),ap.forEach(O),au=Je(go),xa=he(go,"DIV",{class:!0,id:!0});var du=fe(xa);Ha=he(du,"DIV",{class:!0});var uc=fe(Ha);Pl=Se(uc,"Person's main language as declared in the Census. Statistics for all language questions are restricted to persons aged 3 and over.    "),Ja=he(uc,"A",{href:!0,class:!0});var sp=fe(Ja);Ya=he(sp,"STRONG",{});var lp=fe(Ya);su=Se(lp,"Statistical bulletins"),lp.forEach(O),sp.forEach(O),uc.forEach(O),du.forEach(O),Qa=Je(go),Yr(Cr.$$.fragment,go),go.forEach(O),ol=Je(ks),Fn=he(ks,"DIV",{class:!0});var mu=fe(Fn);on=he(mu,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var up=fe(on);Yt=he(up,"DIV",{class:!0,style:!0});var cc=fe(Yt);Vr=Se(cc,"Knowledge of Irish"),an=he(cc,"SPAN",{style:!0});var ro=fe(an);ro.forEach(O),cc.forEach(O),up.forEach(O),vs=Je(mu),ha=he(mu,"DIV",{class:!0,id:!0});var cp=fe(ha);Os=he(cp,"DIV",{class:!0});var hc=fe(Os);Du=Se(hc,"A person has some ability in Irish if they can understand, speak, read or write Irish. Statistics for all language questions are restricted to persons aged 3 and over.  "),pa=he(hc,"A",{href:!0,class:!0});var th=fe(pa);$a=he(th,"STRONG",{});var hp=fe($a);fa=Se(hp,"Statistical bulletins"),hp.forEach(O),th.forEach(O),hc.forEach(O),cp.forEach(O),Ii=Je(mu),Yr(Jo.$$.fragment,mu),mu.forEach(O),lu=Je(ks),Ur=he(ks,"DIV",{class:!0});var Gl=fe(Ur);at=he(Gl,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var pp=fe(at);Mi=he(pp,"DIV",{class:!0,style:!0});var rh=fe(Mi);al=Se(rh,"Knowledge of Ulster-Scots"),Yo=he(rh,"SPAN",{style:!0});var wf=fe(Yo);wf.forEach(O),rh.forEach(O),pp.forEach(O),Nn=Je(Gl),es=he(Gl,"DIV",{class:!0,id:!0});var ih=fe(es);rt=he(ih,"DIV",{class:!0});var nh=fe(rt);Ml=Se(nh,"A person has some ability in Ulster-Scots if they can understand, speak, read or write Ulster-Scots. Statistics for all language questions are restricted to persons aged 3 and over.  "),wa=he(nh,"A",{href:!0,class:!0});var fp=fe(wa);Fs=he(fp,"STRONG",{});var yu=fe(Fs);po=Se(yu,"Statistical bulletins"),yu.forEach(O),fp.forEach(O),nh.forEach(O),ih.forEach(O),Vn=Je(Gl),Yr(ma.$$.fragment,Gl),Gl.forEach(O),ks.forEach(O),wn=Je(Q),Un=he(Q,"DIV",{style:!0});var oh=fe(Un);bs=he(oh,"H2",{class:!0});var pc=fe(bs);Ns=Se(pc,"Religion and Ethnicity Statistics "),ts=he(pc,"SPAN",{class:!0});var gu=fe(ts);fo=Se(gu,Vs),$n=Se(gu," - Census 2021"),gu.forEach(O),pc.forEach(O),oh.forEach(O),rr=Je(Q),Ai=he(Q,"DIV",{class:!0});var Mr=fe(Ai);ji=he(Mr,"DIV",{class:!0});var Kl=fe(ji);ti=he(Kl,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Ts=fe(ti);eo=he(Ts,"DIV",{class:!0,style:!0});var ml=fe(eo);Sa=Se(ml,"Religion"),Sn=he(ml,"SPAN",{style:!0});var dp=fe(Sn);dp.forEach(O),ml.forEach(O),Ts.forEach(O),Us=Je(Kl),vt=he(Kl,"DIV",{class:!0,id:!0});var mp=fe(vt);dt=he(mp,"DIV",{class:!0});var ah=fe(dt);sl=Se(ah,"Religion, religious denomination or body the person indicated they belong to.    "),Di=he(ah,"A",{href:!0,class:!0});var yp=fe(Di);to=he(yp,"STRONG",{});var gp=fe(to);Hi=Se(gp,"Statistical bulletins"),gp.forEach(O),yp.forEach(O),ah.forEach(O),mp.forEach(O),Qo=Je(Kl),Yr(Ea.$$.fragment,Kl),Kl.forEach(O),ll=Je(Mr),hr=he(Mr,"DIV",{class:!0});var _u=fe(hr);Wr=he(_u,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var _p=fe(Wr);ka=he(_p,"DIV",{class:!0,style:!0});var sh=fe(ka);rs=Se(sh,"Religion, Religion brought up"),is=he(sh,"SPAN",{style:!0});var Sf=fe(is);Sf.forEach(O),sh.forEach(O),_p.forEach(O),qn=Je(_u),$o=he(_u,"DIV",{class:!0,id:!0});var vp=fe($o);Zn=he(vp,"DIV",{class:!0});var vu=fe(Zn);ul=Se(vu,"The religious group the person belongs to or for people with no current religion their religious group of upbringing. People with no current religion and no religion of upbringing are labelled 'None'.    "),ea=he(vu,"A",{href:!0,class:!0});var Xl=fe(ea);os=he(Xl,"STRONG",{});var lh=fe(os);Ll=Se(lh,"Statistical bulletins"),lh.forEach(O),Xl.forEach(O),vu.forEach(O),vp.forEach(O),xs=Je(_u),Yr(mo.$$.fragment,_u),_u.forEach(O),Rl=Je(Mr),En=he(Mr,"DIV",{class:!0});var bu=fe(En);sn=he(bu,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var bp=fe(sn);ta=he(bp,"DIV",{class:!0,style:!0});var uh=fe(ta);Ta=Se(uh,"Ethnic group"),dn=he(uh,"SPAN",{style:!0});var xp=fe(dn);xp.forEach(O),uh.forEach(O),bp.forEach(O),js=Je(bu),as=he(bu,"DIV",{class:!0,id:!0});var qu=fe(as);Ia=he(qu,"DIV",{class:!0});var Wl=fe(Ia);n=Se(Wl,"Person\u2019s ethnic group as declared in the Census.  "),s=he(Wl,"A",{href:!0,class:!0});var xu=fe(s);o=he(xu,"STRONG",{});var Do=fe(o);u=Se(Do,"Statistical bulletins"),Do.forEach(O),xu.forEach(O),Wl.forEach(O),qu.forEach(O),m=Je(bu),Yr(w.$$.fragment,bu),bu.forEach(O),Mr.forEach(O),this.h()},h(){U(v,"href",El+"/"),U(v,"sveltekit:noscroll",""),U(v,"class","svelte-ls2yfr"),a.a=I,U(y,"class","text-small"),U(j,"class","text-big title svelte-ls2yfr"),U(Ue,"class","btn svelte-ls2yfr"),en(Ue,"btn-active",c[9]),U(We,"class","btn svelte-ls2yfr"),en(We,"btn-active",c[4]&!c[9]&!c[10]),U(xe,"class","text-bold"),De(xe,"font-size","0.85em"),U(qe,"class","btn svelte-ls2yfr"),De(qe,"width","33%"),U(qe,"title","Click to print this page to pdf or printer"),U(qe,"onclick","window.print();return false;"),U(gr,"class","btn svelte-ls2yfr"),De(gr,"width","33%"),U(gr,"alt","Return to the landing page"),U(gr,"onclick","window.location.href='"+El+"';"),U(Zr,"class","btn svelte-ls2yfr"),De(Zr,"width","30%"),U(Zr,"type","share"),U(Zr,"alt","Share this page"),U(Wt,"width","100%"),De(qt,"width","350px"),De(qt,"padding-top","5px"),U(qt,"class","svelte-ls2yfr"),en(qt,"float-right",c[5]>1),U(h,"class","grid mtl svelte-ls2yfr"),De(ur,"page-break-before","avoid"),U(ur,"class","svelte-ls2yfr"),De(Or,"margin","0 0 10px 0"),De(Or,"line-height","1.78"),U(Or,"class","svelte-ls2yfr"),U(ei,"class","div-grey-box svelte-ls2yfr"),De(ei,"line-height","1.3"),De(di,"color","gray"),De(di,"font-size","14pt"),U(Fi,"class","blocktitle svelte-ls2yfr"),De(Fi,"margin","0"),De(Fi,"width","100%"),U(fi,"class","row"),De(fi,"display","flex"),De(fi,"cursor","pointer"),U(fi,"data-bs-toggle","collapse"),U(fi,"data-bs-target","#pop-info"),U(fi,"aria-expanded","false"),U(fi,"aria-controls","pop-info"),U(zn,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(zn,"class","svelte-ls2yfr"),U(Xn,"class","card card-body svelte-ls2yfr"),U(vn,"class","collapse svelte-ls2yfr"),U(vn,"id","pop-info"),U(Pn,"class","text-big"),De(Pn,"font-size","2.8em"),U(wr,"class","div-grey-box svelte-ls2yfr"),De(xr,"color","gray"),De(xr,"font-size","14pt"),U(rn,"class","blocktitle svelte-ls2yfr"),De(rn,"margin","0"),De(rn,"width","100%"),U(mi,"class","row"),De(mi,"display","flex"),De(mi,"cursor","pointer"),U(mi,"data-bs-toggle","collapse"),U(mi,"data-bs-target","#households-info"),U(mi,"aria-expanded","false"),U(mi,"aria-controls","households-info"),U(ue,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(ue,"class","svelte-ls2yfr"),U(Y,"class","card card-body svelte-ls2yfr"),U(q,"class","collapse svelte-ls2yfr"),U(q,"id","households-info"),U(ve,"class","text-big"),De(ve,"font-size","2.8em"),U(Kr,"class","div-grey-box svelte-ls2yfr"),De(Ut,"color","gray"),De(Ut,"font-size","14pt"),U(Ye,"class","blocktitle svelte-ls2yfr"),De(Ye,"margin","0"),De(Ye,"width","100%"),U(tt,"class","row"),De(tt,"display","flex"),De(tt,"cursor","pointer"),U(tt,"data-bs-toggle","collapse"),U(tt,"data-bs-target","#broadagebands-info"),U(tt,"aria-expanded","false"),U(tt,"aria-controls","broadagebands-info"),U(Jt,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Jt,"class","svelte-ls2yfr"),U(Zt,"class","card card-body svelte-ls2yfr"),U(cr,"class","collapse svelte-ls2yfr"),U(cr,"id","broadagebands-info"),U(nr,"class","chart svelte-ls2yfr"),De(nr,"height","100px"),De(nr,"padding-bottom","5px"),U(ze,"class","div-grey-box svelte-ls2yfr"),U(ni,"class","blocktitle svelte-ls2yfr"),De(ni,"margin","0"),De(ni,"width","100%"),U(Nr,"class","div-grey-box svelte-ls2yfr"),De(Wi,"color","gray"),De(Wi,"font-size","14pt"),U(yi,"class","blocktitle svelte-ls2yfr"),De(yi,"margin","0"),De(yi,"width","100%"),U(Er,"class","row"),De(Er,"display","flex"),De(Er,"cursor","pointer"),U(Er,"data-bs-toggle","collapse"),U(Er,"data-bs-target","#hhsize-info"),U(Er,"aria-expanded","false"),U(Er,"aria-controls","hhsize-info"),U(ai,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(ai,"class","svelte-ls2yfr"),U(Dn,"class","card card-body svelte-ls2yfr"),U(oi,"class","collapse svelte-ls2yfr"),U(oi,"id","hhsize-info"),U(Xr,"class","div-grey-box svelte-ls2yfr"),U(It,"id","grid"),U(It,"class","grid mt svelte-ls2yfr"),De(oa,"color","#93328E"),U(qo,"class","svelte-ls2yfr"),De(Na,"grid-column","span "+c[5]),U(Ln,"id","map"),De(Ln,"padding-right","45px"),De(Ln,"grid-column","span "+(c[5]==2?2:c[5]&&c[5]>2?c[5]-1:1)),U(Ln,"class","svelte-ls2yfr"),De(Bn,"padding-left","0"),U(Ci,"class","grid mt svelte-ls2yfr"),Lc(()=>c[25].call(Ci)),U(Ms,"class","title-inset muted svelte-ls2yfr"),U(us,"class","svelte-ls2yfr"),De(To,"grid-column","span "+c[5]),De(cs,"color","gray"),De(cs,"font-size","14pt"),U(Io,"class","blocktitle svelte-ls2yfr"),De(Io,"margin","0"),De(Io,"width","100%"),U(Go,"class","row"),De(Go,"display","flex"),De(Go,"cursor","pointer"),U(Go,"data-bs-toggle","collapse"),U(Go,"data-bs-target","#cob-info"),U(Go,"aria-expanded","false"),U(Go,"aria-controls","cob-info"),U(Ao,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Ao,"class","svelte-ls2yfr"),U(co,"class","card card-body svelte-ls2yfr"),U(uo,"class","collapse svelte-ls2yfr"),U(uo,"id","cob-info"),U(sa,"class","div-grey-box svelte-ls2yfr"),De(hs,"color","gray"),De(hs,"font-size","14pt"),U(qa,"class","blocktitle svelte-ls2yfr"),De(qa,"margin","0"),De(qa,"width","100%"),U(dr,"class","row"),De(dr,"display","flex"),De(dr,"cursor","pointer"),U(dr,"data-bs-toggle","collapse"),U(dr,"data-bs-target","#passport-info"),U(dr,"aria-expanded","false"),U(dr,"aria-controls","passport-info"),U(Po,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Po,"class","svelte-ls2yfr"),U(zo,"class","card card-body svelte-ls2yfr"),U(ps,"class","collapse svelte-ls2yfr"),U(ps,"id","passport-info"),U(la,"class","div-grey-box svelte-ls2yfr"),De(kr,"color","gray"),De(kr,"font-size","14pt"),U(ua,"class","blocktitle svelte-ls2yfr"),De(ua,"font-size","1.02em"),De(ua,"margin","0"),De(ua,"width","100%"),U(fn,"class","row"),De(fn,"display","flex"),De(fn,"cursor","pointer"),U(fn,"data-bs-toggle","collapse"),U(fn,"data-bs-target","#natid-info"),U(fn,"aria-expanded","false"),U(fn,"aria-controls","natid-info"),U(ds,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(ds,"class","svelte-ls2yfr"),U(fs,"class","card card-body svelte-ls2yfr"),U(Xo,"class","collapse svelte-ls2yfr"),U(Xo,"id","natid-info"),U(On,"class","div-grey-box svelte-ls2yfr"),U(Jn,"class","grid mt svelte-ls2yfr"),Lc(()=>c[26].call(Jn)),U(gs,"class","title-inset muted svelte-ls2yfr"),U(Wo,"class","svelte-ls2yfr"),De(Ga,"grid-column","span "+c[5]),De(Wa,"color","gray"),De(Wa,"font-size","14pt"),U(Xa,"class","blocktitle svelte-ls2yfr"),De(Xa,"margin","0"),De(Xa,"width","100%"),U(Qn,"class","row"),De(Qn,"display","flex"),De(Qn,"cursor","pointer"),U(Qn,"data-bs-toggle","collapse"),U(Qn,"data-bs-target","#mainlang-info"),U(Qn,"aria-expanded","false"),U(Qn,"aria-controls","mainlang-info"),U(Ja,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Ja,"class","svelte-ls2yfr"),U(Ha,"class","card card-body svelte-ls2yfr"),U(xa,"class","collapse svelte-ls2yfr"),U(xa,"id","mainlang-info"),U(Ho,"class","div-grey-box svelte-ls2yfr"),De(an,"color","gray"),De(an,"font-size","14pt"),U(Yt,"class","blocktitle svelte-ls2yfr"),De(Yt,"margin","0"),De(Yt,"width","100%"),U(on,"class","row"),De(on,"display","flex"),De(on,"cursor","pointer"),U(on,"data-bs-toggle","collapse"),U(on,"data-bs-target","#irish-info"),U(on,"aria-expanded","false"),U(on,"aria-controls","irish-info"),U(pa,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(pa,"class","svelte-ls2yfr"),U(Os,"class","card card-body svelte-ls2yfr"),U(ha,"class","collapse svelte-ls2yfr"),U(ha,"id","irish-info"),U(Fn,"class","div-grey-box svelte-ls2yfr"),De(Yo,"color","gray"),De(Yo,"font-size","14pt"),U(Mi,"class","blocktitle svelte-ls2yfr"),De(Mi,"margin","0"),De(Mi,"width","100%"),U(at,"class","row"),De(at,"display","flex"),De(at,"cursor","pointer"),U(at,"data-bs-toggle","collapse"),U(at,"data-bs-target","#ulster-info"),U(at,"aria-expanded","false"),U(at,"aria-controls","ulster-info"),U(wa,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(wa,"class","svelte-ls2yfr"),U(rt,"class","card card-body svelte-ls2yfr"),U(es,"class","collapse svelte-ls2yfr"),U(es,"id","ulster-info"),U(Ur,"class","div-grey-box svelte-ls2yfr"),U(xn,"class","grid mt svelte-ls2yfr"),Lc(()=>c[27].call(xn)),U(ts,"class","title-inset muted svelte-ls2yfr"),U(bs,"class","svelte-ls2yfr"),De(Un,"grid-column","span "+c[5]),De(Sn,"color","gray"),De(Sn,"font-size","14pt"),U(eo,"class","blocktitle svelte-ls2yfr"),De(eo,"margin","0"),De(eo,"width","100%"),U(ti,"class","row"),De(ti,"display","flex"),De(ti,"cursor","pointer"),U(ti,"data-bs-toggle","collapse"),U(ti,"data-bs-target","#rel-info"),U(ti,"aria-expanded","false"),U(ti,"aria-controls","rel-info"),U(Di,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Di,"class","svelte-ls2yfr"),U(dt,"class","card card-body svelte-ls2yfr"),U(vt,"class","collapse svelte-ls2yfr"),U(vt,"id","rel-info"),U(ji,"class","div-grey-box svelte-ls2yfr"),De(is,"color","gray"),De(is,"font-size","14pt"),U(ka,"class","blocktitle svelte-ls2yfr"),De(ka,"margin","0"),De(ka,"width","100%"),U(Wr,"class","row"),De(Wr,"display","flex"),De(Wr,"cursor","pointer"),U(Wr,"data-bs-toggle","collapse"),U(Wr,"data-bs-target","#relbup-info"),U(Wr,"aria-expanded","false"),U(Wr,"aria-controls","relbup-info"),U(ea,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(ea,"class","svelte-ls2yfr"),U(Zn,"class","card card-body svelte-ls2yfr"),U($o,"class","collapse svelte-ls2yfr"),U($o,"id","relbup-info"),U(hr,"class","div-grey-box svelte-ls2yfr"),De(dn,"color","gray"),De(dn,"font-size","14pt"),U(ta,"class","blocktitle svelte-ls2yfr"),De(ta,"margin","0"),De(ta,"width","100%"),U(sn,"class","row"),De(sn,"display","flex"),De(sn,"cursor","pointer"),U(sn,"data-bs-toggle","collapse"),U(sn,"data-bs-target","#ethnic-info"),U(sn,"aria-expanded","false"),U(sn,"aria-controls","ethnic-info"),U(s,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(s,"class","svelte-ls2yfr"),U(Ia,"class","card card-body svelte-ls2yfr"),U(as,"class","collapse svelte-ls2yfr"),U(as,"id","ethnic-info"),U(En,"class","div-grey-box svelte-ls2yfr"),U(Ai,"class","grid mt svelte-ls2yfr"),Lc(()=>c[28].call(Ai))},m(Q,Me){Ie(Q,h,Me),V(h,f),V(f,y),V(y,v),V(v,x),a.m(A,y),V(y,I),J.m(y,null),V(y,R),V(f,B),V(f,G),V(f,j),V(j,de),V(f,Ce),V(f,xe),V(xe,Xe),V(xe,Ue),V(Ue,Bt),V(xe,St),ee&&ee.m(xe,null),V(xe,ut),V(xe,We),V(We,tr),V(h,Xt),V(h,xt),V(xt,qt),V(qt,Ge),V(Ge,Rt),V(qt,yt),Qr(gt,qt,null),V(qt,Le),V(qt,Ne),V(Ne,Et),V(qt,mr),V(qt,Wt),V(Wt,qe),V(qe,$e),V(Wt,lr),V(Wt,gr),V(gr,pi),V(Wt,ii),V(Wt,Zr),V(Zr,Gr),Ie(Q,si,Me),Ie(Q,kt,Me),V(kt,ur),V(ur,wt),Ie(Q,Ht,Me),Ie(Q,It,Me),V(It,ei),V(ei,Or),V(Or,li),V(ei,_n),$.m(ei,null),V(ei,Si),be.m(ei,null),V(It,tn),V(It,wr),V(wr,fi),V(fi,Fi),V(Fi,Ni),V(Fi,di),di.innerHTML=oo,V(wr,Xi),V(wr,vn),V(vn,Xn),V(Xn,Bo),V(Xn,zn),V(zn,Wn),V(Wn,ia),V(wr,So),V(wr,Pn),V(Pn,Eo),V(wr,Oo),V(wr,na),Te&&Te.m(wr,null),V(wr,Fo),Ee&&Ee.m(wr,null),V(It,ao),V(It,Kr),V(Kr,mi),V(mi,rn),V(rn,so),V(rn,xr),xr.innerHTML=M,V(Kr,F),V(Kr,q),V(q,Y),V(Y,re),V(Y,ue),V(ue,ye),V(ye,Z),V(Kr,oe),V(Kr,ve),V(ve,Ze),V(Kr,Re),V(Kr,je),Ae&&Ae.m(Kr,null),V(Kr,ht),Oe&&Oe.m(Kr,null),V(It,st),V(It,ze),V(ze,tt),V(tt,Ye),V(Ye,it),V(Ye,Ut),Ut.innerHTML=ot,V(ze,er),V(ze,cr),V(cr,Zt),V(Zt,or),V(Zt,Jt),V(Jt,ui),V(ui,fr),V(ze,Fr),V(ze,nr),Qr(Gt,nr,null),V(ze,ar),Ke&&Ke.m(ze,null),V(ze,Ei),mt&&mt.m(ze,null),V(It,ko),V(It,Nr),V(Nr,ni),V(ni,_a),V(Nr,No),Qr(Sr,Nr,null),V(It,Vo),V(It,Xr),V(Xr,Er),V(Er,yi),V(yi,Pr),V(yi,Wi),Wi.innerHTML=Mn,V(Xr,Ps),V(Xr,oi),V(oi,Dn),V(Dn,Vi),V(Dn,ai),V(ai,bn),V(bn,Ui),V(Xr,Uo),Qr(jo,Xr,null),Ie(Q,Ys,Me),Ie(Q,Ci,Me),V(Ci,Na),V(Na,qo),V(qo,kl),V(qo,oa),V(oa,aa),V(Ci,Cs),V(Ci,Ln),Qr(Zo,Ln,null),V(Ci,Rn),V(Ci,lo),V(lo,_e),Kt&&Kt.m(_e,null),V(Ci,nn),V(Ci,Ti),V(Ti,Br),V(Br,Bn),Nt.m(Bn,null),Hn=Rc(Ci,c[25].bind(Ci)),Ie(Q,gi,Me),Ie(Q,To,Me),V(To,us),V(us,Pu),V(us,Ms),V(Ms,Qs),V(Ms,Tl),Ie(Q,$s,Me),Ie(Q,Jn,Me),V(Jn,sa),V(sa,Go),V(Go,Io),V(Io,Ls),V(Io,cs),cs.innerHTML=pn,V(sa,Il),V(sa,uo),V(uo,co),V(co,Va),V(co,Ao),V(Ao,Ko),V(Ko,Ua),V(sa,ja),Qr(Yn,sa,null),V(Jn,tu),V(Jn,la),V(la,dr),V(dr,qa),V(qa,el),V(qa,hs),hs.innerHTML=rc,V(la,ru),V(la,ps),V(ps,zo),V(zo,ba),V(zo,Po),V(Po,tl),V(tl,iu),V(la,Al),Qr(ho,la,null),V(Jn,nu),V(Jn,On),V(On,fn),V(fn,ua),V(ua,Rs),V(ua,kr),kr.innerHTML=ou,V(On,Cu),V(On,Xo),V(Xo,fs),V(fs,Mu),V(fs,ds),V(ds,ms),V(ms,ys),V(On,Bs),Qr(ca,On,null),rl=Rc(Jn,c[26].bind(Jn)),Ie(Q,Za,Me),Ie(Q,Ga,Me),V(Ga,Wo),V(Wo,Co),V(Wo,gs),V(gs,zl),V(gs,Ka),Ie(Q,_s,Me),Ie(Q,xn,Me),V(xn,Ho),V(Ho,Qn),V(Qn,Xa),V(Xa,nl),V(Xa,Wa),Wa.innerHTML=ic,V(Ho,au),V(Ho,xa),V(xa,Ha),V(Ha,Pl),V(Ha,Ja),V(Ja,Ya),V(Ya,su),V(Ho,Qa),Qr(Cr,Ho,null),V(xn,ol),V(xn,Fn),V(Fn,on),V(on,Yt),V(Yt,Vr),V(Yt,an),an.innerHTML=Cl,V(Fn,vs),V(Fn,ha),V(ha,Os),V(Os,Du),V(Os,pa),V(pa,$a),V($a,fa),V(Fn,Ii),Qr(Jo,Fn,null),V(xn,lu),V(xn,Ur),V(Ur,at),V(at,Mi),V(Mi,al),V(Mi,Yo),Yo.innerHTML=da,V(Ur,Nn),V(Ur,es),V(es,rt),V(rt,Ml),V(rt,wa),V(wa,Fs),V(Fs,po),V(Ur,Vn),Qr(ma,Ur,null),Dl=Rc(xn,c[27].bind(xn)),Ie(Q,wn,Me),Ie(Q,Un,Me),V(Un,bs),V(bs,Ns),V(bs,ts),V(ts,fo),V(ts,$n),Ie(Q,rr,Me),Ie(Q,Ai,Me),V(Ai,ji),V(ji,ti),V(ti,eo),V(eo,Sa),V(eo,Sn),Sn.innerHTML=jn,V(ji,Us),V(ji,vt),V(vt,dt),V(dt,sl),V(dt,Di),V(Di,to),V(to,Hi),V(ji,Qo),Qr(Ea,ji,null),V(Ai,ll),V(Ai,hr),V(hr,Wr),V(Wr,ka),V(ka,rs),V(ka,is),is.innerHTML=ns,V(hr,qn),V(hr,$o),V($o,Zn),V(Zn,ul),V(Zn,ea),V(ea,os),V(os,Ll),V(hr,xs),Qr(mo,hr,null),V(Ai,Rl),V(Ai,En),V(En,sn),V(sn,ta),V(ta,Ta),V(ta,dn),dn.innerHTML=Lu,V(En,js),V(En,as),V(as,Ia),V(Ia,n),V(Ia,s),V(s,o),V(o,u),V(En,m),Qr(w,En,null),S=Rc(Ai,c[28].bind(Ai)),k=!0,P||(L=[Kn(Ue,"click",c[15]),Kn(Ue,"click",c[16]),Kn(Ue,"click",c[17]),Kn(We,"click",c[21]),Kn(We,"click",c[22]),Kn(We,"click",c[23])],P=!0)},p(Q,Me){W===(W=X(Q))&&J?J.p(Q,Me):(J.d(1),J=W(Q),J&&(J.c(),J.m(y,R))),(!k||Me[0]&2)&&H!==(H=Q[1].name+"")&&Ct(de,H),Me[0]&512&&en(Ue,"btn-active",Q[9]),Q[1].type!="ew"?ee?ee.p(Q,Me):(ee=Sy(Q),ee.c(),ee.m(xe,ut)):ee&&(ee.d(1),ee=null),Me[0]&1552&&en(We,"btn-active",Q[4]&!Q[9]&!Q[10]);const Vt={};Me[0]&1&&(Vt.options=Q[0]),gt.$set(Vt),Me[0]&32&&en(qt,"float-right",Q[5]>1),se===(se=ie(Q))&&$?$.p(Q,Me):($.d(1),$=se(Q),$&&($.c(),$.m(ei,Si))),me===(me=le(Q))&&be?be.p(Q,Me):(be.d(1),be=me(Q),be&&(be.c(),be.m(ei,null))),(!k||Me[0]&2)&&Cn!==(Cn=Q[1].data.population.value[2021].all.toLocaleString()+"")&&Ct(Eo,Cn),Q[1].type!="ew"?Te?(Te.p(Q,Me),Me[0]&2&&bt(Te,1)):(Te=Ey(Q),Te.c(),bt(Te,1),Te.m(wr,Fo)):Te&&(As(),Ot(Te,1,1,()=>{Te=null}),zs()),Q[4]?Ee?(Ee.p(Q,Me),Me[0]&16&&bt(Ee,1)):(Ee=Ty(Q),Ee.c(),bt(Ee,1),Ee.m(wr,null)):Ee&&(As(),Ot(Ee,1,1,()=>{Ee=null}),zs()),(!k||Me[0]&2)&&Ve!==(Ve=Q[1].data.households.value[2021].all_households.toLocaleString()+"")&&Ct(Ze,Ve),Q[1].type!="ew"&Q[10]?Ae?(Ae.p(Q,Me),Me[0]&1026&&bt(Ae,1)):(Ae=Iy(Q),Ae.c(),bt(Ae,1),Ae.m(Kr,ht)):Ae&&(As(),Ot(Ae,1,1,()=>{Ae=null}),zs()),Q[4]?Oe?(Oe.p(Q,Me),Me[0]&16&&bt(Oe,1)):(Oe=Ay(Q),Oe.c(),bt(Oe,1),Oe.m(Kr,null)):Oe&&(As(),Ot(Oe,1,1,()=>{Oe=null}),zs());const At={};Me[0]&2&&(At.data=Q[1]&&Q[12](["age","perc","2021"])),Me[0]&530&&(At.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Gt.$set(At),!Q[9]&&Q[11]?Ke?Ke.p(Q,Me):(Ke=zy(Q),Ke.c(),Ke.m(ze,Ei)):Ke&&(Ke.d(1),Ke=null),lt===(lt=et(Q))&&mt?mt.p(Q,Me):(mt&&mt.d(1),mt=lt&&lt(Q),mt&&(mt.c(),mt.m(ze,null)));const Pt={};Me[0]&2&&(Pt.data=Q[1]&&Q[12](["population","perc","2021"])),Me[0]&530&&(Pt.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(Pt.label=Q[11]),Sr.$set(Pt);const ci={};Me[0]&2&&(ci.data=Q[1]&&Q[12](["hh_size","perc","2021"])),Me[0]&530&&(ci.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(ci.label=Q[11]),jo.$set(ci),(!k||Me[0]&2)&&ls!==(ls=Q[1].name+"")&&Ct(aa,ls),(!k||Me[0]&32)&&De(Na,"grid-column","span "+Q[5]);const Tr={};Me[0]&2&&(Tr.location={bounds:Q[1].bounds}),Me[0]&384|Me[1]&8192&&(Tr.$$scope={dirty:Me,ctx:Q}),!va&&Me[0]&64&&(va=!0,Tr.map=Q[6],Wg(()=>va=!1)),Zo.$set(Tr),(!k||Me[0]&32)&&De(Ln,"grid-column","span "+(Q[5]==2?2:Q[5]&&Q[5]>2?Q[5]-1:1)),Q[1].parents[0]?Kt?Kt.p(Q,Me):(Kt=By(Q),Kt.c(),Kt.m(_e,null)):Kt&&(Kt.d(1),Kt=null),Ft===(Ft=ft(Q))&&Nt?Nt.p(Q,Me):(Nt.d(1),Nt=Ft(Q),Nt&&(Nt.c(),Nt.m(Bn,null))),(!k||Me[0]&2)&&Ds!==(Ds=Q[1].name+"")&&Ct(Qs,Ds),(!k||Me[0]&32)&&De(To,"grid-column","span "+Q[5]);const zi={};Me[0]&2&&(zi.data=Q[1]&&Q[12](["cob","perc","2021"])),Me[0]&530&&(zi.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(zi.label=Q[11]),Yn.$set(zi);const _i={};Me[0]&2&&(_i.data=Q[1]&&Q[12](["passport","perc","2021"])),Me[0]&530&&(_i.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(_i.label=Q[11]),ho.$set(_i);const jr={};Me[0]&2&&(jr.data=Q[1]&&Q[12](["natid","perc","2021"])),Me[0]&530&&(jr.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(jr.label=Q[11]),ca.$set(jr),(!k||Me[0]&2)&&il!==(il=Q[1].name+"")&&Ct(zl,il),(!k||Me[0]&32)&&De(Ga,"grid-column","span "+Q[5]);const Ir={};Me[0]&2&&(Ir.data=Q[1]&&Q[12](["mainlang","perc","2021"])),Me[0]&530&&(Ir.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(Ir.label=Q[11]),Cr.$set(Ir);const Ji={};Me[0]&2&&(Ji.data=Q[1]&&Q[12](["irish","perc","2021"])),Me[0]&530&&(Ji.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(Ji.label=Q[11]),Jo.$set(Ji);const Li={};Me[0]&2&&(Li.data=Q[1]&&Q[12](["ulster","perc","2021"])),Me[0]&530&&(Li.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(Li.label=Q[11]),ma.$set(Li),(!k||Me[0]&2)&&Vs!==(Vs=Q[1].name+"")&&Ct(fo,Vs),(!k||Me[0]&32)&&De(Un,"grid-column","span "+Q[5]);const mn={};Me[0]&2&&(mn.data=Q[1]&&Q[12](["religion","perc","2021"])),Me[0]&530&&(mn.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(mn.label=Q[11]),Ea.$set(mn);const qi={};Me[0]&2&&(qi.data=Q[1]&&Q[12](["religion_or_religion_brought_up_in","perc","2021"])),Me[0]&530&&(qi.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(qi.label=Q[11]),mo.$set(qi);const kn={};Me[0]&2&&(kn.data=Q[1]&&Q[12](["ethnic","perc","2021"])),Me[0]&530&&(kn.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Me[0]&2048&&(kn.label=Q[11]),w.$set(kn)},i(Q){k||(bt(gt.$$.fragment,Q),bt(Te),bt(Ee),bt(Ae),bt(Oe),bt(Gt.$$.fragment,Q),bt(Sr.$$.fragment,Q),bt(jo.$$.fragment,Q),bt(Zo.$$.fragment,Q),bt(Yn.$$.fragment,Q),bt(ho.$$.fragment,Q),bt(ca.$$.fragment,Q),bt(Cr.$$.fragment,Q),bt(Jo.$$.fragment,Q),bt(ma.$$.fragment,Q),bt(Ea.$$.fragment,Q),bt(mo.$$.fragment,Q),bt(w.$$.fragment,Q),k=!0)},o(Q){Ot(gt.$$.fragment,Q),Ot(Te),Ot(Ee),Ot(Ae),Ot(Oe),Ot(Gt.$$.fragment,Q),Ot(Sr.$$.fragment,Q),Ot(jo.$$.fragment,Q),Ot(Zo.$$.fragment,Q),Ot(Yn.$$.fragment,Q),Ot(ho.$$.fragment,Q),Ot(ca.$$.fragment,Q),Ot(Cr.$$.fragment,Q),Ot(Jo.$$.fragment,Q),Ot(ma.$$.fragment,Q),Ot(Ea.$$.fragment,Q),Ot(mo.$$.fragment,Q),Ot(w.$$.fragment,Q),k=!1},d(Q){Q&&O(h),J.d(),ee&&ee.d(),$r(gt),Q&&O(si),Q&&O(kt),Q&&O(Ht),Q&&O(It),$.d(),be.d(),Te&&Te.d(),Ee&&Ee.d(),Ae&&Ae.d(),Oe&&Oe.d(),$r(Gt),Ke&&Ke.d(),mt&&mt.d(),$r(Sr),$r(jo),Q&&O(Ys),Q&&O(Ci),$r(Zo),Kt&&Kt.d(),Nt.d(),Hn(),Q&&O(gi),Q&&O(To),Q&&O($s),Q&&O(Jn),$r(Yn),$r(ho),$r(ca),rl(),Q&&O(Za),Q&&O(Ga),Q&&O(_s),Q&&O(xn),$r(Cr),$r(Jo),$r(ma),Dl(),Q&&O(wn),Q&&O(Un),Q&&O(rr),Q&&O(Ai),$r(Ea),$r(mo),$r(w),S(),P=!1,$u(L)}}}function H0(c){let h=c[1].name+"",f;return{c(){f=we(h)},l(y){f=Se(y,h)},m(y,v){Ie(y,f,v)},p(y,v){v[0]&2&&h!==(h=y[1].name+"")&&Ct(f,h)},d(y){y&&O(f)}}}function J0(c){let h,f=c[1].name+"",y,v=[...c[1].parents].reverse(),x=[];for(let a=0;a<v.length;a+=1)x[a]=wy(by(c,v,a));return{c(){for(let a=0;a<x.length;a+=1)x[a].c();h=He(),y=we(f)},l(a){for(let A=0;A<x.length;A+=1)x[A].l(a);h=Je(a),y=Se(a,f)},m(a,A){for(let I=0;I<x.length;I+=1)x[I].m(a,A);Ie(a,h,A),Ie(a,y,A)},p(a,A){if(A[0]&2){v=[...a[1].parents].reverse();let I;for(I=0;I<v.length;I+=1){const R=by(a,v,I);x[I]?x[I].p(R,A):(x[I]=wy(R),x[I].c(),x[I].m(h.parentNode,h))}for(;I<x.length;I+=1)x[I].d(1);x.length=v.length}A[0]&2&&f!==(f=a[1].name+"")&&Ct(y,f)},d(a){Js(x,a),a&&O(h),a&&O(y)}}}function wy(c){let h,f=c[36].name+"",y,v,x,a=" &gt; ",A;return{c(){h=ce("a"),y=we(f),x=new qy(!1),A=ki(),this.h()},l(I){h=he(I,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var R=fe(h);y=Se(R,f),R.forEach(O),x=Zy(I,!1),A=ki(),this.h()},h(){U(h,"href",v=El+"/"+c[36].code+"/"),U(h,"sveltekit:noscroll",""),U(h,"class","svelte-ls2yfr"),x.a=A},m(I,R){Ie(I,h,R),V(h,y),x.m(a,I,R),Ie(I,A,R)},p(I,R){R[0]&2&&f!==(f=I[36].name+"")&&Ct(y,f),R[0]&2&&v!==(v=El+"/"+I[36].code+"/")&&U(h,"href",v)},d(I){I&&O(h),I&&O(A),I&&x.d()}}}function Sy(c){let h,f,y,v;return{c(){h=ce("button"),f=we("NI comparison"),this.h()},l(x){h=he(x,"BUTTON",{class:!0});var a=fe(h);f=Se(a,"NI comparison"),a.forEach(O),this.h()},h(){U(h,"class","btn svelte-ls2yfr"),en(h,"btn-active",c[10]&!c[9]&!c[4])},m(x,a){Ie(x,h,a),V(h,f),y||(v=[Kn(h,"click",c[18]),Kn(h,"click",c[19]),Kn(h,"click",c[20])],y=!0)},p(x,a){a[0]&1552&&en(h,"btn-active",x[10]&!x[9]&!x[4])},d(x){x&&O(h),y=!1,$u(v)}}}function Y0(c){let h,f=c[1].name+"",y,v,x=c[1].data.population.value[2021].all.toLocaleString()+"",a,A,I;function R(j,H){return j[1].data.population.value_rank[2021].all==1?r1:j[1].data.population.value_rank[2021].all==j[1].count?t1:j[1].data.population.value_rank[2021].all<=(j[1].count+1)/2&&j[1].data.population.value_rank[2021].all!=1?e1:$0}let B=R(c),G=B(c);return{c(){h=we("The population of "),y=we(f),v=we(" was "),a=we(x),A=we(` at the time of the 2021 Census, which made it the \r
			`),G.c(),I=ki()},l(j){h=Se(j,"The population of "),y=Se(j,f),v=Se(j," was "),a=Se(j,x),A=Se(j,` at the time of the 2021 Census, which made it the \r
			`),G.l(j),I=ki()},m(j,H){Ie(j,h,H),Ie(j,y,H),Ie(j,v,H),Ie(j,a,H),Ie(j,A,H),G.m(j,H),Ie(j,I,H)},p(j,H){H[0]&2&&f!==(f=j[1].name+"")&&Ct(y,f),H[0]&2&&x!==(x=j[1].data.population.value[2021].all.toLocaleString()+"")&&Ct(a,x),B===(B=R(j))&&G?G.p(j,H):(G.d(1),G=B(j),G&&(G.c(),G.m(I.parentNode,I)))},d(j){j&&O(h),j&&O(y),j&&O(v),j&&O(a),j&&O(A),G.d(j),j&&O(I)}}}function Q0(c){let h,f=c[1].name+"",y,v,x=c[1].data.population.value[2021].all.toLocaleString()+"",a,A;return{c(){h=we("The population of "),y=we(f),v=we(" was "),a=we(x),A=we(" at the time of the 2021 Census.")},l(I){h=Se(I,"The population of "),y=Se(I,f),v=Se(I," was "),a=Se(I,x),A=Se(I," at the time of the 2021 Census.")},m(I,R){Ie(I,h,R),Ie(I,y,R),Ie(I,v,R),Ie(I,a,R),Ie(I,A,R)},p(I,R){R[0]&2&&f!==(f=I[1].name+"")&&Ct(y,f),R[0]&2&&x!==(x=I[1].data.population.value[2021].all.toLocaleString()+"")&&Ct(a,x)},d(I){I&&O(h),I&&O(y),I&&O(v),I&&O(a),I&&O(A)}}}function $0(c){let h=c[1].count+1-c[1].data.population.value_rank[2021].all.toLocaleString()+"",f,y=zu(c[1].count+1-c[1].data.population.value_rank[2021].all)+"",v,x;return{c(){f=we(h),v=we(y),x=we(" smallest area.")},l(a){f=Se(a,h),v=Se(a,y),x=Se(a," smallest area.")},m(a,A){Ie(a,f,A),Ie(a,v,A),Ie(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].count+1-a[1].data.population.value_rank[2021].all.toLocaleString()+"")&&Ct(f,h),A[0]&2&&y!==(y=zu(a[1].count+1-a[1].data.population.value_rank[2021].all)+"")&&Ct(v,y)},d(a){a&&O(f),a&&O(v),a&&O(x)}}}function e1(c){let h=c[1].data.population.value_rank[2021].all.toLocaleString()+"",f,y=zu(c[1].data.population.value_rank[2021].all)+"",v,x;return{c(){f=we(h),v=we(y),x=we(" largest area.")},l(a){f=Se(a,h),v=Se(a,y),x=Se(a," largest area.")},m(a,A){Ie(a,f,A),Ie(a,v,A),Ie(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].data.population.value_rank[2021].all.toLocaleString()+"")&&Ct(f,h),A[0]&2&&y!==(y=zu(a[1].data.population.value_rank[2021].all)+"")&&Ct(v,y)},d(a){a&&O(f),a&&O(v),a&&O(x)}}}function t1(c){let h;return{c(){h=we("smallest area.")},l(f){h=Se(f,"smallest area.")},m(f,y){Ie(f,h,y)},p:Ro,d(f){f&&O(h)}}}function r1(c){let h;return{c(){h=we("largest area.")},l(f){h=Se(f,"largest area.")},m(f,y){Ie(f,h,y)},p:Ro,d(f){f&&O(h)}}}function i1(c){let h,f=sr(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=we("A decrease of "),y=we(f),v=we(" since the 2011 Census.")},l(x){h=Se(x,"A decrease of "),y=Se(x,f),v=Se(x," since the 2011 Census.")},m(x,a){Ie(x,h,a),Ie(x,y,a),Ie(x,v,a)},p(x,a){a[0]&2&&f!==(f=sr(x[1].data.population.value.change.all,"%",1)+"")&&Ct(y,f)},d(x){x&&O(h),x&&O(y),x&&O(v)}}}function n1(c){let h,f=sr(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=we("An increase of "),y=we(f),v=we(" since the 2011 Census.")},l(x){h=Se(x,"An increase of "),y=Se(x,f),v=Se(x," since the 2011 Census.")},m(x,a){Ie(x,h,a),Ie(x,y,a),Ie(x,v,a)},p(x,a){a[0]&2&&f!==(f=sr(x[1].data.population.value.change.all,"%",1)+"")&&Ct(y,f)},d(x){x&&O(h),x&&O(y),x&&O(v)}}}function o1(c){let h;return{c(){h=we("No change in population since the 2011 Census.")},l(f){h=Se(f,"No change in population since the 2011 Census.")},m(f,y){Ie(f,h,y)},p:Ro,d(f){f&&O(h)}}}function Ey(c){let h,f,y=c[1].type!="ctry"&c[10]&!c[4]&&ky(c);return{c(){y&&y.c(),h=ki()},l(v){y&&y.l(v),h=ki()},m(v,x){y&&y.m(v,x),Ie(v,h,x),f=!0},p(v,x){v[1].type!="ctry"&v[10]&!v[4]?y?(y.p(v,x),x[0]&1042&&bt(y,1)):(y=ky(v),y.c(),bt(y,1),y.m(h.parentNode,h)):y&&(As(),Ot(y,1,1,()=>{y=null}),zs())},i(v){f||(bt(y),f=!0)},o(v){Ot(y),f=!1},d(v){y&&y.d(v),v&&O(h)}}}function ky(c){let h,f,y,v,x,a,A=c[1].count.toLocaleString()+"",I,R,B=zh[c[1].type].pl.toLowerCase()+"",G,j;f=new _f({props:{$$slots:{default:[a1]},$$scope:{ctx:c}}});function H(xe,Xe){return xe[1].data.population.value_rank[2021].all==1?c1:xe[1].data.population.value_rank[2021].all==xe[1].count?u1:xe[1].data.population.value_rank[2021].all<=(xe[1].count+1)/2&&xe[1].data.population.value_rank[2021].all!=1?l1:s1}let de=H(c),Ce=de(c);return{c(){h=ce("span"),Jr(f.$$.fragment),y=we(" of Northern Ireland population"),v=He(),x=ce("div"),Ce.c(),a=we(`\r
			 population of `),I=we(A),R=He(),G=we(B),this.h()},l(xe){h=he(xe,"SPAN",{class:!0});var Xe=fe(h);Yr(f.$$.fragment,Xe),y=Se(Xe," of Northern Ireland population"),Xe.forEach(O),v=Je(xe),x=he(xe,"DIV",{class:!0});var Ue=fe(x);Ce.l(Ue),a=Se(Ue,`\r
			 population of `),I=Se(Ue,A),R=Je(Ue),G=Se(Ue,B),Ue.forEach(O),this.h()},h(){U(h,"class","text-small "),U(x,"class","text-small ")},m(xe,Xe){Ie(xe,h,Xe),Qr(f,h,null),V(h,y),Ie(xe,v,Xe),Ie(xe,x,Xe),Ce.m(x,null),V(x,a),V(x,I),V(x,R),V(x,G),j=!0},p(xe,Xe){const Ue={};Xe[0]&6|Xe[1]&8192&&(Ue.$$scope={dirty:Xe,ctx:xe}),f.$set(Ue),de===(de=H(xe))&&Ce?Ce.p(xe,Xe):(Ce.d(1),Ce=de(xe),Ce&&(Ce.c(),Ce.m(x,a))),(!j||Xe[0]&2)&&A!==(A=xe[1].count.toLocaleString()+"")&&Ct(I,A),(!j||Xe[0]&2)&&B!==(B=zh[xe[1].type].pl.toLowerCase()+"")&&Ct(G,B)},i(xe){j||(bt(f.$$.fragment,xe),j=!0)},o(xe){Ot(f.$$.fragment,xe),j=!1},d(xe){xe&&O(h),$r(f),xe&&O(v),xe&&O(x),Ce.d()}}}function a1(c){let h=(c[1].data.population.value[2021].all/c[2].data.population.value[2021].all>=.001?(c[1].data.population.value[2021].all/c[2].data.population.value[2021].all*100).toFixed(1):"<0.1")+"",f,y;return{c(){f=we(h),y=we("%")},l(v){f=Se(v,h),y=Se(v,"%")},m(v,x){Ie(v,f,x),Ie(v,y,x)},p(v,x){x[0]&6&&h!==(h=(v[1].data.population.value[2021].all/v[2].data.population.value[2021].all>=.001?(v[1].data.population.value[2021].all/v[2].data.population.value[2021].all*100).toFixed(1):"<0.1")+"")&&Ct(f,h)},d(v){v&&O(f),v&&O(y)}}}function s1(c){let h=c[1].count+1-c[1].data.population.value_rank[2021].all.toLocaleString()+"",f,y=zu(c[1].count+1-c[1].data.population.value_rank[2021].all)+"",v,x;return{c(){f=we(h),v=we(y),x=we(" smallest")},l(a){f=Se(a,h),v=Se(a,y),x=Se(a," smallest")},m(a,A){Ie(a,f,A),Ie(a,v,A),Ie(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].count+1-a[1].data.population.value_rank[2021].all.toLocaleString()+"")&&Ct(f,h),A[0]&2&&y!==(y=zu(a[1].count+1-a[1].data.population.value_rank[2021].all)+"")&&Ct(v,y)},d(a){a&&O(f),a&&O(v),a&&O(x)}}}function l1(c){let h=c[1].data.population.value_rank[2021].all.toLocaleString()+"",f,y=zu(c[1].data.population.value_rank[2021].all)+"",v,x;return{c(){f=we(h),v=we(y),x=we(" largest")},l(a){f=Se(a,h),v=Se(a,y),x=Se(a," largest")},m(a,A){Ie(a,f,A),Ie(a,v,A),Ie(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].data.population.value_rank[2021].all.toLocaleString()+"")&&Ct(f,h),A[0]&2&&y!==(y=zu(a[1].data.population.value_rank[2021].all)+"")&&Ct(v,y)},d(a){a&&O(f),a&&O(v),a&&O(x)}}}function u1(c){let h;return{c(){h=we("The smallest")},l(f){h=Se(f,"The smallest")},m(f,y){Ie(f,h,y)},p:Ro,d(f){f&&O(h)}}}function c1(c){let h;return{c(){h=we("The largest")},l(f){h=Se(f,"The largest")},m(f,y){Ie(f,h,y)},p:Ro,d(f){f&&O(h)}}}function Ty(c){let h,f,y,v;return f=new _f({props:{$$slots:{default:[h1]},$$scope:{ctx:c}}}),{c(){h=ce("span"),Jr(f.$$.fragment),y=we(" since 2011 Census"),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);Yr(f.$$.fragment,a),y=Se(a," since 2011 Census"),a.forEach(O),this.h()},h(){U(h,"class","text-small ")},m(x,a){Ie(x,h,a),Qr(f,h,null),V(h,y),v=!0},p(x,a){const A={};a[0]&2|a[1]&8192&&(A.$$scope={dirty:a,ctx:x}),f.$set(A)},i(x){v||(bt(f.$$.fragment,x),v=!0)},o(x){Ot(f.$$.fragment,x),v=!1},d(x){x&&O(h),$r(f)}}}function h1(c){let h,f=sr(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=ce("span"),y=we(f),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);y=Se(a,f),a.forEach(O),this.h()},h(){U(h,"class",v=of(lf(c[1].data.population.value.change.all))+" svelte-ls2yfr")},m(x,a){Ie(x,h,a),V(h,y)},p(x,a){a[0]&2&&f!==(f=sr(x[1].data.population.value.change.all,"%",1)+"")&&Ct(y,f),a[0]&2&&v!==(v=of(lf(x[1].data.population.value.change.all))+" svelte-ls2yfr")&&U(h,"class",v)},d(x){x&&O(h)}}}function Iy(c){let h,f,y,v;return f=new _f({props:{$$slots:{default:[p1]},$$scope:{ctx:c}}}),{c(){h=ce("span"),Jr(f.$$.fragment),y=we(" of Northern Ireland households"),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);Yr(f.$$.fragment,a),y=Se(a," of Northern Ireland households"),a.forEach(O),this.h()},h(){U(h,"class","text-small")},m(x,a){Ie(x,h,a),Qr(f,h,null),V(h,y),v=!0},p(x,a){const A={};a[0]&6|a[1]&8192&&(A.$$scope={dirty:a,ctx:x}),f.$set(A)},i(x){v||(bt(f.$$.fragment,x),v=!0)},o(x){Ot(f.$$.fragment,x),v=!1},d(x){x&&O(h),$r(f)}}}function p1(c){let h=(c[1].data.households.value[2021].all_households/c[2].data.households.value[2021].all_households>=.001?(c[1].data.households.value[2021].all_households/c[2].data.households.value[2021].all_households*100).toFixed(1):"<0.1")+"",f,y;return{c(){f=we(h),y=we("%")},l(v){f=Se(v,h),y=Se(v,"%")},m(v,x){Ie(v,f,x),Ie(v,y,x)},p(v,x){x[0]&6&&h!==(h=(v[1].data.households.value[2021].all_households/v[2].data.households.value[2021].all_households>=.001?(v[1].data.households.value[2021].all_households/v[2].data.households.value[2021].all_households*100).toFixed(1):"<0.1")+"")&&Ct(f,h)},d(v){v&&O(f),v&&O(y)}}}function Ay(c){let h,f,y,v;return f=new _f({props:{$$slots:{default:[f1]},$$scope:{ctx:c}}}),{c(){h=ce("span"),Jr(f.$$.fragment),y=we(" since 2011 Census"),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);Yr(f.$$.fragment,a),y=Se(a," since 2011 Census"),a.forEach(O),this.h()},h(){U(h,"class","text-small")},m(x,a){Ie(x,h,a),Qr(f,h,null),V(h,y),v=!0},p(x,a){const A={};a[0]&2|a[1]&8192&&(A.$$scope={dirty:a,ctx:x}),f.$set(A)},i(x){v||(bt(f.$$.fragment,x),v=!0)},o(x){Ot(f.$$.fragment,x),v=!1},d(x){x&&O(h),$r(f)}}}function f1(c){let h,f=sr(c[1].data.households.value.change.all_households,"%",1)+"",y,v;return{c(){h=ce("span"),y=we(f),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);y=Se(a,f),a.forEach(O),this.h()},h(){U(h,"class",v=of(lf(c[1].data.households.value.change.all_households))+" svelte-ls2yfr")},m(x,a){Ie(x,h,a),V(h,y)},p(x,a){a[0]&2&&f!==(f=sr(x[1].data.households.value.change.all_households,"%",1)+"")&&Ct(y,f),a[0]&2&&v!==(v=of(lf(x[1].data.households.value.change.all_households))+" svelte-ls2yfr")&&U(h,"class",v)},d(x){x&&O(h)}}}function zy(c){let h,f,y,v,x;return{c(){h=ce("div"),f=xo("svg"),y=xo("rect"),v=He(),x=we(c[11]),this.h()},l(a){h=he(a,"DIV",{class:!0});var A=fe(h);f=wo(A,"svg",{width:!0,height:!0,style:!0});var I=fe(f);y=wo(I,"rect",{width:!0,height:!0,style:!0});var R=fe(y);R.forEach(O),I.forEach(O),v=Je(A),x=Se(A,c[11]),A.forEach(O),this.h()},h(){U(y,"width","25"),U(y,"height","4"),De(y,"fill","#CEDC20"),U(f,"width","25"),U(f,"height","4"),De(f,"display","inline-block"),De(f,"margin-bottom","3px"),U(h,"class","text-small muted; ")},m(a,A){Ie(a,h,A),V(h,f),V(f,y),V(h,v),V(h,x)},p(a,A){A[0]&2048&&Ct(x,a[11])},d(a){a&&O(h)}}}function d1(c){let h,f,y=sr(c[1].data.age.perc[2021].a0to14,"%",0)+"",v,x,a,A,I,R,B=sr(c[1].data.age.perc[2021].a15to39,"%",0)+"",G,j,H,de,Ce,xe,Xe=sr(c[1].data.age.perc[2021].a40to64,"%",0)+"",Ue,Bt,St,ut,We,tr,Xt=sr(c[1].data.age.perc[2021].a65plus,"%",0)+"",xt,qt,Ge,Rt=c[1].parents[0]&&Py(c),yt=c[1].parents[0]&&Cy(c),gt=c[1].parents[0]&&My(c),Le=c[1].parents[0]&&Dy(c);return{c(){h=ce("span"),f=we("0-14 years "),v=we(y),x=He(),Rt&&Rt.c(),a=ce("br"),A=He(),I=ce("span"),R=we("15-39 years "),G=we(B),j=He(),yt&&yt.c(),H=ce("br"),de=He(),Ce=ce("span"),xe=we("40-64 years "),Ue=we(Xe),Bt=He(),gt&&gt.c(),St=ce("br"),ut=He(),We=ce("span"),tr=we("65+ years "),xt=we(Xt),qt=He(),Le&&Le.c(),Ge=ki(),this.h()},l(Ne){h=he(Ne,"SPAN",{class:!0});var Et=fe(h);f=Se(Et,"0-14 years "),v=Se(Et,y),x=Je(Et),Et.forEach(O),Rt&&Rt.l(Ne),a=he(Ne,"BR",{}),A=Je(Ne),I=he(Ne,"SPAN",{class:!0});var mr=fe(I);R=Se(mr,"15-39 years "),G=Se(mr,B),j=Je(mr),mr.forEach(O),yt&&yt.l(Ne),H=he(Ne,"BR",{}),de=Je(Ne),Ce=he(Ne,"SPAN",{class:!0});var Wt=fe(Ce);xe=Se(Wt,"40-64 years "),Ue=Se(Wt,Xe),Bt=Je(Wt),Wt.forEach(O),gt&&gt.l(Ne),St=he(Ne,"BR",{}),ut=Je(Ne),We=he(Ne,"SPAN",{class:!0});var qe=fe(We);tr=Se(qe,"65+ years "),xt=Se(qe,Xt),qt=Je(qe),qe.forEach(O),Le&&Le.l(Ne),Ge=ki(),this.h()},h(){U(h,"class","text-small"),U(I,"class","text-small"),U(Ce,"class","text-small"),U(We,"class","text-small")},m(Ne,Et){Ie(Ne,h,Et),V(h,f),V(h,v),V(h,x),Rt&&Rt.m(Ne,Et),Ie(Ne,a,Et),Ie(Ne,A,Et),Ie(Ne,I,Et),V(I,R),V(I,G),V(I,j),yt&&yt.m(Ne,Et),Ie(Ne,H,Et),Ie(Ne,de,Et),Ie(Ne,Ce,Et),V(Ce,xe),V(Ce,Ue),V(Ce,Bt),gt&&gt.m(Ne,Et),Ie(Ne,St,Et),Ie(Ne,ut,Et),Ie(Ne,We,Et),V(We,tr),V(We,xt),V(We,qt),Le&&Le.m(Ne,Et),Ie(Ne,Ge,Et)},p(Ne,Et){Et[0]&2&&y!==(y=sr(Ne[1].data.age.perc[2021].a0to14,"%",0)+"")&&Ct(v,y),Ne[1].parents[0]?Rt?Rt.p(Ne,Et):(Rt=Py(Ne),Rt.c(),Rt.m(a.parentNode,a)):Rt&&(Rt.d(1),Rt=null),Et[0]&2&&B!==(B=sr(Ne[1].data.age.perc[2021].a15to39,"%",0)+"")&&Ct(G,B),Ne[1].parents[0]?yt?yt.p(Ne,Et):(yt=Cy(Ne),yt.c(),yt.m(H.parentNode,H)):yt&&(yt.d(1),yt=null),Et[0]&2&&Xe!==(Xe=sr(Ne[1].data.age.perc[2021].a40to64,"%",0)+"")&&Ct(Ue,Xe),Ne[1].parents[0]?gt?gt.p(Ne,Et):(gt=My(Ne),gt.c(),gt.m(St.parentNode,St)):gt&&(gt.d(1),gt=null),Et[0]&2&&Xt!==(Xt=sr(Ne[1].data.age.perc[2021].a65plus,"%",0)+"")&&Ct(xt,Xt),Ne[1].parents[0]?Le?Le.p(Ne,Et):(Le=Dy(Ne),Le.c(),Le.m(Ge.parentNode,Ge)):Le&&(Le.d(1),Le=null)},d(Ne){Ne&&O(h),Rt&&Rt.d(Ne),Ne&&O(a),Ne&&O(A),Ne&&O(I),yt&&yt.d(Ne),Ne&&O(H),Ne&&O(de),Ne&&O(Ce),gt&&gt.d(Ne),Ne&&O(St),Ne&&O(ut),Ne&&O(We),Le&&Le.d(Ne),Ne&&O(Ge)}}}function m1(c){let h,f,y=sr(c[1].data.age.perc[2021].a0to14,"%",0)+"",v,x,a,A,I=sr(c[1].data.age.perc[2011].a0to14,"%",0)+"",R,B,G,j,H,de,Ce=sr(c[1].data.age.perc[2021].a15to39,"%",0)+"",xe,Xe,Ue,Bt,St=sr(c[1].data.age.perc[2011].a15to39,"%",0)+"",ut,We,tr,Xt,xt,qt,Ge=sr(c[1].data.age.perc[2021].a40to64,"%",0)+"",Rt,yt,gt,Le,Ne=sr(c[1].data.age.perc[2011].a40to64,"%",0)+"",Et,mr,Wt,qe,$e,lr,gr=sr(c[1].data.age.perc[2021].a65plus,"%",0)+"",pi,ii,Zr,Gr,si=sr(c[1].data.age.perc[2011].a65plus,"%",0)+"",kt,ur;return{c(){h=ce("span"),f=we("0-14 years "),v=we(y),x=He(),a=ce("span"),A=we("(2011 "),R=we(I),B=we(")"),G=ce("br"),j=He(),H=ce("span"),de=we("15-39 years "),xe=we(Ce),Xe=He(),Ue=ce("span"),Bt=we("(2011 "),ut=we(St),We=we(")"),tr=ce("br"),Xt=He(),xt=ce("span"),qt=we("40-64 years "),Rt=we(Ge),yt=He(),gt=ce("span"),Le=we("(2011 "),Et=we(Ne),mr=we(")"),Wt=ce("br"),qe=He(),$e=ce("span"),lr=we("65+ years "),pi=we(gr),ii=He(),Zr=ce("span"),Gr=we("(2011 "),kt=we(si),ur=we(")"),this.h()},l(wt){h=he(wt,"SPAN",{class:!0});var Ht=fe(h);f=Se(Ht,"0-14 years "),v=Se(Ht,y),x=Je(Ht),Ht.forEach(O),a=he(wt,"SPAN",{class:!0,style:!0});var It=fe(a);A=Se(It,"(2011 "),R=Se(It,I),B=Se(It,")"),It.forEach(O),G=he(wt,"BR",{}),j=Je(wt),H=he(wt,"SPAN",{class:!0});var ei=fe(H);de=Se(ei,"15-39 years "),xe=Se(ei,Ce),Xe=Je(ei),ei.forEach(O),Ue=he(wt,"SPAN",{class:!0,style:!0});var Or=fe(Ue);Bt=Se(Or,"(2011 "),ut=Se(Or,St),We=Se(Or,")"),Or.forEach(O),tr=he(wt,"BR",{}),Xt=Je(wt),xt=he(wt,"SPAN",{class:!0});var li=fe(xt);qt=Se(li,"40-64 years "),Rt=Se(li,Ge),yt=Je(li),li.forEach(O),gt=he(wt,"SPAN",{class:!0,style:!0});var _n=fe(gt);Le=Se(_n,"(2011 "),Et=Se(_n,Ne),mr=Se(_n,")"),_n.forEach(O),Wt=he(wt,"BR",{}),qe=Je(wt),$e=he(wt,"SPAN",{class:!0});var Si=fe($e);lr=Se(Si,"65+ years "),pi=Se(Si,gr),ii=Je(Si),Si.forEach(O),Zr=he(wt,"SPAN",{class:!0,style:!0});var tn=fe(Zr);Gr=Se(tn,"(2011 "),kt=Se(tn,si),ur=Se(tn,")"),tn.forEach(O),this.h()},h(){U(h,"class","text-small"),U(a,"class","text-small"),De(a,"color","#3878C5"),U(H,"class","text-small"),U(Ue,"class","text-small"),De(Ue,"color","#3878C5"),U(xt,"class","text-small"),U(gt,"class","text-small"),De(gt,"color","#3878C5"),U($e,"class","text-small"),U(Zr,"class","text-small"),De(Zr,"color","#3878C5")},m(wt,Ht){Ie(wt,h,Ht),V(h,f),V(h,v),V(h,x),Ie(wt,a,Ht),V(a,A),V(a,R),V(a,B),Ie(wt,G,Ht),Ie(wt,j,Ht),Ie(wt,H,Ht),V(H,de),V(H,xe),V(H,Xe),Ie(wt,Ue,Ht),V(Ue,Bt),V(Ue,ut),V(Ue,We),Ie(wt,tr,Ht),Ie(wt,Xt,Ht),Ie(wt,xt,Ht),V(xt,qt),V(xt,Rt),V(xt,yt),Ie(wt,gt,Ht),V(gt,Le),V(gt,Et),V(gt,mr),Ie(wt,Wt,Ht),Ie(wt,qe,Ht),Ie(wt,$e,Ht),V($e,lr),V($e,pi),V($e,ii),Ie(wt,Zr,Ht),V(Zr,Gr),V(Zr,kt),V(Zr,ur)},p(wt,Ht){Ht[0]&2&&y!==(y=sr(wt[1].data.age.perc[2021].a0to14,"%",0)+"")&&Ct(v,y),Ht[0]&2&&I!==(I=sr(wt[1].data.age.perc[2011].a0to14,"%",0)+"")&&Ct(R,I),Ht[0]&2&&Ce!==(Ce=sr(wt[1].data.age.perc[2021].a15to39,"%",0)+"")&&Ct(xe,Ce),Ht[0]&2&&St!==(St=sr(wt[1].data.age.perc[2011].a15to39,"%",0)+"")&&Ct(ut,St),Ht[0]&2&&Ge!==(Ge=sr(wt[1].data.age.perc[2021].a40to64,"%",0)+"")&&Ct(Rt,Ge),Ht[0]&2&&Ne!==(Ne=sr(wt[1].data.age.perc[2011].a40to64,"%",0)+"")&&Ct(Et,Ne),Ht[0]&2&&gr!==(gr=sr(wt[1].data.age.perc[2021].a65plus,"%",0)+"")&&Ct(pi,gr),Ht[0]&2&&si!==(si=sr(wt[1].data.age.perc[2011].a65plus,"%",0)+"")&&Ct(kt,si)},d(wt){wt&&O(h),wt&&O(a),wt&&O(G),wt&&O(j),wt&&O(H),wt&&O(Ue),wt&&O(tr),wt&&O(Xt),wt&&O(xt),wt&&O(gt),wt&&O(Wt),wt&&O(qe),wt&&O($e),wt&&O(Zr)}}}function y1(c){let h,f,y=sr(c[1].data.age.perc[2021].a0to14,"%",0)+"",v,x,a,A,I,R,B,G=sr(c[1].data.age.perc[2021].a15to39,"%",0)+"",j,H,de,Ce,xe,Xe,Ue,Bt=sr(c[1].data.age.perc[2021].a40to64,"%",0)+"",St,ut,We,tr,Xt,xt,qt,Ge=sr(c[1].data.age.perc[2021].a65plus,"%",0)+"",Rt,yt,gt;return{c(){h=ce("span"),f=we("0-14 years "),v=we(y),x=He(),a=ce("span"),A=ce("br"),I=He(),R=ce("span"),B=we("15-39 years "),j=we(G),H=He(),de=ce("span"),Ce=ce("br"),xe=He(),Xe=ce("span"),Ue=we("40-64 years "),St=we(Bt),ut=He(),We=ce("span"),tr=ce("br"),Xt=He(),xt=ce("span"),qt=we("65+ years "),Rt=we(Ge),yt=He(),gt=ce("span"),this.h()},l(Le){h=he(Le,"SPAN",{class:!0});var Ne=fe(h);f=Se(Ne,"0-14 years "),v=Se(Ne,y),x=Je(Ne),Ne.forEach(O),a=he(Le,"SPAN",{class:!0,style:!0}),fe(a).forEach(O),A=he(Le,"BR",{}),I=Je(Le),R=he(Le,"SPAN",{class:!0});var Et=fe(R);B=Se(Et,"15-39 years "),j=Se(Et,G),H=Je(Et),Et.forEach(O),de=he(Le,"SPAN",{class:!0,style:!0}),fe(de).forEach(O),Ce=he(Le,"BR",{}),xe=Je(Le),Xe=he(Le,"SPAN",{class:!0});var mr=fe(Xe);Ue=Se(mr,"40-64 years "),St=Se(mr,Bt),ut=Je(mr),mr.forEach(O),We=he(Le,"SPAN",{class:!0,style:!0}),fe(We).forEach(O),tr=he(Le,"BR",{}),Xt=Je(Le),xt=he(Le,"SPAN",{class:!0});var Wt=fe(xt);qt=Se(Wt,"65+ years "),Rt=Se(Wt,Ge),yt=Je(Wt),Wt.forEach(O),gt=he(Le,"SPAN",{class:!0,style:!0}),fe(gt).forEach(O),this.h()},h(){U(h,"class","text-small"),U(a,"class","text-small"),De(a,"color","#3878C5"),U(R,"class","text-small"),U(de,"class","text-small"),De(de,"color","#3878C5"),U(Xe,"class","text-small"),U(We,"class","text-small"),De(We,"color","#3878C5"),U(xt,"class","text-small"),U(gt,"class","text-small"),De(gt,"color","#3878C5")},m(Le,Ne){Ie(Le,h,Ne),V(h,f),V(h,v),V(h,x),Ie(Le,a,Ne),Ie(Le,A,Ne),Ie(Le,I,Ne),Ie(Le,R,Ne),V(R,B),V(R,j),V(R,H),Ie(Le,de,Ne),Ie(Le,Ce,Ne),Ie(Le,xe,Ne),Ie(Le,Xe,Ne),V(Xe,Ue),V(Xe,St),V(Xe,ut),Ie(Le,We,Ne),Ie(Le,tr,Ne),Ie(Le,Xt,Ne),Ie(Le,xt,Ne),V(xt,qt),V(xt,Rt),V(xt,yt),Ie(Le,gt,Ne)},p(Le,Ne){Ne[0]&2&&y!==(y=sr(Le[1].data.age.perc[2021].a0to14,"%",0)+"")&&Ct(v,y),Ne[0]&2&&G!==(G=sr(Le[1].data.age.perc[2021].a15to39,"%",0)+"")&&Ct(j,G),Ne[0]&2&&Bt!==(Bt=sr(Le[1].data.age.perc[2021].a40to64,"%",0)+"")&&Ct(St,Bt),Ne[0]&2&&Ge!==(Ge=sr(Le[1].data.age.perc[2021].a65plus,"%",0)+"")&&Ct(Rt,Ge)},d(Le){Le&&O(h),Le&&O(a),Le&&O(A),Le&&O(I),Le&&O(R),Le&&O(de),Le&&O(Ce),Le&&O(xe),Le&&O(Xe),Le&&O(We),Le&&O(tr),Le&&O(Xt),Le&&O(xt),Le&&O(gt)}}}function Py(c){let h,f,y=sr(c[2].data.age.perc[2021].a0to14,"%",0)+"",v,x;return{c(){h=ce("span"),f=we("(NI "),v=we(y),x=we(")"),this.h()},l(a){h=he(a,"SPAN",{class:!0,style:!0});var A=fe(h);f=Se(A,"(NI "),v=Se(A,y),x=Se(A,")"),A.forEach(O),this.h()},h(){U(h,"class","text-small"),De(h,"color","#3878C5")},m(a,A){Ie(a,h,A),V(h,f),V(h,v),V(h,x)},p(a,A){A[0]&4&&y!==(y=sr(a[2].data.age.perc[2021].a0to14,"%",0)+"")&&Ct(v,y)},d(a){a&&O(h)}}}function Cy(c){let h,f,y=sr(c[2].data.age.perc[2021].a15to39,"%",0)+"",v,x;return{c(){h=ce("span"),f=we("(NI "),v=we(y),x=we(")"),this.h()},l(a){h=he(a,"SPAN",{class:!0,style:!0});var A=fe(h);f=Se(A,"(NI "),v=Se(A,y),x=Se(A,")"),A.forEach(O),this.h()},h(){U(h,"class","text-small"),De(h,"color","#3878C5")},m(a,A){Ie(a,h,A),V(h,f),V(h,v),V(h,x)},p(a,A){A[0]&4&&y!==(y=sr(a[2].data.age.perc[2021].a15to39,"%",0)+"")&&Ct(v,y)},d(a){a&&O(h)}}}function My(c){let h,f,y=sr(c[2].data.age.perc[2021].a40to64,"%",0)+"",v,x;return{c(){h=ce("span"),f=we("(NI "),v=we(y),x=we(")"),this.h()},l(a){h=he(a,"SPAN",{class:!0,style:!0});var A=fe(h);f=Se(A,"(NI "),v=Se(A,y),x=Se(A,")"),A.forEach(O),this.h()},h(){U(h,"class","text-small"),De(h,"color","#3878C5")},m(a,A){Ie(a,h,A),V(h,f),V(h,v),V(h,x)},p(a,A){A[0]&4&&y!==(y=sr(a[2].data.age.perc[2021].a40to64,"%",0)+"")&&Ct(v,y)},d(a){a&&O(h)}}}function Dy(c){let h,f,y=sr(c[2].data.age.perc[2021].a65plus,"%",0)+"",v,x;return{c(){h=ce("span"),f=we("(NI "),v=we(y),x=we(")"),this.h()},l(a){h=he(a,"SPAN",{class:!0,style:!0});var A=fe(h);f=Se(A,"(NI "),v=Se(A,y),x=Se(A,")"),A.forEach(O),this.h()},h(){U(h,"class","text-small"),De(h,"color","#3878C5")},m(a,A){Ie(a,h,A),V(h,f),V(h,v),V(h,x)},p(a,A){A[0]&4&&y!==(y=sr(a[2].data.age.perc[2021].a65plus,"%",0)+"")&&Ct(v,y)},d(a){a&&O(h)}}}function g1(c){let h,f,y,v,x,a;const A=[La[c[38]],{id:c[38]+"-fill"},{type:"fill"},{isChild:c[8][c[38]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[38]||c[7].childType==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Rr["fill-self"]:c[7].childType==c[38]?Rr["fill-child"]:Rr.fill}];let I={};for(let H=0;H<A.length;H+=1)I=Tu(I,A[H]);h=new Oc({props:I}),h.$on("select",c[13]);const R=[La[c[38]],{id:c[38]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[38]||c[7].childType==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Rr["line-active"]:c[7].childType==c[38]?Rr["line-child"]:Rr.line}];let B={};for(let H=0;H<R.length;H+=1)B=Tu(B,R[H]);y=new Oc({props:B});const G=[La[c[38]],{id:c[38]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Rr["line-self"]:Rr.line}];let j={};for(let H=0;H<G.length;H+=1)j=Tu(j,G[H]);return x=new Oc({props:j}),{c(){Jr(h.$$.fragment),f=He(),Jr(y.$$.fragment),v=He(),Jr(x.$$.fragment)},l(H){Yr(h.$$.fragment,H),f=Je(H),Yr(y.$$.fragment,H),v=Je(H),Yr(x.$$.fragment,H)},m(H,de){Qr(h,H,de),Ie(H,f,de),Qr(y,H,de),Ie(H,v,de),Qr(x,H,de),a=!0},p(H,de){const Ce=de[0]&384?Iu(A,[de&0&&Au(La[H[38]]),A[1],A[2],de[0]&256&&{isChild:H[8][H[38]]},A[4],de[0]&128&&{selected:H[7].selected},A[6],de[0]&128&&{highlighted:H[7].highlighted},A[8],de[0]&128&&{hovered:H[7].hovered},de[0]&128&&{layout:{visibility:H[7].type==H[38]||H[7].childType==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Rr["fill-self"]:H[7].childType==H[38]?Rr["fill-child"]:Rr.fill}]):{};h.$set(Ce);const xe=de[0]&128?Iu(R,[de&0&&Au(La[H[38]]),R[1],R[2],de[0]&128&&{selected:H[7].selected},R[4],de[0]&128&&{highlighted:H[7].highlighted},de[0]&128&&{layout:{visibility:H[7].type==H[38]||H[7].childType==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Rr["line-active"]:H[7].childType==H[38]?Rr["line-child"]:Rr.line}]):{};y.$set(xe);const Xe=de[0]&128?Iu(G,[de&0&&Au(La[H[38]]),G[1],G[2],de[0]&128&&{selected:H[7].selected},de[0]&128&&{layout:{visibility:H[7].type==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Rr["line-self"]:Rr.line}]):{};x.$set(Xe)},i(H){a||(bt(h.$$.fragment,H),bt(y.$$.fragment,H),bt(x.$$.fragment,H),a=!0)},o(H){Ot(h.$$.fragment,H),Ot(y.$$.fragment,H),Ot(x.$$.fragment,H),a=!1},d(H){$r(h,H),H&&O(f),$r(y,H),H&&O(v),$r(x,H)}}}function Ly(c){let h,f;const y=[sf[c[38]]];let v={$$slots:{default:[g1]},$$scope:{ctx:c}};for(let x=0;x<y.length;x+=1)v=Tu(v,y[x]);return h=new pg({props:v}),{c(){Jr(h.$$.fragment)},l(x){Yr(h.$$.fragment,x)},m(x,a){Qr(h,x,a),f=!0},p(x,a){const A=a&0?Iu(y,[Au(sf[x[38]])]):{};a[0]&384|a[1]&8192&&(A.$$scope={dirty:a,ctx:x}),h.$set(A)},i(x){f||(bt(h.$$.fragment,x),f=!0)},o(x){Ot(h.$$.fragment,x),f=!1},d(x){$r(h,x)}}}function Ry(c){let h,f,y,v,x,a;const A=[La[c[38]],{id:c[38]+"-fill"},{type:"fill"},{isChild:c[8][c[38]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[38]||c[7].childType==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Rr["fill-self"]:c[7].childType==c[38]?Rr["fill-child"]:Rr.fill}];let I={};for(let H=0;H<A.length;H+=1)I=Tu(I,A[H]);h=new Oc({props:I}),h.$on("select",c[13]);const R=[La[c[38]],{id:c[38]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[38]||c[7].childType==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Rr["line-active"]:c[7].childType==c[38]?Rr["line-child"]:Rr.line}];let B={};for(let H=0;H<R.length;H+=1)B=Tu(B,R[H]);y=new Oc({props:B});const G=[La[c[38]],{id:c[38]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Rr["line-self"]:Rr.line}];let j={};for(let H=0;H<G.length;H+=1)j=Tu(j,G[H]);return x=new Oc({props:j}),{c(){Jr(h.$$.fragment),f=He(),Jr(y.$$.fragment),v=He(),Jr(x.$$.fragment)},l(H){Yr(h.$$.fragment,H),f=Je(H),Yr(y.$$.fragment,H),v=Je(H),Yr(x.$$.fragment,H)},m(H,de){Qr(h,H,de),Ie(H,f,de),Qr(y,H,de),Ie(H,v,de),Qr(x,H,de),a=!0},p(H,de){const Ce=de[0]&384?Iu(A,[de&0&&Au(La[H[38]]),A[1],A[2],de[0]&256&&{isChild:H[8][H[38]]},A[4],de[0]&128&&{selected:H[7].selected},A[6],de[0]&128&&{highlighted:H[7].highlighted},A[8],de[0]&128&&{hovered:H[7].hovered},de[0]&128&&{layout:{visibility:H[7].type==H[38]||H[7].childType==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Rr["fill-self"]:H[7].childType==H[38]?Rr["fill-child"]:Rr.fill}]):{};h.$set(Ce);const xe=de[0]&128?Iu(R,[de&0&&Au(La[H[38]]),R[1],R[2],de[0]&128&&{selected:H[7].selected},R[4],de[0]&128&&{highlighted:H[7].highlighted},de[0]&128&&{layout:{visibility:H[7].type==H[38]||H[7].childType==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Rr["line-active"]:H[7].childType==H[38]?Rr["line-child"]:Rr.line}]):{};y.$set(xe);const Xe=de[0]&128?Iu(G,[de&0&&Au(La[H[38]]),G[1],G[2],de[0]&128&&{selected:H[7].selected},de[0]&128&&{layout:{visibility:H[7].type==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Rr["line-self"]:Rr.line}]):{};x.$set(Xe)},i(H){a||(bt(h.$$.fragment,H),bt(y.$$.fragment,H),bt(x.$$.fragment,H),a=!0)},o(H){Ot(h.$$.fragment,H),Ot(y.$$.fragment,H),Ot(x.$$.fragment,H),a=!1},d(H){$r(h,H),H&&O(f),$r(y,H),H&&O(v),$r(x,H)}}}function _1(c){let h,f,y=["lgd"],v=[];for(let a=0;a<1;a+=1)v[a]=Ry(_y(c,y,a));const x=a=>Ot(v[a],1,1,()=>{v[a]=null});return{c(){for(let a=0;a<1;a+=1)v[a].c();h=ki()},l(a){for(let A=0;A<1;A+=1)v[A].l(a);h=ki()},m(a,A){for(let I=0;I<1;I+=1)v[I].m(a,A);Ie(a,h,A),f=!0},p(a,A){if(A[0]&8576){y=["lgd"];let I;for(I=0;I<1;I+=1){const R=_y(a,y,I);v[I]?(v[I].p(R,A),bt(v[I],1)):(v[I]=Ry(R),v[I].c(),bt(v[I],1),v[I].m(h.parentNode,h))}for(As(),I=1;I<1;I+=1)x(I);zs()}},i(a){if(!f){for(let A=0;A<1;A+=1)bt(v[A]);f=!0}},o(a){v=v.filter(Boolean);for(let A=0;A<1;A+=1)Ot(v[A]);f=!1},d(a){Js(v,a),a&&O(h)}}}function v1(c){let h,f,y,v=["dea"],x=[];for(let R=0;R<1;R+=1)x[R]=Ly(vy(c,v,R));const a=R=>Ot(x[R],1,1,()=>{x[R]=null}),A=[sf.crd];let I={$$slots:{default:[_1]},$$scope:{ctx:c}};for(let R=0;R<A.length;R+=1)I=Tu(I,A[R]);return f=new pg({props:I}),{c(){for(let R=0;R<1;R+=1)x[R].c();h=He(),Jr(f.$$.fragment)},l(R){for(let B=0;B<1;B+=1)x[B].l(R);h=Je(R),Yr(f.$$.fragment,R)},m(R,B){for(let G=0;G<1;G+=1)x[G].m(R,B);Ie(R,h,B),Qr(f,R,B),y=!0},p(R,B){if(B[0]&8576){v=["dea"];let j;for(j=0;j<1;j+=1){const H=vy(R,v,j);x[j]?(x[j].p(H,B),bt(x[j],1)):(x[j]=Ly(H),x[j].c(),bt(x[j],1),x[j].m(h.parentNode,h))}for(As(),j=1;j<1;j+=1)a(j);zs()}const G=B&0?Iu(A,[Au(sf.crd)]):{};B[0]&384|B[1]&8192&&(G.$$scope={dirty:B,ctx:R}),f.$set(G)},i(R){if(!y){for(let B=0;B<1;B+=1)bt(x[B]);bt(f.$$.fragment,R),y=!0}},o(R){x=x.filter(Boolean);for(let B=0;B<1;B+=1)Ot(x[B]);Ot(f.$$.fragment,R),y=!1},d(R){Js(x,R),R&&O(h),$r(f,R)}}}function By(c){let h,f=[...c[1].parents].reverse(),y=[];for(let v=0;v<f.length;v+=1)y[v]=Oy(gy(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=ki()},l(v){for(let x=0;x<y.length;x+=1)y[x].l(v);h=ki()},m(v,x){for(let a=0;a<y.length;a+=1)y[a].m(v,x);Ie(v,h,x)},p(v,x){if(x[0]&2){f=[...v[1].parents].reverse();let a;for(a=0;a<f.length;a+=1){const A=gy(v,f,a);y[a]?y[a].p(A,x):(y[a]=Oy(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){Js(y,v),v&&O(h)}}}function Oy(c){let h,f=c[1].name+"",y,v,x,a,A=c[36].name+"",I,R;return{c(){h=ce("span"),y=we(f),v=we(" is located in "),x=ce("span"),a=ce("a"),I=we(A),this.h()},l(B){h=he(B,"SPAN",{});var G=fe(h);y=Se(G,f),v=Se(G," is located in "),G.forEach(O),x=he(B,"SPAN",{class:!0});var j=fe(x);a=he(j,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var H=fe(a);I=Se(H,A),H.forEach(O),j.forEach(O),this.h()},h(){U(a,"href",R=El+"/"+c[36].code+"/"),U(a,"sveltekit:noscroll",""),U(a,"class","svelte-ls2yfr"),U(x,"class","text-bold")},m(B,G){Ie(B,h,G),V(h,y),V(h,v),Ie(B,x,G),V(x,a),V(a,I)},p(B,G){G[0]&2&&f!==(f=B[1].name+"")&&Ct(y,f),G[0]&2&&A!==(A=B[36].name+"")&&Ct(I,A),G[0]&2&&R!==(R=El+"/"+B[36].code+"/")&&U(a,"href",R)},d(B){B&&O(h),B&&O(x)}}}function b1(c){let h,f,y=c[1].name+"",v;return{c(){h=ce("span"),f=we("No areas within "),v=we(y),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);f=Se(a,"No areas within "),v=Se(a,y),a.forEach(O),this.h()},h(){U(h,"class","muted")},m(x,a){Ie(x,h,a),V(h,f),V(h,v)},p(x,a){a[0]&2&&y!==(y=x[1].name+"")&&Ct(v,y)},d(x){x&&O(h)}}}function x1(c){let h,f,y,v,x,a=c[2].children,A=[];for(let I=0;I<a.length;I+=1)A[I]=Fy(yy(c,a,I));return{c(){h=ce("span"),f=we("Districts within Northern Ireland"),y=ce("br"),v=He();for(let I=0;I<A.length;I+=1)A[I].c();x=ki(),this.h()},l(I){h=he(I,"SPAN",{class:!0});var R=fe(h);f=Se(R,"Districts within Northern Ireland"),R.forEach(O),y=he(I,"BR",{}),v=Je(I);for(let B=0;B<A.length;B+=1)A[B].l(I);x=ki(),this.h()},h(){U(h,"class","text-bold")},m(I,R){Ie(I,h,R),V(h,f),Ie(I,y,R),Ie(I,v,R);for(let B=0;B<A.length;B+=1)A[B].m(I,R);Ie(I,x,R)},p(I,R){if(R[0]&4){a=I[2].children;let B;for(B=0;B<a.length;B+=1){const G=yy(I,a,B);A[B]?A[B].p(G,R):(A[B]=Fy(G),A[B].c(),A[B].m(x.parentNode,x))}for(;B<A.length;B+=1)A[B].d(1);A.length=a.length}},d(I){I&&O(h),I&&O(y),I&&O(v),Js(A,I),I&&O(x)}}}function Fy(c){let h,f,y=c[33].name+"",v,x,a=(c[35]<c[2].children.length-1,""),A;return{c(){h=ce("li"),f=ce("a"),v=we(y),A=we(a),this.h()},l(I){h=he(I,"LI",{style:!0});var R=fe(h);f=he(R,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var B=fe(f);v=Se(B,y),B.forEach(O),A=Se(R,a),R.forEach(O),this.h()},h(){U(f,"href",x=El+"/"+c[33].code+"/"),U(f,"sveltekit:noscroll",""),U(f,"class","svelte-ls2yfr"),De(h,"margin","3px"),De(h,"display","block"),De(h,"line-height","20px"),De(h,"padding-bottom","5px")},m(I,R){Ie(I,h,R),V(h,f),V(f,v),V(h,A)},p(I,R){R[0]&4&&y!==(y=I[33].name+"")&&Ct(v,y),R[0]&4&&x!==(x=El+"/"+I[33].code+"/")&&U(f,"href",x),R[0]&4&&a!==(a=(I[35]<I[2].children.length-1,""))&&Ct(A,a)},d(I){I&&O(h)}}}function w1(c){let h,f,y=c[1]&&c[2]&&xy(c);return{c(){y&&y.c(),h=ki()},l(v){y&&y.l(v),h=ki()},m(v,x){y&&y.m(v,x),Ie(v,h,x),f=!0},p(v,x){v[1]&&v[2]?y?(y.p(v,x),x[0]&6&&bt(y,1)):(y=xy(v),y.c(),bt(y,1),y.m(h.parentNode,h)):y&&(As(),Ot(y,1,1,()=>{y=null}),zs())},i(v){f||(bt(y),f=!0)},o(v){Ot(y),f=!1},d(v){y&&y.d(v),v&&O(h)}}}function S1(c){let h,f,y,v,x,a,A,I,R,B,G,j,H,de;return document.title=h=c[1].name+" Census Data",H=new Hg({props:{column:"wide",$$slots:{default:[w1]},$$scope:{ctx:c}}}),{c(){f=ce("meta"),y=ce("meta"),x=ce("meta"),a=ce("meta"),I=ce("meta"),B=ce("meta"),j=He(),Jr(H.$$.fragment),this.h()},l(Ce){const xe=Kg('[data-svelte="svelte-wtlqhu"]',document.head);f=he(xe,"META",{name:!0,content:!0}),y=he(xe,"META",{property:!0,content:!0}),x=he(xe,"META",{property:!0,content:!0}),a=he(xe,"META",{property:!0,content:!0}),I=he(xe,"META",{property:!0,content:!0}),B=he(xe,"META",{name:!0,content:!0}),xe.forEach(O),j=Je(Ce),Yr(H.$$.fragment,Ce),this.h()},h(){U(f,"name","description"),U(f,"content",""),U(y,"property","og:title"),U(y,"content",v=c[1].name+" Census Data"),U(x,"property","og:type"),U(x,"content","website"),U(a,"property","og:url"),U(a,"content",A=af.base+"/"+c[1].code+"/"),U(I,"property","og:description"),U(I,"content",R="Explore census data for "+c[1].name+"."),U(B,"name","description"),U(B,"content",G="Explore census data for "+c[1].name+".")},m(Ce,xe){V(document.head,f),V(document.head,y),V(document.head,x),V(document.head,a),V(document.head,I),V(document.head,B),Ie(Ce,j,xe),Qr(H,Ce,xe),de=!0},p(Ce,xe){(!de||xe[0]&2)&&h!==(h=Ce[1].name+" Census Data")&&(document.title=h),(!de||xe[0]&2&&v!==(v=Ce[1].name+" Census Data"))&&U(y,"content",v),(!de||xe[0]&2&&A!==(A=af.base+"/"+Ce[1].code+"/"))&&U(a,"content",A),(!de||xe[0]&2&&R!==(R="Explore census data for "+Ce[1].name+"."))&&U(I,"content",R),(!de||xe[0]&2&&G!==(G="Explore census data for "+Ce[1].name+"."))&&U(B,"content",G);const Xe={};xe[0]&4095|xe[1]&8192&&(Xe.$$scope={dirty:xe,ctx:Ce}),H.$set(Xe)},i(Ce){de||(bt(H.$$.fragment,Ce),de=!0)},o(Ce){Ot(H.$$.fragment,Ce),de=!1},d(Ce){O(f),O(y),O(x),O(a),O(I),O(B),Ce&&O(j),$r(H,Ce)}}}const z1=!0;async function Ny(c,h){return await(await h(af.places+c+".json")).json()}async function P1({params:c,fetch:h}){let f=c.code,y=await o_(af.options,h),v={};y.forEach(I=>v[I.code]=I.name),y.forEach(I=>{I.typepl=zh[I.type].pl,I.typenm=zh[I.type].name,I.typestr=v[I.parent]?`${zh[I.type].name} within ${v[I.parent]}`:""});let x=y.sort((I,R)=>I.name.localeCompare(R.name)),a=await Ny("N92000002",h),A=await Ny(f,h);return{props:{options:x,place:A,ew:a}}}function E1(c,h,f){let y,v,x,{options:a,place:A,ew:I}=h,R,B,G=null,j=!1,H={selected:null,type:null,childType:null,highlighted:[],hovered:null},de={};Object.keys(La).forEach(qe=>f(8,de[qe]=!1,de));function Ce(qe){const $e=(ur,wt)=>ur+wt;let lr=qe[0],gr=qe[1],pi=A.data[lr][gr][2021],ii=A.data[lr][gr][2011],Zr=I.data[lr][gr][2021],Gr=gm[lr].map(ur=>ur.code),si=gm[lr].map(ur=>ur.label?ur.label:ur.code);return Gr.map((ur,wt)=>Array.isArray(ur)?{x:si[wt],y:ur.map(Ht=>pi[Ht]).reduce($e,0),ew:ur.map(Ht=>Zr[Ht]).reduce($e,0),prev:ur.map(Ht=>ii[Ht]).reduce($e,0)}:{x:si[wt],y:pi[ur],ew:Zr[ur],prev:ii[ur]})}function xe(qe){G&&G.fitBounds(qe,{padding:20})}function Xe(qe){let $e=JSON.parse(JSON.stringify(H)),lr=qe.code,gr=qe.type,pi=qe.children[0]?qe.children.map(kt=>kt.code):[],ii=qe.type=="rgn"?"cty":pi[0]?qe.children[0].type:null;f(7,H.selected=lr,H),f(7,H.type=gr,H),f(7,H.childType=ii,H),f(7,H.highlighted=pi,H);let Zr=Object.keys(La),Gr=["fill-color","fill-opacity"],si=["line-color","line-width","line-opacity"];G&&(H.type!=$e.type||H.childType!=$e.childType)&&(Zr.forEach(kt=>{let ur=kt==gr||ii&&kt==ii?"visible":"none";G.setLayoutProperty(kt+"-fill","visibility",ur),G.setLayoutProperty(kt+"-bounds","visibility",ur),qe.parents[0]&&G.setLayoutProperty(kt+"-self","visibility",ur),f(8,de[kt]=kt==ii,de)}),qe.parents[0]&&(Gr.forEach(kt=>G.setPaintProperty(gr+"-fill",kt,Rr[pi[0]?"fill-active":"fill-self"][kt])),si.forEach(kt=>{G.setPaintProperty(gr+"-bounds",kt,Rr["line-active"][kt]),G.setPaintProperty(gr+"-self",kt,Rr["line-self"][kt])})),ii&&(Gr.forEach(kt=>G.setPaintProperty(ii+"-fill",kt,Rr["fill-child"][kt])),si.forEach(kt=>G.setPaintProperty(ii+"-bounds",kt,Rr["line-child"][kt]))))}function Ue(qe){Xe(qe),xe(qe.bounds)}function Bt(qe){xm(`${El}/${qe.detail.code}/`,{noscroll:!0})}function St(qe){xm(`${El}/${qe.detail.value}/`,{noscroll:!0})}function ut(){f(5,B=R<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}const We=()=>f(9,x=!0),tr=()=>f(4,j=!1),Xt=()=>f(10,v=!1),xt=()=>f(10,v=!0),qt=()=>f(9,x=!1),Ge=()=>f(4,j=!1),Rt=()=>f(4,j=!0),yt=()=>f(9,x=!1),gt=()=>f(10,v=!1);function Le(qe){G=qe,f(6,G)}function Ne(){R=this.clientWidth,f(3,R)}function Et(){R=this.clientWidth,f(3,R)}function mr(){R=this.clientWidth,f(3,R)}function Wt(){R=this.clientWidth,f(3,R)}return c.$$set=qe=>{"options"in qe&&f(0,a=qe.options),"place"in qe&&f(1,A=qe.place),"ew"in qe&&f(2,I=qe.ew)},c.$$.update=()=>{c.$$.dirty[0]&8&&R&&ut(),c.$$.dirty[0]&18&&f(11,y=j?"2011 comparison":A&&A.parents[0]?"Northern Ireland comparison":null),c.$$.dirty[0]&2&&A&&Ue(A)},f(10,v=!1),f(9,x=!0),[a,A,I,R,j,B,G,H,de,x,v,y,Ce,Bt,St,We,tr,Xt,xt,qt,Ge,Rt,yt,gt,Le,Ne,Et,mr,Wt]}class C1 extends Ba{constructor(h){super(),Oa(this,h,E1,S1,Fa,{options:0,place:1,ew:2},null,[-1,-1])}}export{C1 as default,P1 as load,z1 as prerender};
