import{S as qa,i as Za,s as Ga,e as Ei,b as ke,f as bt,g as Ls,t as Ft,d as Rs,h as O,o as Vy,U as Qt,V as Lr,j as Uy,O as Fc,l as ce,m as he,n as fe,p as U,W as Lc,q as Ce,X as Rc,Q as Nc,R as Vc,T as Uc,Y as Kl,Z as Eo,_ as ko,I as N,K as Gh,E as jo,$ as Ys,J as rn,r as xe,u as we,v as At,w as Gr,x as Kr,y as Xr,B as Hr,a as Je,c as Ye,M as Qn,G as nc,a0 as jy,a1 as ym,P as Kg,a2 as Xg,a3 as qy,a4 as Zy,a5 as Hg,a6 as rf,C as ku,z as Tu,A as Iu}from"../../chunks/index-50f9e43e.js";import{a as Vh,u as nf,S as Wg,m as Ua,c as gm,b as Jg,d as Br,e as of}from"../../chunks/Section-f82c33d7.js";import{b as xl}from"../../chunks/paths-1c47712a.js";import{c as oc,w as Rr,d as dn}from"../../chunks/singletons-2c3f9d32.js";var _m={},Gf={},Kf=34,Oh=10,Xf=13;function Gy(c){return new Function("d","return {"+c.map(function(h,f){return JSON.stringify(h)+": d["+f+'] || ""'}).join(",")+"}")}function Yg(c,h){var f=Gy(c);return function(y,v){return h(f(y),v,c)}}function vm(c){var h=Object.create(null),f=[];return c.forEach(function(y){for(var v in y)v in h||f.push(h[v]=v)}),f}function Va(c,h){var f=c+"",y=f.length;return y<h?new Array(h-y+1).join(0)+f:f}function Qg(c){return c<0?"-"+Va(-c,6):c>9999?"+"+Va(c,6):Va(c,4)}function $g(c){var h=c.getUTCHours(),f=c.getUTCMinutes(),y=c.getUTCSeconds(),v=c.getUTCMilliseconds();return isNaN(c)?"Invalid Date":Qg(c.getUTCFullYear())+"-"+Va(c.getUTCMonth()+1,2)+"-"+Va(c.getUTCDate(),2)+(v?"T"+Va(h,2)+":"+Va(f,2)+":"+Va(y,2)+"."+Va(v,3)+"Z":y?"T"+Va(h,2)+":"+Va(f,2)+":"+Va(y,2)+"Z":f||h?"T"+Va(h,2)+":"+Va(f,2)+"Z":"")}function e_(c){var h=new RegExp('["'+c+`
\r]`),f=c.charCodeAt(0);function y(K,j){var H,de,Me=v(K,function(Se,He){if(H)return H(Se,He-1);de=Se,H=j?Yg(Se,j):Gy(Se)});return Me.columns=de||[],Me}function v(K,j){var H=[],de=K.length,Me=0,Se=0,He,Ue=de<=0,Rt=!1;K.charCodeAt(de-1)===Oh&&--de,K.charCodeAt(de-1)===Xf&&--de;function kt(){if(Ue)return Gf;if(Rt)return Rt=!1,_m;var We,tr=Me,Gt;if(K.charCodeAt(tr)===Kf){for(;Me++<de&&K.charCodeAt(Me)!==Kf||K.charCodeAt(++Me)===Kf;);return(We=Me)>=de?Ue=!0:(Gt=K.charCodeAt(Me++))===Oh?Rt=!0:Gt===Xf&&(Rt=!0,K.charCodeAt(Me)===Oh&&++Me),K.slice(tr+1,We-1).replace(/""/g,'"')}for(;Me<de;){if((Gt=K.charCodeAt(We=Me++))===Oh)Rt=!0;else if(Gt===Xf)Rt=!0,K.charCodeAt(Me)===Oh&&++Me;else if(Gt!==f)continue;return K.slice(tr,We)}return Ue=!0,K.slice(tr,de)}for(;(He=kt())!==Gf;){for(var ut=[];He!==_m&&He!==Gf;)ut.push(He),He=kt();j&&(ut=j(ut,Se++))==null||H.push(ut)}return H}function x(K,j){return K.map(function(H){return j.map(function(de){return B(H[de])}).join(c)})}function a(K,j){return j==null&&(j=vm(K)),[j.map(B).join(c)].concat(x(K,j)).join(`
`)}function A(K,j){return j==null&&(j=vm(K)),x(K,j).join(`
`)}function I(K){return K.map(R).join(`
`)}function R(K){return K.map(B).join(c)}function B(K){return K==null?"":K instanceof Date?$g(K):h.test(K+="")?'"'+K.replace(/"/g,'""')+'"':K}return{parse:y,parseRows:v,format:a,formatBody:A,formatRows:I,formatRow:R,formatValue:B}}var t_=e_(","),r_=t_.parse;function i_(c){for(var h in c){var f=c[h].trim(),y,v;if(!f)f=null;else if(f==="true")f=!0;else if(f==="false")f=!1;else if(f==="NaN")f=NaN;else if(!isNaN(y=+f))f=y;else if(v=f.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))n_&&!!v[4]&&!v[7]&&(f=f.replace(/-/g,"/").replace(/T/," ")),f=new Date(f);else continue;c[h]=f}return c}const n_=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();async function o_(c,h=window.fetch){let y=await(await h(c)).text();return await r_(y,i_)}function Au(c){let h=Math.round(c)%10;return c==11?"th":h==1?"st":h==2?"nd":h==3?"rd":"th"}function af(c){return c>0?"increase":c<0?"decrease":"nochange"}function or(c,h="",f=0){return c!=0?Math.abs(c).toFixed(f)+h:h=="pp"?"n/c":"No change"}function bm(c,h="",f=0){return c!=0?Math.abs(c).toFixed(f)+h:h=="pp"?"n/c":"<1%)"}oc.disable_scroll_handling;const xm=oc.goto;oc.invalidate;oc.prefetch;oc.prefetch_routes;oc.before_navigate;oc.after_navigate;function a_(c){return c===0?!0:c}function Eu(c){return a_(c)?Array.isArray(c)?h=>c.map(f=>typeof f!="function"?h[f]:f(h)):typeof c!="function"?h=>h[c]:c:null}function s_(c){const h={};for(const f of c){if(Object(f)!==f)throw new TypeError("iterable for fromEntries should yield objects");const{"0":y,"1":v}=f;Object.defineProperty(h,y,{configurable:!0,enumerable:!0,writable:!0,value:v})}return h}function Hf(c,h={}){return s_(Object.entries(c).filter(([f,y])=>y!==void 0&&h[f]===void 0))}function l_(c,h){if(!Array.isArray(c))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof c}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(h)||h===void 0||h===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const f={},y=Object.keys(h),v=y.length;let x,a,A,I,R,B,K,j;const H=c.length;for(x=0;x<v;x+=1){for(I=y[x],K=h[I],R=null,B=null,a=0;a<H;a+=1)if(j=K(c[a]),Array.isArray(j)){const de=j.length;for(A=0;A<de;A+=1)j[A]!==void 0&&j[A]!==null&&Number.isNaN(j[A])===!1&&((R===null||j[A]<R)&&(R=j[A]),(B===null||j[A]>B)&&(B=j[A]))}else j!=null&&Number.isNaN(j)===!1&&((R===null||j<R)&&(R=j),(B===null||j>B)&&(B=j));f[I]=[R,B]}return f}function Ky(c=[],h){return Array.isArray(h)===!0?h.map((f,y)=>f===null?c[y]:f):c}function Gp(c){return function([f,y]){return f?Ky(f[c],y):y}}function ef(c,h){return c==null||h==null?NaN:c<h?-1:c>h?1:c>=h?0:NaN}function u_(c,h){return c==null||h==null?NaN:h<c?-1:h>c?1:h>=c?0:NaN}function Xy(c){let h,f,y;c.length!==2?(h=ef,f=(A,I)=>ef(c(A),I),y=(A,I)=>c(A)-I):(h=c===ef||c===u_?c:c_,f=c,y=c);function v(A,I,R=0,B=A.length){if(R<B){if(h(I,I)!==0)return B;do{const K=R+B>>>1;f(A[K],I)<0?R=K+1:B=K}while(R<B)}return R}function x(A,I,R=0,B=A.length){if(R<B){if(h(I,I)!==0)return B;do{const K=R+B>>>1;f(A[K],I)<=0?R=K+1:B=K}while(R<B)}return R}function a(A,I,R=0,B=A.length){const K=v(A,I,R,B-1);return K>R&&y(A[K-1],I)>-y(A[K],I)?K-1:K}return{left:v,center:a,right:x}}function c_(){return 0}function h_(c){return c===null?NaN:+c}const p_=Xy(ef),f_=p_.right;Xy(h_).center;const d_=f_;class wm extends Map{constructor(h,f=g_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:f}}),h!=null)for(const[y,v]of h)this.set(y,v)}get(h){return super.get(Sm(this,h))}has(h){return super.has(Sm(this,h))}set(h,f){return super.set(m_(this,h),f)}delete(h){return super.delete(y_(this,h))}}function Sm({_intern:c,_key:h},f){const y=h(f);return c.has(y)?c.get(y):f}function m_({_intern:c,_key:h},f){const y=h(f);return c.has(y)?c.get(y):(c.set(y,f),f)}function y_({_intern:c,_key:h},f){const y=h(f);return c.has(y)&&(f=c.get(y),c.delete(y)),f}function g_(c){return c!==null&&typeof c=="object"?c.valueOf():c}var ed=Math.sqrt(50),td=Math.sqrt(10),rd=Math.sqrt(2);function __(c,h,f){var y,v=-1,x,a,A;if(h=+h,c=+c,f=+f,c===h&&f>0)return[c];if((y=h<c)&&(x=c,c=h,h=x),(A=Hy(c,h,f))===0||!isFinite(A))return[];if(A>0){let I=Math.round(c/A),R=Math.round(h/A);for(I*A<c&&++I,R*A>h&&--R,a=new Array(x=R-I+1);++v<x;)a[v]=(I+v)*A}else{A=-A;let I=Math.round(c*A),R=Math.round(h*A);for(I/A<c&&++I,R/A>h&&--R,a=new Array(x=R-I+1);++v<x;)a[v]=(I+v)/A}return y&&a.reverse(),a}function Hy(c,h,f){var y=(h-c)/Math.max(0,f),v=Math.floor(Math.log(y)/Math.LN10),x=y/Math.pow(10,v);return v>=0?(x>=ed?10:x>=td?5:x>=rd?2:1)*Math.pow(10,v):-Math.pow(10,-v)/(x>=ed?10:x>=td?5:x>=rd?2:1)}function v_(c,h,f){var y=Math.abs(h-c)/Math.max(0,f),v=Math.pow(10,Math.floor(Math.log(y)/Math.LN10)),x=y/v;return x>=ed?v*=10:x>=td?v*=5:x>=rd&&(v*=2),h<c?-v:v}function b_(c,h,f){c=+c,h=+h,f=(v=arguments.length)<2?(h=c,c=0,1):v<3?1:+f;for(var y=-1,v=Math.max(0,Math.ceil((h-c)/f))|0,x=new Array(v);++y<v;)x[y]=c+y*f;return x}function pf(c,h){switch(arguments.length){case 0:break;case 1:this.range(c);break;default:this.range(h).domain(c);break}return this}const Em=Symbol("implicit");function Wy(){var c=new wm,h=[],f=[],y=Em;function v(x){let a=c.get(x);if(a===void 0){if(y!==Em)return y;c.set(x,a=h.push(x)-1)}return f[a%f.length]}return v.domain=function(x){if(!arguments.length)return h.slice();h=[],c=new wm;for(const a of x)c.has(a)||c.set(a,h.push(a)-1);return v},v.range=function(x){return arguments.length?(f=Array.from(x),v):f.slice()},v.unknown=function(x){return arguments.length?(y=x,v):y},v.copy=function(){return Wy(h,f).unknown(y)},pf.apply(v,arguments),v}function Jy(){var c=Wy().unknown(void 0),h=c.domain,f=c.range,y=0,v=1,x,a,A=!1,I=0,R=0,B=.5;delete c.unknown;function K(){var j=h().length,H=v<y,de=H?v:y,Me=H?y:v;x=(Me-de)/Math.max(1,j-I+R*2),A&&(x=Math.floor(x)),de+=(Me-de-x*(j-I))*B,a=x*(1-I),A&&(de=Math.round(de),a=Math.round(a));var Se=b_(j).map(function(He){return de+x*He});return f(H?Se.reverse():Se)}return c.domain=function(j){return arguments.length?(h(j),K()):h()},c.range=function(j){return arguments.length?([y,v]=j,y=+y,v=+v,K()):[y,v]},c.rangeRound=function(j){return[y,v]=j,y=+y,v=+v,A=!0,K()},c.bandwidth=function(){return a},c.step=function(){return x},c.round=function(j){return arguments.length?(A=!!j,K()):A},c.padding=function(j){return arguments.length?(I=Math.min(1,R=+j),K()):I},c.paddingInner=function(j){return arguments.length?(I=Math.min(1,j),K()):I},c.paddingOuter=function(j){return arguments.length?(R=+j,K()):R},c.align=function(j){return arguments.length?(B=Math.max(0,Math.min(1,j)),K()):B},c.copy=function(){return Jy(h(),[y,v]).round(A).paddingInner(I).paddingOuter(R).align(B)},pf.apply(K(),arguments)}function sd(c,h,f){c.prototype=h.prototype=f,f.constructor=c}function Yy(c,h){var f=Object.create(c.prototype);for(var y in h)f[y]=h[y];return f}function Kh(){}var jh=.7,sf=1/jh,Bc="\\s*([+-]?\\d+)\\s*",qh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",bl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",x_=/^#([0-9a-f]{3,8})$/,w_=new RegExp(`^rgb\\(${Bc},${Bc},${Bc}\\)$`),S_=new RegExp(`^rgb\\(${bl},${bl},${bl}\\)$`),E_=new RegExp(`^rgba\\(${Bc},${Bc},${Bc},${qh}\\)$`),k_=new RegExp(`^rgba\\(${bl},${bl},${bl},${qh}\\)$`),T_=new RegExp(`^hsl\\(${qh},${bl},${bl}\\)$`),I_=new RegExp(`^hsla\\(${qh},${bl},${bl},${qh}\\)$`),km={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};sd(Kh,Zh,{copy(c){return Object.assign(new this.constructor,this,c)},displayable(){return this.rgb().displayable()},hex:Tm,formatHex:Tm,formatHex8:A_,formatHsl:z_,formatRgb:Im,toString:Im});function Tm(){return this.rgb().formatHex()}function A_(){return this.rgb().formatHex8()}function z_(){return Qy(this).formatHsl()}function Im(){return this.rgb().formatRgb()}function Zh(c){var h,f;return c=(c+"").trim().toLowerCase(),(h=x_.exec(c))?(f=h[1].length,h=parseInt(h[1],16),f===6?Am(h):f===3?new ja(h>>8&15|h>>4&240,h>>4&15|h&240,(h&15)<<4|h&15,1):f===8?Kp(h>>24&255,h>>16&255,h>>8&255,(h&255)/255):f===4?Kp(h>>12&15|h>>8&240,h>>8&15|h>>4&240,h>>4&15|h&240,((h&15)<<4|h&15)/255):null):(h=w_.exec(c))?new ja(h[1],h[2],h[3],1):(h=S_.exec(c))?new ja(h[1]*255/100,h[2]*255/100,h[3]*255/100,1):(h=E_.exec(c))?Kp(h[1],h[2],h[3],h[4]):(h=k_.exec(c))?Kp(h[1]*255/100,h[2]*255/100,h[3]*255/100,h[4]):(h=T_.exec(c))?Cm(h[1],h[2]/100,h[3]/100,1):(h=I_.exec(c))?Cm(h[1],h[2]/100,h[3]/100,h[4]):km.hasOwnProperty(c)?Am(km[c]):c==="transparent"?new ja(NaN,NaN,NaN,0):null}function Am(c){return new ja(c>>16&255,c>>8&255,c&255,1)}function Kp(c,h,f,y){return y<=0&&(c=h=f=NaN),new ja(c,h,f,y)}function P_(c){return c instanceof Kh||(c=Zh(c)),c?(c=c.rgb(),new ja(c.r,c.g,c.b,c.opacity)):new ja}function id(c,h,f,y){return arguments.length===1?P_(c):new ja(c,h,f,y==null?1:y)}function ja(c,h,f,y){this.r=+c,this.g=+h,this.b=+f,this.opacity=+y}sd(ja,id,Yy(Kh,{brighter(c){return c=c==null?sf:Math.pow(sf,c),new ja(this.r*c,this.g*c,this.b*c,this.opacity)},darker(c){return c=c==null?jh:Math.pow(jh,c),new ja(this.r*c,this.g*c,this.b*c,this.opacity)},rgb(){return this},clamp(){return new ja(ic(this.r),ic(this.g),ic(this.b),lf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zm,formatHex:zm,formatHex8:C_,formatRgb:Pm,toString:Pm}));function zm(){return`#${rc(this.r)}${rc(this.g)}${rc(this.b)}`}function C_(){return`#${rc(this.r)}${rc(this.g)}${rc(this.b)}${rc((isNaN(this.opacity)?1:this.opacity)*255)}`}function Pm(){const c=lf(this.opacity);return`${c===1?"rgb(":"rgba("}${ic(this.r)}, ${ic(this.g)}, ${ic(this.b)}${c===1?")":`, ${c})`}`}function lf(c){return isNaN(c)?1:Math.max(0,Math.min(1,c))}function ic(c){return Math.max(0,Math.min(255,Math.round(c)||0))}function rc(c){return c=ic(c),(c<16?"0":"")+c.toString(16)}function Cm(c,h,f,y){return y<=0?c=h=f=NaN:f<=0||f>=1?c=h=NaN:h<=0&&(c=NaN),new Js(c,h,f,y)}function Qy(c){if(c instanceof Js)return new Js(c.h,c.s,c.l,c.opacity);if(c instanceof Kh||(c=Zh(c)),!c)return new Js;if(c instanceof Js)return c;c=c.rgb();var h=c.r/255,f=c.g/255,y=c.b/255,v=Math.min(h,f,y),x=Math.max(h,f,y),a=NaN,A=x-v,I=(x+v)/2;return A?(h===x?a=(f-y)/A+(f<y)*6:f===x?a=(y-h)/A+2:a=(h-f)/A+4,A/=I<.5?x+v:2-x-v,a*=60):A=I>0&&I<1?0:a,new Js(a,A,I,c.opacity)}function M_(c,h,f,y){return arguments.length===1?Qy(c):new Js(c,h,f,y==null?1:y)}function Js(c,h,f,y){this.h=+c,this.s=+h,this.l=+f,this.opacity=+y}sd(Js,M_,Yy(Kh,{brighter(c){return c=c==null?sf:Math.pow(sf,c),new Js(this.h,this.s,this.l*c,this.opacity)},darker(c){return c=c==null?jh:Math.pow(jh,c),new Js(this.h,this.s,this.l*c,this.opacity)},rgb(){var c=this.h%360+(this.h<0)*360,h=isNaN(c)||isNaN(this.s)?0:this.s,f=this.l,y=f+(f<.5?f:1-f)*h,v=2*f-y;return new ja(Wf(c>=240?c-240:c+120,v,y),Wf(c,v,y),Wf(c<120?c+240:c-120,v,y),this.opacity)},clamp(){return new Js(Mm(this.h),Xp(this.s),Xp(this.l),lf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const c=lf(this.opacity);return`${c===1?"hsl(":"hsla("}${Mm(this.h)}, ${Xp(this.s)*100}%, ${Xp(this.l)*100}%${c===1?")":`, ${c})`}`}}));function Mm(c){return c=(c||0)%360,c<0?c+360:c}function Xp(c){return Math.max(0,Math.min(1,c||0))}function Wf(c,h,f){return(c<60?h+(f-h)*c/60:c<180?f:c<240?h+(f-h)*(240-c)/60:h)*255}const ld=c=>()=>c;function D_(c,h){return function(f){return c+f*h}}function L_(c,h,f){return c=Math.pow(c,f),h=Math.pow(h,f)-c,f=1/f,function(y){return Math.pow(c+y*h,f)}}function R_(c){return(c=+c)==1?$y:function(h,f){return f-h?L_(h,f,c):ld(isNaN(h)?f:h)}}function $y(c,h){var f=h-c;return f?D_(c,f):ld(isNaN(c)?h:c)}const Dm=function c(h){var f=R_(h);function y(v,x){var a=f((v=id(v)).r,(x=id(x)).r),A=f(v.g,x.g),I=f(v.b,x.b),R=$y(v.opacity,x.opacity);return function(B){return v.r=a(B),v.g=A(B),v.b=I(B),v.opacity=R(B),v+""}}return y.gamma=c,y}(1);function B_(c,h){h||(h=[]);var f=c?Math.min(h.length,c.length):0,y=h.slice(),v;return function(x){for(v=0;v<f;++v)y[v]=c[v]*(1-x)+h[v]*x;return y}}function O_(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}function F_(c,h){var f=h?h.length:0,y=c?Math.min(f,c.length):0,v=new Array(y),x=new Array(f),a;for(a=0;a<y;++a)v[a]=ud(c[a],h[a]);for(;a<f;++a)x[a]=h[a];return function(A){for(a=0;a<y;++a)x[a]=v[a](A);return x}}function N_(c,h){var f=new Date;return c=+c,h=+h,function(y){return f.setTime(c*(1-y)+h*y),f}}function uf(c,h){return c=+c,h=+h,function(f){return c*(1-f)+h*f}}function V_(c,h){var f={},y={},v;(c===null||typeof c!="object")&&(c={}),(h===null||typeof h!="object")&&(h={});for(v in h)v in c?f[v]=ud(c[v],h[v]):y[v]=h[v];return function(x){for(v in f)y[v]=f[v](x);return y}}var nd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jf=new RegExp(nd.source,"g");function U_(c){return function(){return c}}function j_(c){return function(h){return c(h)+""}}function q_(c,h){var f=nd.lastIndex=Jf.lastIndex=0,y,v,x,a=-1,A=[],I=[];for(c=c+"",h=h+"";(y=nd.exec(c))&&(v=Jf.exec(h));)(x=v.index)>f&&(x=h.slice(f,x),A[a]?A[a]+=x:A[++a]=x),(y=y[0])===(v=v[0])?A[a]?A[a]+=v:A[++a]=v:(A[++a]=null,I.push({i:a,x:uf(y,v)})),f=Jf.lastIndex;return f<h.length&&(x=h.slice(f),A[a]?A[a]+=x:A[++a]=x),A.length<2?I[0]?j_(I[0].x):U_(h):(h=I.length,function(R){for(var B=0,K;B<h;++B)A[(K=I[B]).i]=K.x(R);return A.join("")})}function ud(c,h){var f=typeof h,y;return h==null||f==="boolean"?ld(h):(f==="number"?uf:f==="string"?(y=Zh(h))?(h=y,Dm):q_:h instanceof Zh?Dm:h instanceof Date?N_:O_(h)?B_:Array.isArray(h)?F_:typeof h.valueOf!="function"&&typeof h.toString!="function"||isNaN(h)?V_:uf)(c,h)}function Z_(c,h){return c=+c,h=+h,function(f){return Math.round(c*(1-f)+h*f)}}function G_(c){return function(){return c}}function K_(c){return+c}var Lm=[0,1];function vl(c){return c}function od(c,h){return(h-=c=+c)?function(f){return(f-c)/h}:G_(isNaN(h)?NaN:.5)}function X_(c,h){var f;return c>h&&(f=c,c=h,h=f),function(y){return Math.max(c,Math.min(h,y))}}function H_(c,h,f){var y=c[0],v=c[1],x=h[0],a=h[1];return v<y?(y=od(v,y),x=f(a,x)):(y=od(y,v),x=f(x,a)),function(A){return x(y(A))}}function W_(c,h,f){var y=Math.min(c.length,h.length)-1,v=new Array(y),x=new Array(y),a=-1;for(c[y]<c[0]&&(c=c.slice().reverse(),h=h.slice().reverse());++a<y;)v[a]=od(c[a],c[a+1]),x[a]=f(h[a],h[a+1]);return function(A){var I=d_(c,A,1,y)-1;return x[I](v[I](A))}}function eg(c,h){return h.domain(c.domain()).range(c.range()).interpolate(c.interpolate()).clamp(c.clamp()).unknown(c.unknown())}function tg(){var c=Lm,h=Lm,f=ud,y,v,x,a=vl,A,I,R;function B(){var j=Math.min(c.length,h.length);return a!==vl&&(a=X_(c[0],c[j-1])),A=j>2?W_:H_,I=R=null,K}function K(j){return j==null||isNaN(j=+j)?x:(I||(I=A(c.map(y),h,f)))(y(a(j)))}return K.invert=function(j){return a(v((R||(R=A(h,c.map(y),uf)))(j)))},K.domain=function(j){return arguments.length?(c=Array.from(j,K_),B()):c.slice()},K.range=function(j){return arguments.length?(h=Array.from(j),B()):h.slice()},K.rangeRound=function(j){return h=Array.from(j),f=Z_,B()},K.clamp=function(j){return arguments.length?(a=j?!0:vl,B()):a!==vl},K.interpolate=function(j){return arguments.length?(f=j,B()):f},K.unknown=function(j){return arguments.length?(x=j,K):x},function(j,H){return y=j,v=H,B()}}function J_(){return tg()(vl,vl)}function Y_(c){return Math.abs(c=Math.round(c))>=1e21?c.toLocaleString("en").replace(/,/g,""):c.toString(10)}function cf(c,h){if((f=(c=h?c.toExponential(h-1):c.toExponential()).indexOf("e"))<0)return null;var f,y=c.slice(0,f);return[y.length>1?y[0]+y.slice(2):y,+c.slice(f+1)]}function jc(c){return c=cf(Math.abs(c)),c?c[1]:NaN}function Q_(c,h){return function(f,y){for(var v=f.length,x=[],a=0,A=c[0],I=0;v>0&&A>0&&(I+A+1>y&&(A=Math.max(1,y-I)),x.push(f.substring(v-=A,v+A)),!((I+=A+1)>y));)A=c[a=(a+1)%c.length];return x.reverse().join(h)}}function $_(c){return function(h){return h.replace(/[0-9]/g,function(f){return c[+f]})}}var ev=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hf(c){if(!(h=ev.exec(c)))throw new Error("invalid format: "+c);var h;return new cd({fill:h[1],align:h[2],sign:h[3],symbol:h[4],zero:h[5],width:h[6],comma:h[7],precision:h[8]&&h[8].slice(1),trim:h[9],type:h[10]})}hf.prototype=cd.prototype;function cd(c){this.fill=c.fill===void 0?" ":c.fill+"",this.align=c.align===void 0?">":c.align+"",this.sign=c.sign===void 0?"-":c.sign+"",this.symbol=c.symbol===void 0?"":c.symbol+"",this.zero=!!c.zero,this.width=c.width===void 0?void 0:+c.width,this.comma=!!c.comma,this.precision=c.precision===void 0?void 0:+c.precision,this.trim=!!c.trim,this.type=c.type===void 0?"":c.type+""}cd.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function tv(c){e:for(var h=c.length,f=1,y=-1,v;f<h;++f)switch(c[f]){case".":y=v=f;break;case"0":y===0&&(y=f),v=f;break;default:if(!+c[f])break e;y>0&&(y=0);break}return y>0?c.slice(0,y)+c.slice(v+1):c}var rg;function rv(c,h){var f=cf(c,h);if(!f)return c+"";var y=f[0],v=f[1],x=v-(rg=Math.max(-8,Math.min(8,Math.floor(v/3)))*3)+1,a=y.length;return x===a?y:x>a?y+new Array(x-a+1).join("0"):x>0?y.slice(0,x)+"."+y.slice(x):"0."+new Array(1-x).join("0")+cf(c,Math.max(0,h+x-1))[0]}function Rm(c,h){var f=cf(c,h);if(!f)return c+"";var y=f[0],v=f[1];return v<0?"0."+new Array(-v).join("0")+y:y.length>v+1?y.slice(0,v+1)+"."+y.slice(v+1):y+new Array(v-y.length+2).join("0")}const Bm={"%":(c,h)=>(c*100).toFixed(h),b:c=>Math.round(c).toString(2),c:c=>c+"",d:Y_,e:(c,h)=>c.toExponential(h),f:(c,h)=>c.toFixed(h),g:(c,h)=>c.toPrecision(h),o:c=>Math.round(c).toString(8),p:(c,h)=>Rm(c*100,h),r:Rm,s:rv,X:c=>Math.round(c).toString(16).toUpperCase(),x:c=>Math.round(c).toString(16)};function Om(c){return c}var Fm=Array.prototype.map,Nm=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function iv(c){var h=c.grouping===void 0||c.thousands===void 0?Om:Q_(Fm.call(c.grouping,Number),c.thousands+""),f=c.currency===void 0?"":c.currency[0]+"",y=c.currency===void 0?"":c.currency[1]+"",v=c.decimal===void 0?".":c.decimal+"",x=c.numerals===void 0?Om:$_(Fm.call(c.numerals,String)),a=c.percent===void 0?"%":c.percent+"",A=c.minus===void 0?"\u2212":c.minus+"",I=c.nan===void 0?"NaN":c.nan+"";function R(K){K=hf(K);var j=K.fill,H=K.align,de=K.sign,Me=K.symbol,Se=K.zero,He=K.width,Ue=K.comma,Rt=K.precision,kt=K.trim,ut=K.type;ut==="n"?(Ue=!0,ut="g"):Bm[ut]||(Rt===void 0&&(Rt=12),kt=!0,ut="g"),(Se||j==="0"&&H==="=")&&(Se=!0,j="0",H="=");var We=Me==="$"?f:Me==="#"&&/[boxX]/.test(ut)?"0"+ut.toLowerCase():"",tr=Me==="$"?y:/[%p]/.test(ut)?a:"",Gt=Bm[ut],St=/[defgprs%]/.test(ut);Rt=Rt===void 0?6:/[gprs]/.test(ut)?Math.max(1,Math.min(21,Rt)):Math.max(0,Math.min(20,Rt));function jt(Ke){var Lt=We,mt=tr,yt,De,Ne;if(ut==="c")mt=Gt(Ke)+mt,Ke="";else{Ke=+Ke;var Tt=Ke<0||1/Ke<0;if(Ke=isNaN(Ke)?I:Gt(Math.abs(Ke),Rt),kt&&(Ke=tv(Ke)),Tt&&+Ke==0&&de!=="+"&&(Tt=!1),Lt=(Tt?de==="("?de:A:de==="-"||de==="("?"":de)+Lt,mt=(ut==="s"?Nm[8+rg/3]:"")+mt+(Tt&&de==="("?")":""),St){for(yt=-1,De=Ke.length;++yt<De;)if(Ne=Ke.charCodeAt(yt),48>Ne||Ne>57){mt=(Ne===46?v+Ke.slice(yt+1):Ke.slice(yt))+mt,Ke=Ke.slice(0,yt);break}}}Ue&&!Se&&(Ke=h(Ke,1/0));var fr=Lt.length+Ke.length+mt.length,Kt=fr<He?new Array(He-fr+1).join(j):"";switch(Ue&&Se&&(Ke=h(Kt+Ke,Kt.length?He-mt.length:1/0),Kt=""),H){case"<":Ke=Lt+Ke+mt+Kt;break;case"=":Ke=Lt+Kt+Ke+mt;break;case"^":Ke=Kt.slice(0,fr=Kt.length>>1)+Lt+Ke+mt+Kt.slice(fr);break;default:Ke=Kt+Lt+Ke+mt;break}return x(Ke)}return jt.toString=function(){return K+""},jt}function B(K,j){var H=R((K=hf(K),K.type="f",K)),de=Math.max(-8,Math.min(8,Math.floor(jc(j)/3)))*3,Me=Math.pow(10,-de),Se=Nm[8+de/3];return function(He){return H(Me*He)+Se}}return{format:R,formatPrefix:B}}var Hp,ig,ng;nv({thousands:",",grouping:[3],currency:["$",""]});function nv(c){return Hp=iv(c),ig=Hp.format,ng=Hp.formatPrefix,Hp}function ov(c){return Math.max(0,-jc(Math.abs(c)))}function av(c,h){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(jc(h)/3)))*3-jc(Math.abs(c)))}function sv(c,h){return c=Math.abs(c),h=Math.abs(h)-c,Math.max(0,jc(h)-jc(c))+1}function lv(c,h,f,y){var v=v_(c,h,f),x;switch(y=hf(y==null?",f":y),y.type){case"s":{var a=Math.max(Math.abs(c),Math.abs(h));return y.precision==null&&!isNaN(x=av(v,a))&&(y.precision=x),ng(y,a)}case"":case"e":case"g":case"p":case"r":{y.precision==null&&!isNaN(x=sv(v,Math.max(Math.abs(c),Math.abs(h))))&&(y.precision=x-(y.type==="e"));break}case"f":case"%":{y.precision==null&&!isNaN(x=ov(v))&&(y.precision=x-(y.type==="%")*2);break}}return ig(y)}function og(c){var h=c.domain;return c.ticks=function(f){var y=h();return __(y[0],y[y.length-1],f==null?10:f)},c.tickFormat=function(f,y){var v=h();return lv(v[0],v[v.length-1],f==null?10:f,y)},c.nice=function(f){f==null&&(f=10);var y=h(),v=0,x=y.length-1,a=y[v],A=y[x],I,R,B=10;for(A<a&&(R=a,a=A,A=R,R=v,v=x,x=R);B-- >0;){if(R=Hy(a,A,f),R===I)return y[v]=a,y[x]=A,h(y);if(R>0)a=Math.floor(a/R)*R,A=Math.ceil(A/R)*R;else if(R<0)a=Math.ceil(a*R)/R,A=Math.floor(A*R)/R;else break;I=R}return c},c}function tf(){var c=J_();return c.copy=function(){return eg(c,tf())},pf.apply(c,arguments),og(c)}function Vm(c){return function(h){return h<0?-Math.pow(-h,c):Math.pow(h,c)}}function uv(c){return c<0?-Math.sqrt(-c):Math.sqrt(c)}function cv(c){return c<0?-c*c:c*c}function hv(c){var h=c(vl,vl),f=1;function y(){return f===1?c(vl,vl):f===.5?c(uv,cv):c(Vm(f),Vm(1/f))}return h.exponent=function(v){return arguments.length?(f=+v,y()):f},og(h)}function ag(){var c=hv(tg());return c.copy=function(){return eg(c,ag()).exponent(c.exponent())},pf.apply(c,arguments),c}function pv(){return ag.apply(null,arguments).exponent(.5)}const Nh={x:tf,y:tf,z:tf,r:pv};function fv(c){return c.constant?"symlog":c.base?"log":c.exponent?c.exponent()===.5?"sqrt":"pow":"other"}function Um(c){return c}function dv(c){return h=>Math.log(c*h)}function mv(c){return h=>c*Math.exp(h)}function yv(c){return h=>Math.sign(h)*Math.log1p(Math.abs(h/c))}function gv(c){return h=>Math.sign(h)*Math.expm1(Math.abs(h))*c}function Wp(c){return function(f){return f<0?-Math.pow(-f,c):Math.pow(f,c)}}function _v(c){const h=fv(c);if(h==="log"){const f=Math.sign(c.domain()[0]);return{lift:dv(f),ground:mv(f),scaleType:h}}return h==="pow"?{lift:Wp(1),ground:Wp(1/1),scaleType:h}:h==="sqrt"?{lift:Wp(.5),ground:Wp(1/.5),scaleType:h}:h==="symlog"?{lift:yv(1),ground:gv(1),scaleType:h}:{lift:Um,ground:Um,scaleType:h}}function vv(c,h){if(typeof c.range!="function")throw new Error("Scale method `range` must be a function");if(typeof c.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(h))return c.domain();c.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",c.domain()),c.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",c.range());const{lift:f,ground:y}=_v(c),v=c.domain()[0],x=Object.prototype.toString.call(v)==="[object Date]",[a,A]=c.domain().map(H=>f(x?H.getTime():H)),[I,R]=c.range(),B=h[0]||0,K=h[1]||0,j=(A-a)/(Math.abs(R-I)-B-K);return[a-B*j,K*j+A].map(H=>y(x?new Date(H):H))}function bv(c,h,f,y,v){let x,a;return v===!0?(x=0,a=100):(x=c==="r"?1:0,a=c==="y"?f:c==="r"?25:h),y===!0?[a,x]:[x,a]}function xv(c,h,f,y,v,x){return v?typeof v=="function"?v({width:h,height:f}):v:bv(c,h,f,y,x)}function Jp(c){return function([f,y,v,x,a,A,I,R,B,K]){if(y===null)return null;const j=xv(c,I,R,A,B,K),H=f===Nh[c]?f():f.copy();return H.domain(Ky(y[c],v)).range(j),x&&H.domain(vv(H,x)),a===!0&&(typeof H.nice=="function"?H.nice():console.error(`[Layer Cake] You set \`${c}Nice: true\` but the ${c}Scale does not have a \`.nice\` method. Ignoring...`)),H}}function Yp([c,h]){return f=>{const y=c(f);return Array.isArray(y)?y.map(v=>h(v)):h(y)}}function Qp([c]){if(typeof c=="function"){if(typeof c.range=="function")return c.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const $p={x:!1,y:!0,z:!1,r:!1};const wv=c=>({element:c[0]&4,width:c[0]&256,height:c[0]&512,aspectRatio:c[0]&1024,containerWidth:c[0]&128,containerHeight:c[0]&64}),jm=c=>({element:c[2],width:c[8],height:c[9],aspectRatio:c[10],containerWidth:c[7],containerHeight:c[6]});function qm(c){let h,f,y;const v=c[90].default,x=Fc(v,c,c[89],jm);return{c(){h=ce("div"),x&&x.c(),this.h()},l(a){h=he(a,"DIV",{class:!0});var A=fe(h);x&&x.l(A),A.forEach(O),this.h()},h(){U(h,"class","layercake-container svelte-vhzpsp"),Lc(()=>c[92].call(h)),Ce(h,"position",c[5],!1),Ce(h,"top",c[5]==="absolute"?"0":null,!1),Ce(h,"right",c[5]==="absolute"?"0":null,!1),Ce(h,"bottom",c[5]==="absolute"?"0":null,!1),Ce(h,"left",c[5]==="absolute"?"0":null,!1),Ce(h,"pointer-events",c[4]===!1?"none":null,!1)},m(a,A){ke(a,h,A),x&&x.m(h,null),c[91](h),f=Rc(h,c[92].bind(h)),y=!0},p(a,A){x&&x.p&&(!y||A[0]&1988|A[2]&134217728)&&Nc(x,v,a,a[89],y?Uc(v,a[89],A,wv):Vc(a[89]),jm),A[0]&32&&Ce(h,"position",a[5],!1),A[0]&32&&Ce(h,"top",a[5]==="absolute"?"0":null,!1),A[0]&32&&Ce(h,"right",a[5]==="absolute"?"0":null,!1),A[0]&32&&Ce(h,"bottom",a[5]==="absolute"?"0":null,!1),A[0]&32&&Ce(h,"left",a[5]==="absolute"?"0":null,!1),A[0]&16&&Ce(h,"pointer-events",a[4]===!1?"none":null,!1)},i(a){y||(bt(x,a),y=!0)},o(a){Ft(x,a),y=!1},d(a){a&&O(h),x&&x.d(a),c[91](null),f()}}}function Sv(c){let h,f,y=(c[3]===!0||typeof window<"u")&&qm(c);return{c(){y&&y.c(),h=Ei()},l(v){y&&y.l(v),h=Ei()},m(v,x){y&&y.m(v,x),ke(v,h,x),f=!0},p(v,x){v[3]===!0||typeof window<"u"?y?(y.p(v,x),x[0]&8&&bt(y,1)):(y=qm(v),y.c(),bt(y,1),y.m(h.parentNode,h)):y&&(Ls(),Ft(y,1,1,()=>{y=null}),Rs())},i(v){f||(bt(y),f=!0)},o(v){Ft(y),f=!1},d(v){y&&y.d(v),v&&O(h)}}}function Ev(c,h,f){let y,v,x,a,A,I,R,B,K,j,H,de,Me,Se,He,Ue,Rt,kt,ut,We,tr,Gt,St,jt,Ke,Lt,mt,yt,De,Ne,Tt,fr,Kt,Ge,et,ar,vr,di,Qr,Vr,Ur,{$$slots:ui={},$$scope:xt}=h,{ssr:sr=!1}=h,{pointerEvents:Et=!0}=h,{position:Ht="relative"}=h,{percentRange:Nt=!1}=h,{width:nn=void 0}=h,{height:ii=void 0}=h,{containerWidth:dr=nn||100}=h,{containerHeight:ni=ii||100}=h,{element:$r=void 0}=h,{x:on=void 0}=h,{y:Vi=void 0}=h,{z:Sn=void 0}=h,{r:$n=void 0}=h,{data:Ir=[]}=h,{xDomain:jr=void 0}=h,{yDomain:Mi=void 0}=h,{zDomain:Wi=void 0}=h,{rDomain:En=void 0}=h,{xNice:Ka=!1}=h,{yNice:qo=!1}=h,{zNice:Nn=!1}=h,{rNice:kn=!1}=h,{xReverse:na=$p.x}=h,{yReverse:Tn=$p.y}=h,{zReverse:ao=$p.z}=h,{rReverse:so=$p.r}=h,{xPadding:Zo=void 0}=h,{yPadding:Vn=void 0}=h,{zPadding:To=void 0}=h,{rPadding:Go=void 0}=h,{xScale:lo=Nh.x}=h,{yScale:Un=Nh.y}=h,{zScale:In=Nh.z}=h,{rScale:Io=Nh.r}=h,{xRange:ei=void 0}=h,{yRange:mr=void 0}=h,{zRange:M=void 0}=h,{rRange:F=void 0}=h,{padding:q={}}=h,{extents:Y={}}=h,{flatData:re=void 0}=h,{custom:ue={}}=h,me=!1;Vy(()=>{me=!0});const Z={},ie=Rr(Nt);Qt(c,ie,_e=>f(128,di=_e));const be=Rr(dr);Qt(c,be,_e=>f(7,vr=_e));const Ve=Rr(ni);Qt(c,Ve,_e=>f(6,ar=_e));const Xe=Rr(Hf(Y));Qt(c,Xe,_e=>f(127,et=_e));const ze=Rr(Ir);Qt(c,ze,_e=>f(126,Ge=_e));const je=Rr(re||Ir);Qt(c,je,_e=>f(125,Kt=_e));const ht=Rr(q);Qt(c,ht,_e=>f(124,fr=_e));const st=Rr(Eu(on));Qt(c,st,_e=>f(123,Tt=_e));const Re=Rr(Eu(Vi));Qt(c,Re,_e=>f(122,Ne=_e));const ot=Rr(Eu(Sn));Qt(c,ot,_e=>f(121,De=_e));const rt=Rr(Eu($n));Qt(c,rt,_e=>f(120,yt=_e));const Qe=Rr(jr);Qt(c,Qe,_e=>f(119,mt=_e));const Dt=Rr(Mi);Qt(c,Dt,_e=>f(118,Lt=_e));const it=Rr(Wi);Qt(c,it,_e=>f(117,Ke=_e));const $t=Rr(En);Qt(c,$t,_e=>f(116,jt=_e));const lr=Rr(Ka);Qt(c,lr,_e=>f(115,St=_e));const Wt=Rr(qo);Qt(c,Wt,_e=>f(114,Gt=_e));const ir=Rr(Nn);Qt(c,ir,_e=>f(113,tr=_e));const Xt=Rr(kn);Qt(c,Xt,_e=>f(112,We=_e));const ti=Rr(na);Qt(c,ti,_e=>f(111,ut=_e));const hr=Rr(Tn);Qt(c,hr,_e=>f(110,kt=_e));const Ar=Rr(ao);Qt(c,Ar,_e=>f(109,Rt=_e));const pr=Rr(so);Qt(c,pr,_e=>f(108,Ue=_e));const Jt=Rr(Zo);Qt(c,Jt,_e=>f(107,He=_e));const nr=Rr(Vn);Qt(c,nr,_e=>f(106,Se=_e));const ri=Rr(To);Qt(c,ri,_e=>f(105,Me=_e));const mn=Rr(Go);Qt(c,mn,_e=>f(104,de=_e));const ci=Rr(ei);Qt(c,ci,_e=>f(103,H=_e));const ki=Rr(mr);Qt(c,ki,_e=>f(102,j=_e));const ba=Rr(M);Qt(c,ba,_e=>f(101,K=_e));const An=Rr(F);Qt(c,An,_e=>f(100,B=_e));const zr=Rr(lo);Qt(c,zr,_e=>f(99,R=_e));const Ko=Rr(Un);Qt(c,Ko,_e=>f(98,I=_e));const Ti=Rr(In);Qt(c,Ti,_e=>f(97,A=_e));const Or=Rr(Io);Qt(c,Or,_e=>f(96,a=_e));const an=Rr(Z);Qt(c,an,_e=>f(94,v=_e));const yr=Rr(ue);Qt(c,yr,_e=>f(95,x=_e));const mi=dn([st,Re,ot,rt],([_e,ln,Ai,Mr])=>{const Ho={};return _e&&(Ho.x=_e),ln&&(Ho.y=ln),Ai&&(Ho.z=Ai),Mr&&(Ho.r=Mr),Ho}),bi=dn([ht,be,Ve],([_e])=>Object.assign({top:0,right:0,bottom:0,left:0},_e)),Bs=dn([be,Ve,bi],([_e,ln,Ai])=>{const Mr={};return Mr.top=Ai.top,Mr.right=_e-Ai.right,Mr.bottom=ln-Ai.bottom,Mr.left=Ai.left,Mr.width=Mr.right-Mr.left,Mr.height=Mr.bottom-Mr.top,Mr.width<=0&&me===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Mr.height<=0&&me===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Mr}),oi=dn([Bs],([_e])=>_e.width);Qt(c,oi,_e=>f(8,Qr=_e));const xa=dn([Bs],([_e])=>_e.height);Qt(c,xa,_e=>f(9,Vr=_e));const Ui=dn([je,mi,Xe],([_e,ln,Ai])=>{const Mr=Hf(ln,Ai);return Object.keys(Mr).length>0?{...l_(_e,Mr),...Ai}:{}}),ai=dn([Ui,Qe],Gp("x")),sn=dn([Ui,Dt],Gp("y")),ji=dn([Ui,it],Gp("z")),jn=dn([Ui,$t],Gp("r")),Xa=dn([zr,Ui,ai,Jt,lr,ti,oi,xa,ci,ie],Jp("x")),wl=dn([st,Xa],Yp),Ha=dn([Ko,Ui,sn,nr,Wt,hr,oi,xa,ki,ie],Jp("y")),wa=dn([Re,Ha],Yp),Wa=dn([Ti,Ui,ji,ri,ir,Ar,oi,xa,ba,ie],Jp("z")),yn=dn([ot,Wa],Yp),Xo=dn([Or,Ui,jn,mn,Xt,pr,oi,xa,An,ie],Jp("r")),Sa=dn([rt,Xo],Yp),Ea=dn([Xa],Qp),ka=dn([Ha],Qp),oa=dn([Wa],Qp),Os=dn([Xo],Qp),Ta=dn([oi,xa],([_e,ln])=>_e/ln);Qt(c,Ta,_e=>f(10,Ur=_e));function Ii(_e){Kl[_e?"unshift":"push"](()=>{$r=_e,f(2,$r)})}function gn(){dr=this.clientWidth,ni=this.clientHeight,f(0,dr),f(1,ni)}return c.$$set=_e=>{"ssr"in _e&&f(3,sr=_e.ssr),"pointerEvents"in _e&&f(4,Et=_e.pointerEvents),"position"in _e&&f(5,Ht=_e.position),"percentRange"in _e&&f(51,Nt=_e.percentRange),"width"in _e&&f(52,nn=_e.width),"height"in _e&&f(53,ii=_e.height),"containerWidth"in _e&&f(0,dr=_e.containerWidth),"containerHeight"in _e&&f(1,ni=_e.containerHeight),"element"in _e&&f(2,$r=_e.element),"x"in _e&&f(54,on=_e.x),"y"in _e&&f(55,Vi=_e.y),"z"in _e&&f(56,Sn=_e.z),"r"in _e&&f(57,$n=_e.r),"data"in _e&&f(58,Ir=_e.data),"xDomain"in _e&&f(59,jr=_e.xDomain),"yDomain"in _e&&f(60,Mi=_e.yDomain),"zDomain"in _e&&f(61,Wi=_e.zDomain),"rDomain"in _e&&f(62,En=_e.rDomain),"xNice"in _e&&f(63,Ka=_e.xNice),"yNice"in _e&&f(64,qo=_e.yNice),"zNice"in _e&&f(65,Nn=_e.zNice),"rNice"in _e&&f(66,kn=_e.rNice),"xReverse"in _e&&f(67,na=_e.xReverse),"yReverse"in _e&&f(68,Tn=_e.yReverse),"zReverse"in _e&&f(69,ao=_e.zReverse),"rReverse"in _e&&f(70,so=_e.rReverse),"xPadding"in _e&&f(71,Zo=_e.xPadding),"yPadding"in _e&&f(72,Vn=_e.yPadding),"zPadding"in _e&&f(73,To=_e.zPadding),"rPadding"in _e&&f(74,Go=_e.rPadding),"xScale"in _e&&f(75,lo=_e.xScale),"yScale"in _e&&f(76,Un=_e.yScale),"zScale"in _e&&f(77,In=_e.zScale),"rScale"in _e&&f(78,Io=_e.rScale),"xRange"in _e&&f(79,ei=_e.xRange),"yRange"in _e&&f(80,mr=_e.yRange),"zRange"in _e&&f(81,M=_e.zRange),"rRange"in _e&&f(82,F=_e.rRange),"padding"in _e&&f(83,q=_e.padding),"extents"in _e&&f(84,Y=_e.extents),"flatData"in _e&&f(85,re=_e.flatData),"custom"in _e&&f(86,ue=_e.custom),"$$scope"in _e&&f(89,xt=_e.$$scope)},c.$$.update=()=>{c.$$.dirty[1]&8388608&&on&&f(87,Z.x=on,Z),c.$$.dirty[1]&16777216&&Vi&&f(87,Z.y=Vi,Z),c.$$.dirty[1]&33554432&&Sn&&f(87,Z.z=Sn,Z),c.$$.dirty[1]&67108864&&$n&&f(87,Z.r=$n,Z),c.$$.dirty[1]&268435456&&jr&&f(87,Z.xDomain=jr,Z),c.$$.dirty[1]&536870912&&Mi&&f(87,Z.yDomain=Mi,Z),c.$$.dirty[1]&1073741824&&Wi&&f(87,Z.zDomain=Wi,Z),c.$$.dirty[2]&1&&En&&f(87,Z.rDomain=En,Z),c.$$.dirty[2]&131072&&ei&&f(87,Z.xRange=ei,Z),c.$$.dirty[2]&262144&&mr&&f(87,Z.yRange=mr,Z),c.$$.dirty[2]&524288&&M&&f(87,Z.zRange=M,Z),c.$$.dirty[2]&1048576&&F&&f(87,Z.rRange=F,Z),c.$$.dirty[1]&1048576&&Lr(ie,di=Nt,di),c.$$.dirty[0]&1&&Lr(be,vr=dr,vr),c.$$.dirty[0]&2&&Lr(Ve,ar=ni,ar),c.$$.dirty[2]&4194304&&Lr(Xe,et=Hf(Y),et),c.$$.dirty[1]&134217728&&Lr(ze,Ge=Ir,Ge),c.$$.dirty[1]&134217728|c.$$.dirty[2]&8388608&&Lr(je,Kt=re||Ir,Kt),c.$$.dirty[2]&2097152&&Lr(ht,fr=q,fr),c.$$.dirty[1]&8388608&&Lr(st,Tt=Eu(on),Tt),c.$$.dirty[1]&16777216&&Lr(Re,Ne=Eu(Vi),Ne),c.$$.dirty[1]&33554432&&Lr(ot,De=Eu(Sn),De),c.$$.dirty[1]&67108864&&Lr(rt,yt=Eu($n),yt),c.$$.dirty[1]&268435456&&Lr(Qe,mt=jr,mt),c.$$.dirty[1]&536870912&&Lr(Dt,Lt=Mi,Lt),c.$$.dirty[1]&1073741824&&Lr(it,Ke=Wi,Ke),c.$$.dirty[2]&1&&Lr($t,jt=En,jt),c.$$.dirty[2]&2&&Lr(lr,St=Ka,St),c.$$.dirty[2]&4&&Lr(Wt,Gt=qo,Gt),c.$$.dirty[2]&8&&Lr(ir,tr=Nn,tr),c.$$.dirty[2]&16&&Lr(Xt,We=kn,We),c.$$.dirty[2]&32&&Lr(ti,ut=na,ut),c.$$.dirty[2]&64&&Lr(hr,kt=Tn,kt),c.$$.dirty[2]&128&&Lr(Ar,Rt=ao,Rt),c.$$.dirty[2]&256&&Lr(pr,Ue=so,Ue),c.$$.dirty[2]&512&&Lr(Jt,He=Zo,He),c.$$.dirty[2]&1024&&Lr(nr,Se=Vn,Se),c.$$.dirty[2]&2048&&Lr(ri,Me=To,Me),c.$$.dirty[2]&4096&&Lr(mn,de=Go,de),c.$$.dirty[2]&131072&&Lr(ci,H=ei,H),c.$$.dirty[2]&262144&&Lr(ki,j=mr,j),c.$$.dirty[2]&524288&&Lr(ba,K=M,K),c.$$.dirty[2]&1048576&&Lr(An,B=F,B),c.$$.dirty[2]&8192&&Lr(zr,R=lo,R),c.$$.dirty[2]&16384&&Lr(Ko,I=Un,I),c.$$.dirty[2]&32768&&Lr(Ti,A=In,A),c.$$.dirty[2]&65536&&Lr(Or,a=Io,a),c.$$.dirty[2]&16777216&&Lr(yr,x=ue,x),c.$$.dirty[2]&33554432&&Lr(an,v=Z,v),c.$$.dirty[2]&67108864&&Uy("LayerCake",y)},f(88,y={activeGetters:mi,width:oi,height:xa,percentRange:ie,aspectRatio:Ta,containerWidth:be,containerHeight:Ve,x:st,y:Re,z:ot,r:rt,custom:yr,data:ze,xNice:lr,yNice:Wt,zNice:ir,rNice:Xt,xReverse:ti,yReverse:hr,zReverse:Ar,rReverse:pr,xPadding:Jt,yPadding:nr,zPadding:ri,rPadding:mn,padding:bi,flatData:je,extents:Ui,xDomain:ai,yDomain:sn,zDomain:ji,rDomain:jn,xRange:Ea,yRange:ka,zRange:oa,rRange:Os,config:an,xScale:Xa,xGet:wl,yScale:Ha,yGet:wa,zScale:Wa,zGet:yn,rScale:Xo,rGet:Sa}),[dr,ni,$r,sr,Et,Ht,ar,vr,Qr,Vr,Ur,ie,be,Ve,Xe,ze,je,ht,st,Re,ot,rt,Qe,Dt,it,$t,lr,Wt,ir,Xt,ti,hr,Ar,pr,Jt,nr,ri,mn,ci,ki,ba,An,zr,Ko,Ti,Or,an,yr,oi,xa,Ta,Nt,nn,ii,on,Vi,Sn,$n,Ir,jr,Mi,Wi,En,Ka,qo,Nn,kn,na,Tn,ao,so,Zo,Vn,To,Go,lo,Un,In,Io,ei,mr,M,F,q,Y,re,ue,Z,y,xt,ui,Ii,gn]}class kv extends qa{constructor(h){super(),Za(this,h,Ev,Sv,Ga,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const Tv=c=>({element:c&1}),Zm=c=>({element:c[0]}),Iv=c=>({element:c&1}),Gm=c=>({element:c[0]});function Av(c){let h,f,y,v,x;const a=c[12].defs,A=Fc(a,c,c[11],Gm),I=c[12].default,R=Fc(I,c,c[11],Zm);return{c(){h=Eo("svg"),f=Eo("defs"),A&&A.c(),y=Eo("g"),R&&R.c(),this.h()},l(B){h=ko(B,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var K=fe(h);f=ko(K,"defs",{});var j=fe(f);A&&A.l(j),j.forEach(O),y=ko(K,"g",{class:!0,transform:!0});var H=fe(y);R&&R.l(H),H.forEach(O),K.forEach(O),this.h()},h(){U(y,"class","layercake-layout-svg_g"),U(y,"transform",v="translate("+c[7].left+", "+c[7].top+")"),U(h,"class","layercake-layout-svg svelte-u84d8d"),U(h,"viewBox",c[4]),U(h,"width",c[5]),U(h,"height",c[6]),Ce(h,"z-index",c[2],!1),Ce(h,"pointer-events",c[3]===!1?"none":null,!1)},m(B,K){ke(B,h,K),N(h,f),A&&A.m(f,null),N(h,y),R&&R.m(y,null),c[13](y),c[14](h),x=!0},p(B,[K]){A&&A.p&&(!x||K&2049)&&Nc(A,a,B,B[11],x?Uc(a,B[11],K,Iv):Vc(B[11]),Gm),R&&R.p&&(!x||K&2049)&&Nc(R,I,B,B[11],x?Uc(I,B[11],K,Tv):Vc(B[11]),Zm),(!x||K&128&&v!==(v="translate("+B[7].left+", "+B[7].top+")"))&&U(y,"transform",v),(!x||K&16)&&U(h,"viewBox",B[4]),(!x||K&32)&&U(h,"width",B[5]),(!x||K&64)&&U(h,"height",B[6]),K&4&&Ce(h,"z-index",B[2],!1),K&8&&Ce(h,"pointer-events",B[3]===!1?"none":null,!1)},i(B){x||(bt(A,B),bt(R,B),x=!0)},o(B){Ft(A,B),Ft(R,B),x=!1},d(B){B&&O(h),A&&A.d(B),R&&R.d(B),c[13](null),c[14](null)}}}function zv(c,h,f){let y,v,x,{$$slots:a={},$$scope:A}=h,{element:I=void 0}=h,{innerElement:R=void 0}=h,{zIndex:B=void 0}=h,{pointerEvents:K=void 0}=h,{viewBox:j=void 0}=h;const{containerWidth:H,containerHeight:de,padding:Me}=Gh("LayerCake");Qt(c,H,Ue=>f(5,y=Ue)),Qt(c,de,Ue=>f(6,v=Ue)),Qt(c,Me,Ue=>f(7,x=Ue));function Se(Ue){Kl[Ue?"unshift":"push"](()=>{R=Ue,f(1,R)})}function He(Ue){Kl[Ue?"unshift":"push"](()=>{I=Ue,f(0,I)})}return c.$$set=Ue=>{"element"in Ue&&f(0,I=Ue.element),"innerElement"in Ue&&f(1,R=Ue.innerElement),"zIndex"in Ue&&f(2,B=Ue.zIndex),"pointerEvents"in Ue&&f(3,K=Ue.pointerEvents),"viewBox"in Ue&&f(4,j=Ue.viewBox),"$$scope"in Ue&&f(11,A=Ue.$$scope)},[I,R,B,K,j,y,v,x,H,de,Me,A,a,Se,He]}class Pv extends qa{constructor(h){super(),Za(this,h,zv,Av,Ga,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Km(c,h,f){const y=c.slice();return y[24]=h[f],y[26]=f,y}function Xm(c){let h,f,y,v;return{c(){h=Eo("rect"),this.h()},l(x){h=ko(x,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),fe(h).forEach(O),this.h()},h(){U(h,"class","group-rect"),U(h,"data-id",c[26]),U(h,"x",f=c[11].bandwidth?c[7](c[24]):c[7](c[24])[0]),U(h,"y",y=c[13](c[12](c[24]))-1),U(h,"width",v=c[11].bandwidth?c[11].bandwidth():c[9](c[24])),U(h,"height","3"),U(h,"fill","#CEDC20"),U(h,"stroke",c[0]),U(h,"stroke-width",c[1])},m(x,a){ke(x,h,a)},p(x,a){a&3200&&f!==(f=x[11].bandwidth?x[7](x[24]):x[7](x[24])[0])&&U(h,"x",f),a&13312&&y!==(y=x[13](x[12](x[24]))-1)&&U(h,"y",y),a&3584&&v!==(v=x[11].bandwidth?x[11].bandwidth():x[9](x[24]))&&U(h,"width",v),a&1&&U(h,"stroke",x[0]),a&2&&U(h,"stroke-width",x[1])},d(x){x&&O(h)}}}function Hm(c){let h,f,y,v,x,a,A,I,R=c[12]&&Xm(c);return{c(){h=Eo("rect"),R&&R.c(),a=Eo("text"),this.h()},l(B){h=ko(B,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),fe(h).forEach(O),R&&R.l(B),a=ko(B,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),fe(a).forEach(O),this.h()},h(){U(h,"class","group-rect"),U(h,"data-id",c[26]),U(h,"x",f=c[11].bandwidth?c[7](c[24]):c[7](c[24])[0]),U(h,"y",y=c[6](c[24])),U(h,"width",v=c[11].bandwidth?c[11].bandwidth():c[9](c[24])),U(h,"height",x=c[8](c[24])),U(h,"fill",c[4]),U(h,"stroke",c[0]),U(h,"stroke-width",c[1]),U(a,"x",A=c[11].bandwidth?c[7](c[24])+c[11].bandwidth()/2:c[7](c[24])[0]),U(a,"y",I=c[6](c[24])-4),U(a,"dx",c[2]),U(a,"dy",c[3]),U(a,"text-anchor",c[5])},m(B,K){ke(B,h,K),R&&R.m(B,K),ke(B,a,K)},p(B,K){K&3200&&f!==(f=B[11].bandwidth?B[7](B[24]):B[7](B[24])[0])&&U(h,"x",f),K&1088&&y!==(y=B[6](B[24]))&&U(h,"y",y),K&3584&&v!==(v=B[11].bandwidth?B[11].bandwidth():B[9](B[24]))&&U(h,"width",v),K&1280&&x!==(x=B[8](B[24]))&&U(h,"height",x),K&16&&U(h,"fill",B[4]),K&1&&U(h,"stroke",B[0]),K&2&&U(h,"stroke-width",B[1]),B[12]?R?R.p(B,K):(R=Xm(B),R.c(),R.m(a.parentNode,a)):R&&(R.d(1),R=null),K&3200&&A!==(A=B[11].bandwidth?B[7](B[24])+B[11].bandwidth()/2:B[7](B[24])[0])&&U(a,"x",A),K&1088&&I!==(I=B[6](B[24])-4)&&U(a,"y",I),K&4&&U(a,"dx",B[2]),K&8&&U(a,"dy",B[3]),K&32&&U(a,"text-anchor",B[5])},d(B){B&&O(h),R&&R.d(B),B&&O(a)}}}function Cv(c){let h,f=c[10],y=[];for(let v=0;v<f.length;v+=1)y[v]=Hm(Km(c,f,v));return{c(){h=Eo("g");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=ko(v,"g",{class:!0});var x=fe(h);for(let a=0;a<y.length;a+=1)y[a].l(x);x.forEach(O),this.h()},h(){U(h,"class","column-group svelte-wgzwsk")},m(v,x){ke(v,h,x);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,[x]){if(x&16383){f=v[10];let a;for(a=0;a<f.length;a+=1){const A=Km(v,f,a);y[a]?y[a].p(A,x):(y[a]=Hm(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},i:jo,o:jo,d(v){v&&O(h),Ys(y,v)}}}function Mv(c,h,f){let y,v,x,a,A,I,R,B,K;const{data:j,xGet:H,yGet:de,yRange:Me,xScale:Se,yScale:He,y:Ue,z:Rt}=Gh("LayerCake");Qt(c,j,Ke=>f(10,I=Ke)),Qt(c,H,Ke=>f(7,A=Ke)),Qt(c,de,Ke=>f(6,x=Ke)),Qt(c,Me,Ke=>f(22,a=Ke)),Qt(c,Se,Ke=>f(11,R=Ke)),Qt(c,He,Ke=>f(13,K=Ke)),Qt(c,Rt,Ke=>f(12,B=Ke));let{stroke:kt=""}=h,{strokeWidth:ut=0}=h,{dxTick:We=0}=h,{dyTick:tr=0}=h,{formatVal:Gt=Ke=>Ke}=h,{fill:St="#00205b"}=h,{textAnchor:jt="middle"}=h;return c.$$set=Ke=>{"stroke"in Ke&&f(0,kt=Ke.stroke),"strokeWidth"in Ke&&f(1,ut=Ke.strokeWidth),"dxTick"in Ke&&f(2,We=Ke.dxTick),"dyTick"in Ke&&f(3,tr=Ke.dyTick),"formatVal"in Ke&&f(21,Gt=Ke.formatVal),"fill"in Ke&&f(4,St=Ke.fill),"textAnchor"in Ke&&f(5,jt=Ke.textAnchor)},c.$$.update=()=>{c.$$.dirty&128&&f(9,y=Ke=>{const Lt=A(Ke);return Math.max(0,Lt[1]-Lt[0])}),c.$$.dirty&4194368&&f(8,v=Ke=>a[0]-x(Ke))},[kt,ut,We,tr,St,jt,x,A,v,y,I,R,B,K,j,H,de,Me,Se,He,Rt,Gt,a]}class Dv extends qa{constructor(h){super(),Za(this,h,Mv,Cv,Ga,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,formatVal:21,fill:4,textAnchor:5})}}function Wm(c,h,f){const y=c.slice();return y[28]=h[f],y[30]=f,y}function Jm(c){let h,f,y,v;return{c(){h=Eo("line"),this.h()},l(x){h=ko(x,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),fe(h).forEach(O),this.h()},h(){U(h,"y1",f=c[20]*-1),U(h,"y2",y=c[14]&&c[30]%2==0?c[10]+c[8]+2:c[10]+c[8]-13),U(h,"x1","0"),U(h,"x2","0"),U(h,"stroke",c[11]),U(h,"stroke-width",v=c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)?2:1),U(h,"class","svelte-fwjh80"),rn(h,"baseline",c[13])},m(x,a){ke(x,h,a)},p(x,a){a&1048576&&f!==(f=x[20]*-1)&&U(h,"y1",f),a&17664&&y!==(y=x[14]&&x[30]%2==0?x[10]+x[8]+2:x[10]+x[8]-13)&&U(h,"y2",y),a&2048&&U(h,"stroke",x[11]),a&32784&&v!==(v=x[15]&&Array.isArray(x[4])&&x[30]==Math.floor(x[4].length/2)?2:1)&&U(h,"stroke-width",v),a&8192&&rn(h,"baseline",x[13])},d(x){x&&O(h)}}}function Lv(c){let h=c[1](c[28])+"",f;return{c(){f=xe(h)},l(y){f=we(y,h)},m(y,v){ke(y,f,v)},p(y,v){v&262146&&h!==(h=y[1](y[28])+"")&&At(f,h)},d(y){y&&O(f)}}}function Rv(c){let h,f=c[1](c[28])+"",y,v;return{c(){h=xe(c[5]),y=xe(f),v=xe(c[6])},l(x){h=we(x,c[5]),y=we(x,f),v=we(x,c[6])},m(x,a){ke(x,h,a),ke(x,y,a),ke(x,v,a)},p(x,a){a&32&&At(h,x[5]),a&262146&&f!==(f=x[1](x[28])+"")&&At(y,f),a&64&&At(v,x[6])},d(x){x&&O(h),x&&O(y),x&&O(v)}}}function Ym(c){let h,f,y,v,x,a,A,I=c[0]!==!1&&Jm(c);function R(j,H){return j[30]==j[18].length-1?Rv:Lv}let B=R(c),K=B(c);return{c(){h=Eo("g"),I&&I.c(),f=Eo("text"),K.c(),this.h()},l(j){h=ko(j,"g",{class:!0,transform:!0});var H=fe(h);I&&I.l(H),f=ko(H,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var de=fe(f);K.l(de),de.forEach(O),H.forEach(O),this.h()},h(){U(f,"x",y=c[7]||c[16]?c[17].bandwidth()/2:0),U(f,"y",v=c[3]?c[20]*-1-6:c[14]&&c[30]%2==0?c[8]+15:c[8]),U(f,"dx",x=c[24](c[30])=="start"?c[9]-2:c[24](c[30])=="end"?c[9]+2:c[9]),U(f,"dy",c[10]),U(f,"text-anchor",c[24](c[30])),U(f,"fill",c[12]),U(f,"class","svelte-fwjh80"),rn(f,"bold",c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)),U(h,"class",a="tick tick-"+c[28]+" svelte-fwjh80"),U(h,"transform",A="translate("+c[17](c[28])+","+c[19][0]+")")},m(j,H){ke(j,h,H),I&&I.m(h,null),N(h,f),K.m(f,null)},p(j,H){j[0]!==!1?I?I.p(j,H):(I=Jm(j),I.c(),I.m(h,f)):I&&(I.d(1),I=null),B===(B=R(j))&&K?K.p(j,H):(K.d(1),K=B(j),K&&(K.c(),K.m(f,null))),H&196736&&y!==(y=j[7]||j[16]?j[17].bandwidth()/2:0)&&U(f,"x",y),H&1065224&&v!==(v=j[3]?j[20]*-1-6:j[14]&&j[30]%2==0?j[8]+15:j[8])&&U(f,"y",v),H&512&&x!==(x=j[24](j[30])=="start"?j[9]-2:j[24](j[30])=="end"?j[9]+2:j[9])&&U(f,"dx",x),H&1024&&U(f,"dy",j[10]),H&4096&&U(f,"fill",j[12]),H&32784&&rn(f,"bold",j[15]&&Array.isArray(j[4])&&j[30]==Math.floor(j[4].length/2)),H&262144&&a!==(a="tick tick-"+j[28]+" svelte-fwjh80")&&U(h,"class",a),H&917504&&A!==(A="translate("+j[17](j[28])+","+j[19][0]+")")&&U(h,"transform",A)},d(j){j&&O(h),I&&I.d(),K.d()}}}function Qm(c){let h,f,y;return{c(){h=Eo("line"),this.h()},l(v){h=ko(v,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),fe(h).forEach(O),this.h()},h(){U(h,"class","baseline svelte-fwjh80"),U(h,"y1",c[20]),U(h,"y2","0"),U(h,"x1",f=c[17](0)),U(h,"x2",y=c[17](0)),U(h,"stroke",c[11])},m(v,x){ke(v,h,x)},p(v,x){x&1048576&&U(h,"y1",v[20]),x&131072&&f!==(f=v[17](0))&&U(h,"x1",f),x&131072&&y!==(y=v[17](0))&&U(h,"x2",y),x&2048&&U(h,"stroke",v[11])},d(v){v&&O(h)}}}function Bv(c){let h,f,y=c[18],v=[];for(let a=0;a<y.length;a+=1)v[a]=Ym(Wm(c,y,a));let x=c[2]===!0&&Qm(c);return{c(){h=Eo("g");for(let a=0;a<v.length;a+=1)v[a].c();f=Ei(),x&&x.c(),this.h()},l(a){h=ko(a,"g",{class:!0});var A=fe(h);for(let I=0;I<v.length;I+=1)v[I].l(A);f=Ei(),x&&x.l(A),A.forEach(O),this.h()},h(){U(h,"class","axis x-axis")},m(a,A){ke(a,h,A);for(let I=0;I<v.length;I+=1)v[I].m(h,null);N(h,f),x&&x.m(h,null)},p(a,[A]){if(A&18874363){y=a[18];let I;for(I=0;I<y.length;I+=1){const R=Wm(a,y,I);v[I]?v[I].p(R,A):(v[I]=Ym(R),v[I].c(),v[I].m(h,f))}for(;I<v.length;I+=1)v[I].d(1);v.length=y.length}a[2]===!0?x?x.p(a,A):(x=Qm(a),x.c(),x.m(h,null)):x&&(x.d(1),x=null)},i:jo,o:jo,d(a){a&&O(h),Ys(v,a),x&&x.d()}}}function Ov(c,h,f){let y,v,x,a,A;const{width:I,height:R,xScale:B,yScale:K,yRange:j}=Gh("LayerCake");Qt(c,R,De=>f(20,A=De)),Qt(c,B,De=>f(17,x=De)),Qt(c,j,De=>f(19,a=De));let{gridlines:H=!0}=h,{formatTick:de=De=>De}=h,{baseline:Me=!1}=h,{flipped:Se=!1}=h,{snapTicks:He=!1}=h,{ticks:Ue=void 0}=h,{prefix:Rt=""}=h,{suffix:kt=""}=h,{xTick:ut=void 0}=h,{yTick:We=15}=h,{dxTick:tr=0}=h,{dyTick:Gt=0}=h,{lineColor:St="#999"}=h,{textColor:jt="#555"}=h,{solid:Ke=!1}=h,{stagger:Lt=!1}=h,{median:mt=!0}=h;function yt(De){if(He===!0){if(De===0)return"start";if(De===v.length-1)return"end"}return"middle"}return c.$$set=De=>{"gridlines"in De&&f(0,H=De.gridlines),"formatTick"in De&&f(1,de=De.formatTick),"baseline"in De&&f(2,Me=De.baseline),"flipped"in De&&f(3,Se=De.flipped),"snapTicks"in De&&f(25,He=De.snapTicks),"ticks"in De&&f(4,Ue=De.ticks),"prefix"in De&&f(5,Rt=De.prefix),"suffix"in De&&f(6,kt=De.suffix),"xTick"in De&&f(7,ut=De.xTick),"yTick"in De&&f(8,We=De.yTick),"dxTick"in De&&f(9,tr=De.dxTick),"dyTick"in De&&f(10,Gt=De.dyTick),"lineColor"in De&&f(11,St=De.lineColor),"textColor"in De&&f(12,jt=De.textColor),"solid"in De&&f(13,Ke=De.solid),"stagger"in De&&f(14,Lt=De.stagger),"median"in De&&f(15,mt=De.median)},c.$$.update=()=>{c.$$.dirty&131072&&f(16,y=typeof x.bandwidth=="function"),c.$$.dirty&196624&&f(18,v=Array.isArray(Ue)?Ue:y?x.domain():x.ticks(Ue))},[H,de,Me,Se,Ue,Rt,kt,ut,We,tr,Gt,St,jt,Ke,Lt,mt,y,x,v,a,A,R,B,j,yt,He]}class Fv extends qa{constructor(h){super(),Za(this,h,Ov,Bv,Ga,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function Nv(c){let h,f,y,v;return h=new Dv({props:{fill:c[1],formatVal:c[5]}}),y=new Fv({props:{gridlines:!1}}),{c(){Gr(h.$$.fragment),f=Je(),Gr(y.$$.fragment)},l(x){Kr(h.$$.fragment,x),f=Ye(x),Kr(y.$$.fragment,x)},m(x,a){Xr(h,x,a),ke(x,f,a),Xr(y,x,a),v=!0},p(x,a){const A={};a&2&&(A.fill=x[1]),a&32&&(A.formatVal=x[5]),h.$set(A)},i(x){v||(bt(h.$$.fragment,x),bt(y.$$.fragment,x),v=!0)},o(x){Ft(h.$$.fragment,x),Ft(y.$$.fragment,x),v=!1},d(x){Hr(h,x),x&&O(f),Hr(y,x)}}}function Vv(c){let h,f;return h=new Pv({props:{$$slots:{default:[Nv]},$$scope:{ctx:c}}}),{c(){Gr(h.$$.fragment)},l(y){Kr(h.$$.fragment,y)},m(y,v){Xr(h,y,v),f=!0},p(y,v){const x={};v&1058&&(x.$$scope={dirty:v,ctx:y}),h.$set(x)},i(y){f||(bt(h.$$.fragment,y),f=!0)},o(y){Ft(h.$$.fragment,y),f=!1},d(y){Hr(h,y)}}}function Uv(c){let h,f,y;return f=new kv({props:{padding:{top:15,right:0,bottom:20,left:0},x:c[2],y:c[3],z:c[4],xScale:Jy().paddingInner([.02]).round(!0),xDomain:c[7],yDomain:c[6],zDomain:c[6],data:c[0],$$slots:{default:[Vv]},$$scope:{ctx:c}}}),{c(){h=ce("div"),Gr(f.$$.fragment),this.h()},l(v){h=he(v,"DIV",{class:!0});var x=fe(h);Kr(f.$$.fragment,x),x.forEach(O),this.h()},h(){U(h,"class","chart-container svelte-s9z6lx")},m(v,x){ke(v,h,x),Xr(f,h,null),y=!0},p(v,[x]){const a={};x&4&&(a.x=v[2]),x&8&&(a.y=v[3]),x&16&&(a.z=v[4]),x&128&&(a.xDomain=v[7]),x&64&&(a.yDomain=v[6]),x&64&&(a.zDomain=v[6]),x&1&&(a.data=v[0]),x&1058&&(a.$$scope={dirty:x,ctx:v}),f.$set(a)},i(v){y||(bt(f.$$.fragment,v),y=!0)},o(v){Ft(f.$$.fragment,v),y=!1},d(v){v&&O(h),Hr(f)}}}function jv(c,h,f){let y,v,x,{data:a}=h,{suffix:A="%"}=h,{decimals:I=0}=h,{fill:R="#00205B"}=h,{xKey:B="x"}=h,{yKey:K="y"}=h,{zKey:j=null}=h;return c.$$set=H=>{"data"in H&&f(0,a=H.data),"suffix"in H&&f(8,A=H.suffix),"decimals"in H&&f(9,I=H.decimals),"fill"in H&&f(1,R=H.fill),"xKey"in H&&f(2,B=H.xKey),"yKey"in H&&f(3,K=H.yKey),"zKey"in H&&f(4,j=H.zKey)},c.$$.update=()=>{c.$$.dirty&5&&f(7,y=a.map(H=>H[B])),c.$$.dirty&9&&f(6,v=[0,Math.max(...a.map(H=>H[K]))]),c.$$.dirty&768&&f(5,x=H=>H.toFixed(I)+A)},[a,R,B,K,j,x,v,y,A,I]}class qv extends qa{constructor(h){super(),Za(this,h,jv,Uv,Ga,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function $m(c,h,f){const y=c.slice();return y[7]=h[f],y[9]=f,y}function ey(c){let h,f=c[0],y=[];for(let v=0;v<f.length;v+=1)y[v]=ty($m(c,f,v));return{c(){h=Eo("svg");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=ko(v,"svg",{class:!0});var x=fe(h);for(let a=0;a<y.length;a+=1)y[a].l(x);x.forEach(O),this.h()},h(){U(h,"class","stack svelte-q6mgyr")},m(v,x){ke(v,h,x);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,x){if(x&31){f=v[0];let a;for(a=0;a<f.length;a+=1){const A=$m(v,f,a);y[a]?y[a].p(A,x):(y[a]=ty(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){v&&O(h),Ys(y,v)}}}function ty(c){let h,f;return{c(){h=Eo("rect"),this.h()},l(y){h=ko(y,"rect",{class:!0,x:!0,style:!0}),fe(h).forEach(O),this.h()},h(){U(h,"class","cell svelte-q6mgyr"),U(h,"x",f=c[4][c[9]]/c[3]*100+"%"),Ce(h,"width",c[7][c[1]]/c[3]*100+"%"),Ce(h,"fill",c[2][c[9]])},m(y,v){ke(y,h,v)},p(y,v){v&24&&f!==(f=y[4][y[9]]/y[3]*100+"%")&&U(h,"x",f),v&11&&Ce(h,"width",y[7][y[1]]/y[3]*100+"%"),v&4&&Ce(h,"fill",y[2][y[9]])},d(y){y&&O(h)}}}function Zv(c){let h,f=c[3]&&c[4]&&ey(c);return{c(){f&&f.c(),h=Ei()},l(y){f&&f.l(y),h=Ei()},m(y,v){f&&f.m(y,v),ke(y,h,v)},p(y,[v]){y[3]&&y[4]?f?f.p(y,v):(f=ey(y),f.c(),f.m(h.parentNode,h)):f&&(f.d(1),f=null)},i:jo,o:jo,d(y){f&&f.d(y),y&&O(h)}}}function Gv(c,h,f){let{data:y}=h,{xKey:v="x"}=h,{yKey:x="y"}=h,{colors:a=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=h,A,I;function R(){f(3,A=y.map(K=>K[x]).reduce((K,j)=>K+j,0));let B=[0];y.forEach(K=>B.push(B[B.length-1]+K[x])),f(4,I=B)}return c.$$set=B=>{"data"in B&&f(0,y=B.data),"xKey"in B&&f(5,v=B.xKey),"yKey"in B&&f(1,x=B.yKey),"colors"in B&&f(2,a=B.colors)},c.$$.update=()=>{c.$$.dirty&3&&(y||x)&&R()},[y,x,a,A,I,v]}class sg extends qa{constructor(h){super(),Za(this,h,Gv,Zv,Ga,{data:0,xKey:5,yKey:1,colors:2})}}function ry(c,h,f){const y=c.slice();return y[12]=h[f],y[14]=f,y}function Kv(c){let h,f,y=c[6](c[12][c[3]])+"",v,x;return{c(){h=ce("span"),f=xe("(NI "),v=xe(y),x=xe(")"),this.h()},l(a){h=he(a,"SPAN",{class:!0,style:!0});var A=fe(h);f=we(A,"(NI "),v=we(A,y),x=we(A,")"),A.forEach(O),this.h()},h(){U(h,"class",""),Ce(h,"color","#3878C5")},m(a,A){ke(a,h,A),N(h,f),N(h,v),N(h,x)},p(a,A){A&9&&y!==(y=a[6](a[12][a[3]])+"")&&At(v,y)},d(a){a&&O(h)}}}function Xv(c){let h,f,y=bm(Math.round(c[12][c[3]]),"%)")+"",v;return{c(){h=ce("span"),f=xe("(2011 "),v=xe(y),this.h()},l(x){h=he(x,"SPAN",{class:!0,style:!0});var a=fe(h);f=we(a,"(2011 "),v=we(a,y),a.forEach(O),this.h()},h(){U(h,"class",""),Ce(h,"color","#3878C5")},m(x,a){ke(x,h,a),N(h,f),N(h,v)},p(x,a){a&9&&y!==(y=bm(Math.round(x[12][x[3]]),"%)")+"")&&At(v,y)},d(x){x&&O(h)}}}function iy(c){let h,f,y,v,x=c[12][c[1]]+"",a,A,I=c[6](c[12][c[2]])+"",R,B,K;function j(Me,Se){if(Me[3]=="prev")return Xv;if(Me[3])return Kv}let H=j(c),de=H&&H(c);return{c(){h=ce("li"),f=Eo("svg"),y=Eo("rect"),v=Je(),a=xe(x),A=Je(),R=xe(I),B=Je(),de&&de.c(),K=Je(),this.h()},l(Me){h=he(Me,"LI",{style:!0,class:!0});var Se=fe(h);f=ko(Se,"svg",{width:!0,height:!0,class:!0});var He=fe(f);y=ko(He,"rect",{width:!0,height:!0,style:!0});var Ue=fe(y);Ue.forEach(O),He.forEach(O),v=Ye(Se),a=we(Se,x),A=Ye(Se),R=we(Se,I),B=Ye(Se),de&&de.l(Se),K=Ye(Se),Se.forEach(O),this.h()},h(){U(y,"width","20"),U(y,"height","30"),Ce(y,"fill",c[4][c[14]]),U(f,"width","20"),U(f,"height","30"),U(f,"class","bullet svelte-89uh35"),Ce(h,"color",c[5]),U(h,"class","svelte-89uh35")},m(Me,Se){ke(Me,h,Se),N(h,f),N(f,y),N(h,v),N(h,a),N(h,A),N(h,R),N(h,B),de&&de.m(h,null),N(h,K)},p(Me,Se){Se&16&&Ce(y,"fill",Me[4][Me[14]]),Se&3&&x!==(x=Me[12][Me[1]]+"")&&At(a,x),Se&5&&I!==(I=Me[6](Me[12][Me[2]])+"")&&At(R,I),H===(H=j(Me))&&de?de.p(Me,Se):(de&&de.d(1),de=H&&H(Me),de&&(de.c(),de.m(h,K))),Se&32&&Ce(h,"color",Me[5])},d(Me){Me&&O(h),de&&de.d()}}}function Hv(c){let h,f=c[0],y=[];for(let v=0;v<f.length;v+=1)y[v]=iy(ry(c,f,v));return{c(){h=ce("ul");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=he(v,"UL",{class:!0});var x=fe(h);for(let a=0;a<y.length;a+=1)y[a].l(x);x.forEach(O),this.h()},h(){U(h,"class","svelte-89uh35")},m(v,x){ke(v,h,x);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,[x]){if(x&127){f=v[0];let a;for(a=0;a<f.length;a+=1){const A=ry(v,f,a);y[a]?y[a].p(A,x):(y[a]=iy(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},i:jo,o:jo,d(v){v&&O(h),Ys(y,v)}}}function Wv(c,h,f){let y,{data:v}=h,{xKey:x="x"}=h,{yKey:a="y"}=h,{zKey:A="ew"}=h,{colors:I=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=h,{textColor:R="#555"}=h,{mutedColor:B="#999"}=h,{decimals:K=null}=h,{round:j=!1}=h;function H(de){let Me;return K?Me=(de/y*100).toFixed(K)+"%":de/y*100<1?Me="<1%":Me=(de/y*100).toFixed(0)+"%",Me}return c.$$set=de=>{"data"in de&&f(0,v=de.data),"xKey"in de&&f(1,x=de.xKey),"yKey"in de&&f(2,a=de.yKey),"zKey"in de&&f(3,A=de.zKey),"colors"in de&&f(4,I=de.colors),"textColor"in de&&f(5,R=de.textColor),"mutedColor"in de&&f(7,B=de.mutedColor),"decimals"in de&&f(8,K=de.decimals),"round"in de&&f(9,j=de.round)},c.$$.update=()=>{c.$$.dirty&5&&(y=v.map(de=>de[a]).reduce((de,Me)=>de+Me,0)),c.$$.dirty&9&&v.map(de=>de[A]).reduce((de,Me)=>de+Me,0)},[v,x,a,A,I,R,H,B,K,j]}class Jv extends qa{constructor(h){super(),Za(this,h,Wv,Hv,Ga,{data:0,xKey:1,yKey:2,zKey:3,colors:4,textColor:5,mutedColor:7,decimals:8,round:9})}}function ny(c){let h,f,y,v;f=new sg({props:{data:c[0],yKey:c[4],colors:c[5]}});let x=c[7]&&oy(c);return{c(){h=ce("div"),Gr(f.$$.fragment),y=Je(),x&&x.c(),this.h()},l(a){h=he(a,"DIV",{class:!0,style:!0});var A=fe(h);Kr(f.$$.fragment,A),y=Ye(A),x&&x.l(A),A.forEach(O),this.h()},h(){U(h,"class","chart svelte-1tebgpk"),Ce(h,"height",c[1]*.28+"px")},m(a,A){ke(a,h,A),Xr(f,h,null),N(h,y),x&&x.m(h,null),v=!0},p(a,A){const I={};A&1&&(I.data=a[0]),A&16&&(I.yKey=a[4]),A&32&&(I.colors=a[5]),f.$set(I),a[7]?x?x.p(a,A):(x=oy(a),x.c(),x.m(h,null)):x&&(x.d(1),x=null),(!v||A&2)&&Ce(h,"height",a[1]*.28+"px")},i(a){v||(bt(f.$$.fragment,a),v=!0)},o(a){Ft(f.$$.fragment,a),v=!1},d(a){a&&O(h),Hr(f),x&&x.d()}}}function oy(c){let h,f;return{c(){h=ce("div"),f=xe(c[7]),this.h()},l(y){h=he(y,"DIV",{class:!0});var v=fe(h);f=we(v,c[7]),v.forEach(O),this.h()},h(){U(h,"class","label svelte-1tebgpk")},m(y,v){ke(y,h,v),N(h,f)},p(y,v){v&128&&At(f,y[7])},d(y){y&&O(h)}}}function Yv(c){let h,f,y,v,x,a,A;f=new sg({props:{data:c[0],yKey:c[3],colors:c[5]}});let I=c[4]&&ny(c);return a=new Jv({props:{data:c[0],xKey:c[2],yKey:c[3],zKey:c[4],decimals:c[6],colors:c[5]}}),{c(){h=ce("div"),Gr(f.$$.fragment),y=Je(),I&&I.c(),v=Je(),x=ce("div"),Gr(a.$$.fragment),this.h()},l(R){h=he(R,"DIV",{class:!0,style:!0});var B=fe(h);Kr(f.$$.fragment,B),B.forEach(O),y=Ye(R),I&&I.l(R),v=Ye(R),x=he(R,"DIV",{class:!0});var K=fe(x);Kr(a.$$.fragment,K),K.forEach(O),this.h()},h(){U(h,"class","chart svelte-1tebgpk"),Ce(h,"padding-top","3px"),Ce(h,"height",(c[4]?c[1]*.72:c[1])+"px"),U(x,"class","legend svelte-1tebgpk")},m(R,B){ke(R,h,B),Xr(f,h,null),ke(R,y,B),I&&I.m(R,B),ke(R,v,B),ke(R,x,B),Xr(a,x,null),A=!0},p(R,[B]){const K={};B&1&&(K.data=R[0]),B&8&&(K.yKey=R[3]),B&32&&(K.colors=R[5]),f.$set(K),(!A||B&18)&&Ce(h,"height",(R[4]?R[1]*.72:R[1])+"px"),R[4]?I?(I.p(R,B),B&16&&bt(I,1)):(I=ny(R),I.c(),bt(I,1),I.m(v.parentNode,v)):I&&(Ls(),Ft(I,1,1,()=>{I=null}),Rs());const j={};B&1&&(j.data=R[0]),B&4&&(j.xKey=R[2]),B&8&&(j.yKey=R[3]),B&16&&(j.zKey=R[4]),B&64&&(j.decimals=R[6]),B&32&&(j.colors=R[5]),a.$set(j)},i(R){A||(bt(f.$$.fragment,R),bt(I),bt(a.$$.fragment,R),A=!0)},o(R){Ft(f.$$.fragment,R),Ft(I),Ft(a.$$.fragment,R),A=!1},d(R){R&&O(h),Hr(f),R&&O(y),I&&I.d(R),R&&O(v),R&&O(x),Hr(a)}}}function Qv(c,h,f){let{data:y}=h,{height:v=80}=h,{xKey:x="x"}=h,{yKey:a="y"}=h,{zKey:A="ew"}=h,{colors:I=["#00205B","#6C63AC","#781C87","#C11B71","#FB7979","#801650","#fbb15f","#F66068","lightgrey"]}=h,{decimals:R=null}=h,{label:B=null}=h;return c.$$set=K=>{"data"in K&&f(0,y=K.data),"height"in K&&f(1,v=K.height),"xKey"in K&&f(2,x=K.xKey),"yKey"in K&&f(3,a=K.yKey),"zKey"in K&&f(4,A=K.zKey),"colors"in K&&f(5,I=K.colors),"decimals"in K&&f(6,R=K.decimals),"label"in K&&f(7,B=K.label)},[y,v,x,a,A,I,R,B]}class Ws extends qa{constructor(h){super(),Za(this,h,Qv,Yv,Ga,{data:0,height:1,xKey:2,yKey:3,zKey:4,colors:5,decimals:6,label:7})}}var $v=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e0={rgb2hsl:Xh,rgb2hsv:ff,rgb2hwb:Hh,rgb2cmyk:Wh,rgb2keyword:Jh,rgb2xyz:hd,rgb2lab:pd,rgb2lch:t0,hsl2rgb:df,hsl2hsv:r0,hsl2hwb:i0,hsl2cmyk:n0,hsl2keyword:o0,hsv2rgb:mf,hsv2hsl:a0,hsv2hwb:s0,hsv2cmyk:l0,hsv2keyword:u0,hwb2rgb:Yh,hwb2hsl:c0,hwb2hsv:h0,hwb2cmyk:p0,hwb2keyword:f0,cmyk2rgb:Qh,cmyk2hsl:d0,cmyk2hsv:m0,cmyk2hwb:y0,cmyk2keyword:g0,keyword2rgb:ac,keyword2hsl:x0,keyword2hsv:w0,keyword2hwb:S0,keyword2cmyk:E0,keyword2lab:k0,keyword2xyz:T0,xyz2rgb:lg,xyz2lab:ug,xyz2lch:_0,lab2xyz:fd,lab2rgb:cg,lab2lch:dd,lch2lab:md,lch2xyz:v0,lch2rgb:b0};function Xh(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255,v=Math.min(h,f,y),x=Math.max(h,f,y),a=x-v,A,I,R;return x==v?A=0:h==x?A=(f-y)/a:f==x?A=2+(y-h)/a:y==x&&(A=4+(h-f)/a),A=Math.min(A*60,360),A<0&&(A+=360),R=(v+x)/2,x==v?I=0:R<=.5?I=a/(x+v):I=a/(2-x-v),[A,I*100,R*100]}function ff(c){var h=c[0],f=c[1],y=c[2],v=Math.min(h,f,y),x=Math.max(h,f,y),a=x-v,A,I,R;return x==0?I=0:I=a/x*1e3/10,x==v?A=0:h==x?A=(f-y)/a:f==x?A=2+(y-h)/a:y==x&&(A=4+(h-f)/a),A=Math.min(A*60,360),A<0&&(A+=360),R=x/255*1e3/10,[A,I,R]}function Hh(c){var h=c[0],f=c[1],x=c[2],y=Xh(c)[0],v=1/255*Math.min(h,Math.min(f,x)),x=1-1/255*Math.max(h,Math.max(f,x));return[y,v*100,x*100]}function Wh(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255,v,x,a,A;return A=Math.min(1-h,1-f,1-y),v=(1-h-A)/(1-A)||0,x=(1-f-A)/(1-A)||0,a=(1-y-A)/(1-A)||0,[v*100,x*100,a*100,A*100]}function Jh(c){return hg[JSON.stringify(c)]}function hd(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255;h=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,f=f>.04045?Math.pow((f+.055)/1.055,2.4):f/12.92,y=y>.04045?Math.pow((y+.055)/1.055,2.4):y/12.92;var v=h*.4124+f*.3576+y*.1805,x=h*.2126+f*.7152+y*.0722,a=h*.0193+f*.1192+y*.9505;return[v*100,x*100,a*100]}function pd(c){var h=hd(c),f=h[0],y=h[1],v=h[2],x,a,A;return f/=95.047,y/=100,v/=108.883,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=v>.008856?Math.pow(v,1/3):7.787*v+16/116,x=116*y-16,a=500*(f-y),A=200*(y-v),[x,a,A]}function t0(c){return dd(pd(c))}function df(c){var h=c[0]/360,f=c[1]/100,y=c[2]/100,v,x,a,A,I;if(f==0)return I=y*255,[I,I,I];y<.5?x=y*(1+f):x=y+f-y*f,v=2*y-x,A=[0,0,0];for(var R=0;R<3;R++)a=h+1/3*-(R-1),a<0&&a++,a>1&&a--,6*a<1?I=v+(x-v)*6*a:2*a<1?I=x:3*a<2?I=v+(x-v)*(2/3-a)*6:I=v,A[R]=I*255;return A}function r0(c){var h=c[0],f=c[1]/100,y=c[2]/100,v,x;return y===0?[0,0,0]:(y*=2,f*=y<=1?y:2-y,x=(y+f)/2,v=2*f/(y+f),[h,v*100,x*100])}function i0(c){return Hh(df(c))}function n0(c){return Wh(df(c))}function o0(c){return Jh(df(c))}function mf(c){var h=c[0]/60,f=c[1]/100,I=c[2]/100,y=Math.floor(h)%6,v=h-Math.floor(h),x=255*I*(1-f),a=255*I*(1-f*v),A=255*I*(1-f*(1-v)),I=255*I;switch(y){case 0:return[I,A,x];case 1:return[a,I,x];case 2:return[x,I,A];case 3:return[x,a,I];case 4:return[A,x,I];case 5:return[I,x,a]}}function a0(c){var h=c[0],f=c[1]/100,y=c[2]/100,v,x;return x=(2-f)*y,v=f*y,v/=x<=1?x:2-x,v=v||0,x/=2,[h,v*100,x*100]}function s0(c){return Hh(mf(c))}function l0(c){return Wh(mf(c))}function u0(c){return Jh(mf(c))}function Yh(c){var h=c[0]/360,f=c[1]/100,y=c[2]/100,v=f+y,x,a,A,I;switch(v>1&&(f/=v,y/=v),x=Math.floor(6*h),a=1-y,A=6*h-x,(x&1)!=0&&(A=1-A),I=f+A*(a-f),x){default:case 6:case 0:r=a,g=I,b=f;break;case 1:r=I,g=a,b=f;break;case 2:r=f,g=a,b=I;break;case 3:r=f,g=I,b=a;break;case 4:r=I,g=f,b=a;break;case 5:r=a,g=f,b=I;break}return[r*255,g*255,b*255]}function c0(c){return Xh(Yh(c))}function h0(c){return ff(Yh(c))}function p0(c){return Wh(Yh(c))}function f0(c){return Jh(Yh(c))}function Qh(c){var h=c[0]/100,f=c[1]/100,y=c[2]/100,v=c[3]/100,x,a,A;return x=1-Math.min(1,h*(1-v)+v),a=1-Math.min(1,f*(1-v)+v),A=1-Math.min(1,y*(1-v)+v),[x*255,a*255,A*255]}function d0(c){return Xh(Qh(c))}function m0(c){return ff(Qh(c))}function y0(c){return Hh(Qh(c))}function g0(c){return Jh(Qh(c))}function lg(c){var h=c[0]/100,f=c[1]/100,y=c[2]/100,v,x,a;return v=h*3.2406+f*-1.5372+y*-.4986,x=h*-.9689+f*1.8758+y*.0415,a=h*.0557+f*-.204+y*1.057,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v=v*12.92,x=x>.0031308?1.055*Math.pow(x,1/2.4)-.055:x=x*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,v=Math.min(Math.max(0,v),1),x=Math.min(Math.max(0,x),1),a=Math.min(Math.max(0,a),1),[v*255,x*255,a*255]}function ug(c){var h=c[0],f=c[1],y=c[2],v,x,a;return h/=95.047,f/=100,y/=108.883,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=116*f-16,x=500*(h-f),a=200*(f-y),[v,x,a]}function _0(c){return dd(ug(c))}function fd(c){var h=c[0],f=c[1],y=c[2],v,x,a,A;return h<=8?(x=h*100/903.3,A=7.787*(x/100)+16/116):(x=100*Math.pow((h+16)/116,3),A=Math.pow(x/100,1/3)),v=v/95.047<=.008856?v=95.047*(f/500+A-16/116)/7.787:95.047*Math.pow(f/500+A,3),a=a/108.883<=.008859?a=108.883*(A-y/200-16/116)/7.787:108.883*Math.pow(A-y/200,3),[v,x,a]}function dd(c){var h=c[0],f=c[1],y=c[2],v,x,a;return v=Math.atan2(y,f),x=v*360/2/Math.PI,x<0&&(x+=360),a=Math.sqrt(f*f+y*y),[h,a,x]}function cg(c){return lg(fd(c))}function md(c){var h=c[0],f=c[1],y=c[2],v,x,a;return a=y/360*2*Math.PI,v=f*Math.cos(a),x=f*Math.sin(a),[h,v,x]}function v0(c){return fd(md(c))}function b0(c){return cg(md(c))}function ac(c){return ad[c]}function x0(c){return Xh(ac(c))}function w0(c){return ff(ac(c))}function S0(c){return Hh(ac(c))}function E0(c){return Wh(ac(c))}function k0(c){return pd(ac(c))}function T0(c){return hd(ac(c))}var ad={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},hg={};for(var ay in ad)hg[JSON.stringify(ad[ay])]=ay;var Yf=e0,tc=function(){return new $h};for(var Fh in Yf){tc[Fh+"Raw"]=function(c){return function(h){return typeof h=="number"&&(h=Array.prototype.slice.call(arguments)),Yf[c](h)}}(Fh);var sy=/(\w+)2(\w+)/.exec(Fh),Qf=sy[1],I0=sy[2];tc[Qf]=tc[Qf]||{},tc[Qf][I0]=tc[Fh]=function(c){return function(h){typeof h=="number"&&(h=Array.prototype.slice.call(arguments));var f=Yf[c](h);if(typeof f=="string"||f===void 0)return f;for(var y=0;y<f.length;y++)f[y]=Math.round(f[y]);return f}}(Fh)}var $h=function(){this.convs={}};$h.prototype.routeSpace=function(c,h){var f=h[0];return f===void 0?this.getValues(c):(typeof f=="number"&&(f=Array.prototype.slice.call(h)),this.setValues(c,f))};$h.prototype.setValues=function(c,h){return this.space=c,this.convs={},this.convs[c]=h,this};$h.prototype.getValues=function(c){var h=this.convs[c];if(!h){var f=this.space,y=this.convs[f];h=tc[f][c](y),this.convs[c]=h}return h};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(c){$h.prototype[c]=function(h){return this.routeSpace(c,arguments)}});var A0=tc,$f=A0,z0=function(c){var h,f,y,v;if(h=/^((?:rgb|hs[lv]|cmyk|xyz|lab)a?)\s*\(([^\)]*)\)/.exec(c)){var x=h[1],a=x.replace(/a$/,""),A=a==="cmyk"?4:3;f=$f[a],y=h[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map(function(R,B){return/%$/.test(R)&&B===A?parseFloat(R)/100:(/%$/.test(R),parseFloat(R))}),x===a&&y.push(1),v=y[A]===void 0?1:y[A],y=y.slice(0,A),f[a]=function(){return y}}else if(/^#[A-Fa-f0-9]+$/.test(c)){var a=c.replace(/^#/,""),A=a.length;f=$f.rgb,y=a.split(A===3?/(.)/:/(..)/),y=y.filter(Boolean).map(function(K){return parseInt(A===3?K+K:K,16)}),v=1,f.rgb=function(){return y},y[0]||(y[0]=0),y[1]||(y[1]=0),y[2]||(y[2]=0)}else f=$f.keyword,f.keyword=function(){return c},y=c,v=1;var I={rgb:void 0,hsl:void 0,hsv:void 0,cmyk:void 0,keyword:void 0,hex:void 0};try{I.rgb=f.rgb(y)}catch{}try{I.hsl=f.hsl(y)}catch{}try{I.hsv=f.hsv(y)}catch{}try{I.cmyk=f.cmyk(y)}catch{}try{I.keyword=f.keyword(y)}catch{}return I.rgb&&(I.hex="#"+I.rgb.map(function(R){var B=R.toString(16);return B.length===1?"0"+B:B}).join("")),I.rgb&&(I.rgba=I.rgb.concat(v)),I.hsl&&(I.hsla=I.hsl.concat(v)),I.hsv&&(I.hsva=I.hsv.concat(v)),I.cmyk&&(I.cmyka=I.cmyk.concat(v)),I};function P0(c){let h,f;const y=c[5].default,v=Fc(y,c,c[4],null);return{c(){h=ce("span"),v&&v.c(),this.h()},l(x){h=he(x,"SPAN",{class:!0,style:!0,role:!0});var a=fe(h);v&&v.l(a),a.forEach(O),this.h()},h(){U(h,"class","em svelte-s1t2y4"),Ce(h,"background-color",c[0]),Ce(h,"color",c[2]),U(h,"role","presentation"),rn(h,"nowrap",c[1])},m(x,a){ke(x,h,a),v&&v.m(h,null),f=!0},p(x,[a]){v&&v.p&&(!f||a&16)&&Nc(v,y,x,x[4],f?Uc(y,x[4],a,null):Vc(x[4]),null),(!f||a&1)&&Ce(h,"background-color",x[0]),(!f||a&4)&&Ce(h,"color",x[2]),a&2&&rn(h,"nowrap",x[1])},i(x){f||(bt(v,x),f=!0)},o(x){Ft(v,x),f=!1},d(x){x&&O(h),v&&v.d(x)}}}function C0(c,h,f){let y,{$$slots:v={},$$scope:x}=h,{color:a="lightgrey"}=h,{nowrap:A=!0}=h;function I(B){return(B[0]*299+B[1]*587+B[2]*114)/1e3>125?"black":"white"}let R="black";return c.$$set=B=>{"color"in B&&f(0,a=B.color),"nowrap"in B&&f(1,A=B.nowrap),"$$scope"in B&&f(4,x=B.$$scope)},c.$$.update=()=>{c.$$.dirty&1&&f(3,y=z0(a).rgb),c.$$.dirty&8&&y&&f(2,R=I(y))},[a,A,R,y,x,v]}class yf extends qa{constructor(h){super(),Za(this,h,C0,P0,Ga,{color:0,nowrap:1})}}function ly(c,h,f){const y=c.slice();return y[33]=h[f],y[36]=h,y[35]=f,y}function uy(c,h,f){const y=c.slice();return y[33]=h[f],y[34]=h,y[35]=f,y}function M0(c){let h,f,y=(c[0]?c[0]:"Select one")+"",v,x,a,A,I,R;return{c(){h=ce("a"),f=ce("span"),v=xe(y),x=Je(),a=ce("span"),A=xe("\xA0"),this.h()},l(B){h=he(B,"A",{id:!0,class:!0});var K=fe(h);f=he(K,"SPAN",{class:!0});var j=fe(f);v=we(j,y),j.forEach(O),x=Ye(K),a=he(K,"SPAN",{class:!0});var H=fe(a);A=we(H,"\xA0"),H.forEach(O),K.forEach(O),this.h()},h(){U(f,"class","svelte-13flvue"),U(a,"class","button svelte-13flvue"),rn(a,"search",c[3]),rn(a,"down",!c[3]),U(h,"id","toggle"),U(h,"class","svelte-13flvue")},m(B,K){ke(B,h,K),N(h,f),N(f,v),N(h,x),N(h,a),N(a,A),I||(R=Qn(h,"click",c[12]),I=!0)},p(B,K){K[0]&1&&y!==(y=(B[0]?B[0]:"Select one")+"")&&At(v,y),K[0]&8&&rn(a,"search",B[3]),K[0]&8&&rn(a,"down",!B[3])},d(B){B&&O(h),I=!1,R()}}}function D0(c){let h,f,y=c[5][c[1]]+"",v,x,a,A,I,R,B,K=c[2]&&cy(c);return{c(){h=ce("a"),f=ce("span"),v=xe(y),x=Je(),K&&K.c(),a=Je(),A=ce("span"),I=xe("\xA0"),this.h()},l(j){h=he(j,"A",{id:!0,class:!0});var H=fe(h);f=he(H,"SPAN",{class:!0});var de=fe(f);v=we(de,y),x=Ye(de),K&&K.l(de),de.forEach(O),a=Ye(H),A=he(H,"SPAN",{class:!0});var Me=fe(A);I=we(Me,"\xA0"),Me.forEach(O),H.forEach(O),this.h()},h(){U(f,"class","selection svelte-13flvue"),U(A,"class","button close svelte-13flvue"),U(h,"id","toggle"),U(h,"class","selected svelte-13flvue")},m(j,H){ke(j,h,H),N(h,f),N(f,v),N(f,x),K&&K.m(f,null),N(h,a),N(h,A),N(A,I),R||(B=[Qn(A,"click",c[14]),Qn(h,"click",c[12])],R=!0)},p(j,H){H[0]&34&&y!==(y=j[5][j[1]]+"")&&At(v,y),j[2]?K?K.p(j,H):(K=cy(j),K.c(),K.m(f,null)):K&&(K.d(1),K=null)},d(j){j&&O(h),K&&K.d(),R=!1,nc(B)}}}function cy(c){let h,f=c[5][c[2]]+"",y;return{c(){h=ce("small"),y=xe(f),this.h()},l(v){h=he(v,"SMALL",{class:!0});var x=fe(h);y=we(x,f),x.forEach(O),this.h()},h(){U(h,"class","svelte-13flvue")},m(v,x){ke(v,h,x),N(h,y)},p(v,x){x[0]&36&&f!==(f=v[5][v[2]]+"")&&At(y,f)},d(v){v&&O(h)}}}function hy(c){let h,f,y,v,x,a;function A(B,K){return B[4].length<3?O0:B[8][0]&&B[2]?B0:B[8][0]?R0:L0}let I=A(c),R=I(c);return{c(){h=ce("div"),f=ce("input"),y=Je(),v=ce("ul"),R.c(),this.h()},l(B){h=he(B,"DIV",{id:!0,style:!0,class:!0});var K=fe(h);f=he(K,"INPUT",{type:!0,placeholder:!0,autocomplete:!0,onfocus:!0,class:!0}),y=Ye(K),v=he(K,"UL",{class:!0});var j=fe(v);R.l(j),j.forEach(O),K.forEach(O),this.h()},h(){U(f,"type","text"),U(f,"placeholder",""),U(f,"autocomplete","false"),f.autofocus="autofocus",U(f,"onfocus","this.select()"),U(f,"class","svelte-13flvue"),U(v,"class","svelte-13flvue"),U(h,"id","dropdown"),Ce(h,"top","0"),U(h,"class","svelte-13flvue")},m(B,K){ke(B,h,K),N(h,f),ym(f,c[4]),c[24](f),N(h,y),N(h,v),R.m(v,null),c[31](h),f.focus(),x||(a=[Qn(f,"input",c[23]),Qn(f,"keyup",c[16])],x=!0)},p(B,K){K[0]&16&&f.value!==B[4]&&ym(f,B[4]),I===(I=A(B))&&R?R.p(B,K):(R.d(1),R=I(B),R&&(R.c(),R.m(v,null)))},d(B){B&&O(h),c[24](null),R.d(),c[31](null),x=!1,nc(a)}}}function L0(c){let h,f;return{c(){h=ce("li"),f=xe("No results"),this.h()},l(y){h=he(y,"LI",{class:!0});var v=fe(h);f=we(v,"No results"),v.forEach(O),this.h()},h(){U(h,"class","svelte-13flvue")},m(y,v){ke(y,h,v),N(h,f)},p:jo,d(y){y&&O(h)}}}function R0(c){let h,f=c[8],y=[];for(let v=0;v<f.length;v+=1)y[v]=py(ly(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=Ei()},l(v){for(let x=0;x<y.length;x+=1)y[x].l(v);h=Ei()},m(v,x){for(let a=0;a<y.length;a+=1)y[a].m(v,x);ke(v,h,x)},p(v,x){if(x[0]&10626){f=v[8];let a;for(a=0;a<f.length;a+=1){const A=ly(v,f,a);y[a]?y[a].p(A,x):(y[a]=py(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){Ys(y,v),v&&O(h)}}}function B0(c){let h,f=c[8],y=[];for(let v=0;v<f.length;v+=1)y[v]=fy(uy(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=Ei()},l(v){for(let x=0;x<y.length;x+=1)y[x].l(v);h=Ei()},m(v,x){for(let a=0;a<y.length;a+=1)y[a].m(v,x);ke(v,h,x)},p(v,x){if(x[0]&10630){f=v[8];let a;for(a=0;a<f.length;a+=1){const A=uy(v,f,a);y[a]?y[a].p(A,x):(y[a]=fy(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){Ys(y,v),v&&O(h)}}}function O0(c){let h,f;return{c(){h=ce("li"),f=xe("Type a name..."),this.h()},l(y){h=he(y,"LI",{class:!0});var v=fe(h);f=we(v,"Type a name..."),v.forEach(O),this.h()},h(){U(h,"class","svelte-13flvue")},m(y,v){ke(y,h,v),N(h,f)},p:jo,d(y){y&&O(h)}}}function py(c){let h,f=c[33][c[1]]+"",y,v,x=c[35],a,A;function I(){return c[28](c[33])}function R(){return c[29](c[35])}const B=()=>c[30](h,x),K=()=>c[30](null,x);return{c(){h=ce("li"),y=xe(f),v=Je(),this.h()},l(j){h=he(j,"LI",{class:!0});var H=fe(h);y=we(H,f),v=Ye(H),H.forEach(O),this.h()},h(){U(h,"class","svelte-13flvue"),rn(h,"highlight",c[7]==c[35])},m(j,H){ke(j,h,H),N(h,y),N(h,v),B(),a||(A=[Qn(h,"click",I),Qn(h,"mouseover",R)],a=!0)},p(j,H){c=j,H[0]&258&&f!==(f=c[33][c[1]]+"")&&At(y,f),x!==c[35]&&(K(),x=c[35],B()),H[0]&128&&rn(h,"highlight",c[7]==c[35])},d(j){j&&O(h),K(),a=!1,nc(A)}}}function fy(c){let h,f=c[33][c[1]]+"",y,v,x,a=c[33][c[2]]+"",A,I,R=c[35],B,K;function j(){return c[25](c[33])}function H(){return c[26](c[35])}const de=()=>c[27](h,R),Me=()=>c[27](null,R);return{c(){h=ce("li"),y=xe(f),v=Je(),x=ce("small"),A=xe(a),I=Je(),this.h()},l(Se){h=he(Se,"LI",{class:!0});var He=fe(h);y=we(He,f),v=Ye(He),x=he(He,"SMALL",{class:!0});var Ue=fe(x);A=we(Ue,a),Ue.forEach(O),I=Ye(He),He.forEach(O),this.h()},h(){U(x,"class","svelte-13flvue"),U(h,"class","svelte-13flvue"),rn(h,"highlight",c[7]==c[35])},m(Se,He){ke(Se,h,He),N(h,y),N(h,v),N(h,x),N(x,A),N(h,I),de(),B||(K=[Qn(h,"click",j),Qn(h,"mouseover",H)],B=!0)},p(Se,He){c=Se,He[0]&258&&f!==(f=c[33][c[1]]+"")&&At(y,f),He[0]&260&&a!==(a=c[33][c[2]]+"")&&At(A,a),R!==c[35]&&(Me(),R=c[35],de()),He[0]&128&&rn(h,"highlight",c[7]==c[35])},d(Se){Se&&O(h),Me(),B=!1,nc(K)}}}function F0(c){let h,f,y,v;function x(R,B){return R[5]&&!R[3]?D0:M0}let a=x(c),A=a(c),I=c[6]&&hy(c);return{c(){h=ce("div"),A.c(),f=Je(),I&&I.c(),this.h()},l(R){h=he(R,"DIV",{id:!0,class:!0});var B=fe(h);A.l(B),f=Ye(B),I&&I.l(B),B.forEach(O),this.h()},h(){U(h,"id","select"),U(h,"class","svelte-13flvue"),rn(h,"active",c[6])},m(R,B){ke(R,h,B),A.m(h,null),N(h,f),I&&I.m(h,null),y||(v=[Qn(window,"click",c[17]),Qn(h,"keydown",c[15])],y=!0)},p(R,B){a===(a=x(R))&&A?A.p(R,B):(A.d(1),A=a(R),A&&(A.c(),A.m(h,f))),R[6]?I?I.p(R,B):(I=hy(R),I.c(),I.m(h,null)):I&&(I.d(1),I=null),B[0]&64&&rn(h,"active",R[6])},i:jo,o:jo,d(R){R&&O(h),A.d(),I&&I.d(),y=!1,nc(v)}}}function N0(c){return new Promise(h=>setTimeout(h,c))}function V0(c,h,f){let y;const v=jy();let{options:x}=h,{selected:a=null}=h,{placeholder:A="Enter a town or area name"}=h,{value:I="code"}=h,{label:R="name"}=h,{group:B=null}=h,{search:K=!1}=h,j=a,H=a?x.find(Ge=>{Ge[I]==a[I]}):null,de=!1,Me="",Se=null,He,Ue,Rt,kt=[];function ut(Ge){Ge.stopPropagation(),f(4,Me=""),f(6,de=!de),N0(10).then(()=>{Rt&&de&&Rt.focus()})}function We(Ge){f(18,a=Ge),f(6,de=!1),v("select",{selected:Ge,value:Ge[I]})}function tr(Ge){Ge.stopPropagation(),f(18,a=null),f(21,j=null),f(5,H=null),v("select",{selected:null,value:null})}function Gt(Ge){de&&He[0]&&Number.isInteger(Se)&&(Ge.keyCode===38?(f(7,Se-=Se>0?1:0),kt[Se].scrollIntoView({block:"nearest",inline:"start"})):Ge.keyCode===40&&(f(7,Se+=Se<He.length-1?1:0),kt[Se].scrollIntoView({block:"nearest",inline:"end"})))}function St(Ge){He[0]&&Number.isInteger(Se)&&Ge.keyCode===13&&We(He[Se])}function jt(Ge){Ge.target!==Ue&&(f(6,de=!1),f(7,Se=0))}function Ke(){Me=this.value,f(4,Me)}function Lt(Ge){Kl[Ge?"unshift":"push"](()=>{Rt=Ge,f(10,Rt)})}const mt=Ge=>We(Ge),yt=Ge=>f(7,Se=Ge);function De(Ge,et){Kl[Ge?"unshift":"push"](()=>{kt[et]=Ge,f(11,kt)})}const Ne=Ge=>We(Ge),Tt=Ge=>f(7,Se=Ge);function fr(Ge,et){Kl[Ge?"unshift":"push"](()=>{kt[et]=Ge,f(11,kt)})}function Kt(Ge){Kl[Ge?"unshift":"push"](()=>{Ue=Ge,f(9,Ue)})}return c.$$set=Ge=>{"options"in Ge&&f(19,x=Ge.options),"selected"in Ge&&f(18,a=Ge.selected),"placeholder"in Ge&&f(0,A=Ge.placeholder),"value"in Ge&&f(20,I=Ge.value),"label"in Ge&&f(1,R=Ge.label),"group"in Ge&&f(2,B=Ge.group),"search"in Ge&&f(3,K=Ge.search)},c.$$.update=()=>{c.$$.dirty[0]&16&&f(22,y=Me?new RegExp(Me,"i"):null),c.$$.dirty[0]&4718594&&(f(8,He=y?x.filter(Ge=>y.test(Ge[R])):x),f(7,Se=0)),c.$$.dirty[0]&3932160&&j!=a&&(f(5,H=x.find(Ge=>Ge[I]==a[I])),f(21,j=a))},[A,R,B,K,Me,H,de,Se,He,Ue,Rt,kt,ut,We,tr,Gt,St,jt,a,x,I,j,y,Ke,Lt,mt,yt,De,Ne,Tt,fr,Kt]}class U0 extends qa{constructor(h){super(),Za(this,h,V0,F0,Ga,{options:19,selected:18,placeholder:0,value:20,label:1,group:2,search:3},null,[-1,-1])}}var Uh={exports:{}};(function(c,h){(function(f,y){c.exports=y()})($v,function(){var f,y,v;function x(a,A){if(!f)f=A;else if(!y)y=A;else{var I="var sharedChunk = {}; ("+f+")(sharedChunk); ("+y+")(sharedChunk);",R={};f(R),v=A(R),typeof window<"u"&&(v.workerUrl=window.URL.createObjectURL(new Blob([I],{type:"text/javascript"})))}}return x(["exports"],function(a){function A(e,t){return e(t={exports:{}},t.exports),t.exports}var I=R;function R(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}R.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},R.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},R.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},R.prototype.solveCurveX=function(e,t){var i,l,p,d,_;for(t===void 0&&(t=1e-6),p=e,_=0;_<8;_++){if(d=this.sampleCurveX(p)-e,Math.abs(d)<t)return p;var E=this.sampleCurveDerivativeX(p);if(Math.abs(E)<1e-6)break;p-=d/E}if((p=e)<(i=0))return i;if(p>(l=1))return l;for(;i<l;){if(d=this.sampleCurveX(p),Math.abs(d-e)<t)return p;e>d?i=p:l=p,p=.5*(l-i)+i}return p},R.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var B=K;function K(e,t){this.x=e,this.y=t}K.prototype={clone:function(){return new K(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),p=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},K.convert=function(e){return e instanceof K?e:Array.isArray(e)?new K(e[0],e[1]):e};var j=typeof self<"u"?self:{},H=Math.pow(2,53)-1;function de(e,t,i,l){var p=new I(e,t,i,l);return function(d){return p.solve(d)}}var Me=de(.25,.1,.25,1);function Se(e,t,i){return Math.min(i,Math.max(t,e))}function He(e,t,i){var l=i-t,p=((e-t)%l+l)%l+t;return p===t?i:p}function Ue(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var d=p[l];for(var _ in d)e[_]=d[_]}return e}var Rt=1;function kt(){return Rt++}function ut(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function We(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function tr(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function Gt(e,t){return e.indexOf(t,e.length-t.length)!==-1}function St(e,t,i){var l={};for(var p in e)l[p]=t.call(i||this,e[p],p,e);return l}function jt(e,t,i){var l={};for(var p in e)t.call(i||this,e[p],p,e)&&(l[p]=e[p]);return l}function Ke(e){return Array.isArray(e)?e.map(Ke):typeof e=="object"&&e?St(e,Ke):e}var Lt={};function mt(e){Lt[e]||(typeof console<"u"&&console.warn(e),Lt[e]=!0)}function yt(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function De(e){for(var t=0,i=0,l=e.length,p=l-1,d=void 0,_=void 0;i<l;p=i++)t+=((_=e[p]).x-(d=e[i]).x)*(d.y+_.y);return t}function Ne(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Tt(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,p,d,_){var E=d||_;return t[p]=!E||E.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var fr=null;function Kt(e){if(fr==null){var t=e.navigator?e.navigator.userAgent:null;fr=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return fr}function Ge(e){try{var t=j[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var et,ar,vr,di,Qr=j.performance&&j.performance.now?j.performance.now.bind(j.performance):Date.now.bind(Date),Vr=j.requestAnimationFrame||j.mozRequestAnimationFrame||j.webkitRequestAnimationFrame||j.msRequestAnimationFrame,Ur=j.cancelAnimationFrame||j.mozCancelAnimationFrame||j.webkitCancelAnimationFrame||j.msCancelAnimationFrame,ui={now:Qr,frame:function(e){var t=Vr(e);return{cancel:function(){return Ur(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=j.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return et||(et=j.document.createElement("a")),et.href=e,et.href},hardwareConcurrency:j.navigator&&j.navigator.hardwareConcurrency||4,get devicePixelRatio(){return j.devicePixelRatio},get prefersReducedMotion(){return!!j.matchMedia&&(ar==null&&(ar=j.matchMedia("(prefers-reduced-motion: reduce)")),ar.matches)}},xt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},sr={supported:!1,testSupport:function(e){!Et&&di&&(Ht?Nt(e):vr=e)}},Et=!1,Ht=!1;function Nt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,di),e.isContextLost())return;sr.supported=!0}catch{}e.deleteTexture(t),Et=!0}j.document&&((di=j.document.createElement("img")).onload=function(){vr&&Nt(vr),vr=null,Ht=!0},di.onerror=function(){Et=!0,vr=null},di.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var nn="01",ii=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function dr(e){return e.indexOf("mapbox:")===0}ii.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",nn,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},ii.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ii.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},ii.prototype.normalizeStyleURL=function(e,t){if(!dr(e))return e;var i=Vi(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},ii.prototype.normalizeGlyphsURL=function(e,t){if(!dr(e))return e;var i=Vi(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},ii.prototype.normalizeSourceURL=function(e,t){if(!dr(e))return e;var i=Vi(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},ii.prototype.normalizeSpriteURL=function(e,t,i,l){var p=Vi(e);return dr(e)?(p.path="/styles/v1"+p.path+"/sprite"+t+i,this._makeAPIURL(p,this._customAccessToken||l)):(p.path+=""+t+i,Sn(p))},ii.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!dr(e))return e;var i=Vi(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ui.devicePixelRatio>=2||t===512?"@2x":"")+(sr.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(p){for(var d=0,_=p;d<_.length;d+=1){var E=_[d].match(/^access_token=(.*)$/);if(E)return E[1]}return null}(i.params)||xt.ACCESS_TOKEN;return xt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},ii.prototype.canonicalizeTileURL=function(e,t){var i=Vi(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var p=i.params;return t&&(p=p.filter(function(d){return!d.match(/^access_token=/)})),p.length&&(l+="?"+p.join("&")),l},ii.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&dr(t),l=[],p=0,d=e.tiles||[];p<d.length;p+=1){var _=d[p];$r(_)?l.push(this.canonicalizeTileURL(_,i)):l.push(_)}return l},ii.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=Vi(xt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var p=e.params.indexOf("secure");p>=0&&e.params.splice(p,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!xt.REQUIRE_ACCESS_TOKEN)return Sn(e);if(!(t=t||xt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(d){return d.indexOf("access_token")===-1}),e.params.push("access_token="+t),Sn(e)};var ni=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function $r(e){return ni.test(e)}var on=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Vi(e){var t=e.match(on);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Sn(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function $n(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(j.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Ir=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Ir.prototype.getStorageKey=function(e){var t,i=$n(xt.ACCESS_TOKEN);return t=i&&i.u?j.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,p){return String.fromCharCode(Number("0x"+p))})):xt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},Ir.prototype.fetchEventData=function(){var e=Ge("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=j.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var p=j.localStorage.getItem(i);p&&(this.anonId=p)}catch{mt("Unable to read from LocalStorage")}},Ir.prototype.saveEventData=function(){var e=Ge("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{j.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&j.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{mt("Unable to write to LocalStorage")}},Ir.prototype.processRequests=function(e){},Ir.prototype.postEvent=function(e,t,i,l){var p=this;if(xt.EVENTS_URL){var d=Vi(xt.EVENTS_URL);d.params.push("access_token="+(l||xt.ACCESS_TOKEN||""));var _={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:nn,userId:this.anonId},E=t?Ue(_,t):_,T={url:Sn(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=mr(T,function(z){p.pendingRequest=null,i(z),p.saveEventData(),p.processRequests(l)})}},Ir.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var jr,Mi,Wi=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,p,d){this.skuToken=p,(xt.EVENTS_URL&&d||xt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(_){return dr(_)||$r(_)}))&&this.queueRequest({id:l,timestamp:Date.now()},d)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var p=this.queue.shift(),d=p.id,_=p.timestamp;d&&this.success[d]||(this.anonId||this.fetchEventData(),We(this.anonId)||(this.anonId=ut()),this.postEvent(_,{skuToken:this.skuToken},function(E){E||d&&(l.success[d]=!0)},i))}},t}(Ir),En=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){xt.EVENTS_URL&&xt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(p){return dr(p)||$r(p)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var p=$n(xt.ACCESS_TOKEN),d=p?p.u:xt.ACCESS_TOKEN,_=d!==this.eventData.tokenU;We(this.anonId)||(this.anonId=ut(),_=!0);var E=this.queue.shift();if(this.eventData.lastSuccess){var T=new Date(this.eventData.lastSuccess),z=new Date(E),C=(E-this.eventData.lastSuccess)/864e5;_=_||C>=1||C<-1||T.getDate()!==z.getDate()}else _=!0;if(!_)return this.processRequests();this.postEvent(E,{"enabled.telemetry":!1},function(D){D||(l.eventData.lastSuccess=E,l.eventData.tokenU=d)},i)}},t}(Ir)),Ka=En.postTurnstileEvent.bind(En),qo=new Wi,Nn=qo.postMapLoadEvent.bind(qo),kn=500,na=50;function Tn(){j.caches&&!jr&&(jr=j.caches.open("mapbox-tiles"))}function ao(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var so,Zo=1/0;function Vn(){return so==null&&(so=j.OffscreenCanvas&&new j.OffscreenCanvas(1,1).getContext("2d")&&typeof j.createImageBitmap=="function"),so}var To={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(To);var Go=function(e){function t(i,l,p){l===401&&$r(p)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=p,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),lo=Ne()?function(){return self.worker&&self.worker.referrer}:function(){return(j.location.protocol==="blob:"?j.parent:j).location.href},Un,In,Io=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(lo())&&!/^\w+:/.test(i))){if(j.fetch&&j.Request&&j.AbortController&&j.Request.prototype.hasOwnProperty("signal"))return function(l,p){var d,_=new j.AbortController,E=new j.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:lo(),signal:_.signal}),T=!1,z=!1,C=(d=E.url).indexOf("sku=")>0&&$r(d);l.type==="json"&&E.headers.set("Accept","application/json");var D=function(X,ee,ne){if(!z){if(X&&X.message!=="SecurityError"&&mt(X),ee&&ne)return V(ee);var pe=Date.now();j.fetch(E).then(function(ae){if(ae.ok){var ge=C?ae.clone():null;return V(ae,ge,pe)}return p(new Go(ae.statusText,ae.status,l.url))}).catch(function(ae){ae.code!==20&&p(new Error(ae.message))})}},V=function(X,ee,ne){(l.type==="arrayBuffer"?X.arrayBuffer():l.type==="json"?X.json():X.text()).then(function(pe){z||(ee&&ne&&function(ae,ge,Ee){if(Tn(),jr){var Ae={status:ge.status,statusText:ge.statusText,headers:new j.Headers};ge.headers.forEach(function(Fe,$e){return Ae.headers.set($e,Fe)});var Le=Tt(ge.headers.get("Cache-Control")||"");Le["no-store"]||(Le["max-age"]&&Ae.headers.set("Expires",new Date(Ee+1e3*Le["max-age"]).toUTCString()),new Date(Ae.headers.get("Expires")).getTime()-Ee<42e4||function(Fe,$e){if(Mi===void 0)try{new Response(new ReadableStream),Mi=!0}catch{Mi=!1}Mi?$e(Fe.body):Fe.blob().then($e)}(ge,function(Fe){var $e=new j.Response(Fe,Ae);Tn(),jr&&jr.then(function(nt){return nt.put(ao(ae.url),$e)}).catch(function(nt){return mt(nt.message)})}))}}(E,ee,ne),T=!0,p(null,pe,X.headers.get("Cache-Control"),X.headers.get("Expires")))}).catch(function(pe){z||p(new Error(pe.message))})};return C?function(X,ee){if(Tn(),!jr)return ee(null);var ne=ao(X.url);jr.then(function(pe){pe.match(ne).then(function(ae){var ge=function(Ee){if(!Ee)return!1;var Ae=new Date(Ee.headers.get("Expires")||0),Le=Tt(Ee.headers.get("Cache-Control")||"");return Ae>Date.now()&&!Le["no-cache"]}(ae);pe.delete(ne),ge&&pe.put(ne,ae.clone()),ee(null,ae,ge)}).catch(ee)}).catch(ee)}(E,D):D(null,null),{cancel:function(){z=!0,T||_.abort()}}}(e,t);if(Ne()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,p){var d=new j.XMLHttpRequest;for(var _ in d.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(d.responseType="arraybuffer"),l.headers)d.setRequestHeader(_,l.headers[_]);return l.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=l.credentials==="include",d.onerror=function(){p(new Error(d.statusText))},d.onload=function(){if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){var E=d.response;if(l.type==="json")try{E=JSON.parse(d.response)}catch(T){return p(T)}p(null,E,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else p(new Go(d.statusText,d.status,l.url))},d.send(l.body),{cancel:function(){return d.abort()}}}(e,t)},ei=function(e,t){return Io(Ue(e,{type:"arrayBuffer"}),t)},mr=function(e,t){return Io(Ue(e,{method:"POST"}),t)},M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Un=[],In=0;var F=function(e,t){if(sr.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),In>=xt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return Un.push(i),i}In++;var l=!1,p=function(){if(!l)for(l=!0,In--;Un.length&&In<xt.MAX_PARALLEL_IMAGE_REQUESTS;){var _=Un.shift();_.cancelled||(_.cancel=F(_.requestParameters,_.callback).cancel)}},d=ei(e,function(_,E,T,z){p(),_?t(_):E&&(Vn()?function(C,D){var V=new j.Blob([new Uint8Array(C)],{type:"image/png"});j.createImageBitmap(V).then(function(X){D(null,X)}).catch(function(X){D(new Error("Could not load image because of "+X.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(E,t):function(C,D,V,X){var ee=new j.Image,ne=j.URL;ee.onload=function(){D(null,ee),ne.revokeObjectURL(ee.src),ee.onload=null,j.requestAnimationFrame(function(){ee.src=M})},ee.onerror=function(){return D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var pe=new j.Blob([new Uint8Array(C)],{type:"image/png"});ee.cacheControl=V,ee.expires=X,ee.src=C.byteLength?ne.createObjectURL(pe):M}(E,t,T,z))});return{cancel:function(){d.cancel(),p()}}};function q(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function Y(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var re=function(e,t){t===void 0&&(t={}),Ue(this,t),this.type=e},ue=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",Ue({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(re),me=function(){};me.prototype.on=function(e,t){return this._listeners=this._listeners||{},q(e,t,this._listeners),this},me.prototype.off=function(e,t){return Y(e,t,this._listeners),Y(e,t,this._oneTimeListeners),this},me.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},q(e,t,this._oneTimeListeners),this},me.prototype.fire=function(e,t){typeof e=="string"&&(e=new re(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,p=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<p.length;l+=1)p[l].call(this,e);for(var d=0,_=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];d<_.length;d+=1){var E=_[d];Y(i,E,this._oneTimeListeners),E.call(this,e)}var T=this._eventedParent;T&&(Ue(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(e))}else e instanceof ue&&console.error(e.error);return this},me.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},me.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Z={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ie=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function be(e){var t=e.value;return t?[new ie(e.key,t,"constants have been deprecated as of v8")]:[]}function Ve(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var d=p[l];for(var _ in d)e[_]=d[_]}return e}function Xe(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function ze(e){if(Array.isArray(e))return e.map(ze);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=ze(e[i]);return t}return Xe(e)}var je=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),ht=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var p=l[i];this.bindings[p[0]]=p[1]}};ht.prototype.concat=function(e){return new ht(this,e)},ht.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},ht.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var st={kind:"null"},Re={kind:"number"},ot={kind:"string"},rt={kind:"boolean"},Qe={kind:"color"},Dt={kind:"object"},it={kind:"value"},$t={kind:"collator"},lr={kind:"formatted"},Wt={kind:"resolvedImage"};function ir(e,t){return{kind:"array",itemType:e,N:t}}function Xt(e){if(e.kind==="array"){var t=Xt(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var ti=[st,Re,ot,rt,Qe,lr,Dt,ir(it),Wt];function hr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!hr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=ti;i<l.length;i+=1)if(!hr(l[i],t))return null}}return"Expected "+Xt(e)+" but found "+Xt(t)+" instead."}function Ar(e,t){return t.some(function(i){return i.kind===e.kind})}function pr(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Jt=A(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(E){return(E=Math.round(E))<0?0:E>255?255:E}function p(E){return l(E[E.length-1]==="%"?parseFloat(E)/100*255:parseInt(E))}function d(E){return(T=E[E.length-1]==="%"?parseFloat(E)/100:parseFloat(E))<0?0:T>1?1:T;var T}function _(E,T,z){return z<0?z+=1:z>1&&(z-=1),6*z<1?E+(T-E)*z*6:2*z<1?T:3*z<2?E+(T-E)*(2/3-z)*6:E}try{t.parseCSSColor=function(E){var T,z=E.replace(/ /g,"").toLowerCase();if(z in i)return i[z].slice();if(z[0]==="#")return z.length===4?(T=parseInt(z.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:z.length===7&&(T=parseInt(z.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var C=z.indexOf("("),D=z.indexOf(")");if(C!==-1&&D+1===z.length){var V=z.substr(0,C),X=z.substr(C+1,D-(C+1)).split(","),ee=1;switch(V){case"rgba":if(X.length!==4)return null;ee=d(X.pop());case"rgb":return X.length!==3?null:[p(X[0]),p(X[1]),p(X[2]),ee];case"hsla":if(X.length!==4)return null;ee=d(X.pop());case"hsl":if(X.length!==3)return null;var ne=(parseFloat(X[0])%360+360)%360/360,pe=d(X[1]),ae=d(X[2]),ge=ae<=.5?ae*(pe+1):ae+pe-ae*pe,Ee=2*ae-ge;return[l(255*_(Ee,ge,ne+1/3)),l(255*_(Ee,ge,ne)),l(255*_(Ee,ge,ne-1/3)),ee];default:return null}}return null}}catch{}}).parseCSSColor,nr=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};nr.parse=function(e){if(e){if(e instanceof nr)return e;if(typeof e=="string"){var t=Jt(e);if(t)return new nr(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},nr.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},nr.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},nr.black=new nr(0,0,0,1),nr.white=new nr(1,1,1,1),nr.transparent=new nr(0,0,0,0),nr.red=new nr(1,0,0,1);var ri=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};ri.prototype.compare=function(e,t){return this.collator.compare(e,t)},ri.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var mn=function(e,t,i,l,p){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=p},ci=function(e){this.sections=e};ci.fromString=function(e){return new ci([new mn(e,null,null,null,null)])},ci.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},ci.factory=function(e){return e instanceof ci?e:ci.fromString(e)},ci.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},ci.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var p={};l.fontStack&&(p["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(p["font-scale"]=l.scale),l.textColor&&(p["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(p)}}return e};var ki=function(e){this.name=e.name,this.available=e.available};function ba(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function An(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof nr||e instanceof ri||e instanceof ci||e instanceof ki)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!An(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!An(e[l]))return!1;return!0}return!1}function zr(e){if(e===null)return st;if(typeof e=="string")return ot;if(typeof e=="boolean")return rt;if(typeof e=="number")return Re;if(e instanceof nr)return Qe;if(e instanceof ri)return $t;if(e instanceof ci)return lr;if(e instanceof ki)return Wt;if(Array.isArray(e)){for(var t,i=e.length,l=0,p=e;l<p.length;l+=1){var d=zr(p[l]);if(t){if(t===d)continue;t=it;break}t=d}return ir(t||it,i)}return Dt}function Ko(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof nr||e instanceof ci||e instanceof ki?e.toString():JSON.stringify(e)}ki.prototype.toString=function(){return this.name},ki.fromString=function(e){return e?new ki({name:e,available:!1}):null},ki.prototype.serialize=function(){return["image",this.name]};var Ti=function(e,t){this.type=e,this.value=t};Ti.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!An(e[1]))return t.error("invalid value");var i=e[1],l=zr(i),p=t.expectedType;return l.kind!=="array"||l.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(l=p),new Ti(l,i)},Ti.prototype.evaluate=function(){return this.value},Ti.prototype.eachChild=function(){},Ti.prototype.outputDefined=function(){return!0},Ti.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof nr?["rgba"].concat(this.value.toArray()):this.value instanceof ci?this.value.serialize():this.value};var Or=function(e){this.name="ExpressionEvaluationError",this.message=e};Or.prototype.toJSON=function(){return this.message};var an={string:ot,number:Re,boolean:rt,object:Dt},yr=function(e,t){this.type=e,this.args=t};yr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,p=e[0];if(p==="array"){var d,_;if(e.length>2){var E=e[1];if(typeof E!="string"||!(E in an)||E==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);d=an[E],l++}else d=it;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);_=e[2],l++}i=ir(d,_)}else i=an[p];for(var T=[];l<e.length;l++){var z=t.parse(e[l],l,it);if(!z)return null;T.push(z)}return new yr(i,T)},yr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!hr(this.type,zr(i)))return i;if(t===this.args.length-1)throw new Or("Expected value to be of type "+Xt(this.type)+", but found "+Xt(zr(i))+" instead.")}return null},yr.prototype.eachChild=function(e){this.args.forEach(e)},yr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},yr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(p){return p.serialize()}))};var mi=function(e){this.type=lr,this.sections=e};mi.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],p=!1,d=1;d<=e.length-1;++d){var _=e[d];if(p&&typeof _=="object"&&!Array.isArray(_)){p=!1;var E=null;if(_["font-scale"]&&!(E=t.parse(_["font-scale"],1,Re)))return null;var T=null;if(_["text-font"]&&!(T=t.parse(_["text-font"],1,ir(ot))))return null;var z=null;if(_["text-color"]&&!(z=t.parse(_["text-color"],1,Qe)))return null;var C=l[l.length-1];C.scale=E,C.font=T,C.textColor=z}else{var D=t.parse(e[d],1,it);if(!D)return null;var V=D.type.kind;if(V!=="string"&&V!=="value"&&V!=="null"&&V!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,l.push({content:D,scale:null,font:null,textColor:null})}}return new mi(l)},mi.prototype.evaluate=function(e){return new ci(this.sections.map(function(t){var i=t.content.evaluate(e);return zr(i)===Wt?new mn("",i,null,null,null):new mn(Ko(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},mi.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},mi.prototype.outputDefined=function(){return!1},mi.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var p={};l.scale&&(p["font-scale"]=l.scale.serialize()),l.font&&(p["text-font"]=l.font.serialize()),l.textColor&&(p["text-color"]=l.textColor.serialize()),e.push(p)}return e};var bi=function(e){this.type=Wt,this.input=e};bi.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,ot);return i?new bi(i):t.error("No image name provided.")},bi.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=ki.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},bi.prototype.eachChild=function(e){e(this.input)},bi.prototype.outputDefined=function(){return!1},bi.prototype.serialize=function(){return["image",this.input.serialize()]};var Bs={"to-boolean":rt,"to-color":Qe,"to-number":Re,"to-string":ot},oi=function(e,t){this.type=e,this.args=t};oi.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=Bs[i],p=[],d=1;d<e.length;d++){var _=t.parse(e[d],d,it);if(!_)return null;p.push(_)}return new oi(l,p)},oi.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,i,l=0,p=this.args;l<p.length;l+=1){if(i=null,(t=p[l].evaluate(e))instanceof nr)return t;if(typeof t=="string"){var d=e.parseColor(t);if(d)return d}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":ba(t[0],t[1],t[2],t[3])))return new nr(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Or(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var _=null,E=0,T=this.args;E<T.length;E+=1){if((_=T[E].evaluate(e))===null)return 0;var z=Number(_);if(!isNaN(z))return z}throw new Or("Could not convert "+JSON.stringify(_)+" to number.")}return this.type.kind==="formatted"?ci.fromString(Ko(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?ki.fromString(Ko(this.args[0].evaluate(e))):Ko(this.args[0].evaluate(e))},oi.prototype.eachChild=function(e){this.args.forEach(e)},oi.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},oi.prototype.serialize=function(){if(this.type.kind==="formatted")return new mi([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new bi(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var xa=["Unknown","Point","LineString","Polygon"],Ui=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ui.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ui.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?xa[this.feature.type]:this.feature.type:null},Ui.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ui.prototype.canonicalID=function(){return this.canonical},Ui.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ui.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=nr.parse(e)),t};var ai=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};ai.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ai.prototype.eachChild=function(e){this.args.forEach(e)},ai.prototype.outputDefined=function(){return!1},ai.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ai.parse=function(e,t){var i,l=e[0],p=ai.definitions[l];if(!p)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var d=Array.isArray(p)?p[0]:p.type,_=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,E=_.filter(function(Pt){var pt=Pt[0];return!Array.isArray(pt)||pt.length===e.length-1}),T=null,z=0,C=E;z<C.length;z+=1){var D=C[z],V=D[0],X=D[1];T=new Mr(t.registry,t.path,null,t.scope);for(var ee=[],ne=!1,pe=1;pe<e.length;pe++){var ae=e[pe],ge=Array.isArray(V)?V[pe-1]:V.type,Ee=T.parse(ae,1+ee.length,ge);if(!Ee){ne=!0;break}ee.push(Ee)}if(!ne)if(Array.isArray(V)&&V.length!==ee.length)T.error("Expected "+V.length+" arguments, but found "+ee.length+" instead.");else{for(var Ae=0;Ae<ee.length;Ae++){var Le=Array.isArray(V)?V[Ae]:V.type,Fe=ee[Ae];T.concat(Ae+1).checkSubtype(Le,Fe.type)}if(T.errors.length===0)return new ai(l,d,X,ee)}}if(E.length===1)(i=t.errors).push.apply(i,T.errors);else{for(var $e=(E.length?E:_).map(function(Pt){var pt;return pt=Pt[0],Array.isArray(pt)?"("+pt.map(Xt).join(", ")+")":"("+Xt(pt.type)+"...)"}).join(" | "),nt=[],It=1;It<e.length;It++){var ct=t.parse(e[It],1+nt.length);if(!ct)return null;nt.push(Xt(ct.type))}t.error("Expected arguments of type "+$e+", but found ("+nt.join(", ")+") instead.")}return null},ai.register=function(e,t){for(var i in ai.definitions=t,t)e[i]=ai};var sn=function(e,t,i){this.type=$t,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function ji(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function jn(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Xa(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,p=Math.pow(2,t.z);return[Math.round(i*p*8192),Math.round(l*p*8192)]}function wl(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function Ha(e,t){for(var i,l,p,d,_,E,T,z=!1,C=0,D=t.length;C<D;C++)for(var V=t[C],X=0,ee=V.length;X<ee-1;X++){if((d=(i=e)[0]-(l=V[X])[0])*(T=i[1]-(p=V[X+1])[1])-(E=i[0]-p[0])*(_=i[1]-l[1])==0&&d*E<=0&&_*T<=0)return!1;wl(e,V[X],V[X+1])&&(z=!z)}return z}function wa(e,t){for(var i=0;i<t.length;i++)if(Ha(e,t[i]))return!0;return!1}function Wa(e,t,i,l){var p=l[0]-i[0],d=l[1]-i[1],_=(e[0]-i[0])*d-p*(e[1]-i[1]),E=(t[0]-i[0])*d-p*(t[1]-i[1]);return _>0&&E<0||_<0&&E>0}function yn(e,t,i){for(var l=0,p=i;l<p.length;l+=1)for(var d=p[l],_=0;_<d.length-1;++_)if((D=[(C=d[_+1])[0]-(z=d[_])[0],C[1]-z[1]])[0]*(V=[(T=t)[0]-(E=e)[0],T[1]-E[1]])[1]-D[1]*V[0]!=0&&Wa(E,T,z,C)&&Wa(z,C,E,T))return!0;var E,T,z,C,D,V;return!1}function Xo(e,t){for(var i=0;i<e.length;++i)if(!Ha(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(yn(e[l],e[l+1],t))return!1;return!0}function Sa(e,t){for(var i=0;i<t.length;i++)if(Xo(e,t[i]))return!0;return!1}function Ea(e,t,i){for(var l=[],p=0;p<e.length;p++){for(var d=[],_=0;_<e[p].length;_++){var E=Xa(e[p][_],i);ji(t,E),d.push(E)}l.push(d)}return l}function ka(e,t,i){for(var l=[],p=0;p<e.length;p++){var d=Ea(e[p],t,i);l.push(d)}return l}function oa(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var p=.5*l,d=e[0]-i[0]>p?-l:i[0]-e[0]>p?l:0;d===0&&(d=e[0]-i[2]>p?-l:i[2]-e[0]>p?l:0),e[0]+=d}ji(t,e)}function Os(e,t,i,l){for(var p=8192*Math.pow(2,l.z),d=[8192*l.x,8192*l.y],_=[],E=0,T=e;E<T.length;E+=1)for(var z=0,C=T[E];z<C.length;z+=1){var D=C[z],V=[D.x+d[0],D.y+d[1]];oa(V,t,i,p),_.push(V)}return _}function Ta(e,t,i,l){for(var p,d=8192*Math.pow(2,l.z),_=[8192*l.x,8192*l.y],E=[],T=0,z=e;T<z.length;T+=1){for(var C=[],D=0,V=z[T];D<V.length;D+=1){var X=V[D],ee=[X.x+_[0],X.y+_[1]];ji(t,ee),C.push(ee)}E.push(C)}if(t[2]-t[0]<=d/2){(p=t)[0]=p[1]=1/0,p[2]=p[3]=-1/0;for(var ne=0,pe=E;ne<pe.length;ne+=1)for(var ae=0,ge=pe[ne];ae<ge.length;ae+=1)oa(ge[ae],t,i,d)}return E}sn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,rt);if(!l)return null;var p=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,rt);if(!p)return null;var d=null;return i.locale&&!(d=t.parse(i.locale,1,ot))?null:new sn(l,p,d)},sn.prototype.evaluate=function(e){return new ri(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},sn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},sn.prototype.outputDefined=function(){return!1},sn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Ii=function(e,t){this.type=rt,this.geojson=e,this.geometries=t};function gn(e){if(e instanceof ai&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Ii)return!1;var t=!0;return e.eachChild(function(i){t&&!gn(i)&&(t=!1)}),t}function _e(e){if(e instanceof ai&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!_e(i)&&(t=!1)}),t}function ln(e,t){if(e instanceof ai&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!ln(l,t)&&(i=!1)}),i}Ii.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(An(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var p=i.features[l].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Ii(i,i.features[l].geometry)}else if(i.type==="Feature"){var d=i.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Ii(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Ii(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Ii.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],d=t.canonicalID();if(i.type==="Polygon"){var _=Ea(i.coordinates,p,d),E=Os(t.geometry(),l,p,d);if(!jn(l,p))return!1;for(var T=0,z=E;T<z.length;T+=1)if(!Ha(z[T],_))return!1}if(i.type==="MultiPolygon"){var C=ka(i.coordinates,p,d),D=Os(t.geometry(),l,p,d);if(!jn(l,p))return!1;for(var V=0,X=D;V<X.length;V+=1)if(!wa(X[V],C))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],d=t.canonicalID();if(i.type==="Polygon"){var _=Ea(i.coordinates,p,d),E=Ta(t.geometry(),l,p,d);if(!jn(l,p))return!1;for(var T=0,z=E;T<z.length;T+=1)if(!Xo(z[T],_))return!1}if(i.type==="MultiPolygon"){var C=ka(i.coordinates,p,d),D=Ta(t.geometry(),l,p,d);if(!jn(l,p))return!1;for(var V=0,X=D;V<X.length;V+=1)if(!Sa(X[V],C))return!1}return!0}(e,this.geometries)}return!1},Ii.prototype.eachChild=function(){},Ii.prototype.outputDefined=function(){return!0},Ii.prototype.serialize=function(){return["within",this.geojson]};var Ai=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Ai.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Ai(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Ai.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ai.prototype.eachChild=function(){},Ai.prototype.outputDefined=function(){return!1},Ai.prototype.serialize=function(){return["var",this.name]};var Mr=function(e,t,i,l,p){t===void 0&&(t=[]),l===void 0&&(l=new ht),p===void 0&&(p=[]),this.registry=e,this.path=t,this.key=t.map(function(d){return"["+d+"]"}).join(""),this.scope=l,this.errors=p,this.expectedType=i};function Ho(e,t){for(var i,l=e.length-1,p=0,d=l,_=0;p<=d;)if((i=e[_=Math.floor((p+d)/2)])<=t){if(_===l||t<e[_+1])return _;p=_+1}else{if(!(i>t))throw new Or("Input is not a number.");d=_-1}return 0}Mr.prototype.parse=function(e,t,i,l,p){return p===void 0&&(p={}),t?this.concat(t,i,l)._parse(e,p):this._parse(e,p)},Mr.prototype._parse=function(e,t){function i(z,C,D){return D==="assert"?new yr(C,[z]):D==="coerce"?new oi(C,[z]):z}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var p=this.registry[l];if(p){var d=p.parse(e,this);if(!d)return null;if(this.expectedType){var _=this.expectedType,E=d.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||E.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(_,E))return null}else d=i(d,_,t.typeAnnotation||"coerce");else d=i(d,_,t.typeAnnotation||"assert")}if(!(d instanceof Ti)&&d.type.kind!=="resolvedImage"&&function z(C){if(C instanceof Ai)return z(C.boundExpression);if(C instanceof ai&&C.name==="error"||C instanceof sn||C instanceof Ii)return!1;var D=C instanceof oi||C instanceof yr,V=!0;return C.eachChild(function(X){V=D?V&&z(X):V&&X instanceof Ti}),!!V&&gn(C)&&ln(C,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(d)){var T=new Ui;try{d=new Ti(d.type,d.evaluate(T))}catch(z){return this.error(z.message),null}}return d}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Mr.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,p=i?this.scope.concat(i):this.scope;return new Mr(this.registry,l,t||null,p,this.errors)},Mr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(p){return"["+p+"]"}).join("");this.errors.push(new je(l,e))},Mr.prototype.checkSubtype=function(e,t){var i=hr(e,t);return i&&this.error(i),i};var _n=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,p=i;l<p.length;l+=1){var d=p[l],_=d[1];this.labels.push(d[0]),this.outputs.push(_)}};function hi(e,t,i){return e*(1-i)+t*i}_n.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,Re);if(!i)return null;var l=[],p=null;t.expectedType&&t.expectedType.kind!=="value"&&(p=t.expectedType);for(var d=1;d<e.length;d+=2){var _=d===1?-1/0:e[d],E=e[d+1],T=d,z=d+1;if(typeof _!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(l.length&&l[l.length-1][0]>=_)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);var C=t.parse(E,z,p);if(!C)return null;p=p||C.type,l.push([_,C])}return new _n(p,i,l)},_n.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;return l>=t[p-1]?i[p-1].evaluate(e):i[Ho(t,l)].evaluate(e)},_n.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},_n.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},_n.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Wo=Object.freeze({__proto__:null,number:hi,color:function(e,t,i){return new nr(hi(e.r,t.r,i),hi(e.g,t.g,i),hi(e.b,t.b,i),hi(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,p){return hi(l,t[p],i)})}}),zu=6/29*3*(6/29),Xl=Math.PI/180,vs=180/Math.PI;function Ja(e){return e>.008856451679035631?Math.pow(e,1/3):e/zu+4/29}function Sl(e){return e>6/29?e*e*e:zu*(e-4/29)}function Ya(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Fs(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function El(e){var t=Fs(e.r),i=Fs(e.g),l=Fs(e.b),p=Ja((.4124564*t+.3575761*i+.1804375*l)/.95047),d=Ja((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*d-16,a:500*(p-d),b:200*(d-Ja((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function Hl(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*Sl(t),i=.95047*Sl(i),l=1.08883*Sl(l),new nr(Ya(3.2404542*i-1.5371385*t-.4985314*l),Ya(-.969266*i+1.8760108*t+.041556*l),Ya(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function Wl(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var vn={forward:El,reverse:Hl,interpolate:function(e,t,i){return{l:hi(e.l,t.l,i),a:hi(e.a,t.a,i),b:hi(e.b,t.b,i),alpha:hi(e.alpha,t.alpha,i)}}},uo={forward:function(e){var t=El(e),i=t.l,l=t.a,p=t.b,d=Math.atan2(p,l)*vs;return{h:d<0?d+360:d,c:Math.sqrt(l*l+p*p),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Xl,i=e.c;return Hl({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Wl(e.h,t.h,i),c:hi(e.c,t.c,i),l:hi(e.l,t.l,i),alpha:hi(e.alpha,t.alpha,i)}}},Ao=Object.freeze({__proto__:null,lab:vn,hcl:uo}),si=function(e,t,i,l,p){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var d=0,_=p;d<_.length;d+=1){var E=_[d],T=E[1];this.labels.push(E[0]),this.outputs.push(T)}};function kl(e,t,i,l){var p=l-i,d=e-i;return p===0?0:t===1?d/p:(Math.pow(t,d)-1)/(Math.pow(t,p)-1)}si.interpolationFactor=function(e,t,i,l){var p=0;if(e.name==="exponential")p=kl(t,e.base,i,l);else if(e.name==="linear")p=kl(t,1,i,l);else if(e.name==="cubic-bezier"){var d=e.controlPoints;p=new I(d[0],d[1],d[2],d[3]).solve(kl(t,1,i,l))}return p},si.parse=function(e,t){var i=e[0],l=e[1],p=e[2],d=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var _=l[1];if(typeof _!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:_}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var E=l.slice(1);if(E.length!==4||E.some(function(pe){return typeof pe!="number"||pe<0||pe>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:E}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(p=t.parse(p,2,Re)))return null;var T=[],z=null;i==="interpolate-hcl"||i==="interpolate-lab"?z=Qe:t.expectedType&&t.expectedType.kind!=="value"&&(z=t.expectedType);for(var C=0;C<d.length;C+=2){var D=d[C],V=d[C+1],X=C+3,ee=C+4;if(typeof D!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',X);if(T.length&&T[T.length-1][0]>=D)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',X);var ne=t.parse(V,ee,z);if(!ne)return null;z=z||ne.type,T.push([D,ne])}return z.kind==="number"||z.kind==="color"||z.kind==="array"&&z.itemType.kind==="number"&&typeof z.N=="number"?new si(z,i,l,p,T):t.error("Type "+Xt(z)+" is not interpolatable.")},si.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;if(l>=t[p-1])return i[p-1].evaluate(e);var d=Ho(t,l),_=si.interpolationFactor(this.interpolation,l,t[d],t[d+1]),E=i[d].evaluate(e),T=i[d+1].evaluate(e);return this.operator==="interpolate"?Wo[this.type.kind.toLowerCase()](E,T,_):this.operator==="interpolate-hcl"?uo.reverse(uo.interpolate(uo.forward(E),uo.forward(T),_)):vn.reverse(vn.interpolate(vn.forward(E),vn.forward(T),_))},si.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},si.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},si.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var co=function(e,t){this.type=e,this.args=t};co.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var p=[],d=0,_=e.slice(1);d<_.length;d+=1){var E=t.parse(_[d],1+p.length,i,void 0,{typeAnnotation:"omit"});if(!E)return null;i=i||E.type,p.push(E)}var T=l&&p.some(function(z){return hr(l,z.type)});return new co(T?it:i,p)},co.prototype.evaluate=function(e){for(var t,i=null,l=0,p=0,d=this.args;p<d.length&&(l++,(i=d[p].evaluate(e))&&i instanceof ki&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);p+=1);return i},co.prototype.eachChild=function(e){this.args.forEach(e)},co.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},co.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var bs=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};bs.prototype.evaluate=function(e){return this.result.evaluate(e)},bs.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},bs.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var p=e[l];if(typeof p!="string")return t.error("Expected string, but found "+typeof p+" instead.",l);if(/[^a-zA-Z0-9_]/.test(p))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var d=t.parse(e[l+1],l+1);if(!d)return null;i.push([p,d])}var _=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return _?new bs(i,_):null},bs.prototype.outputDefined=function(){return this.result.outputDefined()},bs.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var Qa=function(e,t,i){this.type=e,this.index=t,this.input=i};Qa.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Re),l=t.parse(e[2],2,ir(t.expectedType||it));return i&&l?new Qa(l.type.itemType,i,l):null},Qa.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new Or("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new Or("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new Or("Array index must be an integer, but found "+t+" instead.");return i[t]},Qa.prototype.eachChild=function(e){e(this.index),e(this.input)},Qa.prototype.outputDefined=function(){return!1},Qa.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var zo=function(e,t){this.type=rt,this.needle=e,this.haystack=t};zo.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,it),l=t.parse(e[2],2,it);return i&&l?Ar(i.type,[rt,ot,Re,st,it])?new zo(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Xt(i.type)+" instead"):null},zo.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!pr(t,["boolean","string","number","null"]))throw new Or("Expected first argument to be of type boolean, string, number or null, but found "+Xt(zr(t))+" instead.");if(!pr(i,["string","array"]))throw new Or("Expected second argument to be of type array or string, but found "+Xt(zr(i))+" instead.");return i.indexOf(t)>=0},zo.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},zo.prototype.outputDefined=function(){return!0},zo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ho=function(e,t,i){this.type=Re,this.needle=e,this.haystack=t,this.fromIndex=i};ho.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,it),l=t.parse(e[2],2,it);if(!i||!l)return null;if(!Ar(i.type,[rt,ot,Re,st,it]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Xt(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,Re);return p?new ho(i,l,p):null}return new ho(i,l)},ho.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!pr(t,["boolean","string","number","null"]))throw new Or("Expected first argument to be of type boolean, string, number or null, but found "+Xt(zr(t))+" instead.");if(!pr(i,["string","array"]))throw new Or("Expected second argument to be of type array or string, but found "+Xt(zr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},ho.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var $a=function(e,t,i,l,p,d){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=p,this.otherwise=d};$a.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var p={},d=[],_=2;_<e.length-1;_+=2){var E=e[_],T=e[_+1];Array.isArray(E)||(E=[E]);var z=t.concat(_);if(E.length===0)return z.error("Expected at least one branch label.");for(var C=0,D=E;C<D.length;C+=1){var V=D[C];if(typeof V!="number"&&typeof V!="string")return z.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return z.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof V=="number"&&Math.floor(V)!==V)return z.error("Numeric branch labels must be integer values.");if(i){if(z.checkSubtype(i,zr(V)))return null}else i=zr(V);if(p[String(V)]!==void 0)return z.error("Branch labels must be unique.");p[String(V)]=d.length}var X=t.parse(T,_,l);if(!X)return null;l=l||X.type,d.push(X)}var ee=t.parse(e[1],1,it);if(!ee)return null;var ne=t.parse(e[e.length-1],e.length-1,l);return ne?ee.type.kind!=="value"&&t.concat(1).checkSubtype(i,ee.type)?null:new $a(i,l,ee,p,d,ne):null},$a.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(zr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},$a.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},$a.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},$a.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},p=0,d=Object.keys(this.cases).sort();p<d.length;p+=1){var _=d[p];(D=l[this.cases[_]])===void 0?(l[this.cases[_]]=i.length,i.push([this.cases[_],[_]])):i[D][1].push(_)}for(var E=function(X){return e.inputType.kind==="number"?Number(X):X},T=0,z=i;T<z.length;T+=1){var C=z[T],D=C[0],V=C[1];t.push(V.length===1?E(V[0]):V.map(E)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Po=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};Po.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],p=1;p<e.length-1;p+=2){var d=t.parse(e[p],p,rt);if(!d)return null;var _=t.parse(e[p+1],p+1,i);if(!_)return null;l.push([d,_]),i=i||_.type}var E=t.parse(e[e.length-1],e.length-1,i);return E?new Po(i,l,E):null},Po.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];if(l[0].evaluate(e))return p.evaluate(e)}return this.otherwise.evaluate(e)},Po.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];e(l[0]),e(p)}e(this.otherwise)},Po.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},Po.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Jo=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function Jl(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Yl(e,t,i,l){return l.compare(t,i)===0}function br(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function p(d,_,E){this.type=rt,this.lhs=d,this.rhs=_,this.collator=E,this.hasUntypedArgument=d.type.kind==="value"||_.type.kind==="value"}return p.parse=function(d,_){if(d.length!==3&&d.length!==4)return _.error("Expected two or three arguments.");var E=d[0],T=_.parse(d[1],1,it);if(!T)return null;if(!Jl(E,T.type))return _.concat(1).error('"'+E+`" comparisons are not supported for type '`+Xt(T.type)+"'.");var z=_.parse(d[2],2,it);if(!z)return null;if(!Jl(E,z.type))return _.concat(2).error('"'+E+`" comparisons are not supported for type '`+Xt(z.type)+"'.");if(T.type.kind!==z.type.kind&&T.type.kind!=="value"&&z.type.kind!=="value")return _.error("Cannot compare types '"+Xt(T.type)+"' and '"+Xt(z.type)+"'.");l&&(T.type.kind==="value"&&z.type.kind!=="value"?T=new yr(z.type,[T]):T.type.kind!=="value"&&z.type.kind==="value"&&(z=new yr(T.type,[z])));var C=null;if(d.length===4){if(T.type.kind!=="string"&&z.type.kind!=="string"&&T.type.kind!=="value"&&z.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(!(C=_.parse(d[3],3,$t)))return null}return new p(T,z,C)},p.prototype.evaluate=function(d){var _=this.lhs.evaluate(d),E=this.rhs.evaluate(d);if(l&&this.hasUntypedArgument){var T=zr(_),z=zr(E);if(T.kind!==z.kind||T.kind!=="string"&&T.kind!=="number")throw new Or('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+T.kind+", "+z.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var C=zr(_),D=zr(E);if(C.kind!=="string"||D.kind!=="string")return t(d,_,E)}return this.collator?i(d,_,E,this.collator.evaluate(d)):t(d,_,E)},p.prototype.eachChild=function(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)},p.prototype.outputDefined=function(){return!0},p.prototype.serialize=function(){var d=[e];return this.eachChild(function(_){d.push(_.serialize())}),d},p}()}Jo.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,it),l=t.parse(e[2],2,Re);if(!i||!l)return null;if(!Ar(i.type,[ir(it),ot,it]))return t.error("Expected first argument to be of type array or string, but found "+Xt(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,Re);return p?new Jo(i.type,i,l,p):null}return new Jo(i.type,i,l)},Jo.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!pr(t,["string","array"]))throw new Or("Expected first argument to be of type array or string, but found "+Xt(zr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Jo.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Jo.prototype.outputDefined=function(){return!1},Jo.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Pu=br("==",function(e,t,i){return t===i},Yl),Co=br("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!Yl(0,t,i,l)}),Mo=br("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),Ia=br(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),Ql=br("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),xs=br(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),Ns=function(e,t,i,l,p){this.type=ot,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=p};Ns.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Re);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var p=null;if(l.locale&&!(p=t.parse(l.locale,1,ot)))return null;var d=null;if(l.currency&&!(d=t.parse(l.currency,1,ot)))return null;var _=null;if(l["min-fraction-digits"]&&!(_=t.parse(l["min-fraction-digits"],1,Re)))return null;var E=null;return l["max-fraction-digits"]&&!(E=t.parse(l["max-fraction-digits"],1,Re))?null:new Ns(i,p,d,_,E)},Ns.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Ns.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Ns.prototype.outputDefined=function(){return!1},Ns.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Aa=function(e){this.type=Re,this.input=e};Aa.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Xt(i.type)+" instead."):new Aa(i):null},Aa.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Or("Expected value to be of type string or array, but found "+Xt(zr(t))+" instead.")},Aa.prototype.eachChild=function(e){e(this.input)},Aa.prototype.outputDefined=function(){return!1},Aa.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Do={"==":Pu,"!=":Co,">":Ia,"<":Mo,">=":xs,"<=":Ql,array:yr,at:Qa,boolean:yr,case:Po,coalesce:co,collator:sn,format:mi,image:bi,in:zo,"index-of":ho,interpolate:si,"interpolate-hcl":si,"interpolate-lab":si,length:Aa,let:bs,literal:Ti,match:$a,number:yr,"number-format":Ns,object:yr,slice:Jo,step:_n,string:yr,"to-boolean":oi,"to-color":oi,"to-number":oi,"to-string":oi,var:Ai,within:Ii};function ws(e,t){var i=t[0],l=t[1],p=t[2],d=t[3];i=i.evaluate(e),l=l.evaluate(e),p=p.evaluate(e);var _=d?d.evaluate(e):1,E=ba(i,l,p,_);if(E)throw new Or(E);return new nr(i/255*_,l/255*_,p/255*_,_)}function $l(e,t){return e in t}function es(e,t){var i=t[e];return i===void 0?null:i}function aa(e){return{type:e}}function eu(e){return{result:"success",value:e}}function ts(e){return{result:"error",value:e}}function po(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function tu(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function fo(e){return!!e.expression&&e.expression.interpolated}function _r(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Yo(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Cu(e){return e}function Qo(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function sc(e,t,i,l,p){return Qo(typeof i===p?l[i]:void 0,e.default,t.default)}function Mu(e,t,i){if(_r(i)!=="number")return Qo(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var p=Ho(e.stops.map(function(d){return d[0]}),i);return e.stops[p][1]}function Ss(e,t,i){var l=e.base!==void 0?e.base:1;if(_r(i)!=="number")return Qo(e.default,t.default);var p=e.stops.length;if(p===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[p-1][0])return e.stops[p-1][1];var d=Ho(e.stops.map(function(D){return D[0]}),i),_=function(D,V,X,ee){var ne=ee-X,pe=D-X;return ne===0?0:V===1?pe/ne:(Math.pow(V,pe)-1)/(Math.pow(V,ne)-1)}(i,l,e.stops[d][0],e.stops[d+1][0]),E=e.stops[d][1],T=e.stops[d+1][1],z=Wo[t.type]||Cu;if(e.colorSpace&&e.colorSpace!=="rgb"){var C=Ao[e.colorSpace];z=function(D,V){return C.reverse(C.interpolate(C.forward(D),C.forward(V),_))}}return typeof E.evaluate=="function"?{evaluate:function(){for(var D=[],V=arguments.length;V--;)D[V]=arguments[V];var X=E.evaluate.apply(void 0,D),ee=T.evaluate.apply(void 0,D);if(X!==void 0&&ee!==void 0)return z(X,ee,_)}}:z(E,T,_)}function za(e,t,i){return t.type==="color"?i=nr.parse(i):t.type==="formatted"?i=ci.fromString(i.toString()):t.type==="resolvedImage"?i=ki.fromString(i.toString()):_r(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Qo(i,e.default,t.default)}ai.register(Do,{error:[{kind:"error"},[ot],function(e,t){throw new Or(t[0].evaluate(e))}],typeof:[ot,[it],function(e,t){return Xt(zr(t[0].evaluate(e)))}],"to-rgba":[ir(Re,4),[Qe],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Qe,[Re,Re,Re],ws],rgba:[Qe,[Re,Re,Re,Re],ws],has:{type:rt,overloads:[[[ot],function(e,t){return $l(t[0].evaluate(e),e.properties())}],[[ot,Dt],function(e,t){var i=t[1];return $l(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:it,overloads:[[[ot],function(e,t){return es(t[0].evaluate(e),e.properties())}],[[ot,Dt],function(e,t){var i=t[1];return es(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[it,[ot],function(e,t){return es(t[0].evaluate(e),e.featureState||{})}],properties:[Dt,[],function(e){return e.properties()}],"geometry-type":[ot,[],function(e){return e.geometryType()}],id:[it,[],function(e){return e.id()}],zoom:[Re,[],function(e){return e.globals.zoom}],"heatmap-density":[Re,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Re,[],function(e){return e.globals.lineProgress||0}],accumulated:[it,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Re,aa(Re),function(e,t){for(var i=0,l=0,p=t;l<p.length;l+=1)i+=p[l].evaluate(e);return i}],"*":[Re,aa(Re),function(e,t){for(var i=1,l=0,p=t;l<p.length;l+=1)i*=p[l].evaluate(e);return i}],"-":{type:Re,overloads:[[[Re,Re],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[Re],function(e,t){return-t[0].evaluate(e)}]]},"/":[Re,[Re,Re],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[Re,[Re,Re],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[Re,[],function(){return Math.LN2}],pi:[Re,[],function(){return Math.PI}],e:[Re,[],function(){return Math.E}],"^":[Re,[Re,Re],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[Re,[Re],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Re,[Re],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Re,[Re],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Re,[Re],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Re,[Re],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Re,[Re],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Re,[Re],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Re,[Re],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Re,[Re],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Re,[Re],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Re,aa(Re),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[Re,aa(Re),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[Re,[Re],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Re,[Re],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[Re,[Re],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Re,[Re],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[rt,[ot,it],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[rt,[it],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[rt,[ot],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[rt,[ot,it],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p<d}],"filter-id-<":[rt,[it],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<p}],"filter->":[rt,[ot,it],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p>d}],"filter-id->":[rt,[it],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>p}],"filter-<=":[rt,[ot,it],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p<=d}],"filter-id-<=":[rt,[it],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<=p}],"filter->=":[rt,[ot,it],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p>=d}],"filter-id->=":[rt,[it],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>=p}],"filter-has":[rt,[it],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[rt,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[rt,[ir(ot)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[rt,[ir(it)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[rt,[ot,ir(it)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[rt,[ot,ir(it)],function(e,t){var i=t[0],l=t[1];return function(p,d,_,E){for(;_<=E;){var T=_+E>>1;if(d[T]===p)return!0;d[T]>p?E=T-1:_=T+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:rt,overloads:[[[rt,rt],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[aa(rt),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:rt,overloads:[[[rt,rt],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[aa(rt),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[rt,[rt],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[rt,[ot],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[ot,[ot],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[ot,[ot],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[ot,aa(it),function(e,t){return t.map(function(i){return Ko(i.evaluate(e))}).join("")}],"resolved-locale":[ot,[$t],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Es=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Ui,this._defaultValue=t?function(i){return i.type==="color"&&Yo(i.default)?new nr(0,0,0,0):i.type==="color"?nr.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function sa(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Do}function ks(e,t){var i=new Mr(Do,[],t?function(p){var d={color:Qe,string:ot,number:Re,enum:ot,boolean:rt,formatted:lr,resolvedImage:Wt};return p.type==="array"?ir(d[p.value]||it,p.length):d[p.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?eu(new Es(l,t)):ts(i.errors)}Es.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=d,this.expression.evaluate(this._evaluator)},Es.prototype.evaluate=function(e,t,i,l,p,d){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=d||null;try{var _=this.expression.evaluate(this._evaluator);if(_==null||typeof _=="number"&&_!=_)return this._defaultValue;if(this._enumValues&&!(_ in this._enumValues))throw new Or("Expected value to be one of "+Object.keys(this._enumValues).map(function(E){return JSON.stringify(E)}).join(", ")+", but found "+JSON.stringify(_)+" instead.");return _}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}};var Vs=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!_e(t.expression)};Vs.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,d)},Vs.prototype.evaluate=function(e,t,i,l,p,d){return this._styleExpression.evaluate(e,t,i,l,p,d)};var Ts=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!_e(t.expression),this.interpolationType=l};function rs(e,t){if((e=ks(e,t)).result==="error")return e;var i=e.value.expression,l=gn(i);if(!l&&!po(t))return ts([new je("","data expressions not supported")]);var p=ln(i,["zoom"]);if(!p&&!tu(t))return ts([new je("","zoom expressions not supported")]);var d=function _(E){var T=null;if(E instanceof bs)T=_(E.result);else if(E instanceof co)for(var z=0,C=E.args;z<C.length&&!(T=_(C[z]));z+=1);else(E instanceof _n||E instanceof si)&&E.input instanceof ai&&E.input.name==="zoom"&&(T=E);return T instanceof je||E.eachChild(function(D){var V=_(D);V instanceof je?T=V:!T&&V?T=new je("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):T&&V&&T!==V&&(T=new je("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),T}(i);return d||p?d instanceof je?ts([d]):d instanceof si&&!fo(t)?ts([new je("",'"interpolate" expressions cannot be used with this property')]):eu(d?new Ts(l?"camera":"composite",e.value,d.labels,d instanceof si?d.interpolation:void 0):new Vs(l?"constant":"source",e.value)):ts([new je("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Ts.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,d)},Ts.prototype.evaluate=function(e,t,i,l,p,d){return this._styleExpression.evaluate(e,t,i,l,p,d)},Ts.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?si.interpolationFactor(this.interpolationType,e,t,i):0};var Us=function(e,t){this._parameters=e,this._specification=t,Ve(this,function i(l,p){var d,_,E,T=p.type==="color",z=l.stops&&typeof l.stops[0][0]=="object",C=z||!(z||l.property!==void 0),D=l.type||(fo(p)?"exponential":"interval");if(T&&((l=Ve({},l)).stops&&(l.stops=l.stops.map(function(ct){return[ct[0],nr.parse(ct[1])]})),l.default=nr.parse(l.default?l.default:p.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!Ao[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(D==="exponential")d=Ss;else if(D==="interval")d=Mu;else if(D==="categorical"){d=sc,_=Object.create(null);for(var V=0,X=l.stops;V<X.length;V+=1){var ee=X[V];_[ee[0]]=ee[1]}E=typeof l.stops[0][0]}else{if(D!=="identity")throw new Error('Unknown function type "'+D+'"');d=za}if(z){for(var ne={},pe=[],ae=0;ae<l.stops.length;ae++){var ge=l.stops[ae],Ee=ge[0].zoom;ne[Ee]===void 0&&(ne[Ee]={zoom:Ee,type:l.type,property:l.property,default:l.default,stops:[]},pe.push(Ee)),ne[Ee].stops.push([ge[0].value,ge[1]])}for(var Ae=[],Le=0,Fe=pe;Le<Fe.length;Le+=1){var $e=Fe[Le];Ae.push([ne[$e].zoom,i(ne[$e],p)])}var nt={name:"linear"};return{kind:"composite",interpolationType:nt,interpolationFactor:si.interpolationFactor.bind(void 0,nt),zoomStops:Ae.map(function(ct){return ct[0]}),evaluate:function(ct,Pt){var pt=ct.zoom;return Ss({stops:Ae,base:l.base},p,pt).evaluate(pt,Pt)}}}if(C){var It=D==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:It,interpolationFactor:si.interpolationFactor.bind(void 0,It),zoomStops:l.stops.map(function(ct){return ct[0]}),evaluate:function(ct){return d(l,p,ct.zoom,_,E)}}}return{kind:"source",evaluate:function(ct,Pt){var pt=Pt&&Pt.properties?Pt.properties[l.property]:void 0;return pt===void 0?Qo(l.default,p.default):d(l,p,pt,_,E)}}}(this._parameters,this._specification))};function mo(e){var t=e.key,i=e.value,l=e.valueSpec||{},p=e.objectElementValidators||{},d=e.style,_=e.styleSpec,E=[],T=_r(i);if(T!=="object")return[new ie(t,i,"object expected, "+T+" found")];for(var z in i){var C=z.split(".")[0],D=l[C]||l["*"],V=void 0;if(p[C])V=p[C];else if(l[C])V=ur;else if(p["*"])V=p["*"];else{if(!l["*"]){E.push(new ie(t,i[z],'unknown property "'+z+'"'));continue}V=ur}E=E.concat(V({key:(t&&t+".")+z,value:i[z],valueSpec:D,style:d,styleSpec:_,object:i,objectKey:z},i))}for(var X in l)p[X]||l[X].required&&l[X].default===void 0&&i[X]===void 0&&E.push(new ie(t,i,'missing required property "'+X+'"'));return E}function is(e){var t=e.value,i=e.valueSpec,l=e.style,p=e.styleSpec,d=e.key,_=e.arrayElementValidator||ur;if(_r(t)!=="array")return[new ie(d,t,"array expected, "+_r(t)+" found")];if(i.length&&t.length!==i.length)return[new ie(d,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new ie(d,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var E={type:i.value,values:i.values};p.$version<7&&(E.function=i.function),_r(i.value)==="object"&&(E=i.value);for(var T=[],z=0;z<t.length;z++)T=T.concat(_({array:t,arrayIndex:z,value:t[z],valueSpec:E,style:l,styleSpec:p,key:d+"["+z+"]"}));return T}function Is(e){var t=e.key,i=e.value,l=e.valueSpec,p=_r(i);return p==="number"&&i!=i&&(p="NaN"),p!=="number"?[new ie(t,i,"number expected, "+p+" found")]:"minimum"in l&&i<l.minimum?[new ie(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new ie(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function ru(e){var t,i,l,p=e.valueSpec,d=Xe(e.value.type),_={},E=d!=="categorical"&&e.value.property===void 0,T=!E,z=_r(e.value.stops)==="array"&&_r(e.value.stops[0])==="array"&&_r(e.value.stops[0][0])==="object",C=mo({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(X){if(d==="identity")return[new ie(X.key,X.value,'identity function may not have a "stops" property')];var ee=[],ne=X.value;return ee=ee.concat(is({key:X.key,value:ne,valueSpec:X.valueSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:D})),_r(ne)==="array"&&ne.length===0&&ee.push(new ie(X.key,ne,"array must have at least one stop")),ee},default:function(X){return ur({key:X.key,value:X.value,valueSpec:p,style:X.style,styleSpec:X.styleSpec})}}});return d==="identity"&&E&&C.push(new ie(e.key,e.value,'missing required property "property"')),d==="identity"||e.value.stops||C.push(new ie(e.key,e.value,'missing required property "stops"')),d==="exponential"&&e.valueSpec.expression&&!fo(e.valueSpec)&&C.push(new ie(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(T&&!po(e.valueSpec)?C.push(new ie(e.key,e.value,"property functions not supported")):E&&!tu(e.valueSpec)&&C.push(new ie(e.key,e.value,"zoom functions not supported"))),d!=="categorical"&&!z||e.value.property!==void 0||C.push(new ie(e.key,e.value,'"property" property is required')),C;function D(X){var ee=[],ne=X.value,pe=X.key;if(_r(ne)!=="array")return[new ie(pe,ne,"array expected, "+_r(ne)+" found")];if(ne.length!==2)return[new ie(pe,ne,"array length 2 expected, length "+ne.length+" found")];if(z){if(_r(ne[0])!=="object")return[new ie(pe,ne,"object expected, "+_r(ne[0])+" found")];if(ne[0].zoom===void 0)return[new ie(pe,ne,"object stop key must have zoom")];if(ne[0].value===void 0)return[new ie(pe,ne,"object stop key must have value")];if(l&&l>Xe(ne[0].zoom))return[new ie(pe,ne[0].zoom,"stop zoom values must appear in ascending order")];Xe(ne[0].zoom)!==l&&(l=Xe(ne[0].zoom),i=void 0,_={}),ee=ee.concat(mo({key:pe+"[0]",value:ne[0],valueSpec:{zoom:{}},style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:Is,value:V}}))}else ee=ee.concat(V({key:pe+"[0]",value:ne[0],valueSpec:{},style:X.style,styleSpec:X.styleSpec},ne));return sa(ze(ne[1]))?ee.concat([new ie(pe+"[1]",ne[1],"expressions are not allowed in function stops.")]):ee.concat(ur({key:pe+"[1]",value:ne[1],valueSpec:p,style:X.style,styleSpec:X.styleSpec}))}function V(X,ee){var ne=_r(X.value),pe=Xe(X.value),ae=X.value!==null?X.value:ee;if(t){if(ne!==t)return[new ie(X.key,ae,ne+" stop domain type must match previous stop domain type "+t)]}else t=ne;if(ne!=="number"&&ne!=="string"&&ne!=="boolean")return[new ie(X.key,ae,"stop domain value must be a number, string, or boolean")];if(ne!=="number"&&d!=="categorical"){var ge="number expected, "+ne+" found";return po(p)&&d===void 0&&(ge+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ie(X.key,ae,ge)]}return d!=="categorical"||ne!=="number"||isFinite(pe)&&Math.floor(pe)===pe?d!=="categorical"&&ne==="number"&&i!==void 0&&pe<i?[new ie(X.key,ae,"stop domain values must appear in ascending order")]:(i=pe,d==="categorical"&&pe in _?[new ie(X.key,ae,"stop domain values must be unique")]:(_[pe]=!0,[])):[new ie(X.key,ae,"integer expected, found "+pe)]}}function Lo(e){var t=(e.expressionContext==="property"?rs:ks)(ze(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new ie(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new ie(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!_e(i))return[new ie(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!_e(i))return[new ie(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!ln(i,["zoom","feature-state"]))return[new ie(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!gn(i))return[new ie(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ns(e){var t=e.key,i=e.value,l=e.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(Xe(i))===-1&&p.push(new ie(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Xe(i))===-1&&p.push(new ie(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),p}function js(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!js(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}Us.deserialize=function(e){return new Us(e._parameters,e._specification)},Us.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Tl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function qs(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};js(e)||(e=Ro(e));var t=ks(e,Tl);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,p){return t.value.evaluate(i,l,{},p)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var p=1;p<l.length;p++)if(i(l[p]))return!0;return!1}(e)}}function yo(e,t){return e<t?-1:e>t?1:0}function Ro(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?go(e[1],e[2],"=="):i==="!="?Ca(go(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?go(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Ro))):i==="all"?["all"].concat(e.slice(1).map(Ro)):i==="none"?["all"].concat(e.slice(1).map(Ro).map(Ca)):i==="in"?Pa(e[1],e.slice(2)):i==="!in"?Ca(Pa(e[1],e.slice(2))):i==="has"?iu(e[1]):i==="!has"?Ca(iu(e[1])):i!=="within"||e}function go(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function Pa(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(yo)]]:["filter-in-small",e,["literal",t]]}}function iu(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Ca(e){return["!",e]}function Du(e){return js(ze(e.value))?Lo(Ve({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,p=i.key;if(_r(l)!=="array")return[new ie(p,l,"array expected, "+_r(l)+" found")];var d,_=i.styleSpec,E=[];if(l.length<1)return[new ie(p,l,"filter array must have at least 1 element")];switch(E=E.concat(ns({key:p+"[0]",value:l[0],valueSpec:_.filter_operator,style:i.style,styleSpec:i.styleSpec})),Xe(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Xe(l[1])==="$type"&&E.push(new ie(p,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&E.push(new ie(p,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(d=_r(l[1]))!=="string"&&E.push(new ie(p+"[1]",l[1],"string expected, "+d+" found"));for(var T=2;T<l.length;T++)d=_r(l[T]),Xe(l[1])==="$type"?E=E.concat(ns({key:p+"["+T+"]",value:l[T],valueSpec:_.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&E.push(new ie(p+"["+T+"]",l[T],"string, number, or boolean expected, "+d+" found"));break;case"any":case"all":case"none":for(var z=1;z<l.length;z++)E=E.concat(t({key:p+"["+z+"]",value:l[z],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=_r(l[1]),l.length!==2?E.push(new ie(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):d!=="string"&&E.push(new ie(p+"[1]",l[1],"string expected, "+d+" found"));break;case"within":d=_r(l[1]),l.length!==2?E.push(new ie(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):d!=="object"&&E.push(new ie(p+"[1]",l[1],"object expected, "+d+" found"))}return E}(e)}function Il(e,t){var i=e.key,l=e.style,p=e.styleSpec,d=e.value,_=e.objectKey,E=p[t+"_"+e.layerType];if(!E)return[];var T=_.match(/^(.*)-transition$/);if(t==="paint"&&T&&E[T[1]]&&E[T[1]].transition)return ur({key:i,value:d,valueSpec:p.transition,style:l,styleSpec:p});var z,C=e.valueSpec||E[_];if(!C)return[new ie(i,d,'unknown property "'+_+'"')];if(_r(d)==="string"&&po(C)&&!C.tokens&&(z=/^{([^}]+)}$/.exec(d)))return[new ie(i,d,'"'+_+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(z[1])+" }`.")];var D=[];return e.layerType==="symbol"&&(_==="text-field"&&l&&!l.glyphs&&D.push(new ie(i,d,'use of "text-field" requires a style "glyphs" property')),_==="text-font"&&Yo(ze(d))&&Xe(d.type)==="identity"&&D.push(new ie(i,d,'"text-font" does not support identity functions'))),D.concat(ur({key:e.key,value:d,valueSpec:C,style:l,styleSpec:p,expressionContext:"property",propertyType:t,propertyKey:_}))}function os(e){return Il(e,"paint")}function la(e){return Il(e,"layout")}function nu(e){var t=[],i=e.value,l=e.key,p=e.style,d=e.styleSpec;i.type||i.ref||t.push(new ie(l,i,'either "type" or "ref" is required'));var _,E=Xe(i.type),T=Xe(i.ref);if(i.id)for(var z=Xe(i.id),C=0;C<e.arrayIndex;C++){var D=p.layers[C];Xe(D.id)===z&&t.push(new ie(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+D.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(ee){ee in i&&t.push(new ie(l,i[ee],'"'+ee+'" is prohibited for ref layers'))}),p.layers.forEach(function(ee){Xe(ee.id)===T&&(_=ee)}),_?_.ref?t.push(new ie(l,i.ref,"ref cannot reference another ref layer")):E=Xe(_.type):t.push(new ie(l,i.ref,'ref layer "'+T+'" not found'));else if(E!=="background")if(i.source){var V=p.sources&&p.sources[i.source],X=V&&Xe(V.type);V?X==="vector"&&E==="raster"?t.push(new ie(l,i.source,'layer "'+i.id+'" requires a raster source')):X==="raster"&&E!=="raster"?t.push(new ie(l,i.source,'layer "'+i.id+'" requires a vector source')):X!=="vector"||i["source-layer"]?X==="raster-dem"&&E!=="hillshade"?t.push(new ie(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!i.paint||!i.paint["line-gradient"]||X==="geojson"&&V.lineMetrics||t.push(new ie(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new ie(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new ie(l,i.source,'source "'+i.source+'" not found'))}else t.push(new ie(l,i,'missing required property "source"'));return t=t.concat(mo({key:l,value:i,valueSpec:d.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return ur({key:l+".type",value:i.type,valueSpec:d.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Du,layout:function(ee){return mo({layer:i,key:ee.key,value:ee.value,style:ee.style,styleSpec:ee.styleSpec,objectElementValidators:{"*":function(ne){return la(Ve({layerType:E},ne))}}})},paint:function(ee){return mo({layer:i,key:ee.key,value:ee.value,style:ee.style,styleSpec:ee.styleSpec,objectElementValidators:{"*":function(ne){return os(Ve({layerType:E},ne))}}})}}}))}function Bo(e){var t=e.value,i=e.key,l=_r(t);return l!=="string"?[new ie(i,t,"string expected, "+l+" found")]:[]}var Fr={promoteId:function(e){var t=e.key,i=e.value;if(_r(i)==="string")return Bo({key:t,value:i});var l=[];for(var p in i)l.push.apply(l,Bo({key:t+"."+p,value:i[p]}));return l}};function Qs(e){var t=e.value,i=e.key,l=e.styleSpec,p=e.style;if(!t.type)return[new ie(i,t,'"type" is required')];var d,_=Xe(t.type);switch(_){case"vector":case"raster":case"raster-dem":return mo({key:i,value:t,valueSpec:l["source_"+_.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Fr});case"geojson":if(d=mo({key:i,value:t,valueSpec:l.source_geojson,style:p,styleSpec:l,objectElementValidators:Fr}),t.cluster)for(var E in t.clusterProperties){var T=t.clusterProperties[E],z=T[0],C=typeof z=="string"?[z,["accumulated"],["get",E]]:z;d.push.apply(d,Lo({key:i+"."+E+".map",value:T[1],expressionContext:"cluster-map"})),d.push.apply(d,Lo({key:i+"."+E+".reduce",value:C,expressionContext:"cluster-reduce"}))}return d;case"video":return mo({key:i,value:t,valueSpec:l.source_video,style:p,styleSpec:l});case"image":return mo({key:i,value:t,valueSpec:l.source_image,style:p,styleSpec:l});case"canvas":return[new ie(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ns({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,styleSpec:l})}}function as(e){var t=e.value,i=e.styleSpec,l=i.light,p=e.style,d=[],_=_r(t);if(t===void 0)return d;if(_!=="object")return d.concat([new ie("light",t,"object expected, "+_+" found")]);for(var E in t){var T=E.match(/^(.*)-transition$/);d=d.concat(T&&l[T[1]]&&l[T[1]].transition?ur({key:E,value:t[E],valueSpec:i.transition,style:p,styleSpec:i}):l[E]?ur({key:E,value:t[E],valueSpec:l[E],style:p,styleSpec:i}):[new ie(E,t[E],'unknown property "'+E+'"')])}return d}var eo={"*":function(){return[]},array:is,boolean:function(e){var t=e.value,i=e.key,l=_r(t);return l!=="boolean"?[new ie(i,t,"boolean expected, "+l+" found")]:[]},number:Is,color:function(e){var t=e.key,i=e.value,l=_r(i);return l!=="string"?[new ie(t,i,"color expected, "+l+" found")]:Jt(i)===null?[new ie(t,i,'color expected, "'+i+'" found')]:[]},constants:be,enum:ns,filter:Du,function:ru,layer:nu,object:mo,source:Qs,light:as,string:Bo,formatted:function(e){return Bo(e).length===0?[]:Lo(e)},resolvedImage:function(e){return Bo(e).length===0?[]:Lo(e)}};function ur(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&Yo(Xe(t))?ru(e):i.expression&&sa(ze(t))?Lo(e):i.type&&eo[i.type]?eo[i.type](e):mo(Ve({},e,{valueSpec:i.type?l[i.type]:i}))}function xr(e){var t=e.value,i=e.key,l=Bo(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new ie(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new ie(i,t,'"glyphs" url must include a "{range}" token'))),l}function xi(e,t){t===void 0&&(t=Z);var i=[];return i=i.concat(ur({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:xr,"*":function(){return[]}}})),e.constants&&(i=i.concat(be({key:"constants",value:e.constants,style:e,styleSpec:t}))),Oo(i)}function Oo(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function As(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return Oo(e.apply(this,t))}}xi.source=As(Qs),xi.light=As(as),xi.layer=As(nu),xi.filter=As(Du),xi.paintProperty=As(os),xi.layoutProperty=As(la);var ua=xi,qc=ua.light,Lu=ua.paintProperty,ca=ua.layoutProperty;function ha(e,t){var i=!1;if(t&&t.length)for(var l=0,p=t;l<p.length;l+=1)e.fire(new ue(new Error(p[l].message))),i=!0;return i}var pa=li;function li(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var p=new Int32Array(this.arrayBuffer);e=p[0],this.d=(t=p[1])+2*(i=p[2]);for(var d=0;d<this.d*this.d;d++){var _=p[3+d],E=p[3+d+1];l.push(_===E?null:p.subarray(_,E))}var T=p[3+l.length+1];this.keys=p.subarray(p[3+l.length],T),this.bboxes=p.subarray(T),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var z=0;z<this.d*this.d;z++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var C=i/t*e;this.min=-C,this.max=e+C}li.prototype.insert=function(e,t,i,l,p){this._forEachCell(t,i,l,p,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(p)},li.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},li.prototype._insertCell=function(e,t,i,l,p,d){this.cells[p].push(d)},li.prototype.query=function(e,t,i,l,p){var d=this.min,_=this.max;if(e<=d&&t<=d&&_<=i&&_<=l&&!p)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(e,t,i,l,this._queryCell,E,{},p),E},li.prototype._queryCell=function(e,t,i,l,p,d,_,E){var T=this.cells[p];if(T!==null)for(var z=this.keys,C=this.bboxes,D=0;D<T.length;D++){var V=T[D];if(_[V]===void 0){var X=4*V;(E?E(C[X+0],C[X+1],C[X+2],C[X+3]):e<=C[X+2]&&t<=C[X+3]&&i>=C[X+0]&&l>=C[X+1])?(_[V]=!0,d.push(z[V])):_[V]=!1}}},li.prototype._forEachCell=function(e,t,i,l,p,d,_,E){for(var T=this._convertToCellCoord(e),z=this._convertToCellCoord(t),C=this._convertToCellCoord(i),D=this._convertToCellCoord(l),V=T;V<=C;V++)for(var X=z;X<=D;X++){var ee=this.d*X+V;if((!E||E(this._convertFromCellCoord(V),this._convertFromCellCoord(X),this._convertFromCellCoord(V+1),this._convertFromCellCoord(X+1)))&&p.call(this,e,t,i,l,ee,d,_,E))return}},li.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},li.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},li.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var p=new Int32Array(t+i+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var d=t,_=0;_<e.length;_++){var E=e[_];p[3+_]=d,p.set(E,d),d+=E.length}return p[3+e.length]=d,p.set(this.keys,d),p[3+e.length+1]=d+=this.keys.length,p.set(this.bboxes,d),d+=this.bboxes.length,p.buffer};var ss=j.ImageData,ou=j.ImageBitmap,wi={};function lt(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),wi[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var qn in lt("Object",Object),pa.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},pa.deserialize=function(e){return new pa(e.buffer)},lt("Grid",pa),lt("Color",nr),lt("Error",Error),lt("ResolvedImage",ki),lt("StylePropertyFunction",Us),lt("StyleExpression",Es,{omit:["_evaluator"]}),lt("ZoomDependentExpression",Ts),lt("ZoomConstantExpression",Vs),lt("CompoundExpression",ai,{omit:["_evaluate"]}),Do)Do[qn]._classRegistryKey||lt("Expression_"+qn,Do[qn]);function Fo(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function zn(e){return ou&&e instanceof ou}function un(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Fo(e)||zn(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof ss)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],p=0,d=e;p<d.length;p+=1)l.push(un(d[p],t));return l}if(typeof e=="object"){var _=e.constructor,E=_._classRegistryKey;if(!E)throw new Error("can't serialize object of unregistered class");var T=_.serialize?_.serialize(e,t):{};if(!_.serialize){for(var z in e)if(e.hasOwnProperty(z)&&!(wi[E].omit.indexOf(z)>=0)){var C=e[z];T[z]=wi[E].shallow.indexOf(z)>=0?C:un(C,t)}e instanceof Error&&(T.message=e.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return E!=="Object"&&(T.$name=E),T}throw new Error("can't serialize object of type "+typeof e)}function Zn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Fo(e)||zn(e)||ArrayBuffer.isView(e)||e instanceof ss)return e;if(Array.isArray(e))return e.map(Zn);if(typeof e=="object"){var t=e.$name||"Object",i=wi[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),p=0,d=Object.keys(e);p<d.length;p+=1){var _=d[p];if(_!=="$name"){var E=e[_];l[_]=wi[t].shallow.indexOf(_)>=0?E:Zn(E)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var ls=function(){this.first=!0};ls.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var at={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Al(e){for(var t=0,i=e;t<i.length;t+=1)if(Ma(i[t].charCodeAt(0)))return!0;return!1}function Ma(e){return!(e!==746&&e!==747&&(e<4352||!(at["Bopomofo Extended"](e)||at.Bopomofo(e)||at["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||at["CJK Compatibility Ideographs"](e)||at["CJK Compatibility"](e)||at["CJK Radicals Supplement"](e)||at["CJK Strokes"](e)||!(!at["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||at["CJK Unified Ideographs Extension A"](e)||at["CJK Unified Ideographs"](e)||at["Enclosed CJK Letters and Months"](e)||at["Hangul Compatibility Jamo"](e)||at["Hangul Jamo Extended-A"](e)||at["Hangul Jamo Extended-B"](e)||at["Hangul Jamo"](e)||at["Hangul Syllables"](e)||at.Hiragana(e)||at["Ideographic Description Characters"](e)||at.Kanbun(e)||at["Kangxi Radicals"](e)||at["Katakana Phonetic Extensions"](e)||at.Katakana(e)&&e!==12540||!(!at["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!at["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||at["Unified Canadian Aboriginal Syllabics"](e)||at["Unified Canadian Aboriginal Syllabics Extended"](e)||at["Vertical Forms"](e)||at["Yijing Hexagram Symbols"](e)||at["Yi Syllables"](e)||at["Yi Radicals"](e))))}function us(e){return!(Ma(e)||function(t){return!!(at["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||at["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||at["Letterlike Symbols"](t)||at["Number Forms"](t)||at["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||at["Control Pictures"](t)&&t!==9251||at["Optical Character Recognition"](t)||at["Enclosed Alphanumerics"](t)||at["Geometric Shapes"](t)||at["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||at["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||at["CJK Symbols and Punctuation"](t)||at.Katakana(t)||at["Private Use Area"](t)||at["CJK Compatibility Forms"](t)||at["Small Form Variants"](t)||at["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function _o(e){return e>=1424&&e<=2303||at["Arabic Presentation Forms-A"](e)||at["Arabic Presentation Forms-B"](e)}function Ji(e,t){return!(!t&&_o(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||at.Khmer(e))}function zs(e){for(var t=0,i=e;t<i.length;t+=1)if(_o(i[t].charCodeAt(0)))return!0;return!1}var $s=null,Gn="unavailable",Kn=null,Ru=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Gn="error"),$s&&$s(e)};function Ps(){Da.fire(new re("pluginStateChange",{pluginStatus:Gn,pluginURL:Kn}))}var Da=new me,cs=function(){return Gn},No=function(){if(Gn!=="deferred"||!Kn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Gn="loading",Ps(),Kn&&ei({url:Kn},function(e){e?Ru(e):(Gn="loaded",Ps())})},cn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Gn==="loaded"||cn.applyArabicShaping!=null},isLoading:function(){return Gn==="loading"},setState:function(e){Gn=e.pluginStatus,Kn=e.pluginURL},isParsed:function(){return cn.applyArabicShaping!=null&&cn.processBidirectionalText!=null&&cn.processStyledBidirectionalText!=null},getPluginURL:function(){return Kn}},er=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ls,this.transition={})};er.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,p=t;l<p.length;l+=1)if(!Ji(p[l].charCodeAt(0),i))return!1;return!0}(e,cn.isLoaded())},er.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},er.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var Vo=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(Yo(i))return new Us(i,l);if(sa(i)){var p=rs(i,l);if(p.result==="error")throw new Error(p.value.map(function(_){return _.key+": "+_.message}).join(", "));return p.value}var d=i;return typeof i=="string"&&l.type==="color"&&(d=nr.parse(i)),{kind:"constant",evaluate:function(){return d}}}(t===void 0?e.specification.default:t,e.specification)};Vo.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Vo.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var vo=function(e){this.property=e,this.value=new Vo(e,void 0)};vo.prototype.transitioned=function(e,t){return new Yi(this.property,this.value,t,Ue({},e.transition,this.transition),e.now)},vo.prototype.untransitioned=function(){return new Yi(this.property,this.value,null,{},0)};var qi=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};qi.prototype.getValue=function(e){return Ke(this._values[e].value.value)},qi.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new vo(this._values[e].property)),this._values[e].value=new Vo(this._values[e].property,t===null?void 0:Ke(t))},qi.prototype.getTransition=function(e){return Ke(this._values[e].transition)},qi.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new vo(this._values[e].property)),this._values[e].transition=Ke(t)||void 0},qi.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p);var d=this.getTransition(l);d!==void 0&&(e[l+"-transition"]=d)}return e},qi.prototype.transitioned=function(e,t){for(var i=new Pn(this._properties),l=0,p=Object.keys(this._values);l<p.length;l+=1){var d=p[l];i._values[d]=this._values[d].transitioned(e,t._values[d])}return i},qi.prototype.untransitioned=function(){for(var e=new Pn(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var Yi=function(e,t,i,l,p){this.property=e,this.value=t,this.begin=p+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};Yi.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,p=this.value.possiblyEvaluate(e,t,i),d=this.prior;if(d){if(l>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(l<this.begin)return d.possiblyEvaluate(e,t,i);var _=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(d.possiblyEvaluate(e,t,i),p,function(E){if(E<=0)return 0;if(E>=1)return 1;var T=E*E,z=T*E;return 4*(E<.5?z:3*(E-T)+z-.75)}(_))}return p};var Pn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Pn.prototype.possiblyEvaluate=function(e,t,i){for(var l=new Zs(this._properties),p=0,d=Object.keys(this._values);p<d.length;p+=1){var _=d[p];l._values[_]=this._values[_].possiblyEvaluate(e,t,i)}return l},Pn.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var Di=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};Di.prototype.getValue=function(e){return Ke(this._values[e].value)},Di.prototype.setValue=function(e,t){this._values[e]=new Vo(this._values[e].property,t===null?void 0:Ke(t))},Di.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p)}return e},Di.prototype.possiblyEvaluate=function(e,t,i){for(var l=new Zs(this._properties),p=0,d=Object.keys(this._values);p<d.length;p+=1){var _=d[p];l._values[_]=this._values[_].possiblyEvaluate(e,t,i)}return l};var Si=function(e,t,i){this.property=e,this.value=t,this.parameters=i};Si.prototype.isConstant=function(){return this.value.kind==="constant"},Si.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Si.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var Zs=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Zs.prototype.get=function(e){return this._values[e]};var vt=function(e){this.specification=e};vt.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},vt.prototype.interpolate=function(e,t,i){var l=Wo[this.specification.type];return l?l(e,t,i):e};var gt=function(e,t){this.specification=e,this.overrides=t};gt.prototype.possiblyEvaluate=function(e,t,i,l){return new Si(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},gt.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Si(this,{kind:"constant",value:void 0},e.parameters);var l=Wo[this.specification.type];return l?new Si(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},gt.prototype.evaluate=function(e,t,i,l,p,d){return e.kind==="constant"?e.value:e.evaluate(t,i,l,p,d)};var el=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,p,d){if(i.value===void 0)return new Si(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var _=i.expression.evaluate(l,null,{},p,d),E=i.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,T=this._calculate(E,E,E,l);return new Si(this,{kind:"constant",value:T},l)}if(i.expression.kind==="camera"){var z=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new Si(this,{kind:"constant",value:z},l)}return new Si(this,i.expression,l)},t.prototype.evaluate=function(i,l,p,d,_,E){if(i.kind==="source"){var T=i.evaluate(l,p,d,_,E);return this._calculate(T,T,T,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},p,d),i.evaluate({zoom:Math.floor(l.zoom)},p,d),i.evaluate({zoom:Math.floor(l.zoom)+1},p,d),l):i.value},t.prototype._calculate=function(i,l,p,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}},t.prototype.interpolate=function(i){return i},t}(gt),Li=function(e){this.specification=e};Li.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var p=e.expression.evaluate(t,null,{},i,l);return this._calculate(p,p,p,t)}return this._calculate(e.expression.evaluate(new er(Math.floor(t.zoom-1),t)),e.expression.evaluate(new er(Math.floor(t.zoom),t)),e.expression.evaluate(new er(Math.floor(t.zoom+1),t)),t)}},Li.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},Li.prototype.interpolate=function(e){return e};var Cn=function(e){this.specification=e};Cn.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},Cn.prototype.interpolate=function(){return!1};var Qi=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new Vo(i,void 0),p=this.defaultTransitionablePropertyValues[t]=new vo(i);this.defaultTransitioningPropertyValues[t]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};lt("DataDrivenProperty",gt),lt("DataConstantProperty",vt),lt("CrossFadedDataDrivenProperty",el),lt("CrossFadedProperty",Li),lt("ColorRampProperty",Cn);var Xn=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new Di(l.layout)),l.paint)){for(var p in this._transitionablePaint=new qi(l.paint),i.paint)this.setPaintProperty(p,i.paint[p],{validate:!1});for(var d in i.layout)this.setLayoutProperty(d,i.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Zs(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,p){p===void 0&&(p={}),l!=null&&this._validate(ca,"layers."+this.id+".layout."+i,i,l,p)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return Gt(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,p){if(p===void 0&&(p={}),l!=null&&this._validate(Lu,"layers."+this.id+".paint."+i,i,l,p))return!1;if(Gt(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var d=this._transitionablePaint._values[i],_=d.property.specification["property-type"]==="cross-faded-data-driven",E=d.value.isDataDriven(),T=d.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var z=this._transitionablePaint._values[i].value;return z.isDataDriven()||E||_||this._handleOverridablePaintPropertyUpdate(i,T,z)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),jt(i,function(l,p){return!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,p,d,_){return _===void 0&&(_={}),(!_||_.validate!==!1)&&ha(this,i.call(ua,{key:l,layerType:this.type,objectKey:p,value:d,styleSpec:Z,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof Si&&po(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(me),Gs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},tl=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Er=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function pi(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(p){var d=Gs[p.type].BYTES_PER_ELEMENT,_=i=au(i,Math.max(t,d)),E=p.components||1;return l=Math.max(l,d),i+=d*E,{name:p.name,type:p.type,components:E,offset:_}}),size:au(i,Math.max(l,t)),alignment:t}}function au(e,t){return Math.ceil(e/t)*t}Er.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Er.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Er.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Er.prototype.clear=function(){this.length=0},Er.prototype.resize=function(e){this.reserve(e),this.length=e},Er.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Er.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Hn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.int16[d+0]=l,this.int16[d+1]=p,i},t}(Er);Hn.prototype.bytesPerElement=4,lt("StructArrayLayout2i4",Hn);var bo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var E=4*i;return this.int16[E+0]=l,this.int16[E+1]=p,this.int16[E+2]=d,this.int16[E+3]=_,i},t}(Er);bo.prototype.bytesPerElement=8,lt("StructArrayLayout4i8",bo);var Mn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E){var T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,d,_,E)},t.prototype.emplace=function(i,l,p,d,_,E,T){var z=6*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.int16[z+2]=d,this.int16[z+3]=_,this.int16[z+4]=E,this.int16[z+5]=T,i},t}(Er);Mn.prototype.bytesPerElement=12,lt("StructArrayLayout2i4i12",Mn);var Wn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E){var T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,d,_,E)},t.prototype.emplace=function(i,l,p,d,_,E,T){var z=4*i,C=8*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.uint8[C+4]=d,this.uint8[C+5]=_,this.uint8[C+6]=E,this.uint8[C+7]=T,i},t}(Er);Wn.prototype.bytesPerElement=8,lt("StructArrayLayout2i4ub8",Wn);var $o=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.float32[d+0]=l,this.float32[d+1]=p,i},t}(Er);$o.prototype.bytesPerElement=8,lt("StructArrayLayout2f8",$o);var La=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E,T,z,C,D){var V=this.length;return this.resize(V+1),this.emplace(V,i,l,p,d,_,E,T,z,C,D)},t.prototype.emplace=function(i,l,p,d,_,E,T,z,C,D,V){var X=10*i;return this.uint16[X+0]=l,this.uint16[X+1]=p,this.uint16[X+2]=d,this.uint16[X+3]=_,this.uint16[X+4]=E,this.uint16[X+5]=T,this.uint16[X+6]=z,this.uint16[X+7]=C,this.uint16[X+8]=D,this.uint16[X+9]=V,i},t}(Er);La.prototype.bytesPerElement=20,lt("StructArrayLayout10ui20",La);var rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E,T,z,C,D,V,X){var ee=this.length;return this.resize(ee+1),this.emplace(ee,i,l,p,d,_,E,T,z,C,D,V,X)},t.prototype.emplace=function(i,l,p,d,_,E,T,z,C,D,V,X,ee){var ne=12*i;return this.int16[ne+0]=l,this.int16[ne+1]=p,this.int16[ne+2]=d,this.int16[ne+3]=_,this.uint16[ne+4]=E,this.uint16[ne+5]=T,this.uint16[ne+6]=z,this.uint16[ne+7]=C,this.int16[ne+8]=D,this.int16[ne+9]=V,this.int16[ne+10]=X,this.int16[ne+11]=ee,i},t}(Er);rl.prototype.bytesPerElement=24,lt("StructArrayLayout4i4ui4i24",rl);var ea=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.float32[_+0]=l,this.float32[_+1]=p,this.float32[_+2]=d,i},t}(Er);ea.prototype.bytesPerElement=12,lt("StructArrayLayout3f12",ea);var fa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(Er);fa.prototype.bytesPerElement=4,lt("StructArrayLayout1ul4",fa);var zl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E,T,z,C){var D=this.length;return this.resize(D+1),this.emplace(D,i,l,p,d,_,E,T,z,C)},t.prototype.emplace=function(i,l,p,d,_,E,T,z,C,D){var V=10*i,X=5*i;return this.int16[V+0]=l,this.int16[V+1]=p,this.int16[V+2]=d,this.int16[V+3]=_,this.int16[V+4]=E,this.int16[V+5]=T,this.uint32[X+3]=z,this.uint16[V+8]=C,this.uint16[V+9]=D,i},t}(Er);zl.prototype.bytesPerElement=20,lt("StructArrayLayout6i1ul2ui20",zl);var ta=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E){var T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,d,_,E)},t.prototype.emplace=function(i,l,p,d,_,E,T){var z=6*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.int16[z+2]=d,this.int16[z+3]=_,this.int16[z+4]=E,this.int16[z+5]=T,i},t}(Er);ta.prototype.bytesPerElement=12,lt("StructArrayLayout2i2i2i12",ta);var da=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_){var E=this.length;return this.resize(E+1),this.emplace(E,i,l,p,d,_)},t.prototype.emplace=function(i,l,p,d,_,E){var T=4*i,z=8*i;return this.float32[T+0]=l,this.float32[T+1]=p,this.float32[T+2]=d,this.int16[z+6]=_,this.int16[z+7]=E,i},t}(Er);da.prototype.bytesPerElement=16,lt("StructArrayLayout2f1f2i16",da);var Pl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var E=12*i,T=3*i;return this.uint8[E+0]=l,this.uint8[E+1]=p,this.float32[T+1]=d,this.float32[T+2]=_,i},t}(Er);Pl.prototype.bytesPerElement=12,lt("StructArrayLayout2ub2f12",Pl);var Ra=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.uint16[_+0]=l,this.uint16[_+1]=p,this.uint16[_+2]=d,i},t}(Er);Ra.prototype.bytesPerElement=6,lt("StructArrayLayout3ui6",Ra);var to=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E,T,z,C,D,V,X,ee,ne,pe,ae,ge){var Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,i,l,p,d,_,E,T,z,C,D,V,X,ee,ne,pe,ae,ge)},t.prototype.emplace=function(i,l,p,d,_,E,T,z,C,D,V,X,ee,ne,pe,ae,ge,Ee){var Ae=24*i,Le=12*i,Fe=48*i;return this.int16[Ae+0]=l,this.int16[Ae+1]=p,this.uint16[Ae+2]=d,this.uint16[Ae+3]=_,this.uint32[Le+2]=E,this.uint32[Le+3]=T,this.uint32[Le+4]=z,this.uint16[Ae+10]=C,this.uint16[Ae+11]=D,this.uint16[Ae+12]=V,this.float32[Le+7]=X,this.float32[Le+8]=ee,this.uint8[Fe+36]=ne,this.uint8[Fe+37]=pe,this.uint8[Fe+38]=ae,this.uint32[Le+10]=ge,this.int16[Ae+22]=Ee,i},t}(Er);to.prototype.bytesPerElement=48,lt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",to);var il=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,E,T,z,C,D,V,X,ee,ne,pe,ae,ge,Ee,Ae,Le,Fe,$e,nt,It,ct,Pt,pt,rr){var Ut=this.length;return this.resize(Ut+1),this.emplace(Ut,i,l,p,d,_,E,T,z,C,D,V,X,ee,ne,pe,ae,ge,Ee,Ae,Le,Fe,$e,nt,It,ct,Pt,pt,rr)},t.prototype.emplace=function(i,l,p,d,_,E,T,z,C,D,V,X,ee,ne,pe,ae,ge,Ee,Ae,Le,Fe,$e,nt,It,ct,Pt,pt,rr,Ut){var _t=34*i,cr=17*i;return this.int16[_t+0]=l,this.int16[_t+1]=p,this.int16[_t+2]=d,this.int16[_t+3]=_,this.int16[_t+4]=E,this.int16[_t+5]=T,this.int16[_t+6]=z,this.int16[_t+7]=C,this.uint16[_t+8]=D,this.uint16[_t+9]=V,this.uint16[_t+10]=X,this.uint16[_t+11]=ee,this.uint16[_t+12]=ne,this.uint16[_t+13]=pe,this.uint16[_t+14]=ae,this.uint16[_t+15]=ge,this.uint16[_t+16]=Ee,this.uint16[_t+17]=Ae,this.uint16[_t+18]=Le,this.uint16[_t+19]=Fe,this.uint16[_t+20]=$e,this.uint16[_t+21]=nt,this.uint16[_t+22]=It,this.uint32[cr+12]=ct,this.float32[cr+13]=Pt,this.float32[cr+14]=pt,this.float32[cr+15]=rr,this.float32[cr+16]=Ut,i},t}(Er);il.prototype.bytesPerElement=68,lt("StructArrayLayout8i15ui1ul4f68",il);var Dn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(Er);Dn.prototype.bytesPerElement=4,lt("StructArrayLayout1f4",Dn);var zi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.int16[_+0]=l,this.int16[_+1]=p,this.int16[_+2]=d,i},t}(Er);zi.prototype.bytesPerElement=6,lt("StructArrayLayout3i6",zi);var ma=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=4*i;return this.uint32[2*i+0]=l,this.uint16[_+2]=p,this.uint16[_+3]=d,i},t}(Er);ma.prototype.bytesPerElement=8,lt("StructArrayLayout1ul2ui8",ma);var Ks=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.uint16[d+0]=l,this.uint16[d+1]=p,i},t}(Er);Ks.prototype.bytesPerElement=4,lt("StructArrayLayout2ui4",Ks);var hs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(Er);hs.prototype.bytesPerElement=2,lt("StructArrayLayout1ui2",hs);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var E=4*i;return this.float32[E+0]=l,this.float32[E+1]=p,this.float32[E+2]=d,this.float32[E+3]=_,i},t}(Er);su.prototype.bytesPerElement=16,lt("StructArrayLayout4f16",su);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new B(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(tl);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(zl);lt("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(tl);o.prototype.size=48;var u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(to);lt("PlacedSymbolArray",u);var m=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(tl);m.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new m(this,i)},t}(il);lt("SymbolInstanceArray",w);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(Dn);lt("GlyphOffsetArray",S);var k=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(zi);lt("SymbolLineVertexArray",k);var P=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(tl);P.prototype.size=8;var L=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new P(this,i)},t}(ma);lt("FeatureIndexArray",L);var G=pi([{name:"a_pos",components:2,type:"Int16"}],4).members,W=function(e){e===void 0&&(e=[]),this.segments=e};function J(e,t){return 256*(e=Se(Math.floor(e),0,255))+Se(Math.floor(t),0,255)}W.prototype.prepareSegment=function(e,t,i,l){var p=this.segments[this.segments.length-1];return e>W.MAX_VERTEX_ARRAY_LENGTH&&mt("Max vertices per segment is "+W.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!p||p.vertexLength+e>W.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==l)&&(p={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(p.sortKey=l),this.segments.push(p)),p},W.prototype.get=function(){return this.segments},W.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},W.simpleSegment=function(e,t,i,l){return new W([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},W.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,lt("SegmentVector",W);var oe=pi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),te=A(function(e){e.exports=function(t,i){var l,p,d,_,E,T,z,C;for(p=t.length-(l=3&t.length),d=i,E=3432918353,T=461845907,C=0;C<p;)z=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,d=27492+(65535&(_=5*(65535&(d=(d^=z=(65535&(z=(z=(65535&z)*E+(((z>>>16)*E&65535)<<16)&4294967295)<<15|z>>>17))*T+(((z>>>16)*T&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(z=0,l){case 3:z^=(255&t.charCodeAt(C+2))<<16;case 2:z^=(255&t.charCodeAt(C+1))<<8;case 1:d^=z=(65535&(z=(z=(65535&(z^=255&t.charCodeAt(C)))*E+(((z>>>16)*E&65535)<<16)&4294967295)<<15|z>>>17))*T+(((z>>>16)*T&65535)<<16)&4294967295}return d^=t.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0}}),se=A(function(e){e.exports=function(t,i){for(var l,p=t.length,d=i^p,_=0;p>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(_)|(255&t.charCodeAt(++_))<<8|(255&t.charCodeAt(++_))<<16|(255&t.charCodeAt(++_))<<24))+((1540483477*(l>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++_;switch(p){case 3:d^=(255&t.charCodeAt(_+2))<<16;case 2:d^=(255&t.charCodeAt(_+1))<<8;case 1:d=1540483477*(65535&(d^=255&t.charCodeAt(_)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0}}),$=te,le=se;$.murmur3=te,$.murmur2=le;var ye=function(){this.ids=[],this.positions=[],this.indexed=!1};ye.prototype.add=function(e,t,i,l){this.ids.push(Be(e)),this.positions.push(t,i,l)},ye.prototype.getPositions=function(e){for(var t=Be(e),i=0,l=this.ids.length-1;i<l;){var p=i+l>>1;this.ids[p]>=t?l=p:i=p+1}for(var d=[];this.ids[i]===t;)d.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return d},ye.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function p(d,_,E,T){for(;E<T;){for(var z=d[E+T>>1],C=E-1,D=T+1;;){do C++;while(d[C]<z);do D--;while(d[D]>z);if(C>=D)break;Te(d,C,D),Te(_,3*C,3*D),Te(_,3*C+1,3*D+1),Te(_,3*C+2,3*D+2)}D-E<T-D?(p(d,_,E,D),E=D+1):(p(d,_,D+1,T),T=D)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},ye.deserialize=function(e){var t=new ye;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ve=Math.pow(2,53)-1;function Be(e){var t=+e;return!isNaN(t)&&t<=ve?t:$(String(e))}function Te(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}lt("FeaturePositionMap",ye);var Pe=function(e,t){this.gl=e.gl,this.location=t},Oe=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Pe),Ze=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Pe),qe=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Pe),tt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Pe),ft=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Pe),zt=function(e){function t(i,l){e.call(this,i,l),this.current=nr.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Pe),wt=new Float32Array(16),Zt=function(e){function t(i,l){e.call(this,i,l),this.current=wt}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Pe);function dt(e){return[J(255*e.r,255*e.g),J(255*e.b,255*e.a)]}var qt=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};qt.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},qt.prototype.getBinding=function(e,t,i){return this.type==="color"?new zt(e,t):new Ze(e,t)};var Mt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Mt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Mt.prototype.setUniform=function(e,t,i,l){var p=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;p&&e.set(p)},Mt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new ft(e,t):new Ze(e,t)};var Vt=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(p){return{name:"a_"+p,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Vt.prototype.populatePaintArray=function(e,t,i,l,p){var d=this.paintVertexArray.length,_=this.expression.evaluate(new er(0),t,{},l,[],p);this.paintVertexArray.resize(e),this._setPaintValue(d,e,_)},Vt.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,p)},Vt.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=dt(i),p=e;p<t;p++)this.paintVertexArray.emplace(p,l[0],l[1]);else{for(var d=e;d<t;d++)this.paintVertexArray.emplace(d,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Vt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Vt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Bt=function(e,t,i,l,p,d){this.expression=e,this.uniformNames=t.map(function(_){return"u_"+_+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=t.map(function(_){return{name:"a_"+_,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new d};Bt.prototype.populatePaintArray=function(e,t,i,l,p){var d=this.expression.evaluate(new er(this.zoom),t,{},l,[],p),_=this.expression.evaluate(new er(this.zoom+1),t,{},l,[],p),E=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(E,e,d,_)},Bt.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:this.zoom},i,l),d=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,p,d)},Bt.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var p=dt(i),d=dt(l),_=e;_<t;_++)this.paintVertexArray.emplace(_,p[0],p[1],d[0],d[1]);else{for(var E=e;E<t;E++)this.paintVertexArray.emplace(E,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},Bt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Bt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Bt.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=Se(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},Bt.prototype.getBinding=function(e,t,i){return new Ze(e,t)};var Ot=function(e,t,i,l,p,d){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=d,this.zoomInPaintVertexArray=new p,this.zoomOutPaintVertexArray=new p};Ot.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Ot.prototype.updatePaintArray=function(e,t,i,l,p){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],p)},Ot.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var p=l[i.min],d=l[i.mid],_=l[i.max];if(p&&d&&_)for(var E=e;E<t;E++)this.zoomInPaintVertexArray.emplace(E,d.tl[0],d.tl[1],d.br[0],d.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],d.pixelRatio,p.pixelRatio),this.zoomOutPaintVertexArray.emplace(E,d.tl[0],d.tl[1],d.br[0],d.br[1],_.tl[0],_.tl[1],_.br[0],_.br[1],d.pixelRatio,_.pixelRatio)}},Ot.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,oe.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,oe.members,this.expression.isStateDependent))},Ot.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Q=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var p in e.paint._values)if(i(p)){var d=e.paint.get(p);if(d instanceof Si&&po(d.property.specification)){var _=Wr(p,e.type),E=d.value,T=d.property.specification.type,z=d.property.useIntegerZoom,C=d.property.specification["property-type"],D=C==="cross-faded"||C==="cross-faded-data-driven";if(E.kind==="constant")this.binders[p]=D?new Mt(E.value,_):new qt(E.value,_,T),l.push("/u_"+p);else if(E.kind==="source"||D){var V=Dr(p,T,"source");this.binders[p]=D?new Ot(E,T,z,t,V,e.id):new Vt(E,_,T,V),l.push("/a_"+p)}else{var X=Dr(p,T,"composite");this.binders[p]=new Bt(E,_,T,z,t,X),l.push("/z_"+p)}}}this.cacheKey=l.sort().join("")};Q.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Vt||t instanceof Bt?t.maxValue:0},Q.prototype.populatePaintArrays=function(e,t,i,l,p){for(var d in this.binders){var _=this.binders[d];(_ instanceof Vt||_ instanceof Bt||_ instanceof Ot)&&_.populatePaintArray(e,t,i,l,p)}},Q.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Mt&&l.setConstantPatternPositions(e,t)}},Q.prototype.updatePaintArrays=function(e,t,i,l,p){var d=!1;for(var _ in e)for(var E=0,T=t.getPositions(_);E<T.length;E+=1){var z=T[E],C=i.feature(z.index);for(var D in this.binders){var V=this.binders[D];if((V instanceof Vt||V instanceof Bt||V instanceof Ot)&&V.expression.isStateDependent===!0){var X=l.paint.get(D);V.expression=X.value,V.updatePaintArray(z.start,z.end,C,e[_],p),d=!0}}}return d},Q.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof qt||i instanceof Mt)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},Q.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Vt||i instanceof Bt)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Ot)for(var p=0;p<oe.members.length;p++)e.push(oe.members[p].name)}return e},Q.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof qt||i instanceof Mt||i instanceof Bt)for(var l=0,p=i.uniformNames;l<p.length;l+=1)e.push(p[l])}return e},Q.prototype.getPaintVertexBuffers=function(){return this._buffers},Q.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var p=this.binders[l];if(p instanceof qt||p instanceof Mt||p instanceof Bt)for(var d=0,_=p.uniformNames;d<_.length;d+=1){var E=_[d];if(t[E]){var T=p.getBinding(e,t[E],E);i.push({name:E,property:l,binding:T})}}}return i},Q.prototype.setUniforms=function(e,t,i,l){for(var p=0,d=t;p<d.length;p+=1){var _=d[p],E=_.name,T=_.property;this.binders[T].setUniform(_.binding,l,i.get(T),E)}},Q.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Ot){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Vt||i instanceof Bt)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Q.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Vt||i instanceof Bt||i instanceof Ot)&&i.upload(e)}this.updatePaintBuffers()},Q.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Vt||t instanceof Bt||t instanceof Ot)&&t.destroy()}};var Ie=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,p=e;l<p.length;l+=1){var d=p[l];this.programConfigurations[d.id]=new Q(d,t,i)}this.needsUpload=!1,this._featureMap=new ye,this._bufferOffset=0};function Wr(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Dr(e,t,i){var l={color:{source:$o,composite:su},number:{source:Dn,composite:$o}},p=function(d){return{"line-pattern":{source:La,composite:La},"fill-pattern":{source:La,composite:La},"fill-extrusion-pattern":{source:La,composite:La}}[d]}(e);return p&&p[i]||l[t][i]}Ie.prototype.populatePaintArrays=function(e,t,i,l,p,d){for(var _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(e,t,l,p,d);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ie.prototype.updatePaintArrays=function(e,t,i,l){for(var p=0,d=i;p<d.length;p+=1){var _=d[p];this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,t,_,l)||this.needsUpload}},Ie.prototype.get=function(e){return this.programConfigurations[e]},Ie.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Ie.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},lt("ConstantBinder",qt),lt("CrossFadedConstantBinder",Mt),lt("SourceExpressionBinder",Vt),lt("CrossFadedCompositeBinder",Ot),lt("CompositeExpressionBinder",Bt),lt("ProgramConfiguration",Q,{omit:["_buffers"]}),lt("ProgramConfigurationSet",Ie);var Pi=Math.pow(2,14)-1,yi=-Pi-1;function kr(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var p=i[l],d=0;d<p.length;d++){var _=p[d],E=Math.round(_.x*t),T=Math.round(_.y*t);_.x=Se(E,yi,Pi),_.y=Se(T,yi,Pi),(E<_.x||E>_.x+1||T<_.y||T>_.y+1)&&mt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function Jr(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?kr(e):[]}}function $i(e,t,i,l,p){e.emplaceBack(2*t+(l+1)/2,2*i+(p+1)/2)}var Ri=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Hn,this.indexArray=new Ra,this.segments=new W,this.programConfigurations=new Ie(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function en(e,t){for(var i=0;i<e.length;i++)if(ga(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(ga(e,t[l]))return!0;return!!ya(e,t)}function Zi(e,t,i){return!!ga(e,t)||!!ps(t,e,i)}function Ln(e,t){if(e.length===1)return nl(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],p=0;p<l.length;p++)if(ga(e,l[p]))return!0;for(var d=0;d<e.length;d++)if(nl(t,e[d]))return!0;for(var _=0;_<t.length;_++)if(ya(e,t[_]))return!0;return!1}function Bi(e,t,i){if(e.length>1){if(ya(e,t))return!0;for(var l=0;l<t.length;l++)if(ps(t[l],e,i))return!0}for(var p=0;p<e.length;p++)if(ps(e[p],t,i))return!0;return!1}function ya(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],p=e[i+1],d=0;d<t.length-1;d++)if(ra(l,p,t[d],t[d+1]))return!0;return!1}function ra(e,t,i,l){return yt(e,i,l)!==yt(t,i,l)&&yt(e,t,i)!==yt(e,t,l)}function ps(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var p=1;p<t.length;p++)if(fs(e,t[p-1],t[p])<l)return!0;return!1}function fs(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var p=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(p<0?t:p>1?i:i.sub(t)._mult(p)._add(t))}function nl(e,t){for(var i,l,p,d=!1,_=0;_<e.length;_++)for(var E=0,T=(i=e[_]).length-1;E<i.length;T=E++)(l=i[E]).y>t.y!=(p=i[T]).y>t.y&&t.x<(p.x-l.x)*(t.y-l.y)/(p.y-l.y)+l.x&&(d=!d);return d}function ga(e,t){for(var i=!1,l=0,p=e.length-1;l<e.length;p=l++){var d=e[l],_=e[p];d.y>t.y!=_.y>t.y&&t.x<(_.x-d.x)*(t.y-d.y)/(_.y-d.y)+d.x&&(i=!i)}return i}function Jn(e,t,i){var l=i[0],p=i[2];if(e.x<l.x&&t.x<l.x||e.x>p.x&&t.x>p.x||e.y<l.y&&t.y<l.y||e.y>p.y&&t.y>p.y)return!1;var d=yt(e,t,i[0]);return d!==yt(e,t,i[1])||d!==yt(e,t,i[2])||d!==yt(e,t,i[3])}function ro(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Gi(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function hn(e,t,i,l,p){if(!t[0]&&!t[1])return e;var d=B.convert(t)._mult(p);i==="viewport"&&d._rotate(-l);for(var _=[],E=0;E<e.length;E++)_.push(e[E].sub(d));return _}Ri.prototype.populate=function(e,t,i){var l=this.layers[0],p=[],d=null;l.type==="circle"&&(d=l.layout.get("circle-sort-key"));for(var _=0,E=e;_<E.length;_+=1){var T=E[_],z=T.feature,C=T.id,D=T.index,V=T.sourceLayerIndex,X=this.layers[0]._featureFilter.needGeometry,ee=Jr(z,X);if(this.layers[0]._featureFilter.filter(new er(this.zoom),ee,i)){var ne=d?d.evaluate(ee,{},i):void 0,pe={id:C,properties:z.properties,type:z.type,sourceLayerIndex:V,index:D,geometry:X?ee.geometry:kr(z),patterns:{},sortKey:ne};p.push(pe)}}d&&p.sort(function(nt,It){return nt.sortKey-It.sortKey});for(var ae=0,ge=p;ae<ge.length;ae+=1){var Ee=ge[ae],Ae=Ee.geometry,Le=Ee.index,Fe=Ee.sourceLayerIndex,$e=e[Le].feature;this.addFeature(Ee,Ae,Le,i),t.featureIndex.insert($e,Ae,Le,Fe,this.index)}},Ri.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ri.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ri.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ri.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,G),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ri.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ri.prototype.addFeature=function(e,t,i,l){for(var p=0,d=t;p<d.length;p+=1)for(var _=0,E=d[p];_<E.length;_+=1){var T=E[_],z=T.x,C=T.y;if(!(z<0||z>=8192||C<0||C>=8192)){var D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),V=D.vertexLength;$i(this.layoutVertexArray,z,C,-1,-1),$i(this.layoutVertexArray,z,C,1,-1),$i(this.layoutVertexArray,z,C,1,1),$i(this.layoutVertexArray,z,C,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+3,V+2),D.vertexLength+=4,D.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},lt("CircleBucket",Ri,{omit:["layers"]});var ds=new Qi({"circle-sort-key":new gt(Z.layout_circle["circle-sort-key"])}),ms={paint:new Qi({"circle-radius":new gt(Z.paint_circle["circle-radius"]),"circle-color":new gt(Z.paint_circle["circle-color"]),"circle-blur":new gt(Z.paint_circle["circle-blur"]),"circle-opacity":new gt(Z.paint_circle["circle-opacity"]),"circle-translate":new vt(Z.paint_circle["circle-translate"]),"circle-translate-anchor":new vt(Z.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new vt(Z.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new vt(Z.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new gt(Z.paint_circle["circle-stroke-width"]),"circle-stroke-color":new gt(Z.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new gt(Z.paint_circle["circle-stroke-opacity"])}),layout:ds},Tr=typeof Float32Array<"u"?Float32Array:Array;function xo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Rn(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3],E=t[4],T=t[5],z=t[6],C=t[7],D=t[8],V=t[9],X=t[10],ee=t[11],ne=t[12],pe=t[13],ae=t[14],ge=t[15],Ee=i[0],Ae=i[1],Le=i[2],Fe=i[3];return e[0]=Ee*l+Ae*E+Le*D+Fe*ne,e[1]=Ee*p+Ae*T+Le*V+Fe*pe,e[2]=Ee*d+Ae*z+Le*X+Fe*ae,e[3]=Ee*_+Ae*C+Le*ee+Fe*ge,e[4]=(Ee=i[4])*l+(Ae=i[5])*E+(Le=i[6])*D+(Fe=i[7])*ne,e[5]=Ee*p+Ae*T+Le*V+Fe*pe,e[6]=Ee*d+Ae*z+Le*X+Fe*ae,e[7]=Ee*_+Ae*C+Le*ee+Fe*ge,e[8]=(Ee=i[8])*l+(Ae=i[9])*E+(Le=i[10])*D+(Fe=i[11])*ne,e[9]=Ee*p+Ae*T+Le*V+Fe*pe,e[10]=Ee*d+Ae*z+Le*X+Fe*ae,e[11]=Ee*_+Ae*C+Le*ee+Fe*ge,e[12]=(Ee=i[12])*l+(Ae=i[13])*E+(Le=i[14])*D+(Fe=i[15])*ne,e[13]=Ee*p+Ae*T+Le*V+Fe*pe,e[14]=Ee*d+Ae*z+Le*X+Fe*ae,e[15]=Ee*_+Ae*C+Le*ee+Fe*ge,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Cs,lc=Rn;function Cl(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3];return e[0]=i[0]*l+i[4]*p+i[8]*d+i[12]*_,e[1]=i[1]*l+i[5]*p+i[9]*d+i[13]*_,e[2]=i[2]*l+i[6]*p+i[10]*d+i[14]*_,e[3]=i[3]*l+i[7]*p+i[11]*d+i[15]*_,e}Cs=new Tr(3),Tr!=Float32Array&&(Cs[0]=0,Cs[1]=0,Cs[2]=0),function(){var e=new Tr(4);Tr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var _a=(function(){var e=new Tr(2);Tr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,ms)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ri(i)},t.prototype.queryRadius=function(i){var l=i;return ro("circle-radius",this,l)+ro("circle-stroke-width",this,l)+Gi(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,E,T,z){for(var C=hn(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),E.angle,T),D=this.paint.get("circle-radius").evaluate(l,p)+this.paint.get("circle-stroke-width").evaluate(l,p),V=this.paint.get("circle-pitch-alignment")==="map",X=V?C:function($e,nt){return $e.map(function(It){return ol(It,nt)})}(C,z),ee=V?D*T:D,ne=0,pe=d;ne<pe.length;ne+=1)for(var ae=0,ge=pe[ne];ae<ge.length;ae+=1){var Ee=ge[ae],Ae=V?Ee:ol(Ee,z),Le=ee,Fe=Cl([],[Ee.x,Ee.y,0,1],z);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Le*=Fe[3]/E.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Le*=E.cameraToCenterDistance/Fe[3]),Zi(X,Ae,Le))return!0}return!1},t}(Xn));function ol(e,t){var i=Cl([],[e.x,e.y,0,1],t);return new B(i[0]/i[3],i[1]/i[3])}var lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ri);function al(e,t,i,l){var p=t.width,d=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==p*d*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(p*d*i);return e.width=p,e.height=d,e.data=l,e}function Ml(e,t,i){var l=t.width,p=t.height;if(l!==e.width||p!==e.height){var d=al({},{width:l,height:p},i);Bu(e,d,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,p)},i),e.width=l,e.height=p,e.data=d.data}}function Bu(e,t,i,l,p,d){if(p.width===0||p.height===0)return t;if(p.width>e.width||p.height>e.height||i.x>e.width-p.width||i.y>e.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>t.width||p.height>t.height||l.x>t.width-p.width||l.y>t.height-p.height)throw new RangeError("out of range destination coordinates for image copy");for(var _=e.data,E=t.data,T=0;T<p.height;T++)for(var z=((i.y+T)*e.width+i.x)*d,C=((l.y+T)*t.width+l.x)*d,D=0;D<p.width*d;D++)E[C+D]=_[z+D];return t}lt("HeatmapBucket",lu,{omit:["layers"]});var sl=function(e,t){al(this,e,1,t)};sl.prototype.resize=function(e){Ml(this,e,1)},sl.prototype.clone=function(){return new sl({width:this.width,height:this.height},new Uint8Array(this.data))},sl.copy=function(e,t,i,l,p){Bu(e,t,i,l,p,1)};var io=function(e,t){al(this,e,4,t)};io.prototype.resize=function(e){Ml(this,e,4)},io.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},io.prototype.clone=function(){return new io({width:this.width,height:this.height},new Uint8Array(this.data))},io.copy=function(e,t,i,l,p){Bu(e,t,i,l,p,4)},lt("AlphaImage",sl),lt("RGBAImage",io);var ep={paint:new Qi({"heatmap-radius":new gt(Z.paint_heatmap["heatmap-radius"]),"heatmap-weight":new gt(Z.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new vt(Z.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Cn(Z.paint_heatmap["heatmap-color"]),"heatmap-opacity":new vt(Z.paint_heatmap["heatmap-opacity"])})};function ys(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,p=e.image||new io({width:i,height:l}),d=function(ee,ne,pe){t[e.evaluationKey]=pe;var ae=e.expression.evaluate(t);p.data[ee+ne+0]=Math.floor(255*ae.r/ae.a),p.data[ee+ne+1]=Math.floor(255*ae.g/ae.a),p.data[ee+ne+2]=Math.floor(255*ae.b/ae.a),p.data[ee+ne+3]=Math.floor(255*ae.a)};if(e.clips)for(var _=0,E=0;_<l;++_,E+=4*i)for(var T=0,z=0;T<i;T++,z+=4){var C=T/(i-1),D=e.clips[_];d(E,z,D.start*(1-C)+D.end*C)}else for(var V=0,X=0;V<i;V++,X+=4)d(0,X,V/(i-1));return p}var tp=function(e){function t(i){e.call(this,i,ep),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new lu(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=ys({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Xn),Zc={paint:new Qi({"hillshade-illumination-direction":new vt(Z.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new vt(Z.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new vt(Z.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new vt(Z.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new vt(Z.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new vt(Z.paint_hillshade["hillshade-accent-color"])})},gf=function(e){function t(i){e.call(this,i,Zc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Xn),rp=pi([{name:"a_pos",components:2,type:"Int16"}],4).members,Ou=Fu,ip=Fu;function Fu(e,t,i){i=i||2;var l,p,d,_,E,T,z,C=t&&t.length,D=C?t[0]*i:e.length,V=Gc(e,0,D,i,!0),X=[];if(!V||V.next===V.prev)return X;if(C&&(V=function(ne,pe,ae,ge){var Ee,Ae,Le,Fe=[];for(Ee=0,Ae=pe.length;Ee<Ae;Ee++)(Le=Gc(ne,pe[Ee]*ge,Ee<Ae-1?pe[Ee+1]*ge:ne.length,ge,!1))===Le.next&&(Le.steiner=!0),Fe.push(ll(Le));for(Fe.sort(op),Ee=0;Ee<Fe.length;Ee++)Xc(Fe[Ee],ae),ae=gs(ae,ae.next);return ae}(e,t,V,i)),e.length>80*i){l=d=e[0],p=_=e[1];for(var ee=i;ee<D;ee+=i)(E=e[ee])<l&&(l=E),(T=e[ee+1])<p&&(p=T),E>d&&(d=E),T>_&&(_=T);z=(z=Math.max(d-l,_-p))!==0?1/z:0}return uu(V,X,i,l,p,z),X}function Gc(e,t,i,l,p){var d,_;if(p===ul(e,t,i,l)>0)for(d=t;d<i;d+=l)_=Yc(d,e[d],e[d+1],_);else for(d=i-l;d>=t;d-=l)_=Yc(d,e[d],e[d+1],_);return _&&Nu(_,_.next)&&(Ll(_),_=_.next),_}function gs(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!Nu(l,l.next)&&Oi(l.prev,l,l.next)!==0)l=l.next;else{if(Ll(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function uu(e,t,i,l,p,d,_){if(e){!_&&d&&function(C,D,V,X){var ee=C;do ee.z===null&&(ee.z=uc(ee.x,ee.y,D,V,X)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next;while(ee!==C);ee.prevZ.nextZ=null,ee.prevZ=null,function(ne){var pe,ae,ge,Ee,Ae,Le,Fe,$e,nt=1;do{for(ae=ne,ne=null,Ae=null,Le=0;ae;){for(Le++,ge=ae,Fe=0,pe=0;pe<nt&&(Fe++,ge=ge.nextZ);pe++);for($e=nt;Fe>0||$e>0&&ge;)Fe!==0&&($e===0||!ge||ae.z<=ge.z)?(Ee=ae,ae=ae.nextZ,Fe--):(Ee=ge,ge=ge.nextZ,$e--),Ae?Ae.nextZ=Ee:ne=Ee,Ee.prevZ=Ae,Ae=Ee;ae=ge}Ae.nextZ=null,nt*=2}while(Le>1)}(ee)}(e,l,p,d);for(var E,T,z=e;e.prev!==e.next;)if(E=e.prev,T=e.next,d?np(e,l,p,d):cu(e))t.push(E.i/i),t.push(e.i/i),t.push(T.i/i),Ll(e),e=T.next,z=T.next;else if((e=T)===z){_?_===1?uu(e=Kc(gs(e),t,i),t,i,l,p,d,2):_===2&&_f(e,t,i,l,p,d):uu(gs(e),t,i,l,p,d,1);break}}}function cu(e){var t=e.prev,i=e,l=e.next;if(Oi(t,i,l)>=0)return!1;for(var p=e.next.next;p!==e.prev;){if(Dl(t.x,t.y,i.x,i.y,l.x,l.y,p.x,p.y)&&Oi(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function np(e,t,i,l){var p=e.prev,d=e,_=e.next;if(Oi(p,d,_)>=0)return!1;for(var E=p.x>d.x?p.x>_.x?p.x:_.x:d.x>_.x?d.x:_.x,T=p.y>d.y?p.y>_.y?p.y:_.y:d.y>_.y?d.y:_.y,z=uc(p.x<d.x?p.x<_.x?p.x:_.x:d.x<_.x?d.x:_.x,p.y<d.y?p.y<_.y?p.y:_.y:d.y<_.y?d.y:_.y,t,i,l),C=uc(E,T,t,i,l),D=e.prevZ,V=e.nextZ;D&&D.z>=z&&V&&V.z<=C;){if(D!==e.prev&&D!==e.next&&Dl(p.x,p.y,d.x,d.y,_.x,_.y,D.x,D.y)&&Oi(D.prev,D,D.next)>=0||(D=D.prevZ,V!==e.prev&&V!==e.next&&Dl(p.x,p.y,d.x,d.y,_.x,_.y,V.x,V.y)&&Oi(V.prev,V,V.next)>=0))return!1;V=V.nextZ}for(;D&&D.z>=z;){if(D!==e.prev&&D!==e.next&&Dl(p.x,p.y,d.x,d.y,_.x,_.y,D.x,D.y)&&Oi(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;V&&V.z<=C;){if(V!==e.prev&&V!==e.next&&Dl(p.x,p.y,d.x,d.y,_.x,_.y,V.x,V.y)&&Oi(V.prev,V,V.next)>=0)return!1;V=V.nextZ}return!0}function Kc(e,t,i){var l=e;do{var p=l.prev,d=l.next.next;!Nu(p,d)&&Wc(p,l,l.next,d)&&hu(p,d)&&hu(d,p)&&(t.push(p.i/i),t.push(l.i/i),t.push(d.i/i),Ll(l),Ll(l.next),l=e=d),l=l.next}while(l!==e);return gs(l)}function _f(e,t,i,l,p,d){var _=e;do{for(var E=_.next.next;E!==_.prev;){if(_.i!==E.i&&Hc(_,E)){var T=Jc(_,E);return _=gs(_,_.next),T=gs(T,T.next),uu(_,t,i,l,p,d),void uu(T,t,i,l,p,d)}E=E.next}_=_.next}while(_!==e)}function op(e,t){return e.x-t.x}function Xc(e,t){if(t=function(l,p){var d,_=p,E=l.x,T=l.y,z=-1/0;do{if(T<=_.y&&T>=_.next.y&&_.next.y!==_.y){var C=_.x+(T-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(C<=E&&C>z){if(z=C,C===E){if(T===_.y)return _;if(T===_.next.y)return _.next}d=_.x<_.next.x?_:_.next}}_=_.next}while(_!==p);if(!d)return null;if(E===z)return d;var D,V=d,X=d.x,ee=d.y,ne=1/0;_=d;do E>=_.x&&_.x>=X&&E!==_.x&&Dl(T<ee?E:z,T,X,ee,T<ee?z:E,T,_.x,_.y)&&(D=Math.abs(T-_.y)/(E-_.x),hu(_,l)&&(D<ne||D===ne&&(_.x>d.x||_.x===d.x&&ap(d,_)))&&(d=_,ne=D)),_=_.next;while(_!==V);return d}(e,t)){var i=Jc(t,e);gs(t,t.next),gs(i,i.next)}}function ap(e,t){return Oi(e.prev,e,t.prev)<0&&Oi(t.next,e,e.next)<0}function uc(e,t,i,l,p){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*p)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*p)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ll(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function Dl(e,t,i,l,p,d,_,E){return(p-_)*(t-E)-(e-_)*(d-E)>=0&&(e-_)*(l-E)-(i-_)*(t-E)>=0&&(i-_)*(d-E)-(p-_)*(l-E)>=0}function Hc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var p=i;do{if(p.i!==i.i&&p.next.i!==i.i&&p.i!==l.i&&p.next.i!==l.i&&Wc(p,p.next,i,l))return!0;p=p.next}while(p!==i);return!1}(e,t)&&(hu(e,t)&&hu(t,e)&&function(i,l){var p=i,d=!1,_=(i.x+l.x)/2,E=(i.y+l.y)/2;do p.y>E!=p.next.y>E&&p.next.y!==p.y&&_<(p.next.x-p.x)*(E-p.y)/(p.next.y-p.y)+p.x&&(d=!d),p=p.next;while(p!==i);return d}(e,t)&&(Oi(e.prev,e,t.prev)||Oi(e,t.prev,t))||Nu(e,t)&&Oi(e.prev,e,e.next)>0&&Oi(t.prev,t,t.next)>0)}function Oi(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Nu(e,t){return e.x===t.x&&e.y===t.y}function Wc(e,t,i,l){var p=Uu(Oi(e,t,i)),d=Uu(Oi(e,t,l)),_=Uu(Oi(i,l,e)),E=Uu(Oi(i,l,t));return p!==d&&_!==E||!(p!==0||!Vu(e,i,t))||!(d!==0||!Vu(e,l,t))||!(_!==0||!Vu(i,e,l))||!(E!==0||!Vu(i,t,l))}function Vu(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Uu(e){return e>0?1:e<0?-1:0}function hu(e,t){return Oi(e.prev,e,e.next)<0?Oi(e,t,e.next)>=0&&Oi(e,e.prev,t)>=0:Oi(e,t,e.prev)<0||Oi(e,e.next,t)<0}function Jc(e,t){var i=new ju(e.i,e.x,e.y),l=new ju(t.i,t.x,t.y),p=e.next,d=t.prev;return e.next=t,t.prev=e,i.next=p,p.prev=i,l.next=i,i.prev=l,d.next=l,l.prev=d,l}function Yc(e,t,i,l){var p=new ju(e,t,i);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function Ll(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ju(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ul(e,t,i,l){for(var p=0,d=t,_=i-l;d<i;d+=l)p+=(e[_]-e[d])*(e[d+1]+e[_+1]),_=d;return p}function pu(e,t,i,l,p){(function d(_,E,T,z,C){for(;z>T;){if(z-T>600){var D=z-T+1,V=E-T+1,X=Math.log(D),ee=.5*Math.exp(2*X/3),ne=.5*Math.sqrt(X*ee*(D-ee)/D)*(V-D/2<0?-1:1);d(_,E,Math.max(T,Math.floor(E-V*ee/D+ne)),Math.min(z,Math.floor(E+(D-V)*ee/D+ne)),C)}var pe=_[E],ae=T,ge=z;for(fu(_,T,E),C(_[z],pe)>0&&fu(_,T,z);ae<ge;){for(fu(_,ae,ge),ae++,ge--;C(_[ae],pe)<0;)ae++;for(;C(_[ge],pe)>0;)ge--}C(_[T],pe)===0?fu(_,T,ge):fu(_,++ge,z),ge<=E&&(T=ge+1),E<=ge&&(z=ge-1)}})(e,t,i||0,l||e.length-1,p||Qc)}function fu(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function Qc(e,t){return e<t?-1:e>t?1:0}function $c(e,t){var i=e.length;if(i<=1)return[e];for(var l,p,d=[],_=0;_<i;_++){var E=De(e[_]);E!==0&&(e[_].area=Math.abs(E),p===void 0&&(p=E<0),p===E<0?(l&&d.push(l),l=[e[_]]):l.push(e[_]))}if(l&&d.push(l),t>1)for(var T=0;T<d.length;T++)d[T].length<=t||(pu(d[T],t,1,d[T].length-1,sp),d[T]=d[T].slice(0,t));return d}function sp(e,t){return t.area-e.area}function qu(e,t,i){for(var l=i.patternDependencies,p=!1,d=0,_=t;d<_.length;d+=1){var E=_[d].paint.get(e+"-pattern");E.isConstant()||(p=!0);var T=E.constantOr(null);T&&(p=!0,l[T.to]=!0,l[T.from]=!0)}return p}function cc(e,t,i,l,p){for(var d=p.patternDependencies,_=0,E=t;_<E.length;_+=1){var T=E[_],z=T.paint.get(e+"-pattern").value;if(z.kind!=="constant"){var C=z.evaluate({zoom:l-1},i,{},p.availableImages),D=z.evaluate({zoom:l},i,{},p.availableImages),V=z.evaluate({zoom:l+1},i,{},p.availableImages);D=D&&D.name?D.name:D,V=V&&V.name?V.name:V,d[C=C&&C.name?C.name:C]=!0,d[D]=!0,d[V]=!0,i.patterns[T.id]={min:C,mid:D,max:V}}}return i}Fu.deviation=function(e,t,i,l){var p=t&&t.length,d=Math.abs(ul(e,0,p?t[0]*i:e.length,i));if(p)for(var _=0,E=t.length;_<E;_++)d-=Math.abs(ul(e,t[_]*i,_<E-1?t[_+1]*i:e.length,i));var T=0;for(_=0;_<l.length;_+=3){var z=l[_]*i,C=l[_+1]*i,D=l[_+2]*i;T+=Math.abs((e[z]-e[D])*(e[C+1]-e[z+1])-(e[z]-e[C])*(e[D+1]-e[z+1]))}return d===0&&T===0?0:Math.abs((T-d)/d)},Fu.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,p=0;p<e.length;p++){for(var d=0;d<e[p].length;d++)for(var _=0;_<t;_++)i.vertices.push(e[p][d][_]);p>0&&i.holes.push(l+=e[p-1].length)}return i},Ou.default=ip;var Ba=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Hn,this.indexArray=new Ra,this.indexArray2=new Ks,this.programConfigurations=new Ie(e.layers,e.zoom),this.segments=new W,this.segments2=new W,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ba.prototype.populate=function(e,t,i){this.hasPattern=qu("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),p=[],d=0,_=e;d<_.length;d+=1){var E=_[d],T=E.feature,z=E.id,C=E.index,D=E.sourceLayerIndex,V=this.layers[0]._featureFilter.needGeometry,X=Jr(T,V);if(this.layers[0]._featureFilter.filter(new er(this.zoom),X,i)){var ee=l?l.evaluate(X,{},i,t.availableImages):void 0,ne={id:z,properties:T.properties,type:T.type,sourceLayerIndex:D,index:C,geometry:V?X.geometry:kr(T),patterns:{},sortKey:ee};p.push(ne)}}l&&p.sort(function($e,nt){return $e.sortKey-nt.sortKey});for(var pe=0,ae=p;pe<ae.length;pe+=1){var ge=ae[pe],Ee=ge.geometry,Ae=ge.index,Le=ge.sourceLayerIndex;if(this.hasPattern){var Fe=cc("fill",this.layers,ge,this.zoom,t);this.patternFeatures.push(Fe)}else this.addFeature(ge,Ee,Ae,i,{});t.featureIndex.insert(e[Ae].feature,Ee,Ae,Le,this.index)}},Ba.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ba.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},Ba.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ba.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ba.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,rp),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ba.prototype.addFeature=function(e,t,i,l,p){for(var d=0,_=$c(t,500);d<_.length;d+=1){for(var E=_[d],T=0,z=0,C=E;z<C.length;z+=1)T+=C[z].length;for(var D=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),V=D.vertexLength,X=[],ee=[],ne=0,pe=E;ne<pe.length;ne+=1){var ae=pe[ne];if(ae.length!==0){ae!==E[0]&&ee.push(X.length/2);var ge=this.segments2.prepareSegment(ae.length,this.layoutVertexArray,this.indexArray2),Ee=ge.vertexLength;this.layoutVertexArray.emplaceBack(ae[0].x,ae[0].y),this.indexArray2.emplaceBack(Ee+ae.length-1,Ee),X.push(ae[0].x),X.push(ae[0].y);for(var Ae=1;Ae<ae.length;Ae++)this.layoutVertexArray.emplaceBack(ae[Ae].x,ae[Ae].y),this.indexArray2.emplaceBack(Ee+Ae-1,Ee+Ae),X.push(ae[Ae].x),X.push(ae[Ae].y);ge.vertexLength+=ae.length,ge.primitiveLength+=ae.length}}for(var Le=Ou(X,ee),Fe=0;Fe<Le.length;Fe+=3)this.indexArray.emplaceBack(V+Le[Fe],V+Le[Fe+1],V+Le[Fe+2]);D.vertexLength+=T,D.primitiveLength+=Le.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},lt("FillBucket",Ba,{omit:["layers","patternFeatures"]});var du=new Qi({"fill-sort-key":new gt(Z.layout_fill["fill-sort-key"])}),lp={paint:new Qi({"fill-antialias":new vt(Z.paint_fill["fill-antialias"]),"fill-opacity":new gt(Z.paint_fill["fill-opacity"]),"fill-color":new gt(Z.paint_fill["fill-color"]),"fill-outline-color":new gt(Z.paint_fill["fill-outline-color"]),"fill-translate":new vt(Z.paint_fill["fill-translate"]),"fill-translate-anchor":new vt(Z.paint_fill["fill-translate-anchor"]),"fill-pattern":new el(Z.paint_fill["fill-pattern"])}),layout:du},eh=function(e){function t(i){e.call(this,i,lp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Ba(i)},t.prototype.queryRadius=function(){return Gi(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,E,T){return Ln(hn(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),E.angle,T),d)},t.prototype.isTileClipped=function(){return!0},t}(Xn),vf=pi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,th=cl;function cl(e,t,i,l,p){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=p,e.readFields(up,this,t)}function up(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,p){for(var d=l.readVarint()+l.pos;l.pos<d;){var _=p._keys[l.readVarint()],E=p._values[l.readVarint()];p.properties[_]=E}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function cp(e){for(var t,i,l=0,p=0,d=e.length,_=d-1;p<d;_=p++)l+=((i=e[_]).x-(t=e[p]).x)*(t.y+i.y);return l}cl.types=["Unknown","Point","LineString","Polygon"],cl.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,p=0,d=0,_=0,E=[];e.pos<i;){if(p<=0){var T=e.readVarint();l=7&T,p=T>>3}if(p--,l===1||l===2)d+=e.readSVarint(),_+=e.readSVarint(),l===1&&(t&&E.push(t),t=[]),t.push(new B(d,_));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&E.push(t),E},cl.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,p=0,d=0,_=1/0,E=-1/0,T=1/0,z=-1/0;e.pos<t;){if(l<=0){var C=e.readVarint();i=7&C,l=C>>3}if(l--,i===1||i===2)(p+=e.readSVarint())<_&&(_=p),p>E&&(E=p),(d+=e.readSVarint())<T&&(T=d),d>z&&(z=d);else if(i!==7)throw new Error("unknown command "+i)}return[_,T,E,z]},cl.prototype.toGeoJSON=function(e,t,i){var l,p,d=this.extent*Math.pow(2,i),_=this.extent*e,E=this.extent*t,T=this.loadGeometry(),z=cl.types[this.type];function C(X){for(var ee=0;ee<X.length;ee++){var ne=X[ee];X[ee]=[360*(ne.x+_)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*(ne.y+E)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(l=0;l<T.length;l++)D[l]=T[l][0];C(T=D);break;case 2:for(l=0;l<T.length;l++)C(T[l]);break;case 3:for(T=function(X){var ee=X.length;if(ee<=1)return[X];for(var ne,pe,ae=[],ge=0;ge<ee;ge++){var Ee=cp(X[ge]);Ee!==0&&(pe===void 0&&(pe=Ee<0),pe===Ee<0?(ne&&ae.push(ne),ne=[X[ge]]):ne.push(X[ge]))}return ne&&ae.push(ne),ae}(T),l=0;l<T.length;l++)for(p=0;p<T[l].length;p++)C(T[l][p])}T.length===1?T=T[0]:z="Multi"+z;var V={type:"Feature",geometry:{type:z,coordinates:T},properties:this.properties};return"id"in this&&(V.id=this.id),V};var Rl=rh;function rh(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(ih,this,t),this.length=this._features.length}function ih(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var p=null,d=l.readVarint()+l.pos;l.pos<d;){var _=l.readVarint()>>3;p=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return p}(i))}function bf(e,t,i){if(e===3){var l=new Rl(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}rh.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new th(this._pbf,t,this.extent,this._keys,this._values)};var Bl={VectorTile:function(e,t){this.layers=e.readFields(bf,{},t)},VectorTileFeature:th,VectorTileLayer:Rl},nh=Bl.VectorTileFeature.types,hc=Math.pow(2,13);function mu(e,t,i,l,p,d,_,E){e.emplaceBack(t,i,2*Math.floor(l*hc)+_,p*hc*2,d*hc*2,Math.round(E))}var Oa=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Mn,this.indexArray=new Ra,this.programConfigurations=new Ie(e.layers,e.zoom),this.segments=new W,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function oh(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Oa.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=qu("fill-extrusion",this.layers,t);for(var l=0,p=e;l<p.length;l+=1){var d=p[l],_=d.feature,E=d.id,T=d.index,z=d.sourceLayerIndex,C=this.layers[0]._featureFilter.needGeometry,D=Jr(_,C);if(this.layers[0]._featureFilter.filter(new er(this.zoom),D,i)){var V={id:E,sourceLayerIndex:z,index:T,geometry:C?D.geometry:kr(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(cc("fill-extrusion",this.layers,V,this.zoom,t)):this.addFeature(V,V.geometry,T,i,{}),t.featureIndex.insert(_,V.geometry,T,z,this.index,!0)}}},Oa.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.features;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},Oa.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Oa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Oa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Oa.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,vf),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Oa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Oa.prototype.addFeature=function(e,t,i,l,p){for(var d=0,_=$c(t,500);d<_.length;d+=1){for(var E=_[d],T=0,z=0,C=E;z<C.length;z+=1)T+=C[z].length;for(var D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),V=0,X=E;V<X.length;V+=1){var ee=X[V];if(ee.length!==0&&!((cr=ee).every(function(Yt){return Yt.x<0})||cr.every(function(Yt){return Yt.x>8192})||cr.every(function(Yt){return Yt.y<0})||cr.every(function(Yt){return Yt.y>8192})))for(var ne=0,pe=0;pe<ee.length;pe++){var ae=ee[pe];if(pe>=1){var ge=ee[pe-1];if(!oh(ae,ge)){D.vertexLength+4>W.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Ee=ae.sub(ge)._perp()._unit(),Ae=ge.dist(ae);ne+Ae>32768&&(ne=0),mu(this.layoutVertexArray,ae.x,ae.y,Ee.x,Ee.y,0,0,ne),mu(this.layoutVertexArray,ae.x,ae.y,Ee.x,Ee.y,0,1,ne),mu(this.layoutVertexArray,ge.x,ge.y,Ee.x,Ee.y,0,0,ne+=Ae),mu(this.layoutVertexArray,ge.x,ge.y,Ee.x,Ee.y,0,1,ne);var Le=D.vertexLength;this.indexArray.emplaceBack(Le,Le+2,Le+1),this.indexArray.emplaceBack(Le+1,Le+2,Le+3),D.vertexLength+=4,D.primitiveLength+=2}}}}if(D.vertexLength+T>W.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),nh[e.type]==="Polygon"){for(var Fe=[],$e=[],nt=D.vertexLength,It=0,ct=E;It<ct.length;It+=1){var Pt=ct[It];if(Pt.length!==0){Pt!==E[0]&&$e.push(Fe.length/2);for(var pt=0;pt<Pt.length;pt++){var rr=Pt[pt];mu(this.layoutVertexArray,rr.x,rr.y,0,0,1,1,0),Fe.push(rr.x),Fe.push(rr.y)}}}for(var Ut=Ou(Fe,$e),_t=0;_t<Ut.length;_t+=3)this.indexArray.emplaceBack(nt+Ut[_t],nt+Ut[_t+2],nt+Ut[_t+1]);D.primitiveLength+=Ut.length/3,D.vertexLength+=T}}var cr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},lt("FillExtrusionBucket",Oa,{omit:["layers","features"]});var ah={paint:new Qi({"fill-extrusion-opacity":new vt(Z["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new gt(Z["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new vt(Z["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new vt(Z["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new el(Z["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new gt(Z["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new gt(Z["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new vt(Z["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},yu=function(e){function t(i){e.call(this,i,ah)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Oa(i)},t.prototype.queryRadius=function(){return Gi(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,E,T,z){var C=hn(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),E.angle,T),D=this.paint.get("fill-extrusion-height").evaluate(l,p),V=this.paint.get("fill-extrusion-base").evaluate(l,p),X=function(ne,pe,ae,ge){for(var Ee=[],Ae=0,Le=ne;Ae<Le.length;Ae+=1){var Fe=Le[Ae],$e=[Fe.x,Fe.y,0,1];Cl($e,$e,pe),Ee.push(new B($e[0]/$e[3],$e[1]/$e[3]))}return Ee}(C,z),ee=function(ne,pe,ae,ge){for(var Ee=[],Ae=[],Le=ge[8]*pe,Fe=ge[9]*pe,$e=ge[10]*pe,nt=ge[11]*pe,It=ge[8]*ae,ct=ge[9]*ae,Pt=ge[10]*ae,pt=ge[11]*ae,rr=0,Ut=ne;rr<Ut.length;rr+=1){for(var _t=[],cr=[],Yt=0,wr=Ut[rr];Yt<wr.length;Yt+=1){var Ct=wr[Yt],Pr=Ct.x,_i=Ct.y,Fi=ge[0]*Pr+ge[4]*_i+ge[12],Ci=ge[1]*Pr+ge[5]*_i+ge[13],vi=ge[2]*Pr+ge[6]*_i+ge[14],Ni=ge[3]*Pr+ge[7]*_i+ge[15],xn=vi+$e,wn=Ni+nt,wo=Fi+It,On=Ci+ct,So=vi+Pt,Ki=Ni+pt,Fn=new B((Fi+Le)/wn,(Ci+Fe)/wn);Fn.z=xn/wn,_t.push(Fn);var gr=new B(wo/Ki,On/Ki);gr.z=So/Ki,cr.push(gr)}Ee.push(_t),Ae.push(cr)}return[Ee,Ae]}(d,V,D,z);return function(ne,pe,ae){var ge=1/0;Ln(ae,pe)&&(ge=sh(ae,pe[0]));for(var Ee=0;Ee<pe.length;Ee++)for(var Ae=pe[Ee],Le=ne[Ee],Fe=0;Fe<Ae.length-1;Fe++){var $e=Ae[Fe],nt=[$e,Ae[Fe+1],Le[Fe+1],Le[Fe],$e];en(ae,nt)&&(ge=Math.min(ge,sh(ae,nt)))}return ge!==1/0&&ge}(ee[0],ee[1],X)},t}(Xn);function Ms(e,t){return e.x*t.x+e.y*t.y}function sh(e,t){if(e.length===1){for(var i,l=0,p=t[l++];!i||p.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var d=t[l],_=e[0],E=i.sub(p),T=d.sub(p),z=_.sub(p),C=Ms(E,E),D=Ms(E,T),V=Ms(T,T),X=Ms(z,E),ee=Ms(z,T),ne=C*V-D*D,pe=(V*X-D*ee)/ne,ae=(C*ee-D*X)/ne,ge=p.z*(1-pe-ae)+i.z*pe+d.z*ae;if(isFinite(ge))return ge}return 1/0}for(var Ee=1/0,Ae=0,Le=t;Ae<Le.length;Ae+=1)Ee=Math.min(Ee,Le[Ae].z);return Ee}var lh=pi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,xf=pi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,hp=Bl.VectorTileFeature.types,uh=Math.cos(Math.PI/180*37.5),ch=Math.pow(2,14)/.5,Yn=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new Wn,this.layoutVertexArray2=new $o,this.indexArray=new Ra,this.programConfigurations=new Ie(e.layers,e.zoom),this.segments=new W,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Yn.prototype.populate=function(e,t,i){this.hasPattern=qu("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),p=[],d=0,_=e;d<_.length;d+=1){var E=_[d],T=E.feature,z=E.id,C=E.index,D=E.sourceLayerIndex,V=this.layers[0]._featureFilter.needGeometry,X=Jr(T,V);if(this.layers[0]._featureFilter.filter(new er(this.zoom),X,i)){var ee=l?l.evaluate(X,{},i):void 0,ne={id:z,properties:T.properties,type:T.type,sourceLayerIndex:D,index:C,geometry:V?X.geometry:kr(T),patterns:{},sortKey:ee};p.push(ne)}}l&&p.sort(function($e,nt){return $e.sortKey-nt.sortKey});for(var pe=0,ae=p;pe<ae.length;pe+=1){var ge=ae[pe],Ee=ge.geometry,Ae=ge.index,Le=ge.sourceLayerIndex;if(this.hasPattern){var Fe=cc("line",this.layers,ge,this.zoom,t);this.patternFeatures.push(Fe)}else this.addFeature(ge,Ee,Ae,i,{});t.featureIndex.insert(e[Ae].feature,Ee,Ae,Le,this.index)}},Yn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Yn.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},Yn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Yn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Yn.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,xf)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,lh),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Yn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Yn.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Yn.prototype.addFeature=function(e,t,i,l,p){var d=this.layers[0].layout,_=d.get("line-join").evaluate(e,{}),E=d.get("line-cap"),T=d.get("line-miter-limit"),z=d.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var C=0,D=t;C<D.length;C+=1)this.addLine(D[C],e,_,E,T,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},Yn.prototype.addLine=function(e,t,i,l,p,d){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var _=0;_<e.length-1;_++)this.totalDistance+=e[_].dist(e[_+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var E=hp[t.type]==="Polygon",T=e.length;T>=2&&e[T-1].equals(e[T-2]);)T--;for(var z=0;z<T-1&&e[z].equals(e[z+1]);)z++;if(!(T<(E?3:2))){i==="bevel"&&(p=1.05);var C,D=this.overscaling<=16?122880/(512*this.overscaling):0,V=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray),X=void 0,ee=void 0,ne=void 0,pe=void 0;this.e1=this.e2=-1,E&&(pe=e[z].sub(C=e[T-2])._unit()._perp());for(var ae=z;ae<T;ae++)if(!(ee=ae===T-1?E?e[z+1]:void 0:e[ae+1])||!e[ae].equals(ee)){pe&&(ne=pe),C&&(X=C),C=e[ae],pe=ee?ee.sub(C)._unit()._perp():ne;var ge=(ne=ne||pe).add(pe);ge.x===0&&ge.y===0||ge._unit();var Ee=ne.x*pe.x+ne.y*pe.y,Ae=ge.x*pe.x+ge.y*pe.y,Le=Ae!==0?1/Ae:1/0,Fe=2*Math.sqrt(2-2*Ae),$e=Ae<uh&&X&&ee,nt=ne.x*pe.y-ne.y*pe.x>0;if($e&&ae>z){var It=C.dist(X);if(It>2*D){var ct=C.sub(C.sub(X)._mult(D/It)._round());this.updateDistance(X,ct),this.addCurrentVertex(ct,ne,0,0,V),X=ct}}var Pt=X&&ee,pt=Pt?i:E?"butt":l;if(Pt&&pt==="round"&&(Le<d?pt="miter":Le<=2&&(pt="fakeround")),pt==="miter"&&Le>p&&(pt="bevel"),pt==="bevel"&&(Le>2&&(pt="flipbevel"),Le<p&&(pt="miter")),X&&this.updateDistance(X,C),pt==="miter")ge._mult(Le),this.addCurrentVertex(C,ge,0,0,V);else if(pt==="flipbevel"){if(Le>100)ge=pe.mult(-1);else{var rr=Le*ne.add(pe).mag()/ne.sub(pe).mag();ge._perp()._mult(rr*(nt?-1:1))}this.addCurrentVertex(C,ge,0,0,V),this.addCurrentVertex(C,ge.mult(-1),0,0,V)}else if(pt==="bevel"||pt==="fakeround"){var Ut=-Math.sqrt(Le*Le-1),_t=nt?Ut:0,cr=nt?0:Ut;if(X&&this.addCurrentVertex(C,ne,_t,cr,V),pt==="fakeround")for(var Yt=Math.round(180*Fe/Math.PI/20),wr=1;wr<Yt;wr++){var Ct=wr/Yt;if(Ct!==.5){var Pr=Ct-.5;Ct+=Ct*Pr*(Ct-1)*((1.0904+Ee*(Ee*(3.55645-1.43519*Ee)-3.2452))*Pr*Pr+(.848013+Ee*(.215638*Ee-1.06021)))}var _i=pe.sub(ne)._mult(Ct)._add(ne)._unit()._mult(nt?-1:1);this.addHalfVertex(C,_i.x,_i.y,!1,nt,0,V)}ee&&this.addCurrentVertex(C,pe,-_t,-cr,V)}else if(pt==="butt")this.addCurrentVertex(C,ge,0,0,V);else if(pt==="square"){var Fi=X?1:-1;this.addCurrentVertex(C,ge,Fi,Fi,V)}else pt==="round"&&(X&&(this.addCurrentVertex(C,ne,0,0,V),this.addCurrentVertex(C,ne,1,1,V,!0)),ee&&(this.addCurrentVertex(C,pe,-1,-1,V,!0),this.addCurrentVertex(C,pe,0,0,V)));if($e&&ae<T-1){var Ci=C.dist(ee);if(Ci>2*D){var vi=C.add(ee.sub(C)._mult(D/Ci)._round());this.updateDistance(C,vi),this.addCurrentVertex(vi,pe,0,0,V),C=vi}}}}},Yn.prototype.addCurrentVertex=function(e,t,i,l,p,d){d===void 0&&(d=!1);var _=t.y*l-t.x,E=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,d,!1,i,p),this.addHalfVertex(e,_,E,d,!0,-l,p),this.distance>ch/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,p,d))},Yn.prototype.addHalfVertex=function(e,t,i,l,p,d,_){var E=.5*(this.lineClips?this.scaledDistance*(ch-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(p?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(d===0?0:d<0?-1:1)|(63&E)<<2,E>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var T=_.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),_.primitiveLength++),p?this.e2=T:this.e1=T},Yn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Yn.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},lt("LineBucket",Yn,{omit:["layers","patternFeatures"]});var gu=new Qi({"line-cap":new vt(Z.layout_line["line-cap"]),"line-join":new gt(Z.layout_line["line-join"]),"line-miter-limit":new vt(Z.layout_line["line-miter-limit"]),"line-round-limit":new vt(Z.layout_line["line-round-limit"]),"line-sort-key":new gt(Z.layout_line["line-sort-key"])}),hh={paint:new Qi({"line-opacity":new gt(Z.paint_line["line-opacity"]),"line-color":new gt(Z.paint_line["line-color"]),"line-translate":new vt(Z.paint_line["line-translate"]),"line-translate-anchor":new vt(Z.paint_line["line-translate-anchor"]),"line-width":new gt(Z.paint_line["line-width"]),"line-gap-width":new gt(Z.paint_line["line-gap-width"]),"line-offset":new gt(Z.paint_line["line-offset"]),"line-blur":new gt(Z.paint_line["line-blur"]),"line-dasharray":new Li(Z.paint_line["line-dasharray"]),"line-pattern":new el(Z.paint_line["line-pattern"]),"line-gradient":new Cn(Z.paint_line["line-gradient"])}),layout:gu},pc=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new er(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,p,d){return l=Ue({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,p,d)},t}(gt))(hh.paint.properties["line-width"].specification);pc.useIntegerZoom=!0;var wf=function(e){function t(i){e.call(this,i,hh),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof _n,this.gradientVersion=(this.gradientVersion+1)%H)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=pc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Yn(i)},t.prototype.queryRadius=function(i){var l=i,p=ph(ro("line-width",this,l),ro("line-gap-width",this,l)),d=ro("line-offset",this,l);return p/2+Math.abs(d)+Gi(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,E,T){var z=hn(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),E.angle,T),C=T/2*ph(this.paint.get("line-width").evaluate(l,p),this.paint.get("line-gap-width").evaluate(l,p)),D=this.paint.get("line-offset").evaluate(l,p);return D&&(d=function(V,X){for(var ee=[],ne=new B(0,0),pe=0;pe<V.length;pe++){for(var ae=V[pe],ge=[],Ee=0;Ee<ae.length;Ee++){var Ae=ae[Ee],Le=ae[Ee+1],Fe=Ee===0?ne:Ae.sub(ae[Ee-1])._unit()._perp(),$e=Ee===ae.length-1?ne:Le.sub(Ae)._unit()._perp(),nt=Fe._add($e)._unit();nt._mult(1/(nt.x*$e.x+nt.y*$e.y)),ge.push(nt._mult(X)._add(Ae))}ee.push(ge)}return ee}(d,D*T)),function(V,X,ee){for(var ne=0;ne<X.length;ne++){var pe=X[ne];if(V.length>=3){for(var ae=0;ae<pe.length;ae++)if(ga(V,pe[ae]))return!0}if(Bi(V,pe,ee))return!0}return!1}(z,d,C)},t.prototype.isTileClipped=function(){return!0},t}(Xn);function ph(e,t){return t>0?t+2*e:e}var fh=pi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),pp=pi([{name:"a_projected_pos",components:3,type:"Float32"}],4),fp=(pi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),pi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Ol=(pi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),pi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),dp=pi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function dh(e,t,i){return e.sections.forEach(function(l){l.text=function(p,d,_){var E=d.layout.get("text-transform").evaluate(_,{});return E==="uppercase"?p=p.toLocaleUpperCase():E==="lowercase"&&(p=p.toLocaleLowerCase()),cn.applyArabicShaping&&(p=cn.applyArabicShaping(p)),p}(l.text,t,i)}),e}pi([{name:"triangle",components:3,type:"Uint16"}]),pi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),pi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),pi([{type:"Float32",name:"offsetX"}]),pi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Zu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},mh=function(e,t,i,l,p){var d,_,E=8*p-l-1,T=(1<<E)-1,z=T>>1,C=-7,D=i?p-1:0,V=i?-1:1,X=e[t+D];for(D+=V,d=X&(1<<-C)-1,X>>=-C,C+=E;C>0;d=256*d+e[t+D],D+=V,C-=8);for(_=d&(1<<-C)-1,d>>=-C,C+=l;C>0;_=256*_+e[t+D],D+=V,C-=8);if(d===0)d=1-z;else{if(d===T)return _?NaN:1/0*(X?-1:1);_+=Math.pow(2,l),d-=z}return(X?-1:1)*_*Math.pow(2,d-l)},fc=function(e,t,i,l,p,d){var _,E,T,z=8*d-p-1,C=(1<<z)-1,D=C>>1,V=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,X=l?0:d-1,ee=l?1:-1,ne=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(E=isNaN(t)?1:0,_=C):(_=Math.floor(Math.log(t)/Math.LN2),t*(T=Math.pow(2,-_))<1&&(_--,T*=2),(t+=_+D>=1?V/T:V*Math.pow(2,1-D))*T>=2&&(_++,T/=2),_+D>=C?(E=0,_=C):_+D>=1?(E=(t*T-1)*Math.pow(2,p),_+=D):(E=t*Math.pow(2,D-1)*Math.pow(2,p),_=0));p>=8;e[i+X]=255&E,X+=ee,E/=256,p-=8);for(_=_<<p|E,z+=p;z>0;e[i+X]=255&_,X+=ee,_/=256,z-=8);e[i+X-ee]|=128*ne},Gu=qr;function qr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}qr.Varint=0,qr.Fixed64=1,qr.Bytes=2,qr.Fixed32=5;var yh=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function _s(e){return e.type===qr.Bytes?e.readVarint()+e.pos:e.pos+1}function hl(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Fl(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var p=i.pos-1;p>=e;p--)i.buf[p+l]=i.buf[p]}function _u(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function mp(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function gh(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function Sf(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function yp(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function _h(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function gp(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function _p(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function vu(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Ku(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function pl(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function vp(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function bp(e,t,i){e===1&&i.readMessage(vh,t)}function vh(e,t,i){if(e===3){var l=i.readMessage(xp,{}),p=l.width,d=l.height,_=l.left,E=l.top,T=l.advance;t.push({id:l.id,bitmap:new sl({width:p+6,height:d+6},l.bitmap),metrics:{width:p,height:d,left:_,top:E,advance:T}})}}function xp(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function bh(e){for(var t=0,i=0,l=0,p=e;l<p.length;l+=1){var d=p[l];t+=d.w*d.h,i=Math.max(i,d.w)}e.sort(function(ne,pe){return pe.h-ne.h});for(var _=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],E=0,T=0,z=0,C=e;z<C.length;z+=1)for(var D=C[z],V=_.length-1;V>=0;V--){var X=_[V];if(!(D.w>X.w||D.h>X.h)){if(D.x=X.x,D.y=X.y,T=Math.max(T,D.y+D.h),E=Math.max(E,D.x+D.w),D.w===X.w&&D.h===X.h){var ee=_.pop();V<_.length&&(_[V]=ee)}else D.h===X.h?(X.x+=D.w,X.w-=D.w):D.w===X.w?(X.y+=D.h,X.h-=D.h):(_.push({x:X.x+D.w,y:X.y,w:X.w-D.w,h:D.h}),X.y+=D.h,X.h-=D.h);break}}return{w:E,h:T,fill:t/(E*T)||0}}qr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),p=l>>3,d=this.pos;this.type=7&l,e(p,t,this),this.pos===d&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Ku(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=vp(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Ku(this.buf,this.pos)+4294967296*Ku(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Ku(this.buf,this.pos)+4294967296*vp(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=mh(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=mh(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(p,d,_){var E,T,z=_.buf;if(E=(112&(T=z[_.pos++]))>>4,T<128||(E|=(127&(T=z[_.pos++]))<<3,T<128)||(E|=(127&(T=z[_.pos++]))<<10,T<128)||(E|=(127&(T=z[_.pos++]))<<17,T<128)||(E|=(127&(T=z[_.pos++]))<<24,T<128)||(E|=(1&(T=z[_.pos++]))<<31,T<128))return hl(p,E,d);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&yh?function(i,l,p){return yh.decode(i.subarray(l,p))}(this.buf,t,e):function(i,l,p){for(var d="",_=l;_<p;){var E,T,z,C=i[_],D=null,V=C>239?4:C>223?3:C>191?2:1;if(_+V>p)break;V===1?C<128&&(D=C):V===2?(192&(E=i[_+1]))==128&&(D=(31&C)<<6|63&E)<=127&&(D=null):V===3?(T=i[_+2],(192&(E=i[_+1]))==128&&(192&T)==128&&((D=(15&C)<<12|(63&E)<<6|63&T)<=2047||D>=55296&&D<=57343)&&(D=null)):V===4&&(T=i[_+2],z=i[_+3],(192&(E=i[_+1]))==128&&(192&T)==128&&(192&z)==128&&((D=(15&C)<<18|(63&E)<<12|(63&T)<<6|63&z)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,V=1):D>65535&&(D-=65536,d+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),d+=String.fromCharCode(D),_+=V}return d}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==qr.Bytes)return e.push(this.readVarint(t));var i=_s(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==qr.Bytes)return e.push(this.readSVarint());var t=_s(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==qr.Bytes)return e.push(this.readBoolean());var t=_s(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==qr.Bytes)return e.push(this.readFloat());var t=_s(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==qr.Bytes)return e.push(this.readDouble());var t=_s(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==qr.Bytes)return e.push(this.readFixed32());var t=_s(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==qr.Bytes)return e.push(this.readSFixed32());var t=_s(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==qr.Bytes)return e.push(this.readFixed64());var t=_s(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==qr.Bytes)return e.push(this.readSFixed64());var t=_s(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===qr.Varint)for(;this.buf[this.pos++]>127;);else if(t===qr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===qr.Fixed32)this.pos+=4;else{if(t!==qr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),pl(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),pl(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),pl(this.buf,-1&e,this.pos),pl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),pl(this.buf,-1&e,this.pos),pl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,p;if(t>=0?(l=t%4294967296|0,p=t/4294967296|0):(p=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,p=p+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(d,_,E){E.buf[E.pos++]=127&d|128,d>>>=7,E.buf[E.pos++]=127&d|128,d>>>=7,E.buf[E.pos++]=127&d|128,d>>>=7,E.buf[E.pos++]=127&d|128,E.buf[E.pos]=127&(d>>>=7)}(l,0,i),function(d,_){var E=(7&d)<<4;_.buf[_.pos++]|=E|((d>>>=3)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d)))))}(p,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,p,d){for(var _,E,T=0;T<p.length;T++){if((_=p.charCodeAt(T))>55295&&_<57344){if(!E){_>56319||T+1===p.length?(l[d++]=239,l[d++]=191,l[d++]=189):E=_;continue}if(_<56320){l[d++]=239,l[d++]=191,l[d++]=189,E=_;continue}_=E-55296<<10|_-56320|65536,E=null}else E&&(l[d++]=239,l[d++]=191,l[d++]=189,E=null);_<128?l[d++]=_:(_<2048?l[d++]=_>>6|192:(_<65536?l[d++]=_>>12|224:(l[d++]=_>>18|240,l[d++]=_>>12&63|128),l[d++]=_>>6&63|128),l[d++]=63&_|128)}return d}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&Fl(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),fc(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),fc(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&Fl(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,qr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,_u,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,mp,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,yp,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,gh,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Sf,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,_h,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,gp,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,_p,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,vu,t)},writeBytesField:function(e,t){this.writeTag(e,qr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,qr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,qr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,qr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,qr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,qr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,qr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,qr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,qr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,qr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Xs=function(e,t){var i=t.pixelRatio,l=t.version,p=t.stretchX,d=t.stretchY,_=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=p,this.stretchY=d,this.content=_,this.version=l},bu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};bu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},bu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},bu.tlbr.get=function(){return this.tl.concat(this.br)},bu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Xs.prototype,bu);var Nl=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var p=[];this.addImages(e,i,p),this.addImages(t,l,p);var d=bh(p),_=new io({width:d.w||1,height:d.h||1});for(var E in e){var T=e[E],z=i[E].paddedRect;io.copy(T.data,_,{x:0,y:0},{x:z.x+1,y:z.y+1},T.data)}for(var C in t){var D=t[C],V=l[C].paddedRect,X=V.x+1,ee=V.y+1,ne=D.data.width,pe=D.data.height;io.copy(D.data,_,{x:0,y:0},{x:X,y:ee},D.data),io.copy(D.data,_,{x:0,y:pe-1},{x:X,y:ee-1},{width:ne,height:1}),io.copy(D.data,_,{x:0,y:0},{x:X,y:ee+pe},{width:ne,height:1}),io.copy(D.data,_,{x:ne-1,y:0},{x:X-1,y:ee},{width:1,height:pe}),io.copy(D.data,_,{x:0,y:0},{x:X+ne,y:ee},{width:1,height:pe})}this.image=_,this.iconPositions=i,this.patternPositions=l};Nl.prototype.addImages=function(e,t,i){for(var l in e){var p=e[l],d={x:0,y:0,w:p.data.width+2,h:p.data.height+2};i.push(d),t[l]=new Xs(d,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},Nl.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},Nl.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},lt("ImagePosition",Xs),lt("ImageAtlas",Nl);var ia={horizontal:1,vertical:2,horizontalOnly:3},Vl=function(){this.scale=1,this.fontStack="",this.imageName=null};Vl.forText=function(e,t){var i=new Vl;return i.scale=e||1,i.fontStack=t,i},Vl.forImage=function(e){var t=new Vl;return t.imageName=e,t};var bn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Xu(e,t,i,l,p,d,_,E,T,z,C,D,V,X,ee,ne){var pe,ae=bn.fromFeature(e,p);D===ia.vertical&&ae.verticalizePunctuation();var ge=cn.processBidirectionalText,Ee=cn.processStyledBidirectionalText;if(ge&&ae.sections.length===1){pe=[];for(var Ae=0,Le=ge(ae.toString(),Ef(ae,z,d,t,l,X,ee));Ae<Le.length;Ae+=1){var Fe=Le[Ae],$e=new bn;$e.text=Fe,$e.sections=ae.sections;for(var nt=0;nt<Fe.length;nt++)$e.sectionIndex.push(0);pe.push($e)}}else if(Ee){pe=[];for(var It=0,ct=Ee(ae.text,ae.sectionIndex,Ef(ae,z,d,t,l,X,ee));It<ct.length;It+=1){var Pt=ct[It],pt=new bn;pt.text=Pt[0],pt.sectionIndex=Pt[1],pt.sections=ae.sections,pe.push(pt)}}else pe=function(_t,cr){for(var Yt=[],wr=_t.text,Ct=0,Pr=0,_i=cr;Pr<_i.length;Pr+=1){var Fi=_i[Pr];Yt.push(_t.substring(Ct,Fi)),Ct=Fi}return Ct<wr.length&&Yt.push(_t.substring(Ct,wr.length)),Yt}(ae,Ef(ae,z,d,t,l,X,ee));var rr=[],Ut={positionedLines:rr,text:ae.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(_t,cr,Yt,wr,Ct,Pr,_i,Fi,Ci,vi,Ni,xn){for(var wn=0,wo=-17,On=0,So=0,Ki=Fi==="right"?1:Fi==="left"?0:.5,Fn=0,gr=0,Yr=Ct;gr<Yr.length;gr+=1){var Nr=Yr[gr];Nr.trim();var Sr=Nr.getMaxScale(),Uo=24*(Sr-1),no={positionedGlyphs:[],lineOffset:0};_t.positionedLines[Fn]=no;var fi=no.positionedGlyphs,tn=0;if(Nr.length()){for(var oo=0;oo<Nr.length();oo++){var Cr=Nr.getSection(oo),fl=Nr.getSectionIndex(oo),Fa=Nr.getCharCode(oo),dl=0,Xi=null,ml=null,Ds=null,xc=24,Qu=!(Ci===ia.horizontal||!Ni&&!Ma(Fa)||Ni&&(Hu[Fa]||(Zl=Fa,at.Arabic(Zl)||at["Arabic Supplement"](Zl)||at["Arabic Extended-A"](Zl)||at["Arabic Presentation Forms-A"](Zl)||at["Arabic Presentation Forms-B"](Zl))));if(Cr.imageName){var wc=wr[Cr.imageName];if(!wc)continue;Ds=Cr.imageName,_t.iconsInText=_t.iconsInText||!0,ml=wc.paddedRect;var ql=wc.displaySize;Cr.scale=24*Cr.scale/xn,dl=Uo+(24-ql[1]*Cr.scale),xc=(Xi={width:ql[0],height:ql[1],left:1,top:-3,advance:Qu?ql[1]:ql[0]}).advance;var Sc=Qu?ql[0]*Cr.scale-24*Sr:ql[1]*Cr.scale-24*Sr;Sc>0&&Sc>tn&&(tn=Sc)}else{var Pp=Yt[Cr.fontStack],Ec=Pp&&Pp[Fa];if(Ec&&Ec.rect)ml=Ec.rect,Xi=Ec.metrics;else{var Sh=cr[Cr.fontStack],Cp=Sh&&Sh[Fa];if(!Cp)continue;Xi=Cp.metrics}dl=24*(Sr-Cr.scale)}Qu?(_t.verticalizable=!0,fi.push({glyph:Fa,imageName:Ds,x:wn,y:wo+dl,vertical:Qu,scale:Cr.scale,fontStack:Cr.fontStack,sectionIndex:fl,metrics:Xi,rect:ml}),wn+=xc*Cr.scale+vi):(fi.push({glyph:Fa,imageName:Ds,x:wn,y:wo+dl,vertical:Qu,scale:Cr.scale,fontStack:Cr.fontStack,sectionIndex:fl,metrics:Xi,rect:ml}),wn+=Xi.advance*Cr.scale+vi)}fi.length!==0&&(On=Math.max(wn-vi,On),dg(fi,0,fi.length-1,Ki,tn)),wn=0;var Mp=Pr*Sr+tn;no.lineOffset=Math.max(tn,Uo),wo+=Mp,So=Math.max(Mp,So),++Fn}else wo+=Pr,++Fn}var Zl,Eh=wo- -17,kc=kf(_i),wu=kc.horizontalAlign,Tc=kc.verticalAlign;(function(Dp,Lp,kh,Th,Rp,Ih,Ah,zh,Bp){var Ic,Op=(Lp-kh)*Rp;Ic=Ih!==Ah?-zh*Th- -17:(-Th*Bp+.5)*Ah;for(var Ac=0,Ph=Dp;Ac<Ph.length;Ac+=1)for(var $u=0,Ch=Ph[Ac].positionedGlyphs;$u<Ch.length;$u+=1){var zc=Ch[$u];zc.x+=Op,zc.y+=Ic}})(_t.positionedLines,Ki,wu,Tc,On,So,Pr,Eh,Ct.length),_t.top+=-Tc*Eh,_t.bottom=_t.top+Eh,_t.left+=-wu*On,_t.right=_t.left+On}(Ut,t,i,l,pe,_,E,T,D,z,V,ne),!function(_t){for(var cr=0,Yt=_t;cr<Yt.length;cr+=1)if(Yt[cr].positionedGlyphs.length!==0)return!1;return!0}(rr)&&Ut}bn.fromFeature=function(e,t){for(var i=new bn,l=0;l<e.sections.length;l++){var p=e.sections[l];p.image?i.addImageSection(p):i.addTextSection(p,t)}return i},bn.prototype.length=function(){return this.text.length},bn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},bn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},bn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},bn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,p=e.charCodeAt(i-1)||null;t+=l&&us(l)&&!Zu[e[i+1]]||p&&us(p)&&!Zu[e[i-1]]||!Zu[e[i]]?e[i]:Zu[e[i]]}return t}(this.text)},bn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Hu[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&Hu[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},bn.prototype.substring=function(e,t){var i=new bn;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},bn.prototype.toString=function(){return this.text},bn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},bn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(Vl.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},bn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(Vl.forImage(t)),this.sectionIndex.push(this.sections.length-1)):mt("Reached maximum number of images 6401")}else mt("Can't add FormattedSection with an empty image.")},bn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Hu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},va={};function yd(e,t,i,l,p,d){if(t.imageName){var _=l[t.imageName];return _?_.displaySize[0]*t.scale*24/d+p:0}var E=i[t.fontStack],T=E&&E[e];return T?T.metrics.advance*t.scale+p:0}function gd(e,t,i,l){var p=Math.pow(e-t,2);return l?e<t?p/2:2*p:p+Math.abs(i)*i}function fg(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function _d(e,t,i,l,p,d){for(var _=null,E=gd(t,i,p,d),T=0,z=l;T<z.length;T+=1){var C=z[T],D=gd(t-C.x,i,p,d)+C.badness;D<=E&&(_=C,E=D)}return{index:e,x:t,priorBreak:_,badness:E}}function Ef(e,t,i,l,p,d,_){if(d!=="point")return[];if(!e)return[];for(var E,T=[],z=function(pe,ae,ge,Ee,Ae,Le){for(var Fe=0,$e=0;$e<pe.length();$e++){var nt=pe.getSection($e);Fe+=yd(pe.getCharCode($e),nt,Ee,Ae,ae,Le)}return Fe/Math.max(1,Math.ceil(Fe/ge))}(e,t,i,l,p,_),C=e.text.indexOf("\u200B")>=0,D=0,V=0;V<e.length();V++){var X=e.getSection(V),ee=e.getCharCode(V);if(Hu[ee]||(D+=yd(ee,X,l,p,t,_)),V<e.length()-1){var ne=!((E=ee)<11904||!(at["Bopomofo Extended"](E)||at.Bopomofo(E)||at["CJK Compatibility Forms"](E)||at["CJK Compatibility Ideographs"](E)||at["CJK Compatibility"](E)||at["CJK Radicals Supplement"](E)||at["CJK Strokes"](E)||at["CJK Symbols and Punctuation"](E)||at["CJK Unified Ideographs Extension A"](E)||at["CJK Unified Ideographs"](E)||at["Enclosed CJK Letters and Months"](E)||at["Halfwidth and Fullwidth Forms"](E)||at.Hiragana(E)||at["Ideographic Description Characters"](E)||at["Kangxi Radicals"](E)||at["Katakana Phonetic Extensions"](E)||at.Katakana(E)||at["Vertical Forms"](E)||at["Yi Radicals"](E)||at["Yi Syllables"](E)));(va[ee]||ne||X.imageName)&&T.push(_d(V+1,D,z,T,fg(ee,e.getCharCode(V+1),ne&&C),!1))}}return function pe(ae){return ae?pe(ae.priorBreak).concat(ae.index):[]}(_d(e.length(),D,z,T,0,!0))}function kf(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function dg(e,t,i,l,p){if(l||p)for(var d=e[i],_=(e[i].x+d.metrics.advance*d.scale)*l,E=t;E<=i;E++)e[E].x-=_,e[E].y+=p}function vd(e,t,i,l,p,d){var _,E=e.image;if(E.content){var T=E.content,z=E.pixelRatio||1;_=[T[0]/z,T[1]/z,E.displaySize[0]-T[2]/z,E.displaySize[1]-T[3]/z]}var C,D,V,X,ee=t.left*d,ne=t.right*d;i==="width"||i==="both"?(X=p[0]+ee-l[3],D=p[0]+ne+l[1]):D=(X=p[0]+(ee+ne-E.displaySize[0])/2)+E.displaySize[0];var pe=t.top*d,ae=t.bottom*d;return i==="height"||i==="both"?(C=p[1]+pe-l[0],V=p[1]+ae+l[2]):V=(C=p[1]+(pe+ae-E.displaySize[1])/2)+E.displaySize[1],{image:E,top:C,right:D,bottom:V,left:X,collisionPadding:_}}va[10]=!0,va[32]=!0,va[38]=!0,va[40]=!0,va[41]=!0,va[43]=!0,va[45]=!0,va[47]=!0,va[173]=!0,va[183]=!0,va[8203]=!0,va[8208]=!0,va[8211]=!0,va[8231]=!0;var dc=function(e){function t(i,l,p,d){e.call(this,i,l),this.angle=p,d!==void 0&&(this.segment=d)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(B);function Tf(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new er(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,p=i.interpolationType,d=0;d<l.length&&l[d]<=e;)d++;for(var _=d=Math.max(0,d-1);_<l.length&&l[_]<e+1;)_++;_=Math.min(l.length-1,_);var E=l[d],T=l[_];return i.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:T,interpolationType:p}:{kind:"camera",minZoom:E,maxZoom:T,minSize:i.evaluate(new er(E)),maxSize:i.evaluate(new er(T)),interpolationType:p}}function bd(e,t,i){var l=t.uSize,p=i.lowerSize;return e.kind==="source"?p/128:e.kind==="composite"?hi(p/128,i.upperSize/128,t.uSizeT):l}function xd(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var p=e.interpolationType,d=p?Se(si.interpolationFactor(p,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=hi(e.minSize,e.maxSize,d):i=d}return{uSizeT:i,uSize:l}}lt("Anchor",dc);var mg=Object.freeze({__proto__:null,getSizeData:Tf,evaluateSizeForFeature:bd,evaluateSizeForZoom:xd,SIZE_PACK_FACTOR:128});function wd(e,t,i,l,p){if(t.segment===void 0)return!0;for(var d=t,_=t.segment+1,E=0;E>-i/2;){if(--_<0)return!1;E-=e[_].dist(d),d=e[_]}E+=e[_].dist(e[_+1]),_++;for(var T=[],z=0;E<i/2;){var C=e[_],D=e[_+1];if(!D)return!1;var V=e[_-1].angleTo(C)-C.angleTo(D);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:E,angleDelta:V}),z+=V;E-T[0].distance>l;)z-=T.shift().angleDelta;if(z>p)return!1;_++,E+=C.dist(D)}return!0}function Sd(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Ed(e,t,i){return e?.6*t*i:0}function kd(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function yg(e,t,i,l,p,d){for(var _=Ed(i,p,d),E=kd(i,l)*d,T=0,z=Sd(e)/2,C=0;C<e.length-1;C++){var D=e[C],V=e[C+1],X=D.dist(V);if(T+X>z){var ee=(z-T)/X,ne=hi(D.x,V.x,ee),pe=hi(D.y,V.y,ee),ae=new dc(ne,pe,V.angleTo(D),C);return ae._round(),!_||wd(e,ae,E,_,t)?ae:void 0}T+=X}}function gg(e,t,i,l,p,d,_,E,T){var z=Ed(l,d,_),C=kd(l,p),D=C*_,V=e[0].x===0||e[0].x===T||e[0].y===0||e[0].y===T;return t-D<t/4&&(t=D+t/4),function X(ee,ne,pe,ae,ge,Ee,Ae,Le,Fe){for(var $e=Ee/2,nt=Sd(ee),It=0,ct=ne-pe,Pt=[],pt=0;pt<ee.length-1;pt++){for(var rr=ee[pt],Ut=ee[pt+1],_t=rr.dist(Ut),cr=Ut.angleTo(rr);ct+pe<It+_t;){var Yt=((ct+=pe)-It)/_t,wr=hi(rr.x,Ut.x,Yt),Ct=hi(rr.y,Ut.y,Yt);if(wr>=0&&wr<Fe&&Ct>=0&&Ct<Fe&&ct-$e>=0&&ct+$e<=nt){var Pr=new dc(wr,Ct,cr,pt);Pr._round(),ae&&!wd(ee,Pr,Ee,ae,ge)||Pt.push(Pr)}}It+=_t}return Le||Pt.length||Ae||(Pt=X(ee,It/2,pe,ae,ge,Ee,Ae,!0,Fe)),Pt}(e,V?t/2*E%t:(C/2+2*d)*_*E%t,t,z,i,D,V,!1,T)}function Td(e,t,i,l,p){for(var d=[],_=0;_<e.length;_++)for(var E=e[_],T=void 0,z=0;z<E.length-1;z++){var C=E[z],D=E[z+1];C.x<t&&D.x<t||(C.x<t?C=new B(t,C.y+(t-C.x)/(D.x-C.x)*(D.y-C.y))._round():D.x<t&&(D=new B(t,C.y+(t-C.x)/(D.x-C.x)*(D.y-C.y))._round()),C.y<i&&D.y<i||(C.y<i?C=new B(C.x+(i-C.y)/(D.y-C.y)*(D.x-C.x),i)._round():D.y<i&&(D=new B(C.x+(i-C.y)/(D.y-C.y)*(D.x-C.x),i)._round()),C.x>=l&&D.x>=l||(C.x>=l?C=new B(l,C.y+(l-C.x)/(D.x-C.x)*(D.y-C.y))._round():D.x>=l&&(D=new B(l,C.y+(l-C.x)/(D.x-C.x)*(D.y-C.y))._round()),C.y>=p&&D.y>=p||(C.y>=p?C=new B(C.x+(p-C.y)/(D.y-C.y)*(D.x-C.x),p)._round():D.y>=p&&(D=new B(C.x+(p-C.y)/(D.y-C.y)*(D.x-C.x),p)._round()),T&&C.equals(T[T.length-1])||d.push(T=[C]),T.push(D)))))}return d}function Id(e,t,i,l){var p=[],d=e.image,_=d.pixelRatio,E=d.paddedRect.w-2,T=d.paddedRect.h-2,z=e.right-e.left,C=e.bottom-e.top,D=d.stretchX||[[0,E]],V=d.stretchY||[[0,T]],X=function(wr,Ct){return wr+Ct[1]-Ct[0]},ee=D.reduce(X,0),ne=V.reduce(X,0),pe=E-ee,ae=T-ne,ge=0,Ee=ee,Ae=0,Le=ne,Fe=0,$e=pe,nt=0,It=ae;if(d.content&&l){var ct=d.content;ge=wp(D,0,ct[0]),Ae=wp(V,0,ct[1]),Ee=wp(D,ct[0],ct[2]),Le=wp(V,ct[1],ct[3]),Fe=ct[0]-ge,nt=ct[1]-Ae,$e=ct[2]-ct[0]-Ee,It=ct[3]-ct[1]-Le}var Pt=function(wr,Ct,Pr,_i){var Fi=Sp(wr.stretch-ge,Ee,z,e.left),Ci=Ep(wr.fixed-Fe,$e,wr.stretch,ee),vi=Sp(Ct.stretch-Ae,Le,C,e.top),Ni=Ep(Ct.fixed-nt,It,Ct.stretch,ne),xn=Sp(Pr.stretch-ge,Ee,z,e.left),wn=Ep(Pr.fixed-Fe,$e,Pr.stretch,ee),wo=Sp(_i.stretch-Ae,Le,C,e.top),On=Ep(_i.fixed-nt,It,_i.stretch,ne),So=new B(Fi,vi),Ki=new B(xn,vi),Fn=new B(xn,wo),gr=new B(Fi,wo),Yr=new B(Ci/_,Ni/_),Nr=new B(wn/_,On/_),Sr=t*Math.PI/180;if(Sr){var Uo=Math.sin(Sr),no=Math.cos(Sr),fi=[no,-Uo,Uo,no];So._matMult(fi),Ki._matMult(fi),gr._matMult(fi),Fn._matMult(fi)}var tn=wr.stretch+wr.fixed,oo=Ct.stretch+Ct.fixed;return{tl:So,tr:Ki,bl:gr,br:Fn,tex:{x:d.paddedRect.x+1+tn,y:d.paddedRect.y+1+oo,w:Pr.stretch+Pr.fixed-tn,h:_i.stretch+_i.fixed-oo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yr,pixelOffsetBR:Nr,minFontScaleX:$e/_/z,minFontScaleY:It/_/C,isSDF:i}};if(l&&(d.stretchX||d.stretchY))for(var pt=Ad(D,pe,ee),rr=Ad(V,ae,ne),Ut=0;Ut<pt.length-1;Ut++)for(var _t=pt[Ut],cr=pt[Ut+1],Yt=0;Yt<rr.length-1;Yt++)p.push(Pt(_t,rr[Yt],cr,rr[Yt+1]));else p.push(Pt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:T+1}));return p}function wp(e,t,i){for(var l=0,p=0,d=e;p<d.length;p+=1){var _=d[p];l+=Math.max(t,Math.min(i,_[1]))-Math.max(t,Math.min(i,_[0]))}return l}function Ad(e,t,i){for(var l=[{fixed:-1,stretch:0}],p=0,d=e;p<d.length;p+=1){var _=d[p],E=_[0],T=_[1],z=l[l.length-1];l.push({fixed:E-z.stretch,stretch:z.stretch}),l.push({fixed:E-z.stretch,stretch:z.stretch+(T-E)})}return l.push({fixed:t+1,stretch:i}),l}function Sp(e,t,i,l){return e/t*i+l}function Ep(e,t,i,l){return e-t*i/l}var kp=function(e,t,i,l,p,d,_,E,T,z){if(this.boxStartIndex=e.length,T){var C=d.top,D=d.bottom,V=d.collisionPadding;V&&(C-=V[1],D+=V[3]);var X=D-C;X>0&&(X=Math.max(10,X),this.circleDiameter=X)}else{var ee=d.top*_-E,ne=d.bottom*_+E,pe=d.left*_-E,ae=d.right*_+E,ge=d.collisionPadding;if(ge&&(pe-=ge[0]*_,ee-=ge[1]*_,ae+=ge[2]*_,ne+=ge[3]*_),z){var Ee=new B(pe,ee),Ae=new B(ae,ee),Le=new B(pe,ne),Fe=new B(ae,ne),$e=z*Math.PI/180;Ee._rotate($e),Ae._rotate($e),Le._rotate($e),Fe._rotate($e),pe=Math.min(Ee.x,Ae.x,Le.x,Fe.x),ae=Math.max(Ee.x,Ae.x,Le.x,Fe.x),ee=Math.min(Ee.y,Ae.y,Le.y,Fe.y),ne=Math.max(Ee.y,Ae.y,Le.y,Fe.y)}e.emplaceBack(t.x,t.y,pe,ee,ae,ne,i,l,p)}this.boxEndIndex=e.length},mc=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=_g),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function _g(e,t){return e<t?-1:e>t?1:0}function vg(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,p=1/0,d=-1/0,_=-1/0,E=e[0],T=0;T<E.length;T++){var z=E[T];(!T||z.x<l)&&(l=z.x),(!T||z.y<p)&&(p=z.y),(!T||z.x>d)&&(d=z.x),(!T||z.y>_)&&(_=z.y)}var C=Math.min(d-l,_-p),D=C/2,V=new mc([],bg);if(C===0)return new B(l,p);for(var X=l;X<d;X+=C)for(var ee=p;ee<_;ee+=C)V.push(new yc(X+D,ee+D,D,e));for(var ne=function(ge){for(var Ee=0,Ae=0,Le=0,Fe=ge[0],$e=0,nt=Fe.length,It=nt-1;$e<nt;It=$e++){var ct=Fe[$e],Pt=Fe[It],pt=ct.x*Pt.y-Pt.x*ct.y;Ae+=(ct.x+Pt.x)*pt,Le+=(ct.y+Pt.y)*pt,Ee+=3*pt}return new yc(Ae/Ee,Le/Ee,0,ge)}(e),pe=V.length;V.length;){var ae=V.pop();(ae.d>ne.d||!ne.d)&&(ne=ae,i&&console.log("found best %d after %d probes",Math.round(1e4*ae.d)/1e4,pe)),ae.max-ne.d<=t||(V.push(new yc(ae.p.x-(D=ae.h/2),ae.p.y-D,D,e)),V.push(new yc(ae.p.x+D,ae.p.y-D,D,e)),V.push(new yc(ae.p.x-D,ae.p.y+D,D,e)),V.push(new yc(ae.p.x+D,ae.p.y+D,D,e)),pe+=4)}return i&&(console.log("num probes: "+pe),console.log("best distance: "+ne.d)),ne.p}function bg(e,t){return t.max-e.max}function yc(e,t,i,l){this.p=new B(e,t),this.h=i,this.d=function(p,d){for(var _=!1,E=1/0,T=0;T<d.length;T++)for(var z=d[T],C=0,D=z.length,V=D-1;C<D;V=C++){var X=z[C],ee=z[V];X.y>p.y!=ee.y>p.y&&p.x<(ee.x-X.x)*(p.y-X.y)/(ee.y-X.y)+X.x&&(_=!_),E=Math.min(E,fs(p,X,ee))}return(_?1:-1)*Math.sqrt(E)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}mc.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},mc.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},mc.prototype.peek=function(){return this.data[0]},mc.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var p=e-1>>1,d=t[p];if(i(l,d)>=0)break;t[e]=d,e=p}t[e]=l},mc.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,p=t[e];e<l;){var d=1+(e<<1),_=t[d],E=d+1;if(E<this.length&&i(t[E],_)<0&&(d=E,_=t[E]),i(_,p)>=0)break;t[e]=_,e=d}t[e]=p};var If=Number.POSITIVE_INFINITY;function zd(e,t){return t[1]!==If?function(i,l,p){var d=0,_=0;switch(l=Math.abs(l),p=Math.abs(p),i){case"top-right":case"top-left":case"top":_=p-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-p}switch(i){case"top-right":case"bottom-right":case"right":d=-l;break;case"top-left":case"bottom-left":case"left":d=l}return[d,_]}(e,t[0],t[1]):function(i,l){var p=0,d=0;l<0&&(l=0);var _=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":d=_-7;break;case"bottom-right":case"bottom-left":d=7-_;break;case"bottom":d=7-l;break;case"top":d=l-7}switch(i){case"top-right":case"bottom-right":p=-_;break;case"top-left":case"bottom-left":p=_;break;case"left":p=l;break;case"right":p=-l}return[p,d]}(e,t[0])}function Af(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Pd(e,t,i,l,p,d,_,E,T,z,C,D,V,X,ee){var ne=function(Ae,Le,Fe,$e,nt,It,ct,Pt){for(var pt=$e.layout.get("text-rotate").evaluate(It,{})*Math.PI/180,rr=[],Ut=0,_t=Le.positionedLines;Ut<_t.length;Ut+=1)for(var cr=_t[Ut],Yt=0,wr=cr.positionedGlyphs;Yt<wr.length;Yt+=1){var Ct=wr[Yt];if(Ct.rect){var Pr=Ct.rect||{},_i=4,Fi=!0,Ci=1,vi=0,Ni=(nt||Pt)&&Ct.vertical,xn=Ct.metrics.advance*Ct.scale/2;if(Pt&&Le.verticalizable&&(vi=cr.lineOffset/2-(Ct.imageName?-(24-Ct.metrics.width*Ct.scale)/2:24*(Ct.scale-1))),Ct.imageName){var wn=ct[Ct.imageName];Fi=wn.sdf,_i=1/(Ci=wn.pixelRatio)}var wo=nt?[Ct.x+xn,Ct.y]:[0,0],On=nt?[0,0]:[Ct.x+xn+Fe[0],Ct.y+Fe[1]-vi],So=[0,0];Ni&&(So=On,On=[0,0]);var Ki=(Ct.metrics.left-_i)*Ct.scale-xn+On[0],Fn=(-Ct.metrics.top-_i)*Ct.scale+On[1],gr=Ki+Pr.w*Ct.scale/Ci,Yr=Fn+Pr.h*Ct.scale/Ci,Nr=new B(Ki,Fn),Sr=new B(gr,Fn),Uo=new B(Ki,Yr),no=new B(gr,Yr);if(Ni){var fi=new B(-xn,xn- -17),tn=-Math.PI/2,oo=12-xn,Cr=new B(22-oo,-(Ct.imageName?oo:0)),fl=new(Function.prototype.bind.apply(B,[null].concat(So)));Nr._rotateAround(tn,fi)._add(Cr)._add(fl),Sr._rotateAround(tn,fi)._add(Cr)._add(fl),Uo._rotateAround(tn,fi)._add(Cr)._add(fl),no._rotateAround(tn,fi)._add(Cr)._add(fl)}if(pt){var Fa=Math.sin(pt),dl=Math.cos(pt),Xi=[dl,-Fa,Fa,dl];Nr._matMult(Xi),Sr._matMult(Xi),Uo._matMult(Xi),no._matMult(Xi)}var ml=new B(0,0),Ds=new B(0,0);rr.push({tl:Nr,tr:Sr,bl:Uo,br:no,tex:Pr,writingMode:Le.writingMode,glyphOffset:wo,sectionIndex:Ct.sectionIndex,isSDF:Fi,pixelOffsetTL:ml,pixelOffsetBR:Ds,minFontScaleX:0,minFontScaleY:0})}}return rr}(0,i,E,p,d,_,l,e.allowVerticalPlacement),pe=e.textSizeData,ae=null;pe.kind==="source"?(ae=[128*p.layout.get("text-size").evaluate(_,{})])[0]>32640&&mt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):pe.kind==="composite"&&((ae=[128*X.compositeTextSizes[0].evaluate(_,{},ee),128*X.compositeTextSizes[1].evaluate(_,{},ee)])[0]>32640||ae[1]>32640)&&mt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,ne,ae,E,d,_,z,t,T.lineStartIndex,T.lineLength,V,ee);for(var ge=0,Ee=C;ge<Ee.length;ge+=1)D[Ee[ge]]=e.text.placedSymbolArray.length-1;return 4*ne.length}function Cd(e){for(var t in e)return e[t];return null}function xg(e,t,i,l){var p=e.compareText;if(t in p){for(var d=p[t],_=d.length-1;_>=0;_--)if(l.dist(d[_])<i)return!0}else p[t]=[];return p[t].push(l),!1}var wg=Bl.VectorTileFeature.types,Sg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Tp(e,t,i,l,p,d,_,E,T,z,C,D,V){var X=E?Math.min(32640,Math.round(E[0])):0,ee=E?Math.min(32640,Math.round(E[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*p),d,_,(X<<1)+(T?1:0),ee,16*z,16*C,256*D,256*V)}function zf(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function Eg(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(zs(i[t].text))return!0;return!1}var gc=function(e){this.layoutVertexArray=new rl,this.indexArray=new Ra,this.programConfigurations=e,this.segments=new W,this.dynamicLayoutVertexArray=new ea,this.opacityVertexArray=new fa,this.placedSymbolArray=new u};gc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},gc.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,fh.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,pp.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Sg,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},gc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},lt("SymbolBuffers",gc);var xh=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new W,this.collisionVertexArray=new Pl};xh.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,fp.members,!0)},xh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},lt("CollisionBuffers",xh);var Zr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=xo([]),this.placementViewportMatrix=xo([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Tf(this.zoom,t["text-size"]),this.iconSizeData=Tf(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),p=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(d){return ia[d]})),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id}),this.sourceID=e.sourceID};Zr.prototype.createArrays=function(){this.text=new gc(new Ie(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new gc(new Ie(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new S,this.lineVertexArray=new k,this.symbolInstances=new w},Zr.prototype.calculateGlyphDependencies=function(e,t,i,l,p){for(var d=0;d<e.length;d++)if(t[e.charCodeAt(d)]=!0,(i||l)&&p){var _=Zu[e.charAt(d)];_&&(t[_.charCodeAt(0)]=!0)}},Zr.prototype.populate=function(e,t,i){var l=this.layers[0],p=l.layout,d=p.get("text-font"),_=p.get("text-field"),E=p.get("icon-image"),T=(_.value.kind!=="constant"||_.value.value instanceof ci&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&(d.value.kind!=="constant"||d.value.value.length>0),z=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,C=p.get("symbol-sort-key");if(this.features=[],T||z){for(var D=t.iconDependencies,V=t.glyphDependencies,X=t.availableImages,ee=new er(this.zoom),ne=0,pe=e;ne<pe.length;ne+=1){var ae=pe[ne],ge=ae.feature,Ee=ae.id,Ae=ae.index,Le=ae.sourceLayerIndex,Fe=l._featureFilter.needGeometry,$e=Jr(ge,Fe);if(l._featureFilter.filter(ee,$e,i)){Fe||($e.geometry=kr(ge));var nt=void 0;if(T){var It=l.getValueAndResolveTokens("text-field",$e,i,X),ct=ci.factory(It);Eg(ct)&&(this.hasRTLText=!0),(!this.hasRTLText||cs()==="unavailable"||this.hasRTLText&&cn.isParsed())&&(nt=dh(ct,l,$e))}var Pt=void 0;if(z){var pt=l.getValueAndResolveTokens("icon-image",$e,i,X);Pt=pt instanceof ki?pt:ki.fromString(pt)}if(nt||Pt){var rr=this.sortFeaturesByKey?C.evaluate($e,{},i):void 0;if(this.features.push({id:Ee,text:nt,icon:Pt,index:Ae,sourceLayerIndex:Le,geometry:$e.geometry,properties:ge.properties,type:wg[ge.type],sortKey:rr}),Pt&&(D[Pt.name]=!0),nt){var Ut=d.evaluate($e,{},i).join(","),_t=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ia.vertical)>=0;for(var cr=0,Yt=nt.sections;cr<Yt.length;cr+=1){var wr=Yt[cr];if(wr.image)D[wr.image.name]=!0;else{var Ct=Al(nt.toString()),Pr=wr.fontStack||Ut,_i=V[Pr]=V[Pr]||{};this.calculateGlyphDependencies(wr.text,_i,_t,this.allowVerticalPlacement,Ct)}}}}}}p.get("symbol-placement")==="line"&&(this.features=function(Fi){var Ci={},vi={},Ni=[],xn=0;function wn(fi){Ni.push(Fi[fi]),xn++}function wo(fi,tn,oo){var Cr=vi[fi];return delete vi[fi],vi[tn]=Cr,Ni[Cr].geometry[0].pop(),Ni[Cr].geometry[0]=Ni[Cr].geometry[0].concat(oo[0]),Cr}function On(fi,tn,oo){var Cr=Ci[tn];return delete Ci[tn],Ci[fi]=Cr,Ni[Cr].geometry[0].shift(),Ni[Cr].geometry[0]=oo[0].concat(Ni[Cr].geometry[0]),Cr}function So(fi,tn,oo){var Cr=oo?tn[0][tn[0].length-1]:tn[0][0];return fi+":"+Cr.x+":"+Cr.y}for(var Ki=0;Ki<Fi.length;Ki++){var Fn=Fi[Ki],gr=Fn.geometry,Yr=Fn.text?Fn.text.toString():null;if(Yr){var Nr=So(Yr,gr),Sr=So(Yr,gr,!0);if(Nr in vi&&Sr in Ci&&vi[Nr]!==Ci[Sr]){var Uo=On(Nr,Sr,gr),no=wo(Nr,Sr,Ni[Uo].geometry);delete Ci[Nr],delete vi[Sr],vi[So(Yr,Ni[no].geometry,!0)]=no,Ni[Uo].geometry=null}else Nr in vi?wo(Nr,Sr,gr):Sr in Ci?On(Nr,Sr,gr):(wn(Ki),Ci[Nr]=xn-1,vi[Sr]=xn-1)}else wn(Ki)}return Ni.filter(function(fi){return fi.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Fi,Ci){return Fi.sortKey-Ci.sortKey})}},Zr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Zr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Zr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Zr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Zr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Zr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Zr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),p=e.dist(t[e.segment]),d={},_=e.segment+1;_<t.length;_++)d[_]={x:t[_].x,y:t[_].y,tileUnitDistanceFromAnchor:l},_<t.length-1&&(l+=t[_+1].dist(t[_]));for(var E=e.segment||0;E>=0;E--)d[E]={x:t[E].x,y:t[E].y,tileUnitDistanceFromAnchor:p},E>0&&(p+=t[E-1].dist(t[E]));for(var T=0;T<t.length;T++){var z=d[T];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Zr.prototype.addSymbols=function(e,t,i,l,p,d,_,E,T,z,C,D){for(var V=e.indexArray,X=e.layoutVertexArray,ee=e.segments.prepareSegment(4*t.length,X,V,this.canOverlap?d.sortKey:void 0),ne=this.glyphOffsetArray.length,pe=ee.vertexLength,ae=this.allowVerticalPlacement&&_===ia.vertical?Math.PI/2:0,ge=d.text&&d.text.sections,Ee=0;Ee<t.length;Ee++){var Ae=t[Ee],Le=Ae.tl,Fe=Ae.tr,$e=Ae.bl,nt=Ae.br,It=Ae.tex,ct=Ae.pixelOffsetTL,Pt=Ae.pixelOffsetBR,pt=Ae.minFontScaleX,rr=Ae.minFontScaleY,Ut=Ae.glyphOffset,_t=Ae.isSDF,cr=Ae.sectionIndex,Yt=ee.vertexLength,wr=Ut[1];Tp(X,E.x,E.y,Le.x,wr+Le.y,It.x,It.y,i,_t,ct.x,ct.y,pt,rr),Tp(X,E.x,E.y,Fe.x,wr+Fe.y,It.x+It.w,It.y,i,_t,Pt.x,ct.y,pt,rr),Tp(X,E.x,E.y,$e.x,wr+$e.y,It.x,It.y+It.h,i,_t,ct.x,Pt.y,pt,rr),Tp(X,E.x,E.y,nt.x,wr+nt.y,It.x+It.w,It.y+It.h,i,_t,Pt.x,Pt.y,pt,rr),zf(e.dynamicLayoutVertexArray,E,ae),V.emplaceBack(Yt,Yt+1,Yt+2),V.emplaceBack(Yt+1,Yt+2,Yt+3),ee.vertexLength+=4,ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ut[0]),Ee!==t.length-1&&cr===t[Ee+1].sectionIndex||e.programConfigurations.populatePaintArrays(X.length,d,d.index,{},D,ge&&ge[cr])}e.placedSymbolArray.emplaceBack(E.x,E.y,ne,this.glyphOffsetArray.length-ne,pe,T,z,E.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],_,0,!1,0,C)},Zr.prototype._addCollisionDebugVertex=function(e,t,i,l,p,d){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,p,Math.round(d.x),Math.round(d.y))},Zr.prototype.addCollisionDebugVertices=function(e,t,i,l,p,d,_){var E=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),T=E.vertexLength,z=p.layoutVertexArray,C=p.collisionVertexArray,D=_.anchorX,V=_.anchorY;this._addCollisionDebugVertex(z,C,d,D,V,new B(e,t)),this._addCollisionDebugVertex(z,C,d,D,V,new B(i,t)),this._addCollisionDebugVertex(z,C,d,D,V,new B(i,l)),this._addCollisionDebugVertex(z,C,d,D,V,new B(e,l)),E.vertexLength+=4;var X=p.indexArray;X.emplaceBack(T,T+1),X.emplaceBack(T+1,T+2),X.emplaceBack(T+2,T+3),X.emplaceBack(T+3,T),E.primitiveLength+=4},Zr.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var p=e;p<t;p++){var d=this.collisionBoxArray.get(p);this.addCollisionDebugVertices(d.x1,d.y1,d.x2,d.y2,l?this.textCollisionBox:this.iconCollisionBox,d.anchorPoint,i)}},Zr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new xh(ta,Ol.members,Ks),this.iconCollisionBox=new xh(ta,Ol.members,Ks);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Zr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,p,d,_,E,T){for(var z={},C=t;C<i;C++){var D=e.get(C);z.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},z.textFeatureIndex=D.featureIndex;break}for(var V=l;V<p;V++){var X=e.get(V);z.verticalTextBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},z.verticalTextFeatureIndex=X.featureIndex;break}for(var ee=d;ee<_;ee++){var ne=e.get(ee);z.iconBox={x1:ne.x1,y1:ne.y1,x2:ne.x2,y2:ne.y2,anchorPointX:ne.anchorPointX,anchorPointY:ne.anchorPointY},z.iconFeatureIndex=ne.featureIndex;break}for(var pe=E;pe<T;pe++){var ae=e.get(pe);z.verticalIconBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},z.verticalIconFeatureIndex=ae.featureIndex;break}return z},Zr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Zr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Zr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Zr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Zr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Zr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Zr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,p=i.vertexStartIndex;p<l;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)},Zr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],p=[],d=[],_=0;_<this.symbolInstances.length;++_){d.push(_);var E=this.symbolInstances.get(_);l.push(0|Math.round(t*E.anchorX+i*E.anchorY)),p.push(E.featureIndex)}return d.sort(function(T,z){return l[T]-l[z]||p[z]-p[T]}),d},Zr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Zr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var p=this.symbolInstances.get(l[i]);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(function(d,_,E){d>=0&&E.indexOf(d)===_&&t.addIndicesForPlacedSymbol(t.text,d)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},lt("SymbolBucket",Zr,{omit:["layers","collisionBoxArray","features","compareText"]}),Zr.MAX_GLYPHS=65535,Zr.addDynamicAttributes=zf;var kg=new Qi({"symbol-placement":new vt(Z.layout_symbol["symbol-placement"]),"symbol-spacing":new vt(Z.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new vt(Z.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new gt(Z.layout_symbol["symbol-sort-key"]),"symbol-z-order":new vt(Z.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new vt(Z.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new vt(Z.layout_symbol["icon-ignore-placement"]),"icon-optional":new vt(Z.layout_symbol["icon-optional"]),"icon-rotation-alignment":new vt(Z.layout_symbol["icon-rotation-alignment"]),"icon-size":new gt(Z.layout_symbol["icon-size"]),"icon-text-fit":new vt(Z.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new vt(Z.layout_symbol["icon-text-fit-padding"]),"icon-image":new gt(Z.layout_symbol["icon-image"]),"icon-rotate":new gt(Z.layout_symbol["icon-rotate"]),"icon-padding":new vt(Z.layout_symbol["icon-padding"]),"icon-keep-upright":new vt(Z.layout_symbol["icon-keep-upright"]),"icon-offset":new gt(Z.layout_symbol["icon-offset"]),"icon-anchor":new gt(Z.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new vt(Z.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new vt(Z.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new vt(Z.layout_symbol["text-rotation-alignment"]),"text-field":new gt(Z.layout_symbol["text-field"]),"text-font":new gt(Z.layout_symbol["text-font"]),"text-size":new gt(Z.layout_symbol["text-size"]),"text-max-width":new gt(Z.layout_symbol["text-max-width"]),"text-line-height":new vt(Z.layout_symbol["text-line-height"]),"text-letter-spacing":new gt(Z.layout_symbol["text-letter-spacing"]),"text-justify":new gt(Z.layout_symbol["text-justify"]),"text-radial-offset":new gt(Z.layout_symbol["text-radial-offset"]),"text-variable-anchor":new vt(Z.layout_symbol["text-variable-anchor"]),"text-anchor":new gt(Z.layout_symbol["text-anchor"]),"text-max-angle":new vt(Z.layout_symbol["text-max-angle"]),"text-writing-mode":new vt(Z.layout_symbol["text-writing-mode"]),"text-rotate":new gt(Z.layout_symbol["text-rotate"]),"text-padding":new vt(Z.layout_symbol["text-padding"]),"text-keep-upright":new vt(Z.layout_symbol["text-keep-upright"]),"text-transform":new gt(Z.layout_symbol["text-transform"]),"text-offset":new gt(Z.layout_symbol["text-offset"]),"text-allow-overlap":new vt(Z.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new vt(Z.layout_symbol["text-ignore-placement"]),"text-optional":new vt(Z.layout_symbol["text-optional"])}),Pf={paint:new Qi({"icon-opacity":new gt(Z.paint_symbol["icon-opacity"]),"icon-color":new gt(Z.paint_symbol["icon-color"]),"icon-halo-color":new gt(Z.paint_symbol["icon-halo-color"]),"icon-halo-width":new gt(Z.paint_symbol["icon-halo-width"]),"icon-halo-blur":new gt(Z.paint_symbol["icon-halo-blur"]),"icon-translate":new vt(Z.paint_symbol["icon-translate"]),"icon-translate-anchor":new vt(Z.paint_symbol["icon-translate-anchor"]),"text-opacity":new gt(Z.paint_symbol["text-opacity"]),"text-color":new gt(Z.paint_symbol["text-color"],{runtimeType:Qe,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new gt(Z.paint_symbol["text-halo-color"]),"text-halo-width":new gt(Z.paint_symbol["text-halo-width"]),"text-halo-blur":new gt(Z.paint_symbol["text-halo-blur"]),"text-translate":new vt(Z.paint_symbol["text-translate"]),"text-translate-anchor":new vt(Z.paint_symbol["text-translate-anchor"])}),layout:kg},_c=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:st,this.defaultValue=e};_c.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},_c.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},_c.prototype.outputDefined=function(){return!1},_c.prototype.serialize=function(){return null},lt("FormatSectionOverride",_c,{omit:["defaultValue"]});var Tg=function(e){function t(i){e.call(this,i,Pf)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var p=this.layout.get("text-writing-mode");if(p){for(var d=[],_=0,E=p;_<E.length;_+=1){var T=E[_];d.indexOf(T)<0&&d.push(T)}this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,p,d){var _=this.layout.get(i).evaluate(l,{},p,d),E=this._unevaluatedLayout._values[i];return E.isDataDriven()||sa(E.value)||!_?_:function(T,z){return z.replace(/{([^{}]+)}/g,function(C,D){return D in T?String(T[D]):""})}(l.properties,_)},t.prototype.createBucket=function(i){return new Zr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=Pf.paint.overridableProperties;i<l.length;i+=1){var p=l[i];if(t.hasPaintOverride(this.layout,p)){var d,_=this.paint.get(p),E=new _c(_),T=new Es(E,_.property.specification);d=_.value.kind==="constant"||_.value.kind==="source"?new Vs("source",T):new Ts("composite",T,_.value.zoomStops,_.value._interpolationType),this.paint._values[p]=new Si(_.property,d,_.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var p=i.get("text-field"),d=Pf.paint.properties[l],_=!1,E=function(C){for(var D=0,V=C;D<V.length;D+=1)if(d.overrides&&d.overrides.hasOverride(V[D]))return void(_=!0)};if(p.value.kind==="constant"&&p.value.value instanceof ci)E(p.value.value.sections);else if(p.value.kind==="source"){var T=function(C){_||(C instanceof Ti&&zr(C.value)===lr?E(C.value.sections):C instanceof mi?E(C.sections):C.eachChild(T))},z=p.value;z._styleExpression&&T(z._styleExpression.expression)}return _},t}(Xn),Ig={paint:new Qi({"background-color":new vt(Z.paint_background["background-color"]),"background-pattern":new Li(Z.paint_background["background-pattern"]),"background-opacity":new vt(Z.paint_background["background-opacity"])})},Ag=function(e){function t(i){e.call(this,i,Ig)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Xn),zg={paint:new Qi({"raster-opacity":new vt(Z.paint_raster["raster-opacity"]),"raster-hue-rotate":new vt(Z.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new vt(Z.paint_raster["raster-brightness-min"]),"raster-brightness-max":new vt(Z.paint_raster["raster-brightness-max"]),"raster-saturation":new vt(Z.paint_raster["raster-saturation"]),"raster-contrast":new vt(Z.paint_raster["raster-contrast"]),"raster-resampling":new vt(Z.paint_raster["raster-resampling"]),"raster-fade-duration":new vt(Z.paint_raster["raster-fade-duration"])})},Pg=function(e){function t(i){e.call(this,i,zg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Xn),Cg=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Xn),Mg={circle:_a,heatmap:tp,hillshade:gf,fill:eh,"fill-extrusion":yu,line:wf,symbol:Tg,background:Ag,raster:Pg},Md=j.HTMLImageElement,Dd=j.HTMLCanvasElement,Ld=j.HTMLVideoElement,Rd=j.ImageData,Ip=j.ImageBitmap,Wu=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};Wu.prototype.update=function(e,t,i){var l=e.width,p=e.height,d=!(this.size&&this.size[0]===l&&this.size[1]===p||i),_=this.context,E=_.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!t||t.premultiply!==!1)),d)this.size=[l,p],e instanceof Md||e instanceof Dd||e instanceof Ld||e instanceof Rd||Ip&&e instanceof Ip?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,e):E.texImage2D(E.TEXTURE_2D,0,this.format,l,p,0,this.format,E.UNSIGNED_BYTE,e.data);else{var T=i||{x:0,y:0},z=T.x,C=T.y;e instanceof Md||e instanceof Dd||e instanceof Ld||e instanceof Rd||Ip&&e instanceof Ip?E.texSubImage2D(E.TEXTURE_2D,0,z,C,E.RGBA,E.UNSIGNED_BYTE,e):E.texSubImage2D(E.TEXTURE_2D,0,z,C,l,p,E.RGBA,E.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)},Wu.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Wu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Wu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Cf=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};Cf.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},Cf.prototype.remove=function(){delete this._channel,this._callback=function(){}};var vc=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},tr(["receive","process"],this),this.invoker=new Cf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ne()?e:j};function Bd(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}vc.prototype.send=function(e,t,i,l,p){var d=this;p===void 0&&(p=!1);var _=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[_]=i);var E=Kt(this.globalScope)?void 0:[];return this.target.postMessage({id:_,type:e,hasCallback:!!i,targetMapId:l,mustQueue:p,sourceMapId:this.mapId,data:un(t,E)},E),{cancel:function(){i&&delete d.callbacks[_],d.target.postMessage({id:_,type:"<cancel>",targetMapId:l,sourceMapId:d.mapId})}}},vc.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else Ne()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},vc.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},vc.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Zn(t.error)):l(null,Zn(t.data)))}else{var p=!1,d=Kt(this.globalScope)?void 0:[],_=t.hasCallback?function(C,D){p=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:C?un(C):null,data:un(D,d)},d)}:function(C){p=!0},E=null,T=Zn(t.data);if(this.parent[t.type])E=this.parent[t.type](t.sourceMapId,T,_);else if(this.parent.getWorkerSource){var z=t.type.split(".");E=this.parent.getWorkerSource(t.sourceMapId,z[0],T.source)[z[1]](T,_)}else _(new Error("Could not find function "+t.type));!p&&E&&E.cancel&&(this.cancelCallbacks[e]=E.cancel)}},vc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var pn=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};pn.prototype.setNorthEast=function(e){return this._ne=e instanceof gi?new gi(e.lng,e.lat):gi.convert(e),this},pn.prototype.setSouthWest=function(e){return this._sw=e instanceof gi?new gi(e.lng,e.lat):gi.convert(e),this},pn.prototype.extend=function(e){var t,i,l=this._sw,p=this._ne;if(e instanceof gi)t=e,i=e;else{if(!(e instanceof pn))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(pn.convert(e)):this.extend(gi.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||p?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),p.lng=Math.max(i.lng,p.lng),p.lat=Math.max(i.lat,p.lat)):(this._sw=new gi(t.lng,t.lat),this._ne=new gi(i.lng,i.lat)),this},pn.prototype.getCenter=function(){return new gi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},pn.prototype.getSouthWest=function(){return this._sw},pn.prototype.getNorthEast=function(){return this._ne},pn.prototype.getNorthWest=function(){return new gi(this.getWest(),this.getNorth())},pn.prototype.getSouthEast=function(){return new gi(this.getEast(),this.getSouth())},pn.prototype.getWest=function(){return this._sw.lng},pn.prototype.getSouth=function(){return this._sw.lat},pn.prototype.getEast=function(){return this._ne.lng},pn.prototype.getNorth=function(){return this._ne.lat},pn.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},pn.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},pn.prototype.isEmpty=function(){return!(this._sw&&this._ne)},pn.prototype.contains=function(e){var t=gi.convert(e),i=t.lng,l=t.lat,p=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&p},pn.convert=function(e){return!e||e instanceof pn?e:new pn(e)};var gi=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};gi.prototype.wrap=function(){return new gi(He(this.lng,-180,180),this.lat)},gi.prototype.toArray=function(){return[this.lng,this.lat]},gi.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},gi.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,p=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(p,1))},gi.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new pn(new gi(this.lng-i,this.lat-t),new gi(this.lng+i,this.lat+t))},gi.convert=function(e){if(e instanceof gi)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new gi(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new gi(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Od=2*Math.PI*63710088e-1;function Fd(e){return Od*Math.cos(e*Math.PI/180)}function Nd(e){return(180+e)/360}function Vd(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Ud(e,t){return e/Fd(t)}function Mf(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Ju=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};Ju.fromLngLat=function(e,t){t===void 0&&(t=0);var i=gi.convert(e);return new Ju(Nd(i.lng),Vd(i.lat),Ud(t,i.lat))},Ju.prototype.toLngLat=function(){return new gi(360*this.x-180,Mf(this.y))},Ju.prototype.toAltitude=function(){return this.z*Fd(Mf(this.y))},Ju.prototype.meterInMercatorCoordinateUnits=function(){return 1/Od*(e=Mf(this.y),1/Math.cos(e*Math.PI/180));var e};var Yu=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=wh(0,e,e,t,i)};Yu.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Yu.prototype.url=function(e,t){var i,l,p,d,_,E=(l=this.y,p=this.z,d=Bd(256*(i=this.x),256*(l=Math.pow(2,p)-l-1),p),_=Bd(256*(i+1),256*(l+1),p),d[0]+","+d[1]+","+_[0]+","+_[1]),T=function(z,C,D){for(var V,X="",ee=z;ee>0;ee--)X+=(C&(V=1<<ee-1)?1:0)+(D&V?2:0);return X}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",T).replace("{bbox-epsg-3857}",E)},Yu.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new B(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Yu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var jd=function(e,t){this.wrap=e,this.canonical=t,this.key=wh(e,t.z,t.z,t.x,t.y)},fn=function(e,t,i,l,p){this.overscaledZ=e,this.wrap=t,this.canonical=new Yu(i,+l,+p),this.key=wh(t,e,i,l,p)};function wh(e,t,i,l,p){(e*=2)<0&&(e=-1*e-1);var d=1<<i;return(d*d*e+d*p+l).toString(36)+i.toString(36)+t.toString(36)}fn.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},fn.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new fn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fn(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},fn.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?wh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):wh(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},fn.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},fn.prototype.children=function(e){if(this.overscaledZ>=e)return[new fn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new fn(t,this.wrap,t,i,l),new fn(t,this.wrap,t,i+1,l),new fn(t,this.wrap,t,i,l+1),new fn(t,this.wrap,t,i+1,l+1)]},fn.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},fn.prototype.wrapped=function(){return new fn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},fn.prototype.unwrapTo=function(e){return new fn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},fn.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},fn.prototype.toUnwrapped=function(){return new jd(this.wrap,this.canonical)},fn.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},fn.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Ju(e.x-this.wrap,e.y))},lt("CanonicalTileID",Yu),lt("OverscaledTileID",fn,{omit:["posMatrix"]});var Ul=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return mt('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var p=0;p<l;p++)this.data[this._idx(-1,p)]=this.data[this._idx(0,p)],this.data[this._idx(l,p)]=this.data[this._idx(l-1,p)],this.data[this._idx(p,-1)]=this.data[this._idx(p,0)],this.data[this._idx(p,l)]=this.data[this._idx(p,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};Ul.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},Ul.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ul.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Ul.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},Ul.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},Ul.prototype.getPixels=function(){return new io({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ul.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,p=t*this.dim+this.dim,d=i*this.dim,_=i*this.dim+this.dim;switch(t){case-1:l=p-1;break;case 1:p=l+1}switch(i){case-1:d=_-1;break;case 1:_=d+1}for(var E=-t*this.dim,T=-i*this.dim,z=d;z<_;z++)for(var C=l;C<p;C++)this.data[this._idx(C,z)]=e.data[this._idx(C+E,z+T)]},lt("DEMData",Ul);var Ap=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};Ap.prototype.encode=function(e){return this._stringToNumber[e]},Ap.prototype.decode=function(e){return this._numberToString[e]};var zp=function(e,t,i,l,p){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=p},Df={geometry:{configurable:!0}};Df.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Df.geometry.set=function(e){this._geometry=e},zp.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(zp.prototype,Df);var bc=function(){this.state={},this.stateChanges={},this.deletedStates={}};bc.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},Ue(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var p in this.deletedStates[e]={},this.state[e])p!==l&&(this.deletedStates[e][p]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var d in this.deletedStates[e][l]={},this.state[e][l])i[d]||(this.deletedStates[e][l][d]=null);else for(var _ in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][_]===null&&delete this.deletedStates[e][l][_]},bc.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},bc.prototype.getState=function(e,t){var i=String(t),l=Ue({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var p=this.deletedStates[e][t];if(p===null)return{};for(var d in p)delete l[d]}return l},bc.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},bc.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var p={};for(var d in this.stateChanges[l])this.state[l][d]||(this.state[l][d]={}),Ue(this.state[l][d],this.stateChanges[l][d]),p[d]=this.state[l][d];i[l]=p}for(var _ in this.deletedStates){this.state[_]=this.state[_]||{};var E={};if(this.deletedStates[_]===null)for(var T in this.state[_])E[T]={},this.state[_][T]={};else for(var z in this.deletedStates[_]){if(this.deletedStates[_][z]===null)this.state[_][z]={};else for(var C=0,D=Object.keys(this.deletedStates[_][z]);C<D.length;C+=1)delete this.state[_][z][D[C]];E[z]=this.state[_][z]}i[_]=i[_]||{},Ue(i[_],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var V in e)e[V].setFeatureState(i,t)};var jl=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new pa(8192,16,0),this.grid3D=new pa(8192,16,0),this.featureIndexArray=new L,this.promoteId=t};function qd(e,t,i,l,p){return St(e,function(d,_){var E=t instanceof Zs?t.get(_):null;return E&&E.evaluate?E.evaluate(i,l,p):E})}function Zd(e){for(var t=1/0,i=1/0,l=-1/0,p=-1/0,d=0,_=e;d<_.length;d+=1){var E=_[d];t=Math.min(t,E.x),i=Math.min(i,E.y),l=Math.max(l,E.x),p=Math.max(p,E.y)}return{minX:t,minY:i,maxX:l,maxY:p}}function Dg(e,t){return t-e}jl.prototype.insert=function(e,t,i,l,p,d){var _=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,p);for(var E=d?this.grid3D:this.grid,T=0;T<t.length;T++){for(var z=t[T],C=[1/0,1/0,-1/0,-1/0],D=0;D<z.length;D++){var V=z[D];C[0]=Math.min(C[0],V.x),C[1]=Math.min(C[1],V.y),C[2]=Math.max(C[2],V.x),C[3]=Math.max(C[3],V.y)}C[0]<8192&&C[1]<8192&&C[2]>=0&&C[3]>=0&&E.insert(_,C[0],C[1],C[2],C[3])}},jl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Bl.VectorTile(new Gu(this.rawTileData)).layers,this.sourceLayerCoder=new Ap(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},jl.prototype.query=function(e,t,i,l){var p=this;this.loadVTLayers();for(var d=e.params||{},_=8192/e.tileSize/e.scale,E=qs(d.filter),T=e.queryGeometry,z=e.queryPadding*_,C=Zd(T),D=this.grid.query(C.minX-z,C.minY-z,C.maxX+z,C.maxY+z),V=Zd(e.cameraQueryGeometry),X=this.grid3D.query(V.minX-z,V.minY-z,V.maxX+z,V.maxY+z,function(Ae,Le,Fe,$e){return function(nt,It,ct,Pt,pt){for(var rr=0,Ut=nt;rr<Ut.length;rr+=1){var _t=Ut[rr];if(It<=_t.x&&ct<=_t.y&&Pt>=_t.x&&pt>=_t.y)return!0}var cr=[new B(It,ct),new B(It,pt),new B(Pt,pt),new B(Pt,ct)];if(nt.length>2){for(var Yt=0,wr=cr;Yt<wr.length;Yt+=1)if(ga(nt,wr[Yt]))return!0}for(var Ct=0;Ct<nt.length-1;Ct++)if(Jn(nt[Ct],nt[Ct+1],cr))return!0;return!1}(e.cameraQueryGeometry,Ae-z,Le-z,Fe+z,$e+z)}),ee=0,ne=X;ee<ne.length;ee+=1)D.push(ne[ee]);D.sort(Dg);for(var pe,ae={},ge=function(Ae){var Le=D[Ae];if(Le!==pe){pe=Le;var Fe=p.featureIndexArray.get(Le),$e=null;p.loadMatchingFeature(ae,Fe.bucketIndex,Fe.sourceLayerIndex,Fe.featureIndex,E,d.layers,d.availableImages,t,i,l,function(nt,It,ct){return $e||($e=kr(nt)),It.queryIntersectsFeature(T,nt,ct,$e,p.z,e.transform,_,e.pixelPosMatrix)})}},Ee=0;Ee<D.length;Ee++)ge(Ee);return ae},jl.prototype.loadMatchingFeature=function(e,t,i,l,p,d,_,E,T,z,C){var D=this.bucketLayerIDs[t];if(!d||function(nt,It){for(var ct=0;ct<nt.length;ct++)if(It.indexOf(nt[ct])>=0)return!0;return!1}(d,D)){var V=this.sourceLayerCoder.decode(i),X=this.vtLayers[V].feature(l);if(p.needGeometry){var ee=Jr(X,!0);if(!p.filter(new er(this.tileID.overscaledZ),ee,this.tileID.canonical))return}else if(!p.filter(new er(this.tileID.overscaledZ),X))return;for(var ne=this.getId(X,V),pe=0;pe<D.length;pe++){var ae=D[pe];if(!(d&&d.indexOf(ae)<0)){var ge=E[ae];if(ge){var Ee={};ne!==void 0&&z&&(Ee=z.getState(ge.sourceLayer||"_geojsonTileLayer",ne));var Ae=Ue({},T[ae]);Ae.paint=qd(Ae.paint,ge.paint,X,Ee,_),Ae.layout=qd(Ae.layout,ge.layout,X,Ee,_);var Le=!C||C(X,ge,Ee);if(Le){var Fe=new zp(X,this.z,this.x,this.y,ne);Fe.layer=Ae;var $e=e[ae];$e===void 0&&($e=e[ae]=[]),$e.push({featureIndex:l,feature:Fe,intersectionZ:Le})}}}}}},jl.prototype.lookupSymbolFeatures=function(e,t,i,l,p,d,_,E){var T={};this.loadVTLayers();for(var z=qs(p),C=0,D=e;C<D.length;C+=1)this.loadMatchingFeature(T,i,l,D[C],z,d,_,E,t);return T},jl.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,p=i[t];l<p.length;l+=1)if(e===p[l])return!0;return!1},jl.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},lt("FeatureIndex",jl,{omit:["rawTileData","sourceLayerCoder"]});var Bn=function(e,t){this.tileID=e,this.uid=kt(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Bn.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<ui.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Bn.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Bn.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(z,C){var D={};if(!C)return D;for(var V=function(){var ne=ee[X],pe=ne.layerIds.map(function(Ee){return C.getLayer(Ee)}).filter(Boolean);if(pe.length!==0){ne.layers=pe,ne.stateDependentLayerIds&&(ne.stateDependentLayers=ne.stateDependentLayerIds.map(function(Ee){return pe.filter(function(Ae){return Ae.id===Ee})[0]}));for(var ae=0,ge=pe;ae<ge.length;ae+=1)D[ge[ae].id]=ne}},X=0,ee=z;X<ee.length;X+=1)V();return D}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var p=this.buckets[l];if(p instanceof Zr){if(this.hasSymbolBuckets=!0,!i)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var d in this.buckets){var _=this.buckets[d];if(_ instanceof Zr&&_.hasRTLText){this.hasRTLText=!0,cn.isLoading()||cn.isLoaded()||cs()!=="deferred"||No();break}}for(var E in this.queryPadding=0,this.buckets){var T=this.buckets[E];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(E).queryRadius(T))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Bn.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Bn.prototype.getBucket=function(e){return this.buckets[e.id]},Bn.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Wu(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Wu(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},Bn.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Bn.prototype.queryRenderedFeatures=function(e,t,i,l,p,d,_,E,T,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:p,scale:d,tileSize:this.tileSize,pixelPosMatrix:z,transform:E,params:_,queryPadding:this.queryPadding*T},e,t,i):{}},Bn.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),p=t?t.sourceLayer:"",d=l._geojsonTileLayer||l[p];if(d)for(var _=qs(t&&t.filter),E=this.tileID.canonical,T=E.z,z=E.x,C=E.y,D={z:T,x:z,y:C},V=0;V<d.length;V++){var X=d.feature(V);if(_.needGeometry){var ee=Jr(X,!0);if(!_.filter(new er(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!_.filter(new er(this.tileID.overscaledZ),X))continue;var ne=i.getId(X,p),pe=new zp(X,T,z,C,ne);pe.tile=D,e.push(pe)}}},Bn.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Bn.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Bn.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=Tt(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),p=!1;if(this.expirationTime>l)p=!1;else if(t)if(this.expirationTime<t)p=!0;else{var d=this.expirationTime-t;d?this.expirationTime=l+Math.max(d,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Bn.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Bn.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var p=this.buckets[l],d=p.layers[0].sourceLayer||"_geojsonTileLayer",_=i[d],E=e[d];if(_&&E&&Object.keys(E).length!==0){p.update(E,_,this.imageAtlas&&this.imageAtlas.patternPositions||{});var T=t&&t.style&&t.style.getLayer(l);T&&(this.queryPadding=Math.max(this.queryPadding,T.queryRadius(p)))}}}},Bn.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Bn.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ui.now()},Bn.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Bn.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=ui.now()+e},Bn.prototype.setDependencies=function(e,t){for(var i={},l=0,p=t;l<p.length;l+=1)i[p[l]]=!0;this.dependencies[e]=i},Bn.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var p=this.dependencies[l[i]];if(p){for(var d=0,_=t;d<_.length;d+=1)if(p[_[d]])return!0}}return!1};var xu=j.performance,Gd=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},xu.mark(this._marks.start)};Gd.prototype.finish=function(){xu.mark(this._marks.end);var e=xu.getEntriesByName(this._marks.measure);return e.length===0&&(xu.measure(this._marks.measure,this._marks.start,this._marks.end),e=xu.getEntriesByName(this._marks.measure),xu.clearMarks(this._marks.start),xu.clearMarks(this._marks.end),xu.clearMeasures(this._marks.measure)),e},a.Actor=vc,a.AlphaImage=sl,a.CanonicalTileID=Yu,a.CollisionBoxArray=s,a.Color=nr,a.DEMData=Ul,a.DataConstantProperty=vt,a.DictionaryCoder=Ap,a.EXTENT=8192,a.ErrorEvent=ue,a.EvaluationParameters=er,a.Event=re,a.Evented=me,a.FeatureIndex=jl,a.FillBucket=Ba,a.FillExtrusionBucket=Oa,a.ImageAtlas=Nl,a.ImagePosition=Xs,a.LineBucket=Yn,a.LngLat=gi,a.LngLatBounds=pn,a.MercatorCoordinate=Ju,a.ONE_EM=24,a.OverscaledTileID=fn,a.Point=B,a.Point$1=B,a.Properties=Qi,a.Protobuf=Gu,a.RGBAImage=io,a.RequestManager=ii,a.RequestPerformance=Gd,a.ResourceType=To,a.SegmentVector=W,a.SourceFeatureState=bc,a.StructArrayLayout1ui2=hs,a.StructArrayLayout2f1f2i16=da,a.StructArrayLayout2i4=Hn,a.StructArrayLayout3ui6=Ra,a.StructArrayLayout4i8=bo,a.SymbolBucket=Zr,a.Texture=Wu,a.Tile=Bn,a.Transitionable=qi,a.Uniform1f=Ze,a.Uniform1i=Oe,a.Uniform2f=qe,a.Uniform3f=tt,a.Uniform4f=ft,a.UniformColor=zt,a.UniformMatrix4f=Zt,a.UnwrappedTileID=jd,a.ValidationError=ie,a.WritingMode=ia,a.ZoomHistory=ls,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=zf,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,p=new Array(e.length),d=null;e.forEach(function(_,E){t(_,function(T,z){T&&(d=T),p[E]=z,--l==0&&i(d,p)})})},a.bezier=de,a.bindAll=tr,a.browser=ui,a.cacheEntryPossiblyAdded=function(e){++Zo>na&&(e.getActor().send("enforceCacheSizeLimit",kn),Zo=0)},a.clamp=Se,a.clearTileCache=function(e){var t=j.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=Td,a.clone=function(e){var t=new Tr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=Ke,a.clone$2=function(e){var t=new Tr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=dp,a.config=xt,a.create=function(){var e=new Tr(16);return Tr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new Tr(9);return Tr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new Tr(4);return Tr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=A,a.createExpression=ks,a.createLayout=pi,a.createStyleLayer=function(e){return e.type==="custom"?new Cg(e):new Mg[e.type](e)},a.cross=function(e,t,i){var l=t[0],p=t[1],d=t[2],_=i[0],E=i[1],T=i[2];return e[0]=p*T-d*E,e[1]=d*_-l*T,e[2]=l*E-p*_,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var p in t)if(!e(t[p],i[p]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=Me,a.emitValidationErrors=ha,a.endsWith=Gt,a.enforceCacheSizeLimit=function(e){Tn(),jr&&jr.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},a.evaluateSizeForFeature=bd,a.evaluateSizeForZoom=xd,a.evaluateVariableOffset=zd,a.evented=Da,a.extend=Ue,a.featureFilter=qs,a.filterObject=jt,a.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=kf,a.getAnchorJustification=Af,a.getArrayBuffer=ei,a.getImage=F,a.getJSON=function(e,t){return Io(Ue(e,{type:"json"}),t)},a.getRTLTextPluginStatus=cs,a.getReferrer=lo,a.getVideo=function(e,t){var i,l,p=j.document.createElement("video");p.muted=!0,p.onloadstart=function(){t(null,p)};for(var d=0;d<e.length;d++){var _=j.document.createElement("source");i=e[d],l=void 0,(l=j.document.createElement("a")).href=i,(l.protocol!==j.document.location.protocol||l.host!==j.document.location.host)&&(p.crossOrigin="Anonymous"),_.src=e[d],p.appendChild(_)}return{cancel:function(){}}},a.identity=xo,a.invert=function(e,t){var i=t[0],l=t[1],p=t[2],d=t[3],_=t[4],E=t[5],T=t[6],z=t[7],C=t[8],D=t[9],V=t[10],X=t[11],ee=t[12],ne=t[13],pe=t[14],ae=t[15],ge=i*E-l*_,Ee=i*T-p*_,Ae=i*z-d*_,Le=l*T-p*E,Fe=l*z-d*E,$e=p*z-d*T,nt=C*ne-D*ee,It=C*pe-V*ee,ct=C*ae-X*ee,Pt=D*pe-V*ne,pt=D*ae-X*ne,rr=V*ae-X*pe,Ut=ge*rr-Ee*pt+Ae*Pt+Le*ct-Fe*It+$e*nt;return Ut?(e[0]=(E*rr-T*pt+z*Pt)*(Ut=1/Ut),e[1]=(p*pt-l*rr-d*Pt)*Ut,e[2]=(ne*$e-pe*Fe+ae*Le)*Ut,e[3]=(V*Fe-D*$e-X*Le)*Ut,e[4]=(T*ct-_*rr-z*It)*Ut,e[5]=(i*rr-p*ct+d*It)*Ut,e[6]=(pe*Ae-ee*$e-ae*Ee)*Ut,e[7]=(C*$e-V*Ae+X*Ee)*Ut,e[8]=(_*pt-E*ct+z*nt)*Ut,e[9]=(l*ct-i*pt-d*nt)*Ut,e[10]=(ee*Fe-ne*Ae+ae*ge)*Ut,e[11]=(D*Ae-C*Fe-X*ge)*Ut,e[12]=(E*It-_*Pt-T*nt)*Ut,e[13]=(i*Pt-l*It+p*nt)*Ut,e[14]=(ne*Ee-ee*Le-pe*ge)*Ut,e[15]=(C*Le-D*Ee+V*ge)*Ut,e):null},a.isChar=at,a.isMapboxURL=dr,a.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},a.makeRequest=Io,a.mapObject=St,a.mercatorXfromLng=Nd,a.mercatorYfromLat=Vd,a.mercatorZfromAltitude=Ud,a.mul=lc,a.multiply=Rn,a.mvt=Bl,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],l=t[1],p=t[2],d=i*i+l*l+p*p;return d>0&&(d=1/Math.sqrt(d)),e[0]=t[0]*d,e[1]=t[1]*d,e[2]=t[2]*d,e},a.number=hi,a.offscreenCanvasSupported=Vn,a.ortho=function(e,t,i,l,p,d,_){var E=1/(t-i),T=1/(l-p),z=1/(d-_);return e[0]=-2*E,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*T,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*z,e[11]=0,e[12]=(t+i)*E,e[13]=(p+l)*T,e[14]=(_+d)*z,e[15]=1,e},a.parseGlyphPBF=function(e){return new Gu(e).readFields(bp,[])},a.pbf=Gu,a.performSymbolLayout=function(e,t,i,l,p,d,_){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var E=e.layers[0].layout,T=e.layers[0]._unevaluatedLayout._values,z={};if(e.textSizeData.kind==="composite"){var C=e.textSizeData,D=C.maxZoom;z.compositeTextSizes=[T["text-size"].possiblyEvaluate(new er(C.minZoom),_),T["text-size"].possiblyEvaluate(new er(D),_)]}if(e.iconSizeData.kind==="composite"){var V=e.iconSizeData,X=V.maxZoom;z.compositeIconSizes=[T["icon-size"].possiblyEvaluate(new er(V.minZoom),_),T["icon-size"].possiblyEvaluate(new er(X),_)]}z.layoutTextSize=T["text-size"].possiblyEvaluate(new er(e.zoom+1),_),z.layoutIconSize=T["icon-size"].possiblyEvaluate(new er(e.zoom+1),_),z.textMaxSize=T["text-size"].possiblyEvaluate(new er(18));for(var ee=24*E.get("text-line-height"),ne=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point",pe=E.get("text-keep-upright"),ae=E.get("text-size"),ge=function(){var Le=Ae[Ee],Fe=E.get("text-font").evaluate(Le,{},_).join(","),$e=ae.evaluate(Le,{},_),nt=z.layoutTextSize.evaluate(Le,{},_),It=z.layoutIconSize.evaluate(Le,{},_),ct={horizontal:{},vertical:void 0},Pt=Le.text,pt=[0,0];if(Pt){var rr=Pt.toString(),Ut=24*E.get("text-letter-spacing").evaluate(Le,{},_),_t=function(gr){for(var Yr=0,Nr=gr;Yr<Nr.length;Yr+=1)if(Sr=Nr[Yr].charCodeAt(0),at.Arabic(Sr)||at["Arabic Supplement"](Sr)||at["Arabic Extended-A"](Sr)||at["Arabic Presentation Forms-A"](Sr)||at["Arabic Presentation Forms-B"](Sr))return!1;var Sr;return!0}(rr)?Ut:0,cr=E.get("text-anchor").evaluate(Le,{},_),Yt=E.get("text-variable-anchor");if(!Yt){var wr=E.get("text-radial-offset").evaluate(Le,{},_);pt=wr?zd(cr,[24*wr,If]):E.get("text-offset").evaluate(Le,{},_).map(function(gr){return 24*gr})}var Ct=ne?"center":E.get("text-justify").evaluate(Le,{},_),Pr=E.get("symbol-placement"),_i=Pr==="point"?24*E.get("text-max-width").evaluate(Le,{},_):0,Fi=function(){e.allowVerticalPlacement&&Al(rr)&&(ct.vertical=Xu(Pt,t,i,p,Fe,_i,ee,cr,"left",_t,pt,ia.vertical,!0,Pr,nt,$e))};if(!ne&&Yt){for(var Ci=Ct==="auto"?Yt.map(function(gr){return Af(gr)}):[Ct],vi=!1,Ni=0;Ni<Ci.length;Ni++){var xn=Ci[Ni];if(!ct.horizontal[xn])if(vi)ct.horizontal[xn]=ct.horizontal[0];else{var wn=Xu(Pt,t,i,p,Fe,_i,ee,"center",xn,_t,pt,ia.horizontal,!1,Pr,nt,$e);wn&&(ct.horizontal[xn]=wn,vi=wn.positionedLines.length===1)}}Fi()}else{Ct==="auto"&&(Ct=Af(cr));var wo=Xu(Pt,t,i,p,Fe,_i,ee,cr,Ct,_t,pt,ia.horizontal,!1,Pr,nt,$e);wo&&(ct.horizontal[Ct]=wo),Fi(),Al(rr)&&ne&&pe&&(ct.vertical=Xu(Pt,t,i,p,Fe,_i,ee,cr,Ct,_t,pt,ia.vertical,!1,Pr,nt,$e))}}var On=void 0,So=!1;if(Le.icon&&Le.icon.name){var Ki=l[Le.icon.name];Ki&&(On=function(gr,Yr,Nr){var Sr=kf(Nr),Uo=Yr[0]-gr.displaySize[0]*Sr.horizontalAlign,no=Yr[1]-gr.displaySize[1]*Sr.verticalAlign;return{image:gr,top:no,bottom:no+gr.displaySize[1],left:Uo,right:Uo+gr.displaySize[0]}}(p[Le.icon.name],E.get("icon-offset").evaluate(Le,{},_),E.get("icon-anchor").evaluate(Le,{},_)),So=Ki.sdf,e.sdfIcons===void 0?e.sdfIcons=Ki.sdf:e.sdfIcons!==Ki.sdf&&mt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ki.pixelRatio!==e.pixelRatio||E.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Fn=Cd(ct.horizontal)||ct.vertical;e.iconsInText=!!Fn&&Fn.iconsInText,(Fn||On)&&function(gr,Yr,Nr,Sr,Uo,no,fi,tn,oo,Cr,fl){var Fa=no.textMaxSize.evaluate(Yr,{});Fa===void 0&&(Fa=fi);var dl,Xi=gr.layers[0].layout,ml=Xi.get("icon-offset").evaluate(Yr,{},fl),Ds=Cd(Nr.horizontal),xc=fi/24,Qu=gr.tilePixelRatio*xc,wc=gr.tilePixelRatio*Fa/24,ql=gr.tilePixelRatio*tn,Sc=gr.tilePixelRatio*Xi.get("symbol-spacing"),Pp=Xi.get("text-padding")*gr.tilePixelRatio,Ec=Xi.get("icon-padding")*gr.tilePixelRatio,Sh=Xi.get("text-max-angle")/180*Math.PI,Cp=Xi.get("text-rotation-alignment")==="map"&&Xi.get("symbol-placement")!=="point",Mp=Xi.get("icon-rotation-alignment")==="map"&&Xi.get("symbol-placement")!=="point",Zl=Xi.get("symbol-placement"),Eh=Sc/2,kc=Xi.get("icon-text-fit");Sr&&kc!=="none"&&(gr.allowVerticalPlacement&&Nr.vertical&&(dl=vd(Sr,Nr.vertical,kc,Xi.get("icon-text-fit-padding"),ml,xc)),Ds&&(Sr=vd(Sr,Ds,kc,Xi.get("icon-text-fit-padding"),ml,xc)));var wu=function(Lg,Mh){Mh.x<0||Mh.x>=8192||Mh.y<0||Mh.y>=8192||function(Hi,Hs,Rg,Su,Of,Hd,Fp,yl,Np,Dh,Vp,Up,Ff,Wd,Lh,Jd,Yd,Qd,$d,em,Na,jp,tm,gl,Bg){var rm,ec,Pc,Cc,Mc,Dc=Hi.addToLineVertexArray(Hs,Rg),im=0,nm=0,om=0,am=0,Nf=-1,Vf=-1,Gl={},sm=$(""),Uf=0,jf=0;if(yl._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Uf=(rm=yl.layout.get("text-offset").evaluate(Na,{},gl).map(function(Bh){return 24*Bh}))[0],jf=rm[1]):(Uf=24*yl.layout.get("text-radial-offset").evaluate(Na,{},gl),jf=If),Hi.allowVerticalPlacement&&Su.vertical){var lm=yl.layout.get("text-rotate").evaluate(Na,{},gl)+90;Cc=new kp(Np,Hs,Dh,Vp,Up,Su.vertical,Ff,Wd,Lh,lm),Fp&&(Mc=new kp(Np,Hs,Dh,Vp,Up,Fp,Yd,Qd,Lh,lm))}if(Of){var qf=yl.layout.get("icon-rotate").evaluate(Na,{}),um=yl.layout.get("icon-text-fit")!=="none",cm=Id(Of,qf,tm,um),Zf=Fp?Id(Fp,qf,tm,um):void 0;Pc=new kp(Np,Hs,Dh,Vp,Up,Of,Yd,Qd,!1,qf),im=4*cm.length;var hm=Hi.iconSizeData,Rh=null;hm.kind==="source"?(Rh=[128*yl.layout.get("icon-size").evaluate(Na,{})])[0]>32640&&mt(Hi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):hm.kind==="composite"&&((Rh=[128*jp.compositeIconSizes[0].evaluate(Na,{},gl),128*jp.compositeIconSizes[1].evaluate(Na,{},gl)])[0]>32640||Rh[1]>32640)&&mt(Hi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Hi.addSymbols(Hi.icon,cm,Rh,em,$d,Na,!1,Hs,Dc.lineStartIndex,Dc.lineLength,-1,gl),Nf=Hi.icon.placedSymbolArray.length-1,Zf&&(nm=4*Zf.length,Hi.addSymbols(Hi.icon,Zf,Rh,em,$d,Na,ia.vertical,Hs,Dc.lineStartIndex,Dc.lineLength,-1,gl),Vf=Hi.icon.placedSymbolArray.length-1)}for(var pm in Su.horizontal){var qp=Su.horizontal[pm];if(!ec){sm=$(qp.text);var Og=yl.layout.get("text-rotate").evaluate(Na,{},gl);ec=new kp(Np,Hs,Dh,Vp,Up,qp,Ff,Wd,Lh,Og)}var fm=qp.positionedLines.length===1;if(om+=Pd(Hi,Hs,qp,Hd,yl,Lh,Na,Jd,Dc,Su.vertical?ia.horizontal:ia.horizontalOnly,fm?Object.keys(Su.horizontal):[pm],Gl,Nf,jp,gl),fm)break}Su.vertical&&(am+=Pd(Hi,Hs,Su.vertical,Hd,yl,Lh,Na,Jd,Dc,ia.vertical,["vertical"],Gl,Vf,jp,gl));var Fg=ec?ec.boxStartIndex:Hi.collisionBoxArray.length,Ng=ec?ec.boxEndIndex:Hi.collisionBoxArray.length,Vg=Cc?Cc.boxStartIndex:Hi.collisionBoxArray.length,Ug=Cc?Cc.boxEndIndex:Hi.collisionBoxArray.length,jg=Pc?Pc.boxStartIndex:Hi.collisionBoxArray.length,qg=Pc?Pc.boxEndIndex:Hi.collisionBoxArray.length,Zg=Mc?Mc.boxStartIndex:Hi.collisionBoxArray.length,Gg=Mc?Mc.boxEndIndex:Hi.collisionBoxArray.length,_l=-1,Zp=function(Bh,mm){return Bh&&Bh.circleDiameter?Math.max(Bh.circleDiameter,mm):mm};_l=Zp(ec,_l),_l=Zp(Cc,_l),_l=Zp(Pc,_l);var dm=(_l=Zp(Mc,_l))>-1?1:0;dm&&(_l*=Bg/24),Hi.glyphOffsetArray.length>=Zr.MAX_GLYPHS&&mt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Na.sortKey!==void 0&&Hi.addToSortKeyRanges(Hi.symbolInstances.length,Na.sortKey),Hi.symbolInstances.emplaceBack(Hs.x,Hs.y,Gl.right>=0?Gl.right:-1,Gl.center>=0?Gl.center:-1,Gl.left>=0?Gl.left:-1,Gl.vertical||-1,Nf,Vf,sm,Fg,Ng,Vg,Ug,jg,qg,Zg,Gg,Dh,om,am,im,nm,dm,0,Ff,Uf,jf,_l)}(gr,Mh,Lg,Nr,Sr,Uo,dl,gr.layers[0],gr.collisionBoxArray,Yr.index,Yr.sourceLayerIndex,gr.index,Qu,Pp,Cp,oo,ql,Ec,Mp,ml,Yr,no,Cr,fl,fi)};if(Zl==="line")for(var Tc=0,Dp=Td(Yr.geometry,0,0,8192,8192);Tc<Dp.length;Tc+=1)for(var Lp=Dp[Tc],kh=0,Th=gg(Lp,Sc,Sh,Nr.vertical||Ds,Sr,24,wc,gr.overscaling,8192);kh<Th.length;kh+=1){var Rp=Th[kh];Ds&&xg(gr,Ds.text,Eh,Rp)||wu(Lp,Rp)}else if(Zl==="line-center")for(var Ih=0,Ah=Yr.geometry;Ih<Ah.length;Ih+=1){var zh=Ah[Ih];if(zh.length>1){var Bp=yg(zh,Sh,Nr.vertical||Ds,Sr,24,wc);Bp&&wu(zh,Bp)}}else if(Yr.type==="Polygon")for(var Ic=0,Op=$c(Yr.geometry,0);Ic<Op.length;Ic+=1){var Ac=Op[Ic],Ph=vg(Ac,16);wu(Ac[0],new dc(Ph.x,Ph.y,0))}else if(Yr.type==="LineString")for(var $u=0,Ch=Yr.geometry;$u<Ch.length;$u+=1){var zc=Ch[$u];wu(zc,new dc(zc[0].x,zc[0].y,0))}else if(Yr.type==="Point")for(var Lf=0,Kd=Yr.geometry;Lf<Kd.length;Lf+=1)for(var Rf=0,Xd=Kd[Lf];Rf<Xd.length;Rf+=1){var Bf=Xd[Rf];wu([Bf],new dc(Bf.x,Bf.y,0))}}(e,Le,ct,On,l,z,nt,It,pt,So,_)},Ee=0,Ae=e.features;Ee<Ae.length;Ee+=1)ge();d&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,l,p){var d,_=1/Math.tan(t/2);return e[0]=_/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=_,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,p!=null&&p!==1/0?(e[10]=(p+l)*(d=1/(l-p)),e[14]=2*p*l*d):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var p=t[l];p in e&&(i[p]=e[p])}return i},a.plugin=cn,a.polygonIntersectsPolygon=en,a.postMapLoadEvent=Nn,a.postTurnstileEvent=Ka,a.potpack=bh,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=lt,a.registerForPluginStateChange=function(e){return e({pluginStatus:Gn,pluginURL:Kn}),Da.on("pluginStateChange",e),e},a.renderColorRamp=ys,a.rotate=function(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3],E=Math.sin(i),T=Math.cos(i);return e[0]=l*T+d*E,e[1]=p*T+_*E,e[2]=l*-E+d*T,e[3]=p*-E+_*T,e},a.rotateX=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),d=t[4],_=t[5],E=t[6],T=t[7],z=t[8],C=t[9],D=t[10],V=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=d*p+z*l,e[5]=_*p+C*l,e[6]=E*p+D*l,e[7]=T*p+V*l,e[8]=z*p-d*l,e[9]=C*p-_*l,e[10]=D*p-E*l,e[11]=V*p-T*l,e},a.rotateZ=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),d=t[0],_=t[1],E=t[2],T=t[3],z=t[4],C=t[5],D=t[6],V=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=d*p+z*l,e[1]=_*p+C*l,e[2]=E*p+D*l,e[3]=T*p+V*l,e[4]=z*p-d*l,e[5]=C*p-_*l,e[6]=D*p-E*l,e[7]=V*p-T*l,e},a.scale=function(e,t,i){var l=i[0],p=i[1],d=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*p,e[5]=t[5]*p,e[6]=t[6]*p,e[7]=t[7]*p,e[8]=t[8]*d,e[9]=t[9]*d,e[10]=t[10]*d,e[11]=t[11]*d,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){kn=e,na=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),Gn==="deferred"||Gn==="loading"||Gn==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Kn=ui.resolveURL(e),Gn="deferred",$s=t,Ps(),i||No()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=Z,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=mg,a.transformMat3=function(e,t,i){var l=t[0],p=t[1],d=t[2];return e[0]=l*i[0]+p*i[3]+d*i[6],e[1]=l*i[1]+p*i[4]+d*i[7],e[2]=l*i[2]+p*i[5]+d*i[8],e},a.transformMat4=Cl,a.translate=function(e,t,i){var l,p,d,_,E,T,z,C,D,V,X,ee,ne=i[0],pe=i[1],ae=i[2];return t===e?(e[12]=t[0]*ne+t[4]*pe+t[8]*ae+t[12],e[13]=t[1]*ne+t[5]*pe+t[9]*ae+t[13],e[14]=t[2]*ne+t[6]*pe+t[10]*ae+t[14],e[15]=t[3]*ne+t[7]*pe+t[11]*ae+t[15]):(p=t[1],d=t[2],_=t[3],E=t[4],T=t[5],z=t[6],C=t[7],D=t[8],V=t[9],X=t[10],ee=t[11],e[0]=l=t[0],e[1]=p,e[2]=d,e[3]=_,e[4]=E,e[5]=T,e[6]=z,e[7]=C,e[8]=D,e[9]=V,e[10]=X,e[11]=ee,e[12]=l*ne+E*pe+D*ae+t[12],e[13]=p*ne+T*pe+V*ae+t[13],e[14]=d*ne+z*pe+X*ae+t[14],e[15]=_*ne+C*pe+ee*ae+t[15]),e},a.triggerPluginCompletionEvent=Ru,a.uniqueId=kt,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=qc,a.validateStyle=ua,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=Bl,a.version="1.13.2",a.warnOnce=mt,a.webpSupported=sr,a.window=j,a.wrap=He}),x(["./shared"],function(a){function A(M){var F=typeof M;if(F==="number"||F==="boolean"||F==="string"||M==null)return JSON.stringify(M);if(Array.isArray(M)){for(var q="[",Y=0,re=M;Y<re.length;Y+=1)q+=A(re[Y])+",";return q+"]"}for(var ue=Object.keys(M).sort(),me="{",Z=0;Z<ue.length;Z++)me+=JSON.stringify(ue[Z])+":"+A(M[ue[Z]])+",";return me+"}"}function I(M){for(var F="",q=0,Y=a.refProperties;q<Y.length;q+=1)F+="/"+A(M[Y[q]]);return F}var R=function(M){this.keyCache={},M&&this.replace(M)};R.prototype.replace=function(M){this._layerConfigs={},this._layers={},this.update(M,[])},R.prototype.update=function(M,F){for(var q=this,Y=0,re=M;Y<re.length;Y+=1){var ue=re[Y];this._layerConfigs[ue.id]=ue;var me=this._layers[ue.id]=a.createStyleLayer(ue);me._featureFilter=a.featureFilter(me.filter),this.keyCache[ue.id]&&delete this.keyCache[ue.id]}for(var Z=0,ie=F;Z<ie.length;Z+=1){var be=ie[Z];delete this.keyCache[be],delete this._layerConfigs[be],delete this._layers[be]}this.familiesBySource={};for(var Ve=0,Xe=function(rt,Qe){for(var Dt={},it=0;it<rt.length;it++){var $t=Qe&&Qe[rt[it].id]||I(rt[it]);Qe&&(Qe[rt[it].id]=$t);var lr=Dt[$t];lr||(lr=Dt[$t]=[]),lr.push(rt[it])}var Wt=[];for(var ir in Dt)Wt.push(Dt[ir]);return Wt}(a.values(this._layerConfigs),this.keyCache);Ve<Xe.length;Ve+=1){var ze=Xe[Ve].map(function(rt){return q._layers[rt.id]}),je=ze[0];if(je.visibility!=="none"){var ht=je.source||"",st=this.familiesBySource[ht];st||(st=this.familiesBySource[ht]={});var Re=je.sourceLayer||"_geojsonTileLayer",ot=st[Re];ot||(ot=st[Re]=[]),ot.push(ze)}}};var B=function(M){var F={},q=[];for(var Y in M){var re=M[Y],ue=F[Y]={};for(var me in re){var Z=re[+me];if(Z&&Z.bitmap.width!==0&&Z.bitmap.height!==0){var ie={x:0,y:0,w:Z.bitmap.width+2,h:Z.bitmap.height+2};q.push(ie),ue[me]={rect:ie,metrics:Z.metrics}}}}var be=a.potpack(q),Ve=new a.AlphaImage({width:be.w||1,height:be.h||1});for(var Xe in M){var ze=M[Xe];for(var je in ze){var ht=ze[+je];if(ht&&ht.bitmap.width!==0&&ht.bitmap.height!==0){var st=F[Xe][je].rect;a.AlphaImage.copy(ht.bitmap,Ve,{x:0,y:0},{x:st.x+1,y:st.y+1},ht.bitmap)}}}this.image=Ve,this.positions=F};a.register("GlyphAtlas",B);var K=function(M){this.tileID=new a.OverscaledTileID(M.tileID.overscaledZ,M.tileID.wrap,M.tileID.canonical.z,M.tileID.canonical.x,M.tileID.canonical.y),this.uid=M.uid,this.zoom=M.zoom,this.pixelRatio=M.pixelRatio,this.tileSize=M.tileSize,this.source=M.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=M.showCollisionBoxes,this.collectResourceTiming=!!M.collectResourceTiming,this.returnDependencies=!!M.returnDependencies,this.promoteId=M.promoteId};function j(M,F,q){for(var Y=new a.EvaluationParameters(F),re=0,ue=M;re<ue.length;re+=1)ue[re].recalculate(Y,q)}function H(M,F){var q=a.getArrayBuffer(M.request,function(Y,re,ue,me){Y?F(Y):re&&F(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(re)),rawData:re,cacheControl:ue,expires:me})});return function(){q.cancel(),F()}}K.prototype.parse=function(M,F,q,Y,re){var ue=this;this.status="parsing",this.data=M,this.collisionBoxArray=new a.CollisionBoxArray;var me=new a.DictionaryCoder(Object.keys(M.layers).sort()),Z=new a.FeatureIndex(this.tileID,this.promoteId);Z.bucketLayerIDs=[];var ie,be,Ve,Xe,ze={},je={featureIndex:Z,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},ht=F.familiesBySource[this.source];for(var st in ht){var Re=M.layers[st];if(Re){Re.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+st+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var ot=me.encode(st),rt=[],Qe=0;Qe<Re.length;Qe++){var Dt=Re.feature(Qe),it=Z.getId(Dt,st);rt.push({feature:Dt,id:it,index:Qe,sourceLayerIndex:ot})}for(var $t=0,lr=ht[st];$t<lr.length;$t+=1){var Wt=lr[$t],ir=Wt[0];ir.minzoom&&this.zoom<Math.floor(ir.minzoom)||ir.maxzoom&&this.zoom>=ir.maxzoom||ir.visibility!=="none"&&(j(Wt,this.zoom,q),(ze[ir.id]=ir.createBucket({index:Z.bucketLayerIDs.length,layers:Wt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ot,sourceID:this.source})).populate(rt,je,this.tileID.canonical),Z.bucketLayerIDs.push(Wt.map(function(pr){return pr.id})))}}}var Xt=a.mapObject(je.glyphDependencies,function(pr){return Object.keys(pr).map(Number)});Object.keys(Xt).length?Y.send("getGlyphs",{uid:this.uid,stacks:Xt},function(pr,Jt){ie||(ie=pr,be=Jt,Ar.call(ue))}):be={};var ti=Object.keys(je.iconDependencies);ti.length?Y.send("getImages",{icons:ti,source:this.source,tileID:this.tileID,type:"icons"},function(pr,Jt){ie||(ie=pr,Ve=Jt,Ar.call(ue))}):Ve={};var hr=Object.keys(je.patternDependencies);function Ar(){if(ie)return re(ie);if(be&&Ve&&Xe){var pr=new B(be),Jt=new a.ImageAtlas(Ve,Xe);for(var nr in ze){var ri=ze[nr];ri instanceof a.SymbolBucket?(j(ri.layers,this.zoom,q),a.performSymbolLayout(ri,be,pr.positions,Ve,Jt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):ri.hasPattern&&(ri instanceof a.LineBucket||ri instanceof a.FillBucket||ri instanceof a.FillExtrusionBucket)&&(j(ri.layers,this.zoom,q),ri.addFeatures(je,this.tileID.canonical,Jt.patternPositions))}this.status="done",re(null,{buckets:a.values(ze).filter(function(mn){return!mn.isEmpty()}),featureIndex:Z,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:pr.image,imageAtlas:Jt,glyphMap:this.returnDependencies?be:null,iconMap:this.returnDependencies?Ve:null,glyphPositions:this.returnDependencies?pr.positions:null})}}hr.length?Y.send("getImages",{icons:hr,source:this.source,tileID:this.tileID,type:"patterns"},function(pr,Jt){ie||(ie=pr,Xe=Jt,Ar.call(ue))}):Xe={},Ar.call(this)};var de=function(M,F,q,Y){this.actor=M,this.layerIndex=F,this.availableImages=q,this.loadVectorData=Y||H,this.loading={},this.loaded={}};de.prototype.loadTile=function(M,F){var q=this,Y=M.uid;this.loading||(this.loading={});var re=!!(M&&M.request&&M.request.collectResourceTiming)&&new a.RequestPerformance(M.request),ue=this.loading[Y]=new K(M);ue.abort=this.loadVectorData(M,function(me,Z){if(delete q.loading[Y],me||!Z)return ue.status="done",q.loaded[Y]=ue,F(me);var ie=Z.rawData,be={};Z.expires&&(be.expires=Z.expires),Z.cacheControl&&(be.cacheControl=Z.cacheControl);var Ve={};if(re){var Xe=re.finish();Xe&&(Ve.resourceTiming=JSON.parse(JSON.stringify(Xe)))}ue.vectorTile=Z.vectorTile,ue.parse(Z.vectorTile,q.layerIndex,q.availableImages,q.actor,function(ze,je){if(ze||!je)return F(ze);F(null,a.extend({rawTileData:ie.slice(0)},je,be,Ve))}),q.loaded=q.loaded||{},q.loaded[Y]=ue})},de.prototype.reloadTile=function(M,F){var q=this,Y=this.loaded,re=M.uid,ue=this;if(Y&&Y[re]){var me=Y[re];me.showCollisionBoxes=M.showCollisionBoxes;var Z=function(ie,be){var Ve=me.reloadCallback;Ve&&(delete me.reloadCallback,me.parse(me.vectorTile,ue.layerIndex,q.availableImages,ue.actor,Ve)),F(ie,be)};me.status==="parsing"?me.reloadCallback=Z:me.status==="done"&&(me.vectorTile?me.parse(me.vectorTile,this.layerIndex,this.availableImages,this.actor,Z):Z())}},de.prototype.abortTile=function(M,F){var q=this.loading,Y=M.uid;q&&q[Y]&&q[Y].abort&&(q[Y].abort(),delete q[Y]),F()},de.prototype.removeTile=function(M,F){var q=this.loaded,Y=M.uid;q&&q[Y]&&delete q[Y],F()};var Me=a.window.ImageBitmap,Se=function(){this.loaded={}};function He(M,F){if(M.length!==0){Ue(M[0],F);for(var q=1;q<M.length;q++)Ue(M[q],!F)}}function Ue(M,F){for(var q=0,Y=0,re=M.length,ue=re-1;Y<re;ue=Y++)q+=(M[Y][0]-M[ue][0])*(M[ue][1]+M[Y][1]);q>=0!=!!F&&M.reverse()}Se.prototype.loadTile=function(M,F){var q=M.uid,Y=M.encoding,re=M.rawImageData,ue=Me&&re instanceof Me?this.getImageData(re):re,me=new a.DEMData(q,ue,Y);this.loaded=this.loaded||{},this.loaded[q]=me,F(null,me)},Se.prototype.getImageData=function(M){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(M.width,M.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=M.width,this.offscreenCanvas.height=M.height,this.offscreenCanvasContext.drawImage(M,0,0,M.width,M.height);var F=this.offscreenCanvasContext.getImageData(-1,-1,M.width+2,M.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:F.width,height:F.height},F.data)},Se.prototype.removeTile=function(M){var F=this.loaded,q=M.uid;F&&F[q]&&delete F[q]};var Rt=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,kt=function(M){this._feature=M,this.extent=a.EXTENT,this.type=M.type,this.properties=M.tags,"id"in M&&!isNaN(M.id)&&(this.id=parseInt(M.id,10))};kt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var M=[],F=0,q=this._feature.geometry;F<q.length;F+=1){var Y=q[F];M.push([new a.Point$1(Y[0],Y[1])])}return M}for(var re=[],ue=0,me=this._feature.geometry;ue<me.length;ue+=1){for(var Z=[],ie=0,be=me[ue];ie<be.length;ie+=1){var Ve=be[ie];Z.push(new a.Point$1(Ve[0],Ve[1]))}re.push(Z)}return re},kt.prototype.toGeoJSON=function(M,F,q){return Rt.call(this,M,F,q)};var ut=function(M){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=M.length,this._features=M};ut.prototype.feature=function(M){return new kt(this._features[M])};var We=a.vectorTile.VectorTileFeature,tr=Gt;function Gt(M,F){this.options=F||{},this.features=M,this.length=M.length}function St(M,F){this.id=typeof M.id=="number"?M.id:void 0,this.type=M.type,this.rawGeometry=M.type===1?[M.geometry]:M.geometry,this.properties=M.tags,this.extent=F||4096}Gt.prototype.feature=function(M){return new St(this.features[M],this.options.extent)},St.prototype.loadGeometry=function(){var M=this.rawGeometry;this.geometry=[];for(var F=0;F<M.length;F++){for(var q=M[F],Y=[],re=0;re<q.length;re++)Y.push(new a.Point$1(q[re][0],q[re][1]));this.geometry.push(Y)}return this.geometry},St.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var M=this.geometry,F=1/0,q=-1/0,Y=1/0,re=-1/0,ue=0;ue<M.length;ue++)for(var me=M[ue],Z=0;Z<me.length;Z++){var ie=me[Z];F=Math.min(F,ie.x),q=Math.max(q,ie.x),Y=Math.min(Y,ie.y),re=Math.max(re,ie.y)}return[F,Y,q,re]},St.prototype.toGeoJSON=We.prototype.toGeoJSON;var jt=Lt,Ke=tr;function Lt(M){var F=new a.pbf;return function(q,Y){for(var re in q.layers)Y.writeMessage(3,mt,q.layers[re])}(M,F),F.finish()}function mt(M,F){var q;F.writeVarintField(15,M.version||1),F.writeStringField(1,M.name||""),F.writeVarintField(5,M.extent||4096);var Y={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<M.length;q++)Y.feature=M.feature(q),F.writeMessage(2,yt,Y);var re=Y.keys;for(q=0;q<re.length;q++)F.writeStringField(3,re[q]);var ue=Y.values;for(q=0;q<ue.length;q++)F.writeMessage(4,Kt,ue[q])}function yt(M,F){var q=M.feature;q.id!==void 0&&F.writeVarintField(1,q.id),F.writeMessage(2,De,M),F.writeVarintField(3,q.type),F.writeMessage(4,fr,q)}function De(M,F){var q=M.feature,Y=M.keys,re=M.values,ue=M.keycache,me=M.valuecache;for(var Z in q.properties){var ie=ue[Z];ie===void 0&&(Y.push(Z),ue[Z]=ie=Y.length-1),F.writeVarint(ie);var be=q.properties[Z],Ve=typeof be;Ve!=="string"&&Ve!=="boolean"&&Ve!=="number"&&(be=JSON.stringify(be));var Xe=Ve+":"+be,ze=me[Xe];ze===void 0&&(re.push(be),me[Xe]=ze=re.length-1),F.writeVarint(ze)}}function Ne(M,F){return(F<<3)+(7&M)}function Tt(M){return M<<1^M>>31}function fr(M,F){for(var q=M.loadGeometry(),Y=M.type,re=0,ue=0,me=q.length,Z=0;Z<me;Z++){var ie=q[Z],be=1;Y===1&&(be=ie.length),F.writeVarint(Ne(1,be));for(var Ve=Y===3?ie.length-1:ie.length,Xe=0;Xe<Ve;Xe++){Xe===1&&Y!==1&&F.writeVarint(Ne(2,Ve-1));var ze=ie[Xe].x-re,je=ie[Xe].y-ue;F.writeVarint(Tt(ze)),F.writeVarint(Tt(je)),re+=ze,ue+=je}Y===3&&F.writeVarint(Ne(7,1))}}function Kt(M,F){var q=typeof M;q==="string"?F.writeStringField(1,M):q==="boolean"?F.writeBooleanField(7,M):q==="number"&&(M%1!=0?F.writeDoubleField(3,M):M<0?F.writeSVarintField(6,M):F.writeVarintField(5,M))}function Ge(M,F,q,Y){et(M,q,Y),et(F,2*q,2*Y),et(F,2*q+1,2*Y+1)}function et(M,F,q){var Y=M[F];M[F]=M[q],M[q]=Y}function ar(M,F,q,Y){var re=M-q,ue=F-Y;return re*re+ue*ue}jt.fromVectorTileJs=Lt,jt.fromGeojsonVt=function(M,F){F=F||{};var q={};for(var Y in M)q[Y]=new tr(M[Y].features,F),q[Y].name=Y,q[Y].version=F.version,q[Y].extent=F.extent;return Lt({layers:q})},jt.GeoJSONWrapper=Ke;var vr=function(M){return M[0]},di=function(M){return M[1]},Qr=function(M,F,q,Y,re){F===void 0&&(F=vr),q===void 0&&(q=di),Y===void 0&&(Y=64),re===void 0&&(re=Float64Array),this.nodeSize=Y,this.points=M;for(var ue=M.length<65536?Uint16Array:Uint32Array,me=this.ids=new ue(M.length),Z=this.coords=new re(2*M.length),ie=0;ie<M.length;ie++)me[ie]=ie,Z[2*ie]=F(M[ie]),Z[2*ie+1]=q(M[ie]);(function be(Ve,Xe,ze,je,ht,st){if(!(ht-je<=ze)){var Re=je+ht>>1;(function ot(rt,Qe,Dt,it,$t,lr){for(;$t>it;){if($t-it>600){var Wt=$t-it+1,ir=Dt-it+1,Xt=Math.log(Wt),ti=.5*Math.exp(2*Xt/3),hr=.5*Math.sqrt(Xt*ti*(Wt-ti)/Wt)*(ir-Wt/2<0?-1:1);ot(rt,Qe,Dt,Math.max(it,Math.floor(Dt-ir*ti/Wt+hr)),Math.min($t,Math.floor(Dt+(Wt-ir)*ti/Wt+hr)),lr)}var Ar=Qe[2*Dt+lr],pr=it,Jt=$t;for(Ge(rt,Qe,it,Dt),Qe[2*$t+lr]>Ar&&Ge(rt,Qe,it,$t);pr<Jt;){for(Ge(rt,Qe,pr,Jt),pr++,Jt--;Qe[2*pr+lr]<Ar;)pr++;for(;Qe[2*Jt+lr]>Ar;)Jt--}Qe[2*it+lr]===Ar?Ge(rt,Qe,it,Jt):Ge(rt,Qe,++Jt,$t),Jt<=Dt&&(it=Jt+1),Dt<=Jt&&($t=Jt-1)}})(Ve,Xe,Re,je,ht,st%2),be(Ve,Xe,ze,je,Re-1,st+1),be(Ve,Xe,ze,Re+1,ht,st+1)}})(me,Z,Y,0,me.length-1,0)};Qr.prototype.range=function(M,F,q,Y){return function(re,ue,me,Z,ie,be,Ve){for(var Xe,ze,je=[0,re.length-1,0],ht=[];je.length;){var st=je.pop(),Re=je.pop(),ot=je.pop();if(Re-ot<=Ve)for(var rt=ot;rt<=Re;rt++)ze=ue[2*rt+1],(Xe=ue[2*rt])>=me&&Xe<=ie&&ze>=Z&&ze<=be&&ht.push(re[rt]);else{var Qe=Math.floor((ot+Re)/2);ze=ue[2*Qe+1],(Xe=ue[2*Qe])>=me&&Xe<=ie&&ze>=Z&&ze<=be&&ht.push(re[Qe]);var Dt=(st+1)%2;(st===0?me<=Xe:Z<=ze)&&(je.push(ot),je.push(Qe-1),je.push(Dt)),(st===0?ie>=Xe:be>=ze)&&(je.push(Qe+1),je.push(Re),je.push(Dt))}}return ht}(this.ids,this.coords,M,F,q,Y,this.nodeSize)},Qr.prototype.within=function(M,F,q){return function(Y,re,ue,me,Z,ie){for(var be=[0,Y.length-1,0],Ve=[],Xe=Z*Z;be.length;){var ze=be.pop(),je=be.pop(),ht=be.pop();if(je-ht<=ie)for(var st=ht;st<=je;st++)ar(re[2*st],re[2*st+1],ue,me)<=Xe&&Ve.push(Y[st]);else{var Re=Math.floor((ht+je)/2),ot=re[2*Re],rt=re[2*Re+1];ar(ot,rt,ue,me)<=Xe&&Ve.push(Y[Re]);var Qe=(ze+1)%2;(ze===0?ue-Z<=ot:me-Z<=rt)&&(be.push(ht),be.push(Re-1),be.push(Qe)),(ze===0?ue+Z>=ot:me+Z>=rt)&&(be.push(Re+1),be.push(je),be.push(Qe))}}return Ve}(this.ids,this.coords,M,F,q,this.nodeSize)};var Vr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(M){return M}},Ur=function(M){this.options=nn(Object.create(Vr),M),this.trees=new Array(this.options.maxZoom+1)};function ui(M,F,q,Y,re){return{x:M,y:F,zoom:1/0,id:q,parentId:-1,numPoints:Y,properties:re}}function xt(M,F){var q=M.geometry.coordinates,Y=q[1];return{x:Ht(q[0]),y:Nt(Y),zoom:1/0,index:F,parentId:-1}}function sr(M){return{type:"Feature",id:M.id,properties:Et(M),geometry:{type:"Point",coordinates:[(Y=M.x,360*(Y-.5)),(F=M.y,q=(180-360*F)*Math.PI/180,360*Math.atan(Math.exp(q))/Math.PI-90)]}};var F,q,Y}function Et(M){var F=M.numPoints,q=F>=1e4?Math.round(F/1e3)+"k":F>=1e3?Math.round(F/100)/10+"k":F;return nn(nn({},M.properties),{cluster:!0,cluster_id:M.id,point_count:F,point_count_abbreviated:q})}function Ht(M){return M/360+.5}function Nt(M){var F=Math.sin(M*Math.PI/180),q=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return q<0?0:q>1?1:q}function nn(M,F){for(var q in F)M[q]=F[q];return M}function ii(M){return M.x}function dr(M){return M.y}function ni(M,F,q,Y,re,ue){var me=re-q,Z=ue-Y;if(me!==0||Z!==0){var ie=((M-q)*me+(F-Y)*Z)/(me*me+Z*Z);ie>1?(q=re,Y=ue):ie>0&&(q+=me*ie,Y+=Z*ie)}return(me=M-q)*me+(Z=F-Y)*Z}function $r(M,F,q,Y){var re={id:M===void 0?null:M,type:F,geometry:q,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ue){var me=ue.geometry,Z=ue.type;if(Z==="Point"||Z==="MultiPoint"||Z==="LineString")on(ue,me);else if(Z==="Polygon"||Z==="MultiLineString")for(var ie=0;ie<me.length;ie++)on(ue,me[ie]);else if(Z==="MultiPolygon")for(ie=0;ie<me.length;ie++)for(var be=0;be<me[ie].length;be++)on(ue,me[ie][be])}(re),re}function on(M,F){for(var q=0;q<F.length;q+=3)M.minX=Math.min(M.minX,F[q]),M.minY=Math.min(M.minY,F[q+1]),M.maxX=Math.max(M.maxX,F[q]),M.maxY=Math.max(M.maxY,F[q+1])}function Vi(M,F,q,Y){if(F.geometry){var re=F.geometry.coordinates,ue=F.geometry.type,me=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),Z=[],ie=F.id;if(q.promoteId?ie=F.properties[q.promoteId]:q.generateId&&(ie=Y||0),ue==="Point")Sn(re,Z);else if(ue==="MultiPoint")for(var be=0;be<re.length;be++)Sn(re[be],Z);else if(ue==="LineString")$n(re,Z,me,!1);else if(ue==="MultiLineString"){if(q.lineMetrics){for(be=0;be<re.length;be++)$n(re[be],Z=[],me,!1),M.push($r(ie,"LineString",Z,F.properties));return}Ir(re,Z,me,!1)}else if(ue==="Polygon")Ir(re,Z,me,!0);else{if(ue!=="MultiPolygon"){if(ue==="GeometryCollection"){for(be=0;be<F.geometry.geometries.length;be++)Vi(M,{id:ie,geometry:F.geometry.geometries[be],properties:F.properties},q,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(be=0;be<re.length;be++){var Ve=[];Ir(re[be],Ve,me,!0),Z.push(Ve)}}M.push($r(ie,ue,Z,F.properties))}}function Sn(M,F){F.push(jr(M[0])),F.push(Mi(M[1])),F.push(0)}function $n(M,F,q,Y){for(var re,ue,me=0,Z=0;Z<M.length;Z++){var ie=jr(M[Z][0]),be=Mi(M[Z][1]);F.push(ie),F.push(be),F.push(0),Z>0&&(me+=Y?(re*be-ie*ue)/2:Math.sqrt(Math.pow(ie-re,2)+Math.pow(be-ue,2))),re=ie,ue=be}var Ve=F.length-3;F[2]=1,function Xe(ze,je,ht,st){for(var Re,ot=st,rt=ht-je>>1,Qe=ht-je,Dt=ze[je],it=ze[je+1],$t=ze[ht],lr=ze[ht+1],Wt=je+3;Wt<ht;Wt+=3){var ir=ni(ze[Wt],ze[Wt+1],Dt,it,$t,lr);if(ir>ot)Re=Wt,ot=ir;else if(ir===ot){var Xt=Math.abs(Wt-rt);Xt<Qe&&(Re=Wt,Qe=Xt)}}ot>st&&(Re-je>3&&Xe(ze,je,Re,st),ze[Re+2]=ot,ht-Re>3&&Xe(ze,Re,ht,st))}(F,0,Ve,q),F[Ve+2]=1,F.size=Math.abs(me),F.start=0,F.end=F.size}function Ir(M,F,q,Y){for(var re=0;re<M.length;re++){var ue=[];$n(M[re],ue,q,Y),F.push(ue)}}function jr(M){return M/360+.5}function Mi(M){var F=Math.sin(M*Math.PI/180),q=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return q<0?0:q>1?1:q}function Wi(M,F,q,Y,re,ue,me,Z){if(Y/=F,ue>=(q/=F)&&me<Y)return M;if(me<q||ue>=Y)return null;for(var ie=[],be=0;be<M.length;be++){var Ve=M[be],Xe=Ve.geometry,ze=Ve.type,je=re===0?Ve.minX:Ve.minY,ht=re===0?Ve.maxX:Ve.maxY;if(je>=q&&ht<Y)ie.push(Ve);else if(!(ht<q||je>=Y)){var st=[];if(ze==="Point"||ze==="MultiPoint")En(Xe,st,q,Y,re);else if(ze==="LineString")Ka(Xe,st,q,Y,re,!1,Z.lineMetrics);else if(ze==="MultiLineString")Nn(Xe,st,q,Y,re,!1);else if(ze==="Polygon")Nn(Xe,st,q,Y,re,!0);else if(ze==="MultiPolygon")for(var Re=0;Re<Xe.length;Re++){var ot=[];Nn(Xe[Re],ot,q,Y,re,!0),ot.length&&st.push(ot)}if(st.length){if(Z.lineMetrics&&ze==="LineString"){for(Re=0;Re<st.length;Re++)ie.push($r(Ve.id,ze,st[Re],Ve.tags));continue}ze!=="LineString"&&ze!=="MultiLineString"||(st.length===1?(ze="LineString",st=st[0]):ze="MultiLineString"),ze!=="Point"&&ze!=="MultiPoint"||(ze=st.length===3?"Point":"MultiPoint"),ie.push($r(Ve.id,ze,st,Ve.tags))}}}return ie.length?ie:null}function En(M,F,q,Y,re){for(var ue=0;ue<M.length;ue+=3){var me=M[ue+re];me>=q&&me<=Y&&(F.push(M[ue]),F.push(M[ue+1]),F.push(M[ue+2]))}}function Ka(M,F,q,Y,re,ue,me){for(var Z,ie,be=qo(M),Ve=re===0?na:Tn,Xe=M.start,ze=0;ze<M.length-3;ze+=3){var je=M[ze],ht=M[ze+1],st=M[ze+2],Re=M[ze+3],ot=M[ze+4],rt=re===0?je:ht,Qe=re===0?Re:ot,Dt=!1;me&&(Z=Math.sqrt(Math.pow(je-Re,2)+Math.pow(ht-ot,2))),rt<q?Qe>q&&(ie=Ve(be,je,ht,Re,ot,q),me&&(be.start=Xe+Z*ie)):rt>Y?Qe<Y&&(ie=Ve(be,je,ht,Re,ot,Y),me&&(be.start=Xe+Z*ie)):kn(be,je,ht,st),Qe<q&&rt>=q&&(ie=Ve(be,je,ht,Re,ot,q),Dt=!0),Qe>Y&&rt<=Y&&(ie=Ve(be,je,ht,Re,ot,Y),Dt=!0),!ue&&Dt&&(me&&(be.end=Xe+Z*ie),F.push(be),be=qo(M)),me&&(Xe+=Z)}var it=M.length-3;je=M[it],ht=M[it+1],st=M[it+2],(rt=re===0?je:ht)>=q&&rt<=Y&&kn(be,je,ht,st),it=be.length-3,ue&&it>=3&&(be[it]!==be[0]||be[it+1]!==be[1])&&kn(be,be[0],be[1],be[2]),be.length&&F.push(be)}function qo(M){var F=[];return F.size=M.size,F.start=M.start,F.end=M.end,F}function Nn(M,F,q,Y,re,ue){for(var me=0;me<M.length;me++)Ka(M[me],F,q,Y,re,ue,!1)}function kn(M,F,q,Y){M.push(F),M.push(q),M.push(Y)}function na(M,F,q,Y,re,ue){var me=(ue-F)/(Y-F);return M.push(ue),M.push(q+(re-q)*me),M.push(1),me}function Tn(M,F,q,Y,re,ue){var me=(ue-q)/(re-q);return M.push(F+(Y-F)*me),M.push(ue),M.push(1),me}function ao(M,F){for(var q=[],Y=0;Y<M.length;Y++){var re,ue=M[Y],me=ue.type;if(me==="Point"||me==="MultiPoint"||me==="LineString")re=so(ue.geometry,F);else if(me==="MultiLineString"||me==="Polygon"){re=[];for(var Z=0;Z<ue.geometry.length;Z++)re.push(so(ue.geometry[Z],F))}else if(me==="MultiPolygon")for(re=[],Z=0;Z<ue.geometry.length;Z++){for(var ie=[],be=0;be<ue.geometry[Z].length;be++)ie.push(so(ue.geometry[Z][be],F));re.push(ie)}q.push($r(ue.id,me,re,ue.tags))}return q}function so(M,F){var q=[];q.size=M.size,M.start!==void 0&&(q.start=M.start,q.end=M.end);for(var Y=0;Y<M.length;Y+=3)q.push(M[Y]+F,M[Y+1],M[Y+2]);return q}function Zo(M,F){if(M.transformed)return M;var q,Y,re,ue=1<<M.z,me=M.x,Z=M.y;for(q=0;q<M.features.length;q++){var ie=M.features[q],be=ie.geometry,Ve=ie.type;if(ie.geometry=[],Ve===1)for(Y=0;Y<be.length;Y+=2)ie.geometry.push(Vn(be[Y],be[Y+1],F,ue,me,Z));else for(Y=0;Y<be.length;Y++){var Xe=[];for(re=0;re<be[Y].length;re+=2)Xe.push(Vn(be[Y][re],be[Y][re+1],F,ue,me,Z));ie.geometry.push(Xe)}}return M.transformed=!0,M}function Vn(M,F,q,Y,re,ue){return[Math.round(q*(M*Y-re)),Math.round(q*(F*Y-ue))]}function To(M,F,q,Y,re){for(var ue=F===re.maxZoom?0:re.tolerance/((1<<F)*re.extent),me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:Y,z:F,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Z=0;Z<M.length;Z++){me.numFeatures++,Go(me,M[Z],ue,re);var ie=M[Z].minX,be=M[Z].minY,Ve=M[Z].maxX,Xe=M[Z].maxY;ie<me.minX&&(me.minX=ie),be<me.minY&&(me.minY=be),Ve>me.maxX&&(me.maxX=Ve),Xe>me.maxY&&(me.maxY=Xe)}return me}function Go(M,F,q,Y){var re=F.geometry,ue=F.type,me=[];if(ue==="Point"||ue==="MultiPoint")for(var Z=0;Z<re.length;Z+=3)me.push(re[Z]),me.push(re[Z+1]),M.numPoints++,M.numSimplified++;else if(ue==="LineString")lo(me,re,M,q,!1,!1);else if(ue==="MultiLineString"||ue==="Polygon")for(Z=0;Z<re.length;Z++)lo(me,re[Z],M,q,ue==="Polygon",Z===0);else if(ue==="MultiPolygon")for(var ie=0;ie<re.length;ie++){var be=re[ie];for(Z=0;Z<be.length;Z++)lo(me,be[Z],M,q,!0,Z===0)}if(me.length){var Ve=F.tags||null;if(ue==="LineString"&&Y.lineMetrics){for(var Xe in Ve={},F.tags)Ve[Xe]=F.tags[Xe];Ve.mapbox_clip_start=re.start/re.size,Ve.mapbox_clip_end=re.end/re.size}var ze={geometry:me,type:ue==="Polygon"||ue==="MultiPolygon"?3:ue==="LineString"||ue==="MultiLineString"?2:1,tags:Ve};F.id!==null&&(ze.id=F.id),M.features.push(ze)}}function lo(M,F,q,Y,re,ue){var me=Y*Y;if(Y>0&&F.size<(re?me:Y))q.numPoints+=F.length/3;else{for(var Z=[],ie=0;ie<F.length;ie+=3)(Y===0||F[ie+2]>me)&&(q.numSimplified++,Z.push(F[ie]),Z.push(F[ie+1])),q.numPoints++;re&&function(be,Ve){for(var Xe=0,ze=0,je=be.length,ht=je-2;ze<je;ht=ze,ze+=2)Xe+=(be[ze]-be[ht])*(be[ze+1]+be[ht+1]);if(Xe>0===Ve)for(ze=0,je=be.length;ze<je/2;ze+=2){var st=be[ze],Re=be[ze+1];be[ze]=be[je-2-ze],be[ze+1]=be[je-1-ze],be[je-2-ze]=st,be[je-1-ze]=Re}}(Z,ue),M.push(Z)}}function Un(M,F){var q=(F=this.options=function(re,ue){for(var me in ue)re[me]=ue[me];return re}(Object.create(this.options),F)).debug;if(q&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");var Y=function(re,ue){var me=[];if(re.type==="FeatureCollection")for(var Z=0;Z<re.features.length;Z++)Vi(me,re.features[Z],ue,Z);else Vi(me,re.type==="Feature"?re:{geometry:re},ue);return me}(M,F);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Y=function(re,ue){var me=ue.buffer/ue.extent,Z=re,ie=Wi(re,1,-1-me,me,0,-1,2,ue),be=Wi(re,1,1-me,2+me,0,-1,2,ue);return(ie||be)&&(Z=Wi(re,1,-me,1+me,0,-1,2,ue)||[],ie&&(Z=ao(ie,1).concat(Z)),be&&(Z=Z.concat(ao(be,-1)))),Z}(Y,F)).length&&this.splitTile(Y,0,0,0),q&&(Y.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function In(M,F,q){return 32*((1<<M)*q+F)+M}function Io(M,F){var q=M.tileID.canonical;if(!this._geoJSONIndex)return F(null,null);var Y=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!Y)return F(null,null);var re=new ut(Y.features),ue=jt(re);ue.byteOffset===0&&ue.byteLength===ue.buffer.byteLength||(ue=new Uint8Array(ue)),F(null,{vectorTile:re,rawData:ue.buffer})}Ur.prototype.load=function(M){var F=this.options,q=F.log,Y=F.minZoom,re=F.maxZoom,ue=F.nodeSize;q&&console.time("total time");var me="prepare "+M.length+" points";q&&console.time(me),this.points=M;for(var Z=[],ie=0;ie<M.length;ie++)M[ie].geometry&&Z.push(xt(M[ie],ie));this.trees[re+1]=new Qr(Z,ii,dr,ue,Float32Array),q&&console.timeEnd(me);for(var be=re;be>=Y;be--){var Ve=+Date.now();Z=this._cluster(Z,be),this.trees[be]=new Qr(Z,ii,dr,ue,Float32Array),q&&console.log("z%d: %d clusters in %dms",be,Z.length,+Date.now()-Ve)}return q&&console.timeEnd("total time"),this},Ur.prototype.getClusters=function(M,F){var q=((M[0]+180)%360+360)%360-180,Y=Math.max(-90,Math.min(90,M[1])),re=M[2]===180?180:((M[2]+180)%360+360)%360-180,ue=Math.max(-90,Math.min(90,M[3]));if(M[2]-M[0]>=360)q=-180,re=180;else if(q>re){var me=this.getClusters([q,Y,180,ue],F),Z=this.getClusters([-180,Y,re,ue],F);return me.concat(Z)}for(var ie=this.trees[this._limitZoom(F)],be=[],Ve=0,Xe=ie.range(Ht(q),Nt(ue),Ht(re),Nt(Y));Ve<Xe.length;Ve+=1){var ze=ie.points[Xe[Ve]];be.push(ze.numPoints?sr(ze):this.points[ze.index])}return be},Ur.prototype.getChildren=function(M){var F=this._getOriginId(M),q=this._getOriginZoom(M),Y="No cluster with the specified id.",re=this.trees[q];if(!re)throw new Error(Y);var ue=re.points[F];if(!ue)throw new Error(Y);for(var me=this.options.radius/(this.options.extent*Math.pow(2,q-1)),Z=[],ie=0,be=re.within(ue.x,ue.y,me);ie<be.length;ie+=1){var Ve=re.points[be[ie]];Ve.parentId===M&&Z.push(Ve.numPoints?sr(Ve):this.points[Ve.index])}if(Z.length===0)throw new Error(Y);return Z},Ur.prototype.getLeaves=function(M,F,q){var Y=[];return this._appendLeaves(Y,M,F=F||10,q=q||0,0),Y},Ur.prototype.getTile=function(M,F,q){var Y=this.trees[this._limitZoom(M)],re=Math.pow(2,M),ue=this.options,me=ue.radius/ue.extent,Z=(q-me)/re,ie=(q+1+me)/re,be={features:[]};return this._addTileFeatures(Y.range((F-me)/re,Z,(F+1+me)/re,ie),Y.points,F,q,re,be),F===0&&this._addTileFeatures(Y.range(1-me/re,Z,1,ie),Y.points,re,q,re,be),F===re-1&&this._addTileFeatures(Y.range(0,Z,me/re,ie),Y.points,-1,q,re,be),be.features.length?be:null},Ur.prototype.getClusterExpansionZoom=function(M){for(var F=this._getOriginZoom(M)-1;F<=this.options.maxZoom;){var q=this.getChildren(M);if(F++,q.length!==1)break;M=q[0].properties.cluster_id}return F},Ur.prototype._appendLeaves=function(M,F,q,Y,re){for(var ue=0,me=this.getChildren(F);ue<me.length;ue+=1){var Z=me[ue],ie=Z.properties;if(ie&&ie.cluster?re+ie.point_count<=Y?re+=ie.point_count:re=this._appendLeaves(M,ie.cluster_id,q,Y,re):re<Y?re++:M.push(Z),M.length===q)break}return re},Ur.prototype._addTileFeatures=function(M,F,q,Y,re,ue){for(var me=0,Z=M;me<Z.length;me+=1){var ie=F[Z[me]],be=ie.numPoints,Ve={type:1,geometry:[[Math.round(this.options.extent*(ie.x*re-q)),Math.round(this.options.extent*(ie.y*re-Y))]],tags:be?Et(ie):this.points[ie.index].properties},Xe=void 0;be?Xe=ie.id:this.options.generateId?Xe=ie.index:this.points[ie.index].id&&(Xe=this.points[ie.index].id),Xe!==void 0&&(Ve.id=Xe),ue.features.push(Ve)}},Ur.prototype._limitZoom=function(M){return Math.max(this.options.minZoom,Math.min(+M,this.options.maxZoom+1))},Ur.prototype._cluster=function(M,F){for(var q=[],Y=this.options,re=Y.reduce,ue=Y.minPoints,me=Y.radius/(Y.extent*Math.pow(2,F)),Z=0;Z<M.length;Z++){var ie=M[Z];if(!(ie.zoom<=F)){ie.zoom=F;for(var be=this.trees[F+1],Ve=be.within(ie.x,ie.y,me),Xe=ie.numPoints||1,ze=Xe,je=0,ht=Ve;je<ht.length;je+=1){var st=be.points[ht[je]];st.zoom>F&&(ze+=st.numPoints||1)}if(ze>=ue){for(var Re=ie.x*Xe,ot=ie.y*Xe,rt=re&&Xe>1?this._map(ie,!0):null,Qe=(Z<<5)+(F+1)+this.points.length,Dt=0,it=Ve;Dt<it.length;Dt+=1){var $t=be.points[it[Dt]];if(!($t.zoom<=F)){$t.zoom=F;var lr=$t.numPoints||1;Re+=$t.x*lr,ot+=$t.y*lr,$t.parentId=Qe,re&&(rt||(rt=this._map(ie,!0)),re(rt,this._map($t)))}}ie.parentId=Qe,q.push(ui(Re/ze,ot/ze,Qe,ze,rt))}else if(q.push(ie),ze>1)for(var Wt=0,ir=Ve;Wt<ir.length;Wt+=1){var Xt=be.points[ir[Wt]];Xt.zoom<=F||(Xt.zoom=F,q.push(Xt))}}}return q},Ur.prototype._getOriginId=function(M){return M-this.points.length>>5},Ur.prototype._getOriginZoom=function(M){return(M-this.points.length)%32},Ur.prototype._map=function(M,F){if(M.numPoints)return F?nn({},M.properties):M.properties;var q=this.points[M.index].properties,Y=this.options.map(q);return F&&Y===q?nn({},Y):Y},Un.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Un.prototype.splitTile=function(M,F,q,Y,re,ue,me){for(var Z=[M,F,q,Y],ie=this.options,be=ie.debug;Z.length;){Y=Z.pop(),q=Z.pop(),F=Z.pop(),M=Z.pop();var Ve=1<<F,Xe=In(F,q,Y),ze=this.tiles[Xe];if(!ze&&(be>1&&console.time("creation"),ze=this.tiles[Xe]=To(M,F,q,Y,ie),this.tileCoords.push({z:F,x:q,y:Y}),be)){be>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,q,Y,ze.numFeatures,ze.numPoints,ze.numSimplified),console.timeEnd("creation"));var je="z"+F;this.stats[je]=(this.stats[je]||0)+1,this.total++}if(ze.source=M,re){if(F===ie.maxZoom||F===re)continue;var ht=1<<re-F;if(q!==Math.floor(ue/ht)||Y!==Math.floor(me/ht))continue}else if(F===ie.indexMaxZoom||ze.numPoints<=ie.indexMaxPoints)continue;if(ze.source=null,M.length!==0){be>1&&console.time("clipping");var st,Re,ot,rt,Qe,Dt,it=.5*ie.buffer/ie.extent,$t=.5-it,lr=.5+it,Wt=1+it;st=Re=ot=rt=null,Qe=Wi(M,Ve,q-it,q+lr,0,ze.minX,ze.maxX,ie),Dt=Wi(M,Ve,q+$t,q+Wt,0,ze.minX,ze.maxX,ie),M=null,Qe&&(st=Wi(Qe,Ve,Y-it,Y+lr,1,ze.minY,ze.maxY,ie),Re=Wi(Qe,Ve,Y+$t,Y+Wt,1,ze.minY,ze.maxY,ie),Qe=null),Dt&&(ot=Wi(Dt,Ve,Y-it,Y+lr,1,ze.minY,ze.maxY,ie),rt=Wi(Dt,Ve,Y+$t,Y+Wt,1,ze.minY,ze.maxY,ie),Dt=null),be>1&&console.timeEnd("clipping"),Z.push(st||[],F+1,2*q,2*Y),Z.push(Re||[],F+1,2*q,2*Y+1),Z.push(ot||[],F+1,2*q+1,2*Y),Z.push(rt||[],F+1,2*q+1,2*Y+1)}}},Un.prototype.getTile=function(M,F,q){var Y=this.options,re=Y.extent,ue=Y.debug;if(M<0||M>24)return null;var me=1<<M,Z=In(M,F=(F%me+me)%me,q);if(this.tiles[Z])return Zo(this.tiles[Z],re);ue>1&&console.log("drilling down to z%d-%d-%d",M,F,q);for(var ie,be=M,Ve=F,Xe=q;!ie&&be>0;)be--,Ve=Math.floor(Ve/2),Xe=Math.floor(Xe/2),ie=this.tiles[In(be,Ve,Xe)];return ie&&ie.source?(ue>1&&console.log("found parent tile z%d-%d-%d",be,Ve,Xe),ue>1&&console.time("drilling down"),this.splitTile(ie.source,be,Ve,Xe,M,F,q),ue>1&&console.timeEnd("drilling down"),this.tiles[Z]?Zo(this.tiles[Z],re):null):null};var ei=function(M){function F(q,Y,re,ue){M.call(this,q,Y,re,Io),ue&&(this.loadGeoJSON=ue)}return M&&(F.__proto__=M),(F.prototype=Object.create(M&&M.prototype)).constructor=F,F.prototype.loadData=function(q,Y){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Y,this._pendingLoadDataParams=q,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},F.prototype._loadData=function(){var q=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Y=this._pendingCallback,re=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ue=!!(re&&re.request&&re.request.collectResourceTiming)&&new a.RequestPerformance(re.request);this.loadGeoJSON(re,function(me,Z){if(me||!Z)return Y(me);if(typeof Z!="object")return Y(new Error("Input data given to '"+re.source+"' is not a valid GeoJSON object."));(function ze(je,ht){var st,Re=je&&je.type;if(Re==="FeatureCollection")for(st=0;st<je.features.length;st++)ze(je.features[st],ht);else if(Re==="GeometryCollection")for(st=0;st<je.geometries.length;st++)ze(je.geometries[st],ht);else if(Re==="Feature")ze(je.geometry,ht);else if(Re==="Polygon")He(je.coordinates,ht);else if(Re==="MultiPolygon")for(st=0;st<je.coordinates.length;st++)He(je.coordinates[st],ht);return je})(Z,!0);try{if(re.filter){var ie=a.createExpression(re.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ie.result==="error")throw new Error(ie.value.map(function(ze){return ze.key+": "+ze.message}).join(", "));var be=Z.features.filter(function(ze){return ie.value.evaluate({zoom:0},ze)});Z={type:"FeatureCollection",features:be}}q._geoJSONIndex=re.cluster?new Ur(function(ze){var je=ze.superclusterOptions,ht=ze.clusterProperties;if(!ht||!je)return je;for(var st={},Re={},ot={accumulated:null,zoom:0},rt={properties:null},Qe=Object.keys(ht),Dt=0,it=Qe;Dt<it.length;Dt+=1){var $t=it[Dt],lr=ht[$t],Wt=lr[0],ir=a.createExpression(lr[1]),Xt=a.createExpression(typeof Wt=="string"?[Wt,["accumulated"],["get",$t]]:Wt);st[$t]=ir.value,Re[$t]=Xt.value}return je.map=function(ti){rt.properties=ti;for(var hr={},Ar=0,pr=Qe;Ar<pr.length;Ar+=1){var Jt=pr[Ar];hr[Jt]=st[Jt].evaluate(ot,rt)}return hr},je.reduce=function(ti,hr){rt.properties=hr;for(var Ar=0,pr=Qe;Ar<pr.length;Ar+=1){var Jt=pr[Ar];ot.accumulated=ti[Jt],ti[Jt]=Re[Jt].evaluate(ot,rt)}},je}(re)).load(Z.features):function(ze,je){return new Un(ze,je)}(Z,re.geojsonVtOptions)}catch(ze){return Y(ze)}q.loaded={};var Ve={};if(ue){var Xe=ue.finish();Xe&&(Ve.resourceTiming={},Ve.resourceTiming[re.source]=JSON.parse(JSON.stringify(Xe)))}Y(null,Ve)})}},F.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},F.prototype.reloadTile=function(q,Y){var re=this.loaded;return re&&re[q.uid]?M.prototype.reloadTile.call(this,q,Y):this.loadTile(q,Y)},F.prototype.loadGeoJSON=function(q,Y){if(q.request)a.getJSON(q.request,Y);else{if(typeof q.data!="string")return Y(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."));try{return Y(null,JSON.parse(q.data))}catch{return Y(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."))}}},F.prototype.removeSource=function(q,Y){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Y()},F.prototype.getClusterExpansionZoom=function(q,Y){try{Y(null,this._geoJSONIndex.getClusterExpansionZoom(q.clusterId))}catch(re){Y(re)}},F.prototype.getClusterChildren=function(q,Y){try{Y(null,this._geoJSONIndex.getChildren(q.clusterId))}catch(re){Y(re)}},F.prototype.getClusterLeaves=function(q,Y){try{Y(null,this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset))}catch(re){Y(re)}},F}(de),mr=function(M){var F=this;this.self=M,this.actor=new a.Actor(M,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:de,geojson:ei},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(q,Y){if(F.workerSourceTypes[q])throw new Error('Worker source with name "'+q+'" already registered.');F.workerSourceTypes[q]=Y},this.self.registerRTLTextPlugin=function(q){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=q.applyArabicShaping,a.plugin.processBidirectionalText=q.processBidirectionalText,a.plugin.processStyledBidirectionalText=q.processStyledBidirectionalText}};return mr.prototype.setReferrer=function(M,F){this.referrer=F},mr.prototype.setImages=function(M,F,q){for(var Y in this.availableImages[M]=F,this.workerSources[M]){var re=this.workerSources[M][Y];for(var ue in re)re[ue].availableImages=F}q()},mr.prototype.setLayers=function(M,F,q){this.getLayerIndex(M).replace(F),q()},mr.prototype.updateLayers=function(M,F,q){this.getLayerIndex(M).update(F.layers,F.removedIds),q()},mr.prototype.loadTile=function(M,F,q){this.getWorkerSource(M,F.type,F.source).loadTile(F,q)},mr.prototype.loadDEMTile=function(M,F,q){this.getDEMWorkerSource(M,F.source).loadTile(F,q)},mr.prototype.reloadTile=function(M,F,q){this.getWorkerSource(M,F.type,F.source).reloadTile(F,q)},mr.prototype.abortTile=function(M,F,q){this.getWorkerSource(M,F.type,F.source).abortTile(F,q)},mr.prototype.removeTile=function(M,F,q){this.getWorkerSource(M,F.type,F.source).removeTile(F,q)},mr.prototype.removeDEMTile=function(M,F){this.getDEMWorkerSource(M,F.source).removeTile(F)},mr.prototype.removeSource=function(M,F,q){if(this.workerSources[M]&&this.workerSources[M][F.type]&&this.workerSources[M][F.type][F.source]){var Y=this.workerSources[M][F.type][F.source];delete this.workerSources[M][F.type][F.source],Y.removeSource!==void 0?Y.removeSource(F,q):q()}},mr.prototype.loadWorkerSource=function(M,F,q){try{this.self.importScripts(F.url),q()}catch(Y){q(Y.toString())}},mr.prototype.syncRTLPluginState=function(M,F,q){try{a.plugin.setState(F);var Y=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&Y!=null){this.self.importScripts(Y);var re=a.plugin.isParsed();q(re?void 0:new Error("RTL Text Plugin failed to import scripts from "+Y),re)}}catch(ue){q(ue.toString())}},mr.prototype.getAvailableImages=function(M){var F=this.availableImages[M];return F||(F=[]),F},mr.prototype.getLayerIndex=function(M){var F=this.layerIndexes[M];return F||(F=this.layerIndexes[M]=new R),F},mr.prototype.getWorkerSource=function(M,F,q){var Y=this;return this.workerSources[M]||(this.workerSources[M]={}),this.workerSources[M][F]||(this.workerSources[M][F]={}),this.workerSources[M][F][q]||(this.workerSources[M][F][q]=new this.workerSourceTypes[F]({send:function(re,ue,me){Y.actor.send(re,ue,me,M)}},this.getLayerIndex(M),this.getAvailableImages(M))),this.workerSources[M][F][q]},mr.prototype.getDEMWorkerSource=function(M,F){return this.demWorkerSources[M]||(this.demWorkerSources[M]={}),this.demWorkerSources[M][F]||(this.demWorkerSources[M][F]=new Se),this.demWorkerSources[M][F]},mr.prototype.enforceCacheSizeLimit=function(M,F){a.enforceCacheSizeLimit(F)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new mr(self)),mr}),x(["./shared"],function(a){var A=a.createCommonjsModule(function(n){function s(m){return!o(m)}function o(m){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,k,P=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(P);try{k=new Worker(L),S=!0}catch{S=!1}return k&&k.terminate(),URL.revokeObjectURL(L),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var k=S.getContext("2d");if(!k)return!1;var P=k.getImageData(0,0,1,1);return P&&P.width===S.width}()?(u[w=m&&m.failIfMajorPerformanceCaveat]===void 0&&(u[w]=function(S){var k=function(L){var G=document.createElement("canvas"),W=Object.create(s.webGLContextAttributes);return W.failIfMajorPerformanceCaveat=L,G.probablySupportsContext?G.probablySupportsContext("webgl",W)||G.probablySupportsContext("experimental-webgl",W):G.supportsContext?G.supportsContext("webgl",W)||G.supportsContext("experimental-webgl",W):G.getContext("webgl",W)||G.getContext("experimental-webgl",W)}(S);if(!k)return!1;var P=k.createShader(k.VERTEX_SHADER);return!(!P||k.isContextLost())&&(k.shaderSource(P,"void main() {}"),k.compileShader(P),k.getShaderParameter(P,k.COMPILE_STATUS)===!0)}(w)),u[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var u={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),I={create:function(n,s,o){var u=a.window.document.createElement(n);return s!==void 0&&(u.className=s),o&&o.appendChild(u),u},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},R=a.window.document&&a.window.document.documentElement.style;function B(n){if(!R)return n[0];for(var s=0;s<n.length;s++)if(n[s]in R)return n[s];return n[0]}var K,j=B(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);I.disableDrag=function(){R&&j&&(K=R[j],R[j]="none")},I.enableDrag=function(){R&&j&&(R[j]=K)};var H=B(["transform","WebkitTransform"]);I.setTransform=function(n,s){n.style[H]=s};var de=!1;try{var Me=Object.defineProperty({},"passive",{get:function(){de=!0}});a.window.addEventListener("test",Me,Me),a.window.removeEventListener("test",Me,Me)}catch{de=!1}I.addEventListener=function(n,s,o,u){u===void 0&&(u={}),n.addEventListener(s,o,"passive"in u&&de?u:u.capture)},I.removeEventListener=function(n,s,o,u){u===void 0&&(u={}),n.removeEventListener(s,o,"passive"in u&&de?u:u.capture)};var Se=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",Se,!0)};function He(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}I.suppressClick=function(){a.window.addEventListener("click",Se,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",Se,!0)},0)},I.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},I.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),u=[],m=0;m<s.length;m++)u.push(new a.Point(s[m].clientX-o.left-n.clientLeft,s[m].clientY-o.top-n.clientTop));return u},I.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},I.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var Ue=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var u=0,m=this.requestors;u<m.length;u+=1){var w=m[u];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,u){this._validate(o,u)&&(this.images[o]=u)},s.prototype._validate=function(o,u){var m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),m=!1),this._validateContent(u.content,u)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),m=!1),m},s.prototype._validateStretch=function(o,u){if(!o)return!0;for(var m=0,w=0,S=o;w<S.length;w+=1){var k=S[w];if(k[0]<m||k[1]<k[0]||u<k[1])return!1;m=k[1]}return!0},s.prototype._validateContent=function(o,u){return!(o&&(o.length!==4||o[0]<0||u.data.width<o[0]||o[1]<0||u.data.height<o[1]||o[2]<0||u.data.width<o[2]||o[3]<0||u.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,u){u.version=this.images[o].version+1,this.images[o]=u,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,u){var m=!0;if(!this.isLoaded())for(var w=0,S=o;w<S.length;w+=1)this.images[S[w]]||(m=!1);this.isLoaded()||m?this._notify(o,u):this.requestors.push({ids:o,callback:u})},s.prototype._notify=function(o,u){for(var m={},w=0,S=o;w<S.length;w+=1){var k=S[w];this.images[k]||this.fire(new a.Event("styleimagemissing",{id:k}));var P=this.images[k];P?m[k]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:Boolean(P.userImage&&P.userImage.render)}:a.warnOnce('Image "'+k+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}u(null,m)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var u=this.patterns[o],m=this.getImage(o);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{var w={w:m.data.width+2,h:m.data.height+2,x:0,y:0},S=new a.ImagePosition(w,m);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var u in this.patterns)o.push(this.patterns[u].bin);var m=a.potpack(o),w=m.w,S=m.h,k=this.atlasImage;for(var P in k.resize({width:w||1,height:S||1}),this.patterns){var L=this.patterns[P].bin,G=L.x+1,W=L.y+1,J=this.images[P].data,oe=J.width,te=J.height;a.RGBAImage.copy(J,k,{x:0,y:0},{x:G,y:W},{width:oe,height:te}),a.RGBAImage.copy(J,k,{x:0,y:te-1},{x:G,y:W-1},{width:oe,height:1}),a.RGBAImage.copy(J,k,{x:0,y:0},{x:G,y:W+te},{width:oe,height:1}),a.RGBAImage.copy(J,k,{x:oe-1,y:0},{x:G-1,y:W},{width:1,height:te}),a.RGBAImage.copy(J,k,{x:0,y:0},{x:G+oe,y:W},{width:1,height:te})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var u=0,m=o;u<m.length;u+=1){var w=m[u];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var S=this.images[w];He(S)&&this.updateImage(w,S)}}},s}(a.Evented),Rt=We,kt=We,ut=1e20;function We(n,s,o,u,m,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=u||.25,this.fontFamily=m||"sans-serif",this.fontWeight=w||"normal",this.radius=o||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function tr(n,s,o,u,m,w,S){for(var k=0;k<s;k++){for(var P=0;P<o;P++)u[P]=n[P*s+k];for(Gt(u,m,w,S,o),P=0;P<o;P++)n[P*s+k]=m[P]}for(P=0;P<o;P++){for(k=0;k<s;k++)u[k]=n[P*s+k];for(Gt(u,m,w,S,s),k=0;k<s;k++)n[P*s+k]=Math.sqrt(m[k])}}function Gt(n,s,o,u,m){o[0]=0,u[0]=-ut,u[1]=+ut;for(var w=1,S=0;w<m;w++){for(var k=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);k<=u[S];)S--,k=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);o[++S]=w,u[S]=k,u[S+1]=+ut}for(w=0,S=0;w<m;w++){for(;u[S+1]<w;)S++;s[w]=(w-o[S])*(w-o[S])+n[o[S]]}}We.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),u=0;u<this.size*this.size;u++){var m=s.data[4*u+3]/255;this.gridOuter[u]=m===1?0:m===0?ut:Math.pow(Math.max(0,.5-m),2),this.gridInner[u]=m===1?ut:m===0?0:Math.pow(Math.max(0,m-.5),2)}for(tr(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),tr(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),u=0;u<this.size*this.size;u++)o[u]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[u]-this.gridInner[u])/this.radius+this.cutoff))));return o},Rt.default=kt;var St=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};St.prototype.setURL=function(n){this.url=n},St.prototype.getGlyphs=function(n,s){var o=this,u=[];for(var m in n)for(var w=0,S=n[m];w<S.length;w+=1)u.push({stack:m,id:S[w]});a.asyncAll(u,function(k,P){var L=k.stack,G=k.id,W=o.entries[L];W||(W=o.entries[L]={glyphs:{},requests:{},ranges:{}});var J=W.glyphs[G];if(J===void 0){if(J=o._tinySDF(W,L,G))return W.glyphs[G]=J,void P(null,{stack:L,id:G,glyph:J});var oe=Math.floor(G/256);if(256*oe>65535)P(new Error("glyphs > 65535 not supported"));else if(W.ranges[oe])P(null,{stack:L,id:G,glyph:J});else{var te=W.requests[oe];te||(te=W.requests[oe]=[],St.loadGlyphRange(L,oe,o.url,o.requestManager,function(se,$){if($){for(var le in $)o._doesCharSupportLocalGlyph(+le)||(W.glyphs[+le]=$[+le]);W.ranges[oe]=!0}for(var ye=0,ve=te;ye<ve.length;ye+=1)(0,ve[ye])(se,$);delete W.requests[oe]})),te.push(function(se,$){se?P(se):$&&P(null,{stack:L,id:G,glyph:$[G]||null})})}}else P(null,{stack:L,id:G,glyph:J})},function(k,P){if(k)s(k);else if(P){for(var L={},G=0,W=P;G<W.length;G+=1){var J=W[G],oe=J.stack,te=J.id,se=J.glyph;(L[oe]||(L[oe]={}))[te]=se&&{id:se.id,bitmap:se.bitmap.clone(),metrics:se.metrics}}s(null,L)}})},St.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},St.prototype._tinySDF=function(n,s,o){var u=this.localIdeographFontFamily;if(u&&this._doesCharSupportLocalGlyph(o)){var m=n.tinySDF;if(!m){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),m=n.tinySDF=new St.TinySDF(24,3,8,.25,u,w)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},m.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},St.loadGlyphRange=function(n,s,o,u,m){var w=256*s,S=w+255,k=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",w+"-"+S),a.ResourceType.Glyphs);a.getArrayBuffer(k,function(P,L){if(P)m(P);else if(L){for(var G={},W=0,J=a.parseGlyphPBF(L);W<J.length;W+=1){var oe=J[W];G[oe.id]=oe}m(null,G)}})},St.TinySDF=Rt;var jt=function(){this.specification=a.styleSpec.light.position};jt.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},jt.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var Ke=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new jt,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),Lt=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(Ke),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,u){if(u===void 0&&(u={}),!this._validate(a.validateLight,o,u))for(var m in o){var w=o[m];a.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),w):this._transitionable.setValue(m,w)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,u,m){return(!m||m.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),mt=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};mt.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},mt.prototype.getDashRanges=function(n,s,o){var u=[],m=n.length%2==1?-n[n.length-1]*o:0,w=n[0]*o,S=!0;u.push({left:m,right:w,isDash:S,zeroLength:n[0]===0});for(var k=n[0],P=1;P<n.length;P++){var L=n[P];u.push({left:m=k*o,right:w=(k+=L)*o,isDash:S=!S,zeroLength:L===0})}return u},mt.prototype.addRoundDash=function(n,s,o){for(var u=s/2,m=-o;m<=o;m++)for(var w=this.width*(this.nextRow+o+m),S=0,k=n[S],P=0;P<this.width;P++){P/k.right>1&&(k=n[++S]);var L=Math.abs(P-k.left),G=Math.abs(P-k.right),W=Math.min(L,G),J=void 0,oe=m/o*(u+1);if(k.isDash){var te=u-Math.abs(oe);J=Math.sqrt(W*W+te*te)}else J=u-Math.sqrt(W*W+oe*oe);this.data[w+P]=Math.max(0,Math.min(255,J+128))}},mt.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],u=n[s+1];o.zeroLength?n.splice(s,1):u&&u.isDash===o.isDash&&(u.left=o.left,n.splice(s,1))}var m=n[0],w=n[n.length-1];m.isDash===w.isDash&&(m.left=w.left-this.width,w.right=m.right+this.width);for(var S=this.width*this.nextRow,k=0,P=n[k],L=0;L<this.width;L++){L/P.right>1&&(P=n[++k]);var G=Math.abs(L-P.left),W=Math.abs(L-P.right),J=Math.min(G,W);this.data[S+L]=Math.max(0,Math.min(255,(P.isDash?J:-J)+128))}},mt.prototype.addDash=function(n,s){var o=s?7:0,u=2*o+1;if(this.nextRow+u>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var m=0,w=0;w<n.length;w++)m+=n[w];if(m!==0){var S=this.width/m,k=this.getDashRanges(n,this.width,S);s?this.addRoundDash(k,S,o):this.addRegularDash(k)}var P={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:m};return this.nextRow+=u,this.dirty=!0,P},mt.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var yt=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var u=this.workerPool.acquire(this.id),m=0;m<u.length;m++){var w=new n.Actor(u[m],o,this.id);w.name="Worker "+m,this.actors.push(w)}};function De(n,s,o){var u=function(m,w){if(m)return o(m);if(w){var S=a.pick(a.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(S.vectorLayers=w.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(k){return k.id})),S.tiles=s.canonicalizeTileset(S,n.url),o(null,S)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),u):a.browser.frame(function(){return u(null,n)})}yt.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(u,m){u.send(n,s,m)},o=o||function(){})},yt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},yt.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},yt.Actor=a.Actor;var Ne=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};Ne.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},Ne.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),u=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),m=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<m&&n.y>=u&&n.y<w};var Tt=function(n){function s(o,u,m,w){if(n.call(this),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(u,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=De(this._options,this.map._requestManager,function(u,m){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new a.ErrorEvent(u)):m&&(a.extend(o,m),m.bounds&&(o.tileBounds=new Ne(m.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(m.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(m.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var u=this;return this.setSourceProperty(function(){u._options.tiles=o}),this},s.prototype.setUrl=function(o){var u=this;return this.setSourceProperty(function(){u.url=o,u._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,u){var m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(m,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(k,P){return delete o.request,o.aborted?u(null):k&&k.status!==404?u(k):(P&&P.resourceTiming&&(o.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&o.setExpiryData(P),o.loadVectorData(P,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=u:o.request=o.actor.send("reloadTile",w,S.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",w,S.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),fr=function(n){function s(o,u,m,w){n.call(this),this.id=o,this.dispatcher=m,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},u),a.extend(this,a.pick(u,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=De(this._options,this.map._requestManager,function(u,m){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new a.ErrorEvent(u)):m&&(a.extend(o,m),m.bounds&&(o.tileBounds=new Ne(m.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(m.tiles),a.postMapLoadEvent(m.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,u){var m=this,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(S,k){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(S)o.state="errored",u(S);else if(k){m.map._refreshExpiredTiles&&o.setExpiryData(k),delete k.cacheControl,delete k.expires;var P=m.map.painter.context,L=P.gl;o.texture=m.map.painter.getTileTexture(k.width),o.texture?o.texture.update(k,{useMipmap:!0}):(o.texture=new a.Texture(P,k,L.RGBA,{useMipmap:!0}),o.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),P.extTextureFilterAnisotropic&&L.texParameterf(L.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(m.dispatcher),u(null)}})},s.prototype.abortTile=function(o,u){o.request&&(o.request.cancel(),delete o.request),u()},s.prototype.unloadTile=function(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Kt=function(n){function s(o,u,m,w){n.call(this,o,u,m,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,u){var m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(S,k){S&&(o.state="errored",u(S)),k&&(o.dem=k,o.needsHillshadePrepare=!0,o.state="loaded",u(null))}o.request=a.getImage(this.map._requestManager.transformRequest(m,a.ResourceType.Tile),function(S,k){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(S)o.state="errored",u(S);else if(k){this.map._refreshExpiredTiles&&o.setExpiryData(k),delete k.cacheControl,delete k.expires;var P=a.window.ImageBitmap&&k instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?k:a.browser.getImageData(k,1),L={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:P,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",L,w.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var u=o.canonical,m=Math.pow(2,u.z),w=(u.x-1+m)%m,S=u.x===0?o.wrap-1:o.wrap,k=(u.x+1+m)%m,P=u.x+1===m?o.wrap+1:o.wrap,L={};return L[new a.OverscaledTileID(o.overscaledZ,S,u.z,w,u.y).key]={backfilled:!1},L[new a.OverscaledTileID(o.overscaledZ,P,u.z,k,u.y).key]={backfilled:!1},u.y>0&&(L[new a.OverscaledTileID(o.overscaledZ,S,u.z,w,u.y-1).key]={backfilled:!1},L[new a.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},L[new a.OverscaledTileID(o.overscaledZ,P,u.z,k,u.y-1).key]={backfilled:!1}),u.y+1<m&&(L[new a.OverscaledTileID(o.overscaledZ,S,u.z,w,u.y+1).key]={backfilled:!1},L[new a.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},L[new a.OverscaledTileID(o.overscaledZ,P,u.z,k,u.y+1).key]={backfilled:!1}),L},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(fr),Ge=function(n){function s(o,u,m,w){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(w),this._data=u.data,this._options=a.extend({},u),this._collectResourceTiming=u.collectResourceTiming,this._resourceTiming=[],u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;var S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*S,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?Math.min(u.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:a.EXTENT,radius:(u.clusterRadius||50)*S,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(u){if(u)o.fire(new a.ErrorEvent(u));else{var m={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(m.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",m))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var u=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(m){if(m)u.fire(new a.ErrorEvent(m));else{var w={dataType:"source",sourceDataType:"content"};u._collectResourceTiming&&u._resourceTiming&&u._resourceTiming.length>0&&(w.resourceTiming=u._resourceTiming,u._resourceTiming=[]),u.fire(new a.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(o,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},u),this},s.prototype.getClusterChildren=function(o,u){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},u),this},s.prototype.getClusterLeaves=function(o,u,m,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:u,offset:m},w),this},s.prototype._updateWorkerData=function(o){var u=this;this._loaded=!1;var m=a.extend({},this.workerOptions),w=this._data;typeof w=="string"?(m.request=this.map._requestManager.transformRequest(a.browser.resolveURL(w),a.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(w),this.actor.send(this.type+".loadData",m,function(S,k){u._removed||k&&k.abandoned||(u._loaded=!0,k&&k.resourceTiming&&k.resourceTiming[u.id]&&(u._resourceTiming=k.resourceTiming[u.id].slice(0)),u.actor.send(u.type+".coalesce",{source:m.source},null),o(S))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,u){var m=this,w=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(w,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,k){return delete o.request,o.unloadVectorData(),o.aborted?u(null):S?u(S):(o.loadVectorData(k,m.map.painter,w==="reloadTile"),u(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),et=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ar=function(n){function s(o,u,m,w){n.call(this),this.id=o,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,u){var m=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(w,S){m._loaded=!0,w?m.fire(new a.ErrorEvent(w)):S&&(m.image=S,o&&(m.coordinates=o),u&&u(),m._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var u=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){u.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var u=this;this.coordinates=o;var m=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var k=1/0,P=1/0,L=-1/0,G=-1/0,W=0,J=S;W<J.length;W+=1){var oe=J[W];k=Math.min(k,oe.x),P=Math.min(P,oe.y),L=Math.max(L,oe.x),G=Math.max(G,oe.y)}var te=Math.max(L-k,G-P),se=Math.max(0,Math.floor(-Math.log(te)/Math.LN2)),$=Math.pow(2,se);return new a.CanonicalTileID(se,Math.floor((k+L)/2*$),Math.floor((P+G)/2*$))}(m),this.minzoom=this.maxzoom=this.tileID.z;var w=m.map(function(S){return u.tileID.getTilePoint(S)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,u=o.gl;for(var m in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,et.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[m];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),vr=function(n){function s(o,u,m,w){n.call(this,o,u,m,w),this.roundZoom=!0,this.type="video",this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var u=this.options;this.urls=[];for(var m=0,w=u.urls;m<w.length;m+=1)this.urls.push(this.map._requestManager.transformRequest(w[m],a.ResourceType.Source).url);a.getVideo(this.urls,function(S,k){o._loaded=!0,S?o.fire(new a.ErrorEvent(S)):k&&(o.video=k,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+u.start(0)+" and "+u.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,u=o.gl;for(var m in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,et.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[m];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(ar),di=function(n){function s(o,u,m,w){n.call(this,o,u,m,w),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(k){return typeof k!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var u=this.map.painter.context,m=u.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,et.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(u,this.canvas,m.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,u=[this.canvas.width,this.canvas.height];o<u.length;o+=1){var m=u[o];if(isNaN(m)||m<=0)return!0}return!1},s}(ar),Qr={vector:Tt,raster:fr,"raster-dem":Kt,geojson:Ge,video:vr,image:ar,canvas:di};function Vr(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function Ur(n,s,o,u,m,w){var S=function(se,$,le){if(se)for(var ye=0,ve=se;ye<ve.length;ye+=1){var Be=$[ve[ye]];if(Be&&Be.source===le&&Be.type==="fill-extrusion")return!0}else for(var Te in $){var Pe=$[Te];if(Pe.source===le&&Pe.type==="fill-extrusion")return!0}return!1}(m&&m.layers,s,n.id),k=w.maxPitchScaleFactor(),P=n.tilesIn(u,k,S);P.sort(ui);for(var L=[],G=0,W=P;G<W.length;G+=1){var J=W[G];L.push({wrappedTileID:J.tileID.wrapped().key,queryResults:J.tile.queryRenderedFeatures(s,o,n._state,J.queryGeometry,J.cameraQueryGeometry,J.scale,m,w,k,Vr(n.transform,J.tileID))})}var oe=function(se){for(var $={},le={},ye=0,ve=se;ye<ve.length;ye+=1){var Be=ve[ye],Te=Be.queryResults,Pe=Be.wrappedTileID,Oe=le[Pe]=le[Pe]||{};for(var Ze in Te)for(var qe=Te[Ze],tt=Oe[Ze]=Oe[Ze]||{},ft=$[Ze]=$[Ze]||[],zt=0,wt=qe;zt<wt.length;zt+=1){var Zt=wt[zt];tt[Zt.featureIndex]||(tt[Zt.featureIndex]=!0,ft.push(Zt))}}return $}(L);for(var te in oe)oe[te].forEach(function(se){var $=se.feature,le=n.getFeatureState($.layer["source-layer"],$.id);$.source=$.layer.source,$.layer["source-layer"]&&($.sourceLayer=$.layer["source-layer"]),$.state=le});return oe}function ui(n,s){var o=n.tileID,u=s.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}var xt=function(n,s){this.max=n,this.onRemove=s,this.reset()};xt.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var u=o[s];u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value)}return this.data={},this.order=[],this},xt.prototype.add=function(n,s,o){var u=this,m=n.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);var w={value:s,timeout:void 0};if(o!==void 0&&(w.timeout=setTimeout(function(){u.remove(n,w)},o)),this.data[m].push(w),this.order.push(m),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},xt.prototype.has=function(n){return n.wrapped().key in this.data},xt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},xt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},xt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},xt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},xt.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,u=s===void 0?0:this.data[o].indexOf(s),m=this.data[o][u];return this.data[o].splice(u,1),m.timeout&&clearTimeout(m.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(m.value),this.order.splice(this.order.indexOf(o),1),this},xt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},xt.prototype.filter=function(n){var s=[];for(var o in this.data)for(var u=0,m=this.data[o];u<m.length;u+=1){var w=m[u];n(w.value)||s.push(w)}for(var S=0,k=s;S<k.length;S+=1){var P=k[S];this.remove(P.value.tileID,P)}};var sr=function(n,s,o){this.context=n;var u=n.gl;this.buffer=u.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};sr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},sr.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},sr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Et={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Ht=function(n,s,o,u){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=u,this.context=n;var m=n.gl;this.buffer=m.createBuffer(),n.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Ht.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Ht.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},Ht.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var u=s.attributes[this.attributes[o].name];u!==void 0&&n.enableVertexAttribArray(u)}},Ht.prototype.setVertexAttribPointers=function(n,s,o){for(var u=0;u<this.attributes.length;u++){var m=this.attributes[u],w=s.attributes[m.name];w!==void 0&&n.vertexAttribPointer(w,m.components,n[Et[m.type]],!1,this.itemSize,m.offset+this.itemSize*(o||0))}},Ht.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Nt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Nt.prototype.get=function(){return this.current},Nt.prototype.set=function(n){},Nt.prototype.getDefault=function(){return this.default},Nt.prototype.setDefault=function(){this.set(this.default)};var nn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Nt),ii=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(Nt),dr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(Nt),ni=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Nt),$r=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(Nt),on=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(Nt),Vi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(Nt),Sn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(Nt),$n=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(Nt),Ir=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Nt),jr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(Nt),Mi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(Nt),Wi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}},s}(Nt),En=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Nt),Ka=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Nt),qo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(Nt),Nn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}},s}(Nt),kn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(Nt),na=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(Nt),Tn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(Nt),ao=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(Nt),so=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Nt),Zo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(Nt),Vn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Nt),To=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(Nt),Go=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(Nt),lo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(Nt),Un=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(Nt),In=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(Nt),Io=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(Nt),ei=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(Nt),mr=function(n){function s(o,u){n.call(this,o),this.context=o,this.parent=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Nt),M=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(mr),F=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(mr),q=function(n,s,o,u){this.context=n,this.width=s,this.height=o;var m=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new M(n,m),u&&(this.depthAttachment=new F(n,m))};q.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var Y=function(n,s,o){this.func=n,this.mask=s,this.range=o};Y.ReadOnly=!1,Y.ReadWrite=!0,Y.disabled=new Y(519,Y.ReadOnly,[0,1]);var re=function(n,s,o,u,m,w){this.test=n,this.ref=s,this.mask=o,this.fail=u,this.depthFail=m,this.pass=w};re.disabled=new re({func:519,mask:0},0,0,7680,7680,7680);var ue=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};ue.disabled=new ue(ue.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),ue.unblended=new ue(ue.Replace,a.Color.transparent,[!0,!0,!0,!0]),ue.alphaBlended=new ue([1,771],a.Color.transparent,[!0,!0,!0,!0]);var me=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};me.disabled=new me(!1,1029,2305),me.backCCW=new me(!0,1029,2305);var Z=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new nn(this),this.clearDepth=new ii(this),this.clearStencil=new dr(this),this.colorMask=new ni(this),this.depthMask=new $r(this),this.stencilMask=new on(this),this.stencilFunc=new Vi(this),this.stencilOp=new Sn(this),this.stencilTest=new $n(this),this.depthRange=new Ir(this),this.depthTest=new jr(this),this.depthFunc=new Mi(this),this.blend=new Wi(this),this.blendFunc=new En(this),this.blendColor=new Ka(this),this.blendEquation=new qo(this),this.cullFace=new Nn(this),this.cullFaceSide=new kn(this),this.frontFace=new na(this),this.program=new Tn(this),this.activeTexture=new ao(this),this.viewport=new so(this),this.bindFramebuffer=new Zo(this),this.bindRenderbuffer=new Vn(this),this.bindTexture=new To(this),this.bindVertexBuffer=new Go(this),this.bindElementBuffer=new lo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Un(this),this.pixelStoreUnpack=new In(this),this.pixelStoreUnpackPremultiplyAlpha=new Io(this),this.pixelStoreUnpackFlipY=new ei(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};Z.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Z.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Z.prototype.createIndexBuffer=function(n,s){return new sr(this,n,s)},Z.prototype.createVertexBuffer=function(n,s,o){return new Ht(this,n,s,o)},Z.prototype.createRenderbuffer=function(n,s,o){var u=this.gl,m=u.createRenderbuffer();return this.bindRenderbuffer.set(m),u.renderbufferStorage(u.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),m},Z.prototype.createFramebuffer=function(n,s,o){return new q(this,n,s,o)},Z.prototype.clear=function(n){var s=n.color,o=n.depth,u=this.gl,m=0;s&&(m|=u.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u.clear(m)},Z.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},Z.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},Z.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},Z.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,ue.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},Z.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ie=function(n){function s(o,u,m){var w=this;n.call(this),this.id=o,this.dispatcher=m,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(S,k,P,L){var G=new Qr[k.type](S,k,P,L);if(G.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+G.id);return a.bindAll(["load","abort","unload","serialize","prepare"],G),G}(o,u,m,this),this._tiles={},this._cache=new xt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var u=this._tiles[o];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,u){return this._source.loadTile(o,u)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var u in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var m=this._tiles[u];m.upload(o),m.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(be).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var u=this,m=[];for(var w in this._tiles)this._isIdRenderable(w,o)&&m.push(this._tiles[w]);return o?m.sort(function(S,k){var P=S.tileID,L=k.tileID,G=new a.Point(P.canonical.x,P.canonical.y)._rotate(u.transform.angle),W=new a.Point(L.canonical.x,L.canonical.y)._rotate(u.transform.angle);return P.overscaledZ-L.overscaledZ||W.y-G.y||W.x-G.x}).map(function(S){return S.tileID.key}):m.map(function(S){return S.tileID}).sort(be).map(function(S){return S.key})},s.prototype.hasRenderableParent=function(o){var u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)},s.prototype._isIdRenderable=function(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,u){var m=this._tiles[o];m&&(m.state!=="loading"&&(m.state=u),this._loadTile(m,this._tileLoaded.bind(this,m,o,u)))},s.prototype._tileLoaded=function(o,u,m,w){if(w)return o.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),m==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var u=this.getRenderableIds(),m=0;m<u.length;m++){var w=u[m];if(o.neighboringTiles&&o.neighboringTiles[w]){var S=this.getTileByID(w);k(o,S),k(S,o)}}function k(P,L){P.needsHillshadePrepare=!0;var G=L.tileID.canonical.x-P.tileID.canonical.x,W=L.tileID.canonical.y-P.tileID.canonical.y,J=Math.pow(2,P.tileID.canonical.z),oe=L.tileID.key;G===0&&W===0||Math.abs(W)>1||(Math.abs(G)>1&&(Math.abs(G+J)===1?G+=J:Math.abs(G-J)===1&&(G-=J)),L.dem&&P.dem&&(P.dem.backfillBorder(L.dem,G,W),P.neighboringTiles&&P.neighboringTiles[oe]&&(P.neighboringTiles[oe].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,u,m,w){for(var S in this._tiles){var k=this._tiles[S];if(!(w[S]||!k.hasData()||k.tileID.overscaledZ<=u||k.tileID.overscaledZ>m)){for(var P=k.tileID;k&&k.tileID.overscaledZ>u+1;){var L=k.tileID.scaledTo(k.tileID.overscaledZ-1);(k=this._tiles[L.key])&&k.hasData()&&(P=L)}for(var G=P;G.overscaledZ>u;)if(o[(G=G.scaledTo(G.overscaledZ-1)).key]){w[P.key]=P;break}}}},s.prototype.findLoadedParent=function(o,u){if(o.key in this._loadedParentTiles){var m=this._loadedParentTiles[o.key];return m&&m.tileID.overscaledZ>=u?m:null}for(var w=o.overscaledZ-1;w>=u;w--){var S=o.scaledTo(w),k=this._getLoadedTile(S);if(k)return k}},s.prototype._getLoadedTile=function(o){var u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var u=Math.ceil(o.width/this._source.tileSize)+1,m=Math.ceil(o.height/this._source.tileSize)+1,w=Math.floor(u*m*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)},s.prototype.handleWrapJump=function(o){var u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){var m={};for(var w in this._tiles){var S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),m[S.tileID.key]=S}for(var k in this._tiles=m,this._timers)clearTimeout(this._timers[k]),delete this._timers[k];for(var P in this._tiles)this._setTileReloadTimer(P,this._tiles[P])}},s.prototype.update=function(o){var u=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var m;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?m=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Oe){return new a.OverscaledTileID(Oe.canonical.z,Oe.wrap,Oe.canonical.z,Oe.canonical.x,Oe.canonical.y)}):(m=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(m=m.filter(function(Oe){return u._source.hasTile(Oe)}))):m=[];var w=o.coveringZoomLevel(this._source),S=Math.max(w-s.maxOverzooming,this._source.minzoom),k=Math.max(w+s.maxUnderzooming,this._source.minzoom),P=this._updateRetainedTiles(m,w);if(Ve(this._source.type)){for(var L={},G={},W=0,J=Object.keys(P);W<J.length;W+=1){var oe=J[W],te=P[oe],se=this._tiles[oe];if(se&&!(se.fadeEndTime&&se.fadeEndTime<=a.browser.now())){var $=this.findLoadedParent(te,S);$&&(this._addTile($.tileID),L[$.tileID.key]=$.tileID),G[oe]=te}}for(var le in this._retainLoadedChildren(G,w,k,P),L)P[le]||(this._coveredTiles[le]=!0,P[le]=L[le])}for(var ye in P)this._tiles[ye].clearFadeHold();for(var ve=0,Be=a.keysDifference(this._tiles,P);ve<Be.length;ve+=1){var Te=Be[ve],Pe=this._tiles[Te];Pe.hasSymbolBuckets&&!Pe.holdingForFade()?Pe.setHoldDuration(this.map._fadeDuration):Pe.hasSymbolBuckets&&!Pe.symbolFadeFinished()||this._removeTile(Te)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,u){for(var m={},w={},S=Math.max(u-s.maxOverzooming,this._source.minzoom),k=Math.max(u+s.maxUnderzooming,this._source.minzoom),P={},L=0,G=o;L<G.length;L+=1){var W=G[L],J=this._addTile(W);m[W.key]=W,J.hasData()||u<this._source.maxzoom&&(P[W.key]=W)}this._retainLoadedChildren(P,u,k,m);for(var oe=0,te=o;oe<te.length;oe+=1){var se=te[oe],$=this._tiles[se.key];if(!$.hasData()){if(u+1>this._source.maxzoom){var le=se.children(this._source.maxzoom)[0],ye=this.getTile(le);if(ye&&ye.hasData()){m[le.key]=le;continue}}else{var ve=se.children(this._source.maxzoom);if(m[ve[0].key]&&m[ve[1].key]&&m[ve[2].key]&&m[ve[3].key])continue}for(var Be=$.wasRequested(),Te=se.overscaledZ-1;Te>=S;--Te){var Pe=se.scaledTo(Te);if(w[Pe.key]||(w[Pe.key]=!0,!($=this.getTile(Pe))&&Be&&($=this._addTile(Pe)),$&&(m[Pe.key]=Pe,Be=$.wasRequested(),$.hasData())))break}}}return m},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var u=[],m=void 0,w=this._tiles[o].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){m=this._loadedParentTiles[w.key];break}u.push(w.key);var S=w.scaledTo(w.overscaledZ-1);if(m=this._getLoadedTile(S))break;w=S}for(var k=0,P=u;k<P.length;k+=1)this._loadedParentTiles[P[k]]=m}},s.prototype._addTile=function(o){var u=this._tiles[o.key];if(u)return u;(u=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));var m=Boolean(u);return m||(u=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))),u?(u.uses++,this._tiles[o.key]=u,m||this._source.fire(new a.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null},s.prototype._setTileReloadTimer=function(o,u){var m=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var w=u.getExpiryTimeout();w&&(this._timers[o]=setTimeout(function(){m._reloadTile(o,"expired"),delete m._timers[o]},w))},s.prototype._removeTile=function(o){var u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,u,m){var w=this,S=[],k=this.transform;if(!k)return S;for(var P=m?k.getCameraQueryGeometry(o):o,L=o.map(function(Te){return k.pointCoordinate(Te)}),G=P.map(function(Te){return k.pointCoordinate(Te)}),W=this.getIds(),J=1/0,oe=1/0,te=-1/0,se=-1/0,$=0,le=G;$<le.length;$+=1){var ye=le[$];J=Math.min(J,ye.x),oe=Math.min(oe,ye.y),te=Math.max(te,ye.x),se=Math.max(se,ye.y)}for(var ve=function(Te){var Pe=w._tiles[W[Te]];if(!Pe.holdingForFade()){var Oe=Pe.tileID,Ze=Math.pow(2,k.zoom-Pe.tileID.overscaledZ),qe=u*Pe.queryPadding*a.EXTENT/Pe.tileSize/Ze,tt=[Oe.getTilePoint(new a.MercatorCoordinate(J,oe)),Oe.getTilePoint(new a.MercatorCoordinate(te,se))];if(tt[0].x-qe<a.EXTENT&&tt[0].y-qe<a.EXTENT&&tt[1].x+qe>=0&&tt[1].y+qe>=0){var ft=L.map(function(wt){return Oe.getTilePoint(wt)}),zt=G.map(function(wt){return Oe.getTilePoint(wt)});S.push({tile:Pe,tileID:Oe,queryGeometry:ft,cameraQueryGeometry:zt,scale:Ze})}}},Be=0;Be<W.length;Be++)ve(Be);return S},s.prototype.getVisibleCoordinates=function(o){for(var u=this,m=this.getRenderableIds(o).map(function(P){return u._tiles[P].tileID}),w=0,S=m;w<S.length;w+=1){var k=S[w];k.posMatrix=this.transform.calculatePosMatrix(k.toUnwrapped())}return m},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ve(this._source.type))for(var o in this._tiles){var u=this._tiles[o];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,u,m){this._state.updateState(o=o||"_geojsonTileLayer",u,m)},s.prototype.removeFeatureState=function(o,u,m){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,m)},s.prototype.getFeatureState=function(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)},s.prototype.setDependencies=function(o,u,m){var w=this._tiles[o];w&&w.setDependencies(u,m)},s.prototype.reloadTilesForDependencies=function(o,u){for(var m in this._tiles)this._tiles[m].hasDependency(o,u)&&this._reloadTile(m,"reloading");this._cache.filter(function(w){return!w.hasDependency(o,u)})},s}(a.Evented);function be(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),u=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||u-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Ve(n){return n==="raster"||n==="image"||n==="video"}function Xe(){return new a.window.Worker(su.workerUrl)}ie.maxOverzooming=10,ie.maxUnderzooming=3;var ze="mapboxgl_preloaded_worker_pool",je=function(){this.active={}};je.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<je.workerCount;)this.workers.push(new Xe);return this.active[n]=!0,this.workers.slice()},je.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},je.prototype.isPreloaded=function(){return!!this.active[ze]},je.prototype.numActive=function(){return Object.keys(this.active).length};var ht,st=Math.floor(a.browser.hardwareConcurrency/2);function Re(){return ht||(ht=new je),ht}function ot(n,s){var o={};for(var u in n)u!=="ref"&&(o[u]=n[u]);return a.refProperties.forEach(function(m){m in s&&(o[m]=s[m])}),o}function rt(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var u=0;u<n.length;u++)"ref"in n[u]&&(n[u]=ot(n[u],s[n[u].ref]));return n}je.workerCount=Math.max(Math.min(st,6),1);var Qe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Dt(n,s,o){o.push({command:Qe.addSource,args:[n,s[n]]})}function it(n,s,o){s.push({command:Qe.removeSource,args:[n]}),o[n]=!0}function $t(n,s,o,u){it(n,o,u),Dt(n,s,o)}function lr(n,s,o){var u;for(u in n[o])if(n[o].hasOwnProperty(u)&&u!=="data"&&!a.deepEqual(n[o][u],s[o][u]))return!1;for(u in s[o])if(s[o].hasOwnProperty(u)&&u!=="data"&&!a.deepEqual(n[o][u],s[o][u]))return!1;return!0}function Wt(n,s,o,u,m,w){var S;for(S in s=s||{},n=n||{})n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[u,S,s[S],m]}));for(S in s)s.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[u,S,s[S],m]}))}function ir(n){return n.id}function Xt(n,s){return n[s.id]=s,n}var ti=function(n,s){this.reset(n,s)};ti.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ti.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],u=n*this.paddedLength+this.padding;o<u&&s<this._distances.length;)o=this._distances[++s];var m=s-1,w=this._distances[m],S=o-w,k=S>0?(u-w)/S:0;return this.points[m].mult(1-k).add(this.points[s].mult(k))};var hr=function(n,s,o){var u=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var w=0;w<this.xCellCount*this.yCellCount;w++)u.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Ar(n,s,o,u,m){var w=a.create();return s?(a.scale(w,w,[1/m,1/m,1]),o||a.rotateZ(w,w,u.angle)):a.multiply(w,u.labelPlaneMatrix,n),w}function pr(n,s,o,u,m){if(s){var w=a.clone(n);return a.scale(w,w,[m,m,1]),o||a.rotateZ(w,w,-u.angle),w}return u.glCoordMatrix}function Jt(n,s){var o=[n.x,n.y,0,1];Or(o,o,s);var u=o[3];return{point:new a.Point(o[0]/u,o[1]/u),signedDistanceFromCamera:u}}function nr(n,s){return .5+n/s*.5}function ri(n,s){var o=n[0]/n[3],u=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&u>=-s[1]&&u<=s[1]}function mn(n,s,o,u,m,w,S,k){var P=u?n.textSizeData:n.iconSizeData,L=a.evaluateSizeForZoom(P,o.transform.zoom),G=[256/o.width*2+1,256/o.height*2+1],W=u?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;W.clear();for(var J=n.lineVertexArray,oe=u?n.text.placedSymbolArray:n.icon.placedSymbolArray,te=o.transform.width/o.transform.height,se=!1,$=0;$<oe.length;$++){var le=oe.get($);if(le.hidden||le.writingMode===a.WritingMode.vertical&&!se)Ti(le.numGlyphs,W);else{se=!1;var ye=[le.anchorX,le.anchorY,0,1];if(a.transformMat4(ye,ye,s),ri(ye,G)){var ve=nr(o.transform.cameraToCenterDistance,ye[3]),Be=a.evaluateSizeForFeature(P,L,le),Te=S?Be/ve:Be*ve,Pe=new a.Point(le.anchorX,le.anchorY),Oe=Jt(Pe,m).point,Ze={},qe=ba(le,Te,!1,k,s,m,w,n.glyphOffsetArray,J,W,Oe,Pe,Ze,te);se=qe.useVertical,(qe.notEnoughRoom||se||qe.needsFlipping&&ba(le,Te,!0,k,s,m,w,n.glyphOffsetArray,J,W,Oe,Pe,Ze,te).notEnoughRoom)&&Ti(le.numGlyphs,W)}else Ti(le.numGlyphs,W)}}u?n.text.dynamicLayoutVertexBuffer.updateData(W):n.icon.dynamicLayoutVertexBuffer.updateData(W)}function ci(n,s,o,u,m,w,S,k,P,L,G){var W=k.glyphStartIndex+k.numGlyphs,J=k.lineStartIndex,oe=k.lineStartIndex+k.lineLength,te=s.getoffsetX(k.glyphStartIndex),se=s.getoffsetX(W-1),$=zr(n*te,o,u,m,w,S,k.segment,J,oe,P,L,G);if(!$)return null;var le=zr(n*se,o,u,m,w,S,k.segment,J,oe,P,L,G);return le?{first:$,last:le}:null}function ki(n,s,o,u){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*u?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function ba(n,s,o,u,m,w,S,k,P,L,G,W,J,oe){var te,se=s/24,$=n.lineOffsetX*se,le=n.lineOffsetY*se;if(n.numGlyphs>1){var ye=n.glyphStartIndex+n.numGlyphs,ve=n.lineStartIndex,Be=n.lineStartIndex+n.lineLength,Te=ci(se,k,$,le,o,G,W,n,P,w,J);if(!Te)return{notEnoughRoom:!0};var Pe=Jt(Te.first.point,S).point,Oe=Jt(Te.last.point,S).point;if(u&&!o){var Ze=ki(n.writingMode,Pe,Oe,oe);if(Ze)return Ze}te=[Te.first];for(var qe=n.glyphStartIndex+1;qe<ye-1;qe++)te.push(zr(se*k.getoffsetX(qe),$,le,o,G,W,n.segment,ve,Be,P,w,J));te.push(Te.last)}else{if(u&&!o){var tt=Jt(W,m).point,ft=n.lineStartIndex+n.segment+1,zt=new a.Point(P.getx(ft),P.gety(ft)),wt=Jt(zt,m),Zt=wt.signedDistanceFromCamera>0?wt.point:An(W,zt,tt,1,m),dt=ki(n.writingMode,tt,Zt,oe);if(dt)return dt}var qt=zr(se*k.getoffsetX(n.glyphStartIndex),$,le,o,G,W,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,P,w,J);if(!qt)return{notEnoughRoom:!0};te=[qt]}for(var Mt=0,Vt=te;Mt<Vt.length;Mt+=1){var Bt=Vt[Mt];a.addDynamicAttributes(L,Bt.point,Bt.angle)}return{}}function An(n,s,o,u,m){var w=Jt(n.add(n.sub(s)._unit()),m).point,S=o.sub(w);return o.add(S._mult(u/S.mag()))}function zr(n,s,o,u,m,w,S,k,P,L,G,W){var J=u?n-s:n+s,oe=J>0?1:-1,te=0;u&&(oe*=-1,te=Math.PI),oe<0&&(te+=Math.PI);for(var se=oe>0?k+S:k+S+1,$=m,le=m,ye=0,ve=0,Be=Math.abs(J),Te=[];ye+ve<=Be;){if((se+=oe)<k||se>=P)return null;if(le=$,Te.push($),($=W[se])===void 0){var Pe=new a.Point(L.getx(se),L.gety(se)),Oe=Jt(Pe,G);if(Oe.signedDistanceFromCamera>0)$=W[se]=Oe.point;else{var Ze=se-oe;$=An(ye===0?w:new a.Point(L.getx(Ze),L.gety(Ze)),Pe,le,Be-ye+1,G)}}ye+=ve,ve=le.dist($)}var qe=(Be-ye)/ve,tt=$.sub(le),ft=tt.mult(qe)._add(le);ft._add(tt._unit()._perp()._mult(o*oe));var zt=te+Math.atan2($.y-le.y,$.x-le.x);return Te.push(ft),{point:ft,angle:zt,path:Te}}hr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},hr.prototype.insert=function(n,s,o,u,m){this._forEachCell(s,o,u,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(m)},hr.prototype.insertCircle=function(n,s,o,u){this._forEachCell(s-u,o-u,s+u,o+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(u)},hr.prototype._insertBoxCell=function(n,s,o,u,m,w){this.boxCells[m].push(w)},hr.prototype._insertCircleCell=function(n,s,o,u,m,w){this.circleCells[m].push(w)},hr.prototype._query=function(n,s,o,u,m,w){if(o<0||n>this.width||u<0||s>this.height)return!m&&[];var S=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=u){if(m)return!0;for(var k=0;k<this.boxKeys.length;k++)S.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(var P=0;P<this.circleKeys.length;P++){var L=this.circles[3*P],G=this.circles[3*P+1],W=this.circles[3*P+2];S.push({key:this.circleKeys[P],x1:L-W,y1:G-W,x2:L+W,y2:G+W})}return w?S.filter(w):S}return this._forEachCell(n,s,o,u,this._queryCell,S,{hitTest:m,seenUids:{box:{},circle:{}}},w),m?S.length>0:S},hr.prototype._queryCircle=function(n,s,o,u,m){var w=n-o,S=n+o,k=s-o,P=s+o;if(S<0||w>this.width||P<0||k>this.height)return!u&&[];var L=[];return this._forEachCell(w,k,S,P,this._queryCellCircle,L,{hitTest:u,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},m),u?L.length>0:L},hr.prototype.query=function(n,s,o,u,m){return this._query(n,s,o,u,!1,m)},hr.prototype.hitTest=function(n,s,o,u,m){return this._query(n,s,o,u,!0,m)},hr.prototype.hitTestCircle=function(n,s,o,u){return this._queryCircle(n,s,o,!0,u)},hr.prototype._queryCell=function(n,s,o,u,m,w,S,k){var P=S.seenUids,L=this.boxCells[m];if(L!==null)for(var G=this.bboxes,W=0,J=L;W<J.length;W+=1){var oe=J[W];if(!P.box[oe]){P.box[oe]=!0;var te=4*oe;if(n<=G[te+2]&&s<=G[te+3]&&o>=G[te+0]&&u>=G[te+1]&&(!k||k(this.boxKeys[oe]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[oe],x1:G[te],y1:G[te+1],x2:G[te+2],y2:G[te+3]})}}}var se=this.circleCells[m];if(se!==null)for(var $=this.circles,le=0,ye=se;le<ye.length;le+=1){var ve=ye[le];if(!P.circle[ve]){P.circle[ve]=!0;var Be=3*ve;if(this._circleAndRectCollide($[Be],$[Be+1],$[Be+2],n,s,o,u)&&(!k||k(this.circleKeys[ve]))){if(S.hitTest)return w.push(!0),!0;var Te=$[Be],Pe=$[Be+1],Oe=$[Be+2];w.push({key:this.circleKeys[ve],x1:Te-Oe,y1:Pe-Oe,x2:Te+Oe,y2:Pe+Oe})}}}},hr.prototype._queryCellCircle=function(n,s,o,u,m,w,S,k){var P=S.circle,L=S.seenUids,G=this.boxCells[m];if(G!==null)for(var W=this.bboxes,J=0,oe=G;J<oe.length;J+=1){var te=oe[J];if(!L.box[te]){L.box[te]=!0;var se=4*te;if(this._circleAndRectCollide(P.x,P.y,P.radius,W[se+0],W[se+1],W[se+2],W[se+3])&&(!k||k(this.boxKeys[te])))return w.push(!0),!0}}var $=this.circleCells[m];if($!==null)for(var le=this.circles,ye=0,ve=$;ye<ve.length;ye+=1){var Be=ve[ye];if(!L.circle[Be]){L.circle[Be]=!0;var Te=3*Be;if(this._circlesCollide(le[Te],le[Te+1],le[Te+2],P.x,P.y,P.radius)&&(!k||k(this.circleKeys[Be])))return w.push(!0),!0}}},hr.prototype._forEachCell=function(n,s,o,u,m,w,S,k){for(var P=this._convertToXCellCoord(n),L=this._convertToYCellCoord(s),G=this._convertToXCellCoord(o),W=this._convertToYCellCoord(u),J=P;J<=G;J++)for(var oe=L;oe<=W;oe++)if(m.call(this,n,s,o,u,this.xCellCount*oe+J,w,S,k))return},hr.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},hr.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},hr.prototype._circlesCollide=function(n,s,o,u,m,w){var S=u-n,k=m-s,P=o+w;return P*P>S*S+k*k},hr.prototype._circleAndRectCollide=function(n,s,o,u,m,w,S){var k=(w-u)/2,P=Math.abs(n-(u+k));if(P>k+o)return!1;var L=(S-m)/2,G=Math.abs(s-(m+L));if(G>L+o)return!1;if(P<=k||G<=L)return!0;var W=P-k,J=G-L;return W*W+J*J<=o*o};var Ko=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ti(n,s){for(var o=0;o<n;o++){var u=s.length;s.resize(u+4),s.float32.set(Ko,3*u)}}function Or(n,s,o){var u=s[0],m=s[1];return n[0]=o[0]*u+o[4]*m+o[12],n[1]=o[1]*u+o[5]*m+o[13],n[3]=o[3]*u+o[7]*m+o[15],n}var an=function(n,s,o){s===void 0&&(s=new hr(n.width+200,n.height+200,25)),o===void 0&&(o=new hr(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function yr(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}an.prototype.placeCollisionBox=function(n,s,o,u,m){var w=this.projectAndGetPerspectiveRatio(u,n.anchorPointX,n.anchorPointY),S=o*w.perspectiveRatio,k=n.x1*S+w.point.x,P=n.y1*S+w.point.y,L=n.x2*S+w.point.x,G=n.y2*S+w.point.y;return!this.isInsideGrid(k,P,L,G)||!s&&this.grid.hitTest(k,P,L,G,m)?{box:[],offscreen:!1}:{box:[k,P,L,G],offscreen:this.isOffscreen(k,P,L,G)}},an.prototype.placeCollisionCircles=function(n,s,o,u,m,w,S,k,P,L,G,W,J){var oe=[],te=new a.Point(s.anchorX,s.anchorY),se=Jt(te,w),$=nr(this.transform.cameraToCenterDistance,se.signedDistanceFromCamera),le=(L?m/$:m*$)/a.ONE_EM,ye=Jt(te,S).point,ve=ci(le,u,s.lineOffsetX*le,s.lineOffsetY*le,!1,ye,te,s,o,S,{}),Be=!1,Te=!1,Pe=!0;if(ve){for(var Oe=.5*W*$+J,Ze=new a.Point(-100,-100),qe=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),tt=new ti,ft=ve.first,zt=ve.last,wt=[],Zt=ft.path.length-1;Zt>=1;Zt--)wt.push(ft.path[Zt]);for(var dt=1;dt<zt.path.length;dt++)wt.push(zt.path[dt]);var qt=2.5*Oe;if(k){var Mt=wt.map(function(Bi){return Jt(Bi,k)});wt=Mt.some(function(Bi){return Bi.signedDistanceFromCamera<=0})?[]:Mt.map(function(Bi){return Bi.point})}var Vt=[];if(wt.length>0){for(var Bt=wt[0].clone(),Ot=wt[0].clone(),Q=1;Q<wt.length;Q++)Bt.x=Math.min(Bt.x,wt[Q].x),Bt.y=Math.min(Bt.y,wt[Q].y),Ot.x=Math.max(Ot.x,wt[Q].x),Ot.y=Math.max(Ot.y,wt[Q].y);Vt=Bt.x>=Ze.x&&Ot.x<=qe.x&&Bt.y>=Ze.y&&Ot.y<=qe.y?[wt]:Ot.x<Ze.x||Bt.x>qe.x||Ot.y<Ze.y||Bt.y>qe.y?[]:a.clipLine([wt],Ze.x,Ze.y,qe.x,qe.y)}for(var Ie=0,Wr=Vt;Ie<Wr.length;Ie+=1){var Dr;tt.reset(Wr[Ie],.25*Oe),Dr=tt.length<=.5*Oe?1:Math.ceil(tt.paddedLength/qt)+1;for(var Pi=0;Pi<Dr;Pi++){var yi=Pi/Math.max(Dr-1,1),kr=tt.lerp(yi),Jr=kr.x+100,$i=kr.y+100;oe.push(Jr,$i,Oe,0);var Ri=Jr-Oe,en=$i-Oe,Zi=Jr+Oe,Ln=$i+Oe;if(Pe=Pe&&this.isOffscreen(Ri,en,Zi,Ln),Te=Te||this.isInsideGrid(Ri,en,Zi,Ln),!n&&this.grid.hitTestCircle(Jr,$i,Oe,G)&&(Be=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Be}}}}return{circles:!P&&Be||!Te?[]:oe,offscreen:Pe,collisionDetected:Be}},an.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,u=1/0,m=-1/0,w=-1/0,S=0,k=n;S<k.length;S+=1){var P=k[S],L=new a.Point(P.x+100,P.y+100);o=Math.min(o,L.x),u=Math.min(u,L.y),m=Math.max(m,L.x),w=Math.max(w,L.y),s.push(L)}for(var G={},W={},J=0,oe=this.grid.query(o,u,m,w).concat(this.ignoredGrid.query(o,u,m,w));J<oe.length;J+=1){var te=oe[J],se=te.key;if(G[se.bucketInstanceId]===void 0&&(G[se.bucketInstanceId]={}),!G[se.bucketInstanceId][se.featureIndex]){var $=[new a.Point(te.x1,te.y1),new a.Point(te.x2,te.y1),new a.Point(te.x2,te.y2),new a.Point(te.x1,te.y2)];a.polygonIntersectsPolygon(s,$)&&(G[se.bucketInstanceId][se.featureIndex]=!0,W[se.bucketInstanceId]===void 0&&(W[se.bucketInstanceId]=[]),W[se.bucketInstanceId].push(se.featureIndex))}}return W},an.prototype.insertCollisionBox=function(n,s,o,u,m){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:u,collisionGroupID:m},n[0],n[1],n[2],n[3])},an.prototype.insertCollisionCircles=function(n,s,o,u,m){for(var w=s?this.ignoredGrid:this.grid,S={bucketInstanceId:o,featureIndex:u,collisionGroupID:m},k=0;k<n.length;k+=4)w.insertCircle(S,n[k],n[k+1],n[k+2])},an.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var u=[s,o,0,1];return Or(u,u,n),{point:new a.Point((u[0]/u[3]+1)/2*this.transform.width+100,(-u[1]/u[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/u[3]*.5}},an.prototype.isOffscreen=function(n,s,o,u){return o<100||n>=this.screenRightBoundary||u<100||s>this.screenBottomBoundary},an.prototype.isInsideGrid=function(n,s,o,u){return o>=0&&n<this.gridRightBoundary&&u>=0&&s<this.gridBottomBoundary},an.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var mi=function(n,s,o,u){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):u&&o?1:0,this.placed=o};mi.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var bi=function(n,s,o,u,m){this.text=new mi(n?n.text:null,s,o,m),this.icon=new mi(n?n.icon:null,s,u,m)};bi.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Bs=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},oi=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},xa=function(n,s,o,u,m){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=u,this.tileID=m},Ui=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function ai(n,s,o,u,m){var w=a.getAnchorAlignment(n),S=-(w.horizontalAlign-.5)*s,k=-(w.verticalAlign-.5)*o,P=a.evaluateVariableOffset(n,u);return new a.Point(S+P[0]*m,k+P[1]*m)}function sn(n,s,o,u,m,w){var S=n.x1,k=n.x2,P=n.y1,L=n.y2,G=n.anchorPointX,W=n.anchorPointY,J=new a.Point(s,o);return u&&J._rotate(m?w:-w),{x1:S+J.x,y1:P+J.y,x2:k+J.x,y2:L+J.y,anchorPointX:G,anchorPointY:W}}Ui.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var ji=function(n,s,o,u){this.transform=n.clone(),this.collisionIndex=new an(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Ui(o),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}};function jn(n,s,o,u,m){n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0)}ji.prototype.getBucketParts=function(n,s,o,u){var m=o.getBucket(s),w=o.latestFeatureIndex;if(m&&w&&s.id===m.layerIds[0]){var S=o.collisionBoxArray,k=m.layers[0].layout,P=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),L=o.tileSize/a.EXTENT,G=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),W=k.get("text-pitch-alignment")==="map",J=k.get("text-rotation-alignment")==="map",oe=yr(o,1,this.transform.zoom),te=Ar(G,W,J,this.transform,oe),se=null;if(W){var $=pr(G,W,J,this.transform,oe);se=a.multiply([],this.transform.labelPlaneMatrix,$)}this.retainedQueryData[m.bucketInstanceId]=new xa(m.bucketInstanceId,w,m.sourceLayerIndex,m.index,o.tileID);var le={bucket:m,layout:k,posMatrix:G,textLabelPlaneMatrix:te,labelToScreenMatrix:se,scale:P,textPixelRatio:L,holdingForFade:o.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(u)for(var ye=0,ve=m.sortKeyRanges;ye<ve.length;ye+=1){var Be=ve[ye];n.push({sortKey:Be.sortKey,symbolInstanceStart:Be.symbolInstanceStart,symbolInstanceEnd:Be.symbolInstanceEnd,parameters:le})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:le})}},ji.prototype.attemptAnchorPlacement=function(n,s,o,u,m,w,S,k,P,L,G,W,J,oe,te){var se,$=[W.textOffset0,W.textOffset1],le=ai(n,o,u,$,m),ye=this.collisionIndex.placeCollisionBox(sn(s,le.x,le.y,w,S,this.transform.angle),G,k,P,L.predicate);if(!te||this.collisionIndex.placeCollisionBox(sn(te,le.x,le.y,w,S,this.transform.angle),G,k,P,L.predicate).box.length!==0)return ye.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&(se=this.prevPlacement.variableOffsets[W.crossTileID].anchor),this.variableOffsets[W.crossTileID]={textOffset:$,width:o,height:u,anchor:n,textBoxScale:m,prevAnchor:se},this.markUsedJustification(J,n,W,oe),J.allowVerticalPlacement&&(this.markUsedOrientation(J,oe,W),this.placedOrientations[W.crossTileID]=oe),{shift:le,placedGlyphBoxes:ye}):void 0},ji.prototype.placeLayerBucketPart=function(n,s,o){var u=this,m=n.parameters,w=m.bucket,S=m.layout,k=m.posMatrix,P=m.textLabelPlaneMatrix,L=m.labelToScreenMatrix,G=m.textPixelRatio,W=m.holdingForFade,J=m.collisionBoxArray,oe=m.partiallyEvaluatedTextSize,te=m.collisionGroup,se=S.get("text-optional"),$=S.get("icon-optional"),le=S.get("text-allow-overlap"),ye=S.get("icon-allow-overlap"),ve=S.get("text-rotation-alignment")==="map",Be=S.get("text-pitch-alignment")==="map",Te=S.get("icon-text-fit")!=="none",Pe=S.get("symbol-z-order")==="viewport-y",Oe=le&&(ye||!w.hasIconData()||$),Ze=ye&&(le||!w.hasTextData()||se);!w.collisionArrays&&J&&w.deserializeCollisionBoxes(J);var qe=function(dt,qt){if(!s[dt.crossTileID])if(W)u.placements[dt.crossTileID]=new Bs(!1,!1,!1);else{var Mt,Vt=!1,Bt=!1,Ot=!0,Q=null,Ie={box:null,offscreen:null},Wr={box:null,offscreen:null},Dr=null,Pi=null,yi=0,kr=0,Jr=0;qt.textFeatureIndex?yi=qt.textFeatureIndex:dt.useRuntimeCollisionCircles&&(yi=dt.featureIndex),qt.verticalTextFeatureIndex&&(kr=qt.verticalTextFeatureIndex);var $i=qt.textBox;if($i){var Ri=function(Tr){var xo=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Tr&&u.prevPlacement){var Rn=u.prevPlacement.placedOrientations[dt.crossTileID];Rn&&(u.placedOrientations[dt.crossTileID]=Rn,u.markUsedOrientation(w,xo=Rn,dt))}return xo},en=function(Tr,xo){if(w.allowVerticalPlacement&&dt.numVerticalGlyphVertices>0&&qt.verticalTextBox)for(var Rn=0,Cs=w.writingModes;Rn<Cs.length&&(Cs[Rn]===a.WritingMode.vertical?(Ie=xo(),Wr=Ie):Ie=Tr(),!(Ie&&Ie.box&&Ie.box.length));Rn+=1);else Ie=Tr()};if(S.get("text-variable-anchor")){var Zi=S.get("text-variable-anchor");if(u.prevPlacement&&u.prevPlacement.variableOffsets[dt.crossTileID]){var Ln=u.prevPlacement.variableOffsets[dt.crossTileID];Zi.indexOf(Ln.anchor)>0&&(Zi=Zi.filter(function(Tr){return Tr!==Ln.anchor})).unshift(Ln.anchor)}var Bi=function(Tr,xo,Rn){for(var Cs=Tr.x2-Tr.x1,lc=Tr.y2-Tr.y1,Cl=dt.textBoxScale,_a=Te&&!ye?xo:null,ol={box:[],offscreen:!1},lu=le?2*Zi.length:Zi.length,al=0;al<lu;++al){var Ml=u.attemptAnchorPlacement(Zi[al%Zi.length],Tr,Cs,lc,Cl,ve,Be,G,k,te,al>=Zi.length,dt,w,Rn,_a);if(Ml&&(ol=Ml.placedGlyphBoxes)&&ol.box&&ol.box.length){Vt=!0,Q=Ml.shift;break}}return ol};en(function(){return Bi($i,qt.iconBox,a.WritingMode.horizontal)},function(){var Tr=qt.verticalTextBox;return w.allowVerticalPlacement&&!(Ie&&Ie.box&&Ie.box.length)&&dt.numVerticalGlyphVertices>0&&Tr?Bi(Tr,qt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Ie&&(Vt=Ie.box,Ot=Ie.offscreen);var ya=Ri(Ie&&Ie.box);if(!Vt&&u.prevPlacement){var ra=u.prevPlacement.variableOffsets[dt.crossTileID];ra&&(u.variableOffsets[dt.crossTileID]=ra,u.markUsedJustification(w,ra.anchor,dt,ya))}}else{var ps=function(Tr,xo){var Rn=u.collisionIndex.placeCollisionBox(Tr,le,G,k,te.predicate);return Rn&&Rn.box&&Rn.box.length&&(u.markUsedOrientation(w,xo,dt),u.placedOrientations[dt.crossTileID]=xo),Rn};en(function(){return ps($i,a.WritingMode.horizontal)},function(){var Tr=qt.verticalTextBox;return w.allowVerticalPlacement&&dt.numVerticalGlyphVertices>0&&Tr?ps(Tr,a.WritingMode.vertical):{box:null,offscreen:null}}),Ri(Ie&&Ie.box&&Ie.box.length)}}if(Vt=(Mt=Ie)&&Mt.box&&Mt.box.length>0,Ot=Mt&&Mt.offscreen,dt.useRuntimeCollisionCircles){var fs=w.text.placedSymbolArray.get(dt.centerJustifiedTextSymbolIndex),nl=a.evaluateSizeForFeature(w.textSizeData,oe,fs),ga=S.get("text-padding");Dr=u.collisionIndex.placeCollisionCircles(le,fs,w.lineVertexArray,w.glyphOffsetArray,nl,k,P,L,o,Be,te.predicate,dt.collisionCircleDiameter,ga),Vt=le||Dr.circles.length>0&&!Dr.collisionDetected,Ot=Ot&&Dr.offscreen}if(qt.iconFeatureIndex&&(Jr=qt.iconFeatureIndex),qt.iconBox){var Jn=function(Tr){var xo=Te&&Q?sn(Tr,Q.x,Q.y,ve,Be,u.transform.angle):Tr;return u.collisionIndex.placeCollisionBox(xo,ye,G,k,te.predicate)};Bt=Wr&&Wr.box&&Wr.box.length&&qt.verticalIconBox?(Pi=Jn(qt.verticalIconBox)).box.length>0:(Pi=Jn(qt.iconBox)).box.length>0,Ot=Ot&&Pi.offscreen}var ro=se||dt.numHorizontalGlyphVertices===0&&dt.numVerticalGlyphVertices===0,Gi=$||dt.numIconVertices===0;if(ro||Gi?Gi?ro||(Bt=Bt&&Vt):Vt=Bt&&Vt:Bt=Vt=Bt&&Vt,Vt&&Mt&&Mt.box&&u.collisionIndex.insertCollisionBox(Mt.box,S.get("text-ignore-placement"),w.bucketInstanceId,Wr&&Wr.box&&kr?kr:yi,te.ID),Bt&&Pi&&u.collisionIndex.insertCollisionBox(Pi.box,S.get("icon-ignore-placement"),w.bucketInstanceId,Jr,te.ID),Dr&&(Vt&&u.collisionIndex.insertCollisionCircles(Dr.circles,S.get("text-ignore-placement"),w.bucketInstanceId,yi,te.ID),o)){var hn=w.bucketInstanceId,ds=u.collisionCircleArrays[hn];ds===void 0&&(ds=u.collisionCircleArrays[hn]=new oi);for(var ms=0;ms<Dr.circles.length;ms+=4)ds.circles.push(Dr.circles[ms+0]),ds.circles.push(Dr.circles[ms+1]),ds.circles.push(Dr.circles[ms+2]),ds.circles.push(Dr.collisionDetected?1:0)}u.placements[dt.crossTileID]=new Bs(Vt||Oe,Bt||Ze,Ot||w.justReloaded),s[dt.crossTileID]=!0}};if(Pe)for(var tt=w.getSortedSymbolIndexes(this.transform.angle),ft=tt.length-1;ft>=0;--ft){var zt=tt[ft];qe(w.symbolInstances.get(zt),w.collisionArrays[zt])}else for(var wt=n.symbolInstanceStart;wt<n.symbolInstanceEnd;wt++)qe(w.symbolInstances.get(wt),w.collisionArrays[wt]);if(o&&w.bucketInstanceId in this.collisionCircleArrays){var Zt=this.collisionCircleArrays[w.bucketInstanceId];a.invert(Zt.invProjMatrix,k),Zt.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},ji.prototype.markUsedJustification=function(n,s,o,u){var m;m=u===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];w<S.length;w+=1){var k=S[w];k>=0&&(n.text.placedSymbolArray.get(k).crossTileID=m>=0&&k!==m?0:o.crossTileID)}},ji.prototype.markUsedOrientation=function(n,s,o){for(var u=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,m=s===a.WritingMode.vertical?s:0,w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];w<S.length;w+=1)n.text.placedSymbolArray.get(S[w]).placedOrientation=u;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=m)},ji.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var u=s?s.symbolFadeChange(n):1,m=s?s.opacities:{},w=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(var k in this.placements){var P=this.placements[k],L=m[k];L?(this.opacities[k]=new bi(L,u,P.text,P.icon),o=o||P.text!==L.text.placed||P.icon!==L.icon.placed):(this.opacities[k]=new bi(null,u,P.text,P.icon,P.skipFade),o=o||P.text||P.icon)}for(var G in m){var W=m[G];if(!this.opacities[G]){var J=new bi(W,u,!1,!1);J.isHidden()||(this.opacities[G]=J,o=o||W.text.placed||W.icon.placed)}}for(var oe in w)this.variableOffsets[oe]||!this.opacities[oe]||this.opacities[oe].isHidden()||(this.variableOffsets[oe]=w[oe]);for(var te in S)this.placedOrientations[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.placedOrientations[te]=S[te]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},ji.prototype.updateLayerOpacities=function(n,s){for(var o={},u=0,m=s;u<m.length;u+=1){var w=m[u],S=w.getBucket(n);S&&w.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,o,w.collisionBoxArray)}},ji.prototype.updateBucketOpacities=function(n,s,o){var u=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var m=n.layers[0].layout,w=new bi(null,0,!1,!1,!0),S=m.get("text-allow-overlap"),k=m.get("icon-allow-overlap"),P=m.get("text-variable-anchor"),L=m.get("text-rotation-alignment")==="map",G=m.get("text-pitch-alignment")==="map",W=m.get("icon-text-fit")!=="none",J=new bi(null,0,S&&(k||!n.hasIconData()||m.get("icon-optional")),k&&(S||!n.hasTextData()||m.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var oe=function(le,ye,ve){for(var Be=0;Be<ye/4;Be++)le.opacityVertexArray.emplaceBack(ve)},te=function(le){var ye=n.symbolInstances.get(le),ve=ye.numHorizontalGlyphVertices,Be=ye.numVerticalGlyphVertices,Te=ye.crossTileID,Pe=u.opacities[Te];s[Te]?Pe=w:Pe||(u.opacities[Te]=Pe=J),s[Te]=!0;var Oe=ye.numIconVertices>0,Ze=u.placedOrientations[ye.crossTileID],qe=Ze===a.WritingMode.vertical,tt=Ze===a.WritingMode.horizontal||Ze===a.WritingMode.horizontalOnly;if(ve>0||Be>0){var ft=Sa(Pe.text);oe(n.text,ve,qe?Ea:ft),oe(n.text,Be,tt?Ea:ft);var zt=Pe.text.isHidden();[ye.rightJustifiedTextSymbolIndex,ye.centerJustifiedTextSymbolIndex,ye.leftJustifiedTextSymbolIndex].forEach(function(Ie){Ie>=0&&(n.text.placedSymbolArray.get(Ie).hidden=zt||qe?1:0)}),ye.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(ye.verticalPlacedTextSymbolIndex).hidden=zt||tt?1:0);var wt=u.variableOffsets[ye.crossTileID];wt&&u.markUsedJustification(n,wt.anchor,ye,Ze);var Zt=u.placedOrientations[ye.crossTileID];Zt&&(u.markUsedJustification(n,"left",ye,Zt),u.markUsedOrientation(n,Zt,ye))}if(Oe){var dt=Sa(Pe.icon),qt=!(W&&ye.verticalPlacedIconSymbolIndex&&qe);ye.placedIconSymbolIndex>=0&&(oe(n.icon,ye.numIconVertices,qt?dt:Ea),n.icon.placedSymbolArray.get(ye.placedIconSymbolIndex).hidden=Pe.icon.isHidden()),ye.verticalPlacedIconSymbolIndex>=0&&(oe(n.icon,ye.numVerticalIconVertices,qt?Ea:dt),n.icon.placedSymbolArray.get(ye.verticalPlacedIconSymbolIndex).hidden=Pe.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Mt=n.collisionArrays[le];if(Mt){var Vt=new a.Point(0,0);if(Mt.textBox||Mt.verticalTextBox){var Bt=!0;if(P){var Ot=u.variableOffsets[Te];Ot?(Vt=ai(Ot.anchor,Ot.width,Ot.height,Ot.textOffset,Ot.textBoxScale),L&&Vt._rotate(G?u.transform.angle:-u.transform.angle)):Bt=!1}Mt.textBox&&jn(n.textCollisionBox.collisionVertexArray,Pe.text.placed,!Bt||qe,Vt.x,Vt.y),Mt.verticalTextBox&&jn(n.textCollisionBox.collisionVertexArray,Pe.text.placed,!Bt||tt,Vt.x,Vt.y)}var Q=Boolean(!tt&&Mt.verticalIconBox);Mt.iconBox&&jn(n.iconCollisionBox.collisionVertexArray,Pe.icon.placed,Q,W?Vt.x:0,W?Vt.y:0),Mt.verticalIconBox&&jn(n.iconCollisionBox.collisionVertexArray,Pe.icon.placed,!Q,W?Vt.x:0,W?Vt.y:0)}}},se=0;se<n.symbolInstances.length;se++)te(se);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var $=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=$.invProjMatrix,n.placementViewportMatrix=$.viewportMatrix,n.collisionCircleArray=$.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},ji.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ji.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},ji.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},ji.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},ji.prototype.setStale=function(){this.stale=!0};var Xa=Math.pow(2,25),wl=Math.pow(2,24),Ha=Math.pow(2,17),wa=Math.pow(2,16),Wa=Math.pow(2,9),yn=Math.pow(2,8),Xo=Math.pow(2,1);function Sa(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*Xa+s*wl+o*Ha+s*wa+o*Wa+s*yn+o*Xo+s}var Ea=0,ka=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ka.prototype.continuePlacement=function(n,s,o,u,m){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,u,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(S,k){return S.sortKey-k.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,m())return!0;return!1};var oa=function(n,s,o,u,m,w,S){this.placement=new ji(n,m,w,S),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=u,this._done=!1};oa.prototype.isDone=function(){return this._done},oa.prototype.continuePlacement=function(n,s,o){for(var u=this,m=a.browser.now(),w=function(){var P=a.browser.now()-m;return!u._forceFullPlacement&&P>2};this._currentPlacementIndex>=0;){var S=s[n[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=k)&&(!S.maxzoom||S.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new ka(S)),this._inProgressLayer.continuePlacement(o[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},oa.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Os=512/a.EXTENT/2,Ta=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var u=0;u<s.length;u++){var m=s.get(u),w=m.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:m.crossTileID,coord:this.getScaledCoordinates(m,n)})}};Ta.prototype.getScaledCoordinates=function(n,s){var o=Os/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},Ta.prototype.findMatches=function(n,s,o){for(var u=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),m=0;m<n.length;m++){var w=n.get(m);if(!w.crossTileID){var S=this.indexedSymbolInstances[w.key];if(S)for(var k=this.getScaledCoordinates(w,s),P=0,L=S;P<L.length;P+=1){var G=L[P];if(Math.abs(G.coord.x-k.x)<=u&&Math.abs(G.coord.y-k.y)<=u&&!o[G.crossTileID]){o[G.crossTileID]=!0,w.crossTileID=G.crossTileID;break}}}}};var Ii=function(){this.maxCrossTileID=0};Ii.prototype.generate=function(){return++this.maxCrossTileID};var gn=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};gn.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var u=this.indexes[o],m={};for(var w in u){var S=u[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),m[S.tileID.key]=S}this.indexes[o]=m}this.lng=n},gn.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var u=0;u<s.symbolInstances.length;u++)s.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var m=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var S=this.indexes[w];if(Number(w)>n.overscaledZ)for(var k in S){var P=S[k];P.tileID.isChildOf(n)&&P.findMatches(s.symbolInstances,n,m)}else{var L=S[n.scaledTo(Number(w)).key];L&&L.findMatches(s.symbolInstances,n,m)}}for(var G=0;G<s.symbolInstances.length;G++){var W=s.symbolInstances.get(G);W.crossTileID||(W.crossTileID=o.generate(),m[W.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Ta(n,s.symbolInstances,s.bucketInstanceId),!0},gn.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var u=0,m=s.indexedSymbolInstances[o];u<m.length;u+=1)delete this.usedCrossTileIDs[n][m[u].crossTileID]},gn.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var u=this.indexes[o];for(var m in u)n[u[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,u[m]),delete u[m],s=!0)}return s};var _e=function(){this.layerIndexes={},this.crossTileIDs=new Ii,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};_e.prototype.addLayer=function(n,s,o){var u=this.layerIndexes[n.id];u===void 0&&(u=this.layerIndexes[n.id]=new gn);var m=!1,w={};u.handleWrapJump(o);for(var S=0,k=s;S<k.length;S+=1){var P=k[S],L=P.getBucket(n);L&&n.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(P.tileID,L,this.crossTileIDs)&&(m=!0),w[L.bucketInstanceId]=!0)}return u.removeStaleBuckets(w)&&(m=!0),m},_e.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(u){s[u]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var ln=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},Ai=a.pick(Qe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Mr=a.pick(Qe,["setCenter","setZoom","setBearing","setPitch"]),Ho=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var u,m=a.styleSpec.$root[o];m.required&&(u=o==="version"?s:m.type==="array"?[]:{})!=null&&(n[o]=u)}return n}(),_n=function(n){function s(o,u){var m=this;u===void 0&&(u={}),n.call(this),this.map=o,this.dispatcher=new yt(Re(),this),this.imageManager=new Ue,this.imageManager.setEventedParent(this),this.glyphManager=new St(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new mt(256,512),this.crossTileSymbolIndex=new _e,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(S){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(k,P){if(a.triggerPluginCompletionEvent(k),P&&P.every(function(G){return G}))for(var L in w.sourceCaches)w.sourceCaches[L].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var k=m.sourceCaches[S.sourceId];if(k){var P=k.getSource();if(P&&P.vectorLayerIds)for(var L in m._layers){var G=m._layers[L];G.source===P.id&&m._validateLayer(G)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,u){var m=this;u===void 0&&(u={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var w=typeof u.validate=="boolean"?u.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,u.accessToken);var S=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(S,function(k,P){m._request=null,k?m.fire(new a.ErrorEvent(k)):P&&m._load(P,w)})},s.prototype.loadJSON=function(o,u){var m=this;u===void 0&&(u={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){m._request=null,m._load(o,u.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Ho,!1)},s.prototype._load=function(o,u){if(!u||!ln(this,a.validateStyle(o))){for(var m in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(m,o.sources[m],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var w=rt(this.stylesheet.layers);this._order=w.map(function(L){return L.id}),this._layers={},this._serializedLayers={};for(var S=0,k=w;S<k.length;S+=1){var P=k[S];(P=a.createStyleLayer(P)).setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Lt(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var u=this;this._spriteRequest=function(m,w,S){var k,P,L,G=a.browser.devicePixelRatio>1?"@2x":"",W=a.getJSON(w.transformRequest(w.normalizeSpriteURL(m,G,".json"),a.ResourceType.SpriteJSON),function(te,se){W=null,L||(L=te,k=se,oe())}),J=a.getImage(w.transformRequest(w.normalizeSpriteURL(m,G,".png"),a.ResourceType.SpriteImage),function(te,se){J=null,L||(L=te,P=se,oe())});function oe(){if(L)S(L);else if(k&&P){var te=a.browser.getImageData(P),se={};for(var $ in k){var le=k[$],ye=le.width,ve=le.height,Be=le.x,Te=le.y,Pe=le.sdf,Oe=le.pixelRatio,Ze=le.stretchX,qe=le.stretchY,tt=le.content,ft=new a.RGBAImage({width:ye,height:ve});a.RGBAImage.copy(te,ft,{x:Be,y:Te},{x:0,y:0},{width:ye,height:ve}),se[$]={data:ft,pixelRatio:Oe,sdf:Pe,stretchX:Ze,stretchY:qe,content:tt}}S(null,se)}}return{cancel:function(){W&&(W.cancel(),W=null),J&&(J.cancel(),J=null)}}}(o,this.map._requestManager,function(m,w){if(u._spriteRequest=null,m)u.fire(new a.ErrorEvent(m));else if(w)for(var S in w)u.imageManager.addImage(S,w[S]);u.imageManager.setLoaded(!0),u._availableImages=u.imageManager.listImages(),u.dispatcher.broadcast("setImages",u._availableImages),u.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var u=this.sourceCaches[o.source];if(u){var m=o.sourceLayer;if(m){var w=u.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(m)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+m+'" does not exist on source "'+w.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var u=[],m=0,w=o;m<w.length;m+=1){var S=this._layers[w[m]];S.type!=="custom"&&u.push(S.serialize())}return u},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var u in this._layers)if(this._layers[u].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var u=this._changed;if(this._changed){var m=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var S in(m.length||w.length)&&this._updateWorkerLayers(m,w),this._updatedSources){var k=this._updatedSources[S];k==="reload"?this._reloadSource(S):k==="clear"&&this._clearSource(S)}for(var P in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var L={};for(var G in this.sourceCaches){var W=this.sourceCaches[G];L[G]=W.used,W.used=!1}for(var J=0,oe=this._order;J<oe.length;J+=1){var te=this._layers[oe[J]];te.recalculate(o,this._availableImages),!te.isHidden(o.zoom)&&te.source&&(this.sourceCaches[te.source].used=!0)}for(var se in L){var $=this.sourceCaches[se];L[se]!==$.used&&$.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:se}))}this.light.recalculate(o),this.z=o.zoom,u&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:u})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var u=this;if(this._checkLoaded(),ln(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=rt(o.layers);var m=function(S,k){if(!S)return[{command:Qe.setStyle,args:[k]}];var P=[];try{if(!a.deepEqual(S.version,k.version))return[{command:Qe.setStyle,args:[k]}];a.deepEqual(S.center,k.center)||P.push({command:Qe.setCenter,args:[k.center]}),a.deepEqual(S.zoom,k.zoom)||P.push({command:Qe.setZoom,args:[k.zoom]}),a.deepEqual(S.bearing,k.bearing)||P.push({command:Qe.setBearing,args:[k.bearing]}),a.deepEqual(S.pitch,k.pitch)||P.push({command:Qe.setPitch,args:[k.pitch]}),a.deepEqual(S.sprite,k.sprite)||P.push({command:Qe.setSprite,args:[k.sprite]}),a.deepEqual(S.glyphs,k.glyphs)||P.push({command:Qe.setGlyphs,args:[k.glyphs]}),a.deepEqual(S.transition,k.transition)||P.push({command:Qe.setTransition,args:[k.transition]}),a.deepEqual(S.light,k.light)||P.push({command:Qe.setLight,args:[k.light]});var L={},G=[];(function(J,oe,te,se){var $;for($ in oe=oe||{},J=J||{})J.hasOwnProperty($)&&(oe.hasOwnProperty($)||it($,te,se));for($ in oe)oe.hasOwnProperty($)&&(J.hasOwnProperty($)?a.deepEqual(J[$],oe[$])||(J[$].type==="geojson"&&oe[$].type==="geojson"&&lr(J,oe,$)?te.push({command:Qe.setGeoJSONSourceData,args:[$,oe[$].data]}):$t($,oe,te,se)):Dt($,oe,te))})(S.sources,k.sources,G,L);var W=[];S.layers&&S.layers.forEach(function(J){L[J.source]?P.push({command:Qe.removeLayer,args:[J.id]}):W.push(J)}),P=P.concat(G),function(J,oe,te){oe=oe||[];var se,$,le,ye,ve,Be,Te,Pe=(J=J||[]).map(ir),Oe=oe.map(ir),Ze=J.reduce(Xt,{}),qe=oe.reduce(Xt,{}),tt=Pe.slice(),ft=Object.create(null);for(se=0,$=0;se<Pe.length;se++)qe.hasOwnProperty(le=Pe[se])?$++:(te.push({command:Qe.removeLayer,args:[le]}),tt.splice(tt.indexOf(le,$),1));for(se=0,$=0;se<Oe.length;se++)tt[tt.length-1-se]!==(le=Oe[Oe.length-1-se])&&(Ze.hasOwnProperty(le)?(te.push({command:Qe.removeLayer,args:[le]}),tt.splice(tt.lastIndexOf(le,tt.length-$),1)):$++,te.push({command:Qe.addLayer,args:[qe[le],Be=tt[tt.length-se]]}),tt.splice(tt.length-se,0,le),ft[le]=!0);for(se=0;se<Oe.length;se++)if(ye=Ze[le=Oe[se]],ve=qe[le],!ft[le]&&!a.deepEqual(ye,ve))if(a.deepEqual(ye.source,ve.source)&&a.deepEqual(ye["source-layer"],ve["source-layer"])&&a.deepEqual(ye.type,ve.type)){for(Te in Wt(ye.layout,ve.layout,te,le,null,Qe.setLayoutProperty),Wt(ye.paint,ve.paint,te,le,null,Qe.setPaintProperty),a.deepEqual(ye.filter,ve.filter)||te.push({command:Qe.setFilter,args:[le,ve.filter]}),a.deepEqual(ye.minzoom,ve.minzoom)&&a.deepEqual(ye.maxzoom,ve.maxzoom)||te.push({command:Qe.setLayerZoomRange,args:[le,ve.minzoom,ve.maxzoom]}),ye)ye.hasOwnProperty(Te)&&Te!=="layout"&&Te!=="paint"&&Te!=="filter"&&Te!=="metadata"&&Te!=="minzoom"&&Te!=="maxzoom"&&(Te.indexOf("paint.")===0?Wt(ye[Te],ve[Te],te,le,Te.slice(6),Qe.setPaintProperty):a.deepEqual(ye[Te],ve[Te])||te.push({command:Qe.setLayerProperty,args:[le,Te,ve[Te]]}));for(Te in ve)ve.hasOwnProperty(Te)&&!ye.hasOwnProperty(Te)&&Te!=="layout"&&Te!=="paint"&&Te!=="filter"&&Te!=="metadata"&&Te!=="minzoom"&&Te!=="maxzoom"&&(Te.indexOf("paint.")===0?Wt(ye[Te],ve[Te],te,le,Te.slice(6),Qe.setPaintProperty):a.deepEqual(ye[Te],ve[Te])||te.push({command:Qe.setLayerProperty,args:[le,Te,ve[Te]]}))}else te.push({command:Qe.removeLayer,args:[le]}),Be=tt[tt.lastIndexOf(le)+1],te.push({command:Qe.addLayer,args:[ve,Be]})}(W,k.layers,P)}catch(J){console.warn("Unable to compute style diff:",J),P=[{command:Qe.setStyle,args:[k]}]}return P}(this.serialize(),o).filter(function(S){return!(S.command in Mr)});if(m.length===0)return!1;var w=m.filter(function(S){return!(S.command in Ai)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(S){return S.command}).join(", ")+".");return m.forEach(function(S){S.command!=="setTransition"&&u[S.command].apply(u,S.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,u){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,u),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,u){this.imageManager.updateImage(o,u)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,u,m){var w=this;if(m===void 0&&(m={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(u).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,u,null,m))){this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);var S=this.sourceCaches[o]=new ie(o,u,this.dispatcher);S.style=this,S.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:S.serialize(),sourceId:o}}),S.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var u in this._layers)if(this._layers[u].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+u+'" is using it.')));var m=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],m.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),m.setEventedParent(null),m.clearTiles(),m.onRemove&&m.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,u){this._checkLoaded(),this.sourceCaches[o].getSource().setData(u),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,u,m){m===void 0&&(m={}),this._checkLoaded();var w=o.id;if(this.getLayer(w))this.fire(new a.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var S;if(o.type==="custom"){if(ln(this,a.validateCustomStyleLayer(o)))return;S=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.clone$1(o),o=a.extend(o,{source:w})),this._validate(a.validateStyle.layer,"layers."+w,o,{arrayIndex:-1},m))return;S=a.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize()}var k=u?this._order.indexOf(u):this._order.length;if(u&&k===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.')));else{if(this._order.splice(k,0,w),this._layerOrderChanged=!0,this._layers[w]=S,this._removedLayers[w]&&S.source&&S.type!=="custom"){var P=this._removedLayers[w];delete this._removedLayers[w],P.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},s.prototype.moveLayer=function(o,u){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==u){var m=this._order.indexOf(o);this._order.splice(m,1);var w=u?this._order.indexOf(u):this._order.length;u&&w===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.'))):(this._order.splice(w,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var u=this._layers[o];if(u){u.setEventedParent(null);var m=this._order.indexOf(o);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,u,m){this._checkLoaded();var w=this.getLayer(o);w?w.minzoom===u&&w.maxzoom===m||(u!=null&&(w.minzoom=u),m!=null&&(w.maxzoom=m),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,u,m){m===void 0&&(m={}),this._checkLoaded();var w=this.getLayer(o);if(w){if(!a.deepEqual(w.filter,u))return u==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,"layers."+w.id+".filter",u,null,m)||(w.filter=a.clone$1(u),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,u,m,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getLayoutProperty(u),m)||(S.setLayoutProperty(u,m,w),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,u){var m=this.getLayer(o);if(m)return m.getLayoutProperty(u);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,u,m,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getPaintProperty(u),m)||(S.setPaintProperty(u,m,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,u){return this.getLayer(o).getPaintProperty(u)},s.prototype.setFeatureState=function(o,u){this._checkLoaded();var m=o.source,w=o.sourceLayer,S=this.sourceCaches[m];if(S!==void 0){var k=S.getSource().type;k==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):k!=="vector"||w?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(w,o.id,u)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,u){this._checkLoaded();var m=o.source,w=this.sourceCaches[m];if(w!==void 0){var S=w.getSource().type,k=S==="vector"?o.sourceLayer:void 0;S!=="vector"||k?u&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(k,o.id,u):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var u=o.source,m=o.sourceLayer,w=this.sourceCaches[u];if(w!==void 0){if(w.getSource().type!=="vector"||m)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(m,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var u=this,m=function(Ze){return u._layers[Ze].type==="fill-extrusion"},w={},S=[],k=this._order.length-1;k>=0;k--){var P=this._order[k];if(m(P)){w[P]=k;for(var L=0,G=o;L<G.length;L+=1){var W=G[L][P];if(W)for(var J=0,oe=W;J<oe.length;J+=1)S.push(oe[J])}}}S.sort(function(Ze,qe){return qe.intersectionZ-Ze.intersectionZ});for(var te=[],se=this._order.length-1;se>=0;se--){var $=this._order[se];if(m($))for(var le=S.length-1;le>=0;le--){var ye=S[le].feature;if(w[ye.layer.id]<se)break;te.push(ye),S.pop()}else for(var ve=0,Be=o;ve<Be.length;ve+=1){var Te=Be[ve][$];if(Te)for(var Pe=0,Oe=Te;Pe<Oe.length;Pe+=1)te.push(Oe[Pe].feature)}}return te},s.prototype.queryRenderedFeatures=function(o,u,m){u&&u.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);var w={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,k=u.layers;S<k.length;S+=1){var P=k[S],L=this._layers[P];if(!L)return this.fire(new a.ErrorEvent(new Error("The layer '"+P+"' does not exist in the map's style and cannot be queried for features."))),[];w[L.source]=!0}}var G=[];for(var W in u.availableImages=this._availableImages,this.sourceCaches)u.layers&&!w[W]||G.push(Ur(this.sourceCaches[W],this._layers,this._serializedLayers,o,u,m));return this.placement&&G.push(function(J,oe,te,se,$,le,ye){for(var ve={},Be=le.queryRenderedSymbols(se),Te=[],Pe=0,Oe=Object.keys(Be).map(Number);Pe<Oe.length;Pe+=1)Te.push(ye[Oe[Pe]]);Te.sort(ui);for(var Ze=function(){var wt=tt[qe],Zt=wt.featureIndex.lookupSymbolFeatures(Be[wt.bucketInstanceId],oe,wt.bucketIndex,wt.sourceLayerIndex,$.filter,$.layers,$.availableImages,J);for(var dt in Zt){var qt=ve[dt]=ve[dt]||[],Mt=Zt[dt];Mt.sort(function(Ot,Q){var Ie=wt.featureSortOrder;if(Ie){var Wr=Ie.indexOf(Ot.featureIndex);return Ie.indexOf(Q.featureIndex)-Wr}return Q.featureIndex-Ot.featureIndex});for(var Vt=0,Bt=Mt;Vt<Bt.length;Vt+=1)qt.push(Bt[Vt])}},qe=0,tt=Te;qe<tt.length;qe+=1)Ze();var ft=function(wt){ve[wt].forEach(function(Zt){var dt=Zt.feature,qt=te[J[wt].source].getFeatureState(dt.layer["source-layer"],dt.id);dt.source=dt.layer.source,dt.layer["source-layer"]&&(dt.sourceLayer=dt.layer["source-layer"]),dt.state=qt})};for(var zt in ve)ft(zt);return ve}(this._layers,this._serializedLayers,this.sourceCaches,o,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(G)},s.prototype.querySourceFeatures=function(o,u){u&&u.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);var m=this.sourceCaches[o];return m?function(w,S){for(var k=w.getRenderableIds().map(function(oe){return w.getTileByID(oe)}),P=[],L={},G=0;G<k.length;G++){var W=k[G],J=W.tileID.canonical.key;L[J]||(L[J]=!0,W.querySourceFeatures(P,S))}return P}(m,u):[]},s.prototype.addSourceType=function(o,u,m){return s.getSourceType(o)?m(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},m):m(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,u){u===void 0&&(u={}),this._checkLoaded();var m=this.light.getLight(),w=!1;for(var S in o)if(!a.deepEqual(o[S],m[S])){w=!0;break}if(w){var k={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(k)}},s.prototype._validate=function(o,u,m,w,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&ln(this,o.call(a.validateStyle,a.extend({key:u,style:this.serialize(),value:m,styleSpec:a.styleSpec},w)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var u in this.sourceCaches)this.sourceCaches[u].clearTiles(),this.sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var u in this.sourceCaches)this.sourceCaches[u].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,u,m,w,S){S===void 0&&(S=!1);for(var k=!1,P=!1,L={},G=0,W=this._order;G<W.length;G+=1){var J=this._layers[W[G]];if(J.type==="symbol"){if(!L[J.source]){var oe=this.sourceCaches[J.source];L[J.source]=oe.getRenderableIds(!0).map(function(ye){return oe.getTileByID(ye)}).sort(function(ye,ve){return ve.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(ve.tileID)?-1:1)})}var te=this.crossTileSymbolIndex.addLayer(J,L[J.source],o.center.lng);k=k||te}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new oa(o,this._order,S,u,m,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),P=!0),k&&this.pauseablePlacement.placement.setStale()),P||k)for(var se=0,$=this._order;se<$.length;se+=1){var le=this._layers[$[se]];le.type==="symbol"&&this.placement.updateLayerOpacities(le,L[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,u,m){this.imageManager.getImages(u.icons,m),this._updateTilesForChangedImages();var w=this.sourceCaches[u.source];w&&w.setDependencies(u.tileID.key,u.type,u.icons)},s.prototype.getGlyphs=function(o,u,m){this.glyphManager.getGlyphs(u.stacks,m)},s.prototype.getResource=function(o,u,m){return a.makeRequest(u,m)},s}(a.Evented);_n.getSourceType=function(n){return Qr[n]},_n.setSourceType=function(n,s){Qr[n]=s},_n.registerForPluginStateChange=a.registerForPluginStateChange;var hi=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Wo=br(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),zu=br(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Xl=br(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),vs=br(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Ja=br("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Sl=br(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Ya=br(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Fs=br("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),El=br("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Hl=br("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Wl=br(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),vn=br(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),uo=br(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ao=br(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),si=br(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),kl=br(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),co=br(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),bs=br(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Qa=br(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),zo=br(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),ho=br(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),$a=br(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Po=br(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Jo=br(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Jl=br(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Yl=br(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function br(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=s.match(/attribute ([\w]+) ([\w]+)/g),m=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(m):m,k={};return{fragmentSource:n=n.replace(o,function(P,L,G,W,J){return k[J]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_`+J+`
varying `+G+" "+W+" "+J+`;
#else
uniform `+G+" "+W+" u_"+J+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+J+`
    `+G+" "+W+" "+J+" = u_"+J+`;
#endif
`}),vertexSource:s=s.replace(o,function(P,L,G,W,J){var oe=W==="float"?"vec2":"vec4",te=J.match(/color/)?"color":oe;return k[J]?L==="define"?`
#ifndef HAS_UNIFORM_u_`+J+`
uniform lowp float u_`+J+`_t;
attribute `+G+" "+oe+" a_"+J+`;
varying `+G+" "+W+" "+J+`;
#else
uniform `+G+" "+W+" u_"+J+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+J+`
    `+J+" = a_"+J+`;
#else
    `+G+" "+W+" "+J+" = u_"+J+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+J+`
    `+J+" = unpack_mix_"+te+"(a_"+J+", u_"+J+`_t);
#else
    `+G+" "+W+" "+J+" = u_"+J+`;
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_`+J+`
uniform lowp float u_`+J+`_t;
attribute `+G+" "+oe+" a_"+J+`;
#else
uniform `+G+" "+W+" u_"+J+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+J+`
    `+G+" "+W+" "+J+" = a_"+J+`;
#else
    `+G+" "+W+" "+J+" = u_"+J+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+J+`
    `+G+" "+W+" "+J+" = unpack_mix_"+te+"(a_"+J+", u_"+J+`_t);
#else
    `+G+" "+W+" "+J+" = u_"+J+`;
#endif
`}),staticAttributes:u,staticUniforms:S}}var Pu=Object.freeze({__proto__:null,prelude:Wo,background:zu,backgroundPattern:Xl,circle:vs,clippingMask:Ja,heatmap:Sl,heatmapTexture:Ya,collisionBox:Fs,collisionCircle:El,debug:Hl,fill:Wl,fillOutline:vn,fillOutlinePattern:uo,fillPattern:Ao,fillExtrusion:si,fillExtrusionPattern:kl,hillshadePrepare:co,hillshade:bs,line:Qa,lineGradient:zo,linePattern:ho,lineSDF:$a,raster:Po,symbolIcon:Jo,symbolSDF:Jl,symbolTextAndIcon:Yl}),Co=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Mo(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var u=n[o].split(" ");s.push(u.pop())}return s}Co.prototype.bind=function(n,s,o,u,m,w,S,k){this.context=n;for(var P=this.boundPaintVertexBuffers.length!==u.length,L=0;!P&&L<u.length;L++)this.boundPaintVertexBuffers[L]!==u[L]&&(P=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!P&&this.boundIndexBuffer===m&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===k?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),m&&m.dynamicDraw&&m.bind(),k&&k.bind()):this.freshBind(s,o,u,m,w,S,k)},Co.prototype.freshBind=function(n,s,o,u,m,w,S){var k,P=n.numAttributes,L=this.context,G=L.gl;if(L.extVertexArrayObject)this.vao&&this.destroy(),this.vao=L.extVertexArrayObject.createVertexArrayOES(),L.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=u,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{k=L.currentNumAttributes||0;for(var W=P;W<k;W++)G.disableVertexAttribArray(W)}s.enableAttributes(G,n);for(var J=0,oe=o;J<oe.length;J+=1)oe[J].enableAttributes(G,n);w&&w.enableAttributes(G,n),S&&S.enableAttributes(G,n),s.bind(),s.setVertexAttribPointers(G,n,m);for(var te=0,se=o;te<se.length;te+=1){var $=se[te];$.bind(),$.setVertexAttribPointers(G,n,m)}w&&(w.bind(),w.setVertexAttribPointers(G,n,m)),u&&u.bind(),S&&(S.bind(),S.setVertexAttribPointers(G,n,m)),L.currentNumAttributes=P},Co.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Ia=function(n,s,o,u,m,w){var S=n.gl;this.program=S.createProgram();for(var k=Mo(o.staticAttributes),P=u?u.getBinderAttributes():[],L=k.concat(P),G=o.staticUniforms?Mo(o.staticUniforms):[],W=u?u.getBinderUniforms():[],J=[],oe=0,te=G.concat(W);oe<te.length;oe+=1){var se=te[oe];J.indexOf(se)<0&&J.push(se)}var $=u?u.defines():[];w&&$.push("#define OVERDRAW_INSPECTOR;");var le=$.concat(Wo.fragmentSource,o.fragmentSource).join(`
`),ye=$.concat(Wo.vertexSource,o.vertexSource).join(`
`),ve=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(ve,le),S.compileShader(ve),S.attachShader(this.program,ve);var Be=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(Be,ye),S.compileShader(Be),S.attachShader(this.program,Be),this.attributes={};var Te={};this.numAttributes=L.length;for(var Pe=0;Pe<this.numAttributes;Pe++)L[Pe]&&(S.bindAttribLocation(this.program,Pe,L[Pe]),this.attributes[L[Pe]]=Pe);S.linkProgram(this.program),S.deleteShader(Be),S.deleteShader(ve);for(var Oe=0;Oe<J.length;Oe++){var Ze=J[Oe];if(Ze&&!Te[Ze]){var qe=S.getUniformLocation(this.program,Ze);qe&&(Te[Ze]=qe)}}this.fixedUniforms=m(n,Te),this.binderUniforms=u?u.getUniforms(n,Te):[]}}};function Ql(n,s,o){var u=1/yr(o,1,s.transform.tileZoom),m=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,s.transform.tileZoom)/m,S=w*(o.tileID.canonical.x+o.tileID.wrap*m),k=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,k>>16],u_pixel_coord_lower:[65535&S,65535&k]}}Ia.prototype.draw=function(n,s,o,u,m,w,S,k,P,L,G,W,J,oe,te,se){var $,le=n.gl;if(!this.failedToCreate){for(var ye in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(u),n.setColorMode(m),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[ye].set(S[ye]);oe&&oe.setUniforms(n,this.binderUniforms,W,{zoom:J});for(var ve=($={},$[le.LINES]=2,$[le.TRIANGLES]=3,$[le.LINE_STRIP]=1,$)[s],Be=0,Te=G.get();Be<Te.length;Be+=1){var Pe=Te[Be],Oe=Pe.vaos||(Pe.vaos={});(Oe[k]||(Oe[k]=new Co)).bind(n,this,P,oe?oe.getPaintVertexBuffers():[],L,Pe.vertexOffset,te,se),le.drawElements(s,Pe.primitiveLength*ve,le.UNSIGNED_SHORT,Pe.primitiveOffset*ve*2)}}};var xs=function(n,s,o,u){var m=s.style.light,w=m.properties.get("position"),S=[w.x,w.y,w.z],k=a.create$1();m.properties.get("anchor")==="viewport"&&a.fromRotation(k,-s.transform.angle),a.transformMat3(S,S,k);var P=m.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+o,u_opacity:u}},Ns=function(n,s,o,u,m,w,S){return a.extend(xs(n,s,o,u),Ql(w,s,S),{u_height_factor:-Math.pow(2,m.overscaledZ)/S.tileSize/8})},Aa=function(n){return{u_matrix:n}},Do=function(n,s,o,u){return a.extend(Aa(n),Ql(o,s,u))},ws=function(n,s){return{u_matrix:n,u_world:s}},$l=function(n,s,o,u,m){return a.extend(Do(n,s,o,u),{u_world:m})},es=function(n,s,o,u){var m,w,S=n.transform;if(u.paint.get("circle-pitch-alignment")==="map"){var k=yr(o,1,S.zoom);m=!0,w=[k,k]}else m=!1,w=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:w}},aa=function(n,s,o){var u=yr(o,1,s.zoom),m=Math.pow(2,s.zoom-o.tileID.overscaledZ),w=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[s.pixelsToGLUnits[0]/(u*m),s.pixelsToGLUnits[1]/(u*m)],u_overscale_factor:w}},eu=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},ts=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},po=function(n){return{u_matrix:n}},tu=function(n,s,o,u){return{u_matrix:n,u_extrude_scale:yr(s,1,o),u_intensity:u}},fo=function(n,s,o){var u=n.transform;return{u_matrix:sc(n,s,o),u_ratio:1/yr(s,1,u.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},_r=function(n,s,o,u){return a.extend(fo(n,s,o),{u_image:0,u_image_height:u})},Yo=function(n,s,o,u){var m=n.transform,w=Qo(s,m);return{u_matrix:sc(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/yr(s,1,m.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[w,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Cu=function(n,s,o,u,m){var w=n.lineAtlas,S=Qo(s,n.transform),k=o.layout.get("line-cap")==="round",P=w.getDash(u.from,k),L=w.getDash(u.to,k),G=P.width*m.fromScale,W=L.width*m.toScale;return a.extend(fo(n,s,o),{u_patternscale_a:[S/G,-P.height/2],u_patternscale_b:[S/W,-L.height/2],u_sdfgamma:w.width/(256*Math.min(G,W)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:L.y,u_mix:m.t})};function Qo(n,s){return 1/yr(n,1,s.tileZoom)}function sc(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Mu=function(n,s,o,u,m){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(S=m.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=m.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Ss(m.paint.get("raster-hue-rotate"))};var w,S};function Ss(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var za,Es=function(n,s,o,u,m,w,S,k,P,L){var G=m.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:G.width/G.height,u_fade_change:m.options.fadeDuration?m.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:k,u_is_text:+P,u_pitch_with_map:+u,u_texsize:L,u_texture:0}},sa=function(n,s,o,u,m,w,S,k,P,L,G){var W=m.transform;return a.extend(Es(n,s,o,u,m,w,S,k,P,L),{u_gamma_scale:u?Math.cos(W._pitch)*W.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+G})},ks=function(n,s,o,u,m,w,S,k,P,L){return a.extend(sa(n,s,o,u,m,w,S,k,!0,P,!0),{u_texsize_icon:L,u_texture_icon:1})},Vs=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},Ts=function(n,s,o,u,m,w){return a.extend(function(S,k,P,L){var G=P.imageManager.getPattern(S.from.toString()),W=P.imageManager.getPattern(S.to.toString()),J=P.imageManager.getPixelSize(),oe=J.width,te=J.height,se=Math.pow(2,L.tileID.overscaledZ),$=L.tileSize*Math.pow(2,P.transform.tileZoom)/se,le=$*(L.tileID.canonical.x+L.tileID.wrap*se),ye=$*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:G.tl,u_pattern_br_a:G.br,u_pattern_tl_b:W.tl,u_pattern_br_b:W.br,u_texsize:[oe,te],u_mix:k.t,u_pattern_size_a:G.displaySize,u_pattern_size_b:W.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/yr(L,1,P.transform.tileZoom),u_pixel_coord_upper:[le>>16,ye>>16],u_pixel_coord_lower:[65535&le,65535&ye]}}(u,w,o,m),{u_matrix:n,u_opacity:s})},rs={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function Us(n,s,o,u,m,w,S){for(var k=n.context,P=k.gl,L=n.useProgram("collisionBox"),G=[],W=0,J=0,oe=0;oe<u.length;oe++){var te=u[oe],se=s.getTile(te),$=se.getBucket(o);if($){var le=te.posMatrix;m[0]===0&&m[1]===0||(le=n.translatePosMatrix(te.posMatrix,se,m,w));var ye=S?$.textCollisionBox:$.iconCollisionBox,ve=$.collisionCircleArray;if(ve.length>0){var Be=a.create(),Te=le;a.mul(Be,$.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(Be,Be,$.placementViewportMatrix),G.push({circleArray:ve,circleOffset:J,transform:Te,invTransform:Be}),J=W+=ve.length/4}ye&&L.draw(k,P.LINES,Y.disabled,re.disabled,n.colorModeForRenderPass(),me.disabled,aa(le,n.transform,se),o.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,null,n.transform.zoom,null,null,ye.collisionVertexBuffer)}}if(S&&G.length){var Pe=n.useProgram("collisionCircle"),Oe=new a.StructArrayLayout2f1f2i16;Oe.resize(4*W),Oe._trim();for(var Ze=0,qe=0,tt=G;qe<tt.length;qe+=1)for(var ft=tt[qe],zt=0;zt<ft.circleArray.length/4;zt++){var wt=4*zt,Zt=ft.circleArray[wt+0],dt=ft.circleArray[wt+1],qt=ft.circleArray[wt+2],Mt=ft.circleArray[wt+3];Oe.emplace(Ze++,Zt,dt,qt,Mt,0),Oe.emplace(Ze++,Zt,dt,qt,Mt,1),Oe.emplace(Ze++,Zt,dt,qt,Mt,2),Oe.emplace(Ze++,Zt,dt,qt,Mt,3)}(!za||za.length<2*W)&&(za=function(Dr){var Pi=2*Dr,yi=new a.StructArrayLayout3ui6;yi.resize(Pi),yi._trim();for(var kr=0;kr<Pi;kr++){var Jr=6*kr;yi.uint16[Jr+0]=4*kr+0,yi.uint16[Jr+1]=4*kr+1,yi.uint16[Jr+2]=4*kr+2,yi.uint16[Jr+3]=4*kr+2,yi.uint16[Jr+4]=4*kr+3,yi.uint16[Jr+5]=4*kr+0}return yi}(W));for(var Vt=k.createIndexBuffer(za,!0),Bt=k.createVertexBuffer(Oe,a.collisionCircleLayout.members,!0),Ot=0,Q=G;Ot<Q.length;Ot+=1){var Ie=Q[Ot],Wr=eu(Ie.transform,Ie.invTransform,n.transform);Pe.draw(k,P.TRIANGLES,Y.disabled,re.disabled,n.colorModeForRenderPass(),me.disabled,Wr,o.id,Bt,Vt,a.SegmentVector.simpleSegment(0,2*Ie.circleOffset,Ie.circleArray.length,Ie.circleArray.length/2),null,n.transform.zoom,null,null,null)}Bt.destroy(),Vt.destroy()}}var mo=a.identity(new Float32Array(16));function is(n,s,o,u,m,w){var S=a.getAnchorAlignment(n),k=-(S.horizontalAlign-.5)*s,P=-(S.verticalAlign-.5)*o,L=a.evaluateVariableOffset(n,u);return new a.Point((k/m+L[0])*w,(P/m+L[1])*w)}function Is(n,s,o,u,m,w,S,k,P,L,G){var W=n.text.placedSymbolArray,J=n.text.dynamicLayoutVertexArray,oe=n.icon.dynamicLayoutVertexArray,te={};J.clear();for(var se=0;se<W.length;se++){var $=W.get(se),le=$.hidden||!$.crossTileID||n.allowVerticalPlacement&&!$.placedOrientation?null:u[$.crossTileID];if(le){var ye=new a.Point($.anchorX,$.anchorY),ve=Jt(ye,o?k:S),Be=nr(w.cameraToCenterDistance,ve.signedDistanceFromCamera),Te=m.evaluateSizeForFeature(n.textSizeData,L,$)*Be/a.ONE_EM;o&&(Te*=n.tilePixelRatio/P);for(var Pe=is(le.anchor,le.width,le.height,le.textOffset,le.textBoxScale,Te),Oe=o?Jt(ye.add(Pe),S).point:ve.point.add(s?Pe.rotate(-w.angle):Pe),Ze=n.allowVerticalPlacement&&$.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,qe=0;qe<$.numGlyphs;qe++)a.addDynamicAttributes(J,Oe,Ze);G&&$.associatedIconIndex>=0&&(te[$.associatedIconIndex]={shiftedAnchor:Oe,angle:Ze})}else Ti($.numGlyphs,J)}if(G){oe.clear();for(var tt=n.icon.placedSymbolArray,ft=0;ft<tt.length;ft++){var zt=tt.get(ft);if(zt.hidden)Ti(zt.numGlyphs,oe);else{var wt=te[ft];if(wt)for(var Zt=0;Zt<zt.numGlyphs;Zt++)a.addDynamicAttributes(oe,wt.shiftedAnchor,wt.angle);else Ti(zt.numGlyphs,oe)}}n.icon.dynamicLayoutVertexBuffer.updateData(oe)}n.text.dynamicLayoutVertexBuffer.updateData(J)}function ru(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function Lo(n,s,o,u,m,w,S,k,P,L,G,W){for(var J=n.context,oe=J.gl,te=n.transform,se=k==="map",$=P==="map",le=se&&o.layout.get("symbol-placement")!=="point",ye=se&&!$&&!le,ve=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Be=!1,Te=n.depthModeForSublayer(0,Y.ReadOnly),Pe=o.layout.get("text-variable-anchor"),Oe=[],Ze=0,qe=u;Ze<qe.length;Ze+=1){var tt=qe[Ze],ft=s.getTile(tt),zt=ft.getBucket(o);if(zt){var wt=m?zt.text:zt.icon;if(wt&&wt.segments.get().length){var Zt=wt.programConfigurations.get(o.id),dt=m||zt.sdfIcons,qt=m?zt.textSizeData:zt.iconSizeData,Mt=$||te.pitch!==0,Vt=n.useProgram(ru(dt,m,zt),Zt),Bt=a.evaluateSizeForZoom(qt,te.zoom),Ot=void 0,Q=[0,0],Ie=void 0,Wr=void 0,Dr=null,Pi=void 0;if(m)Ie=ft.glyphAtlasTexture,Wr=oe.LINEAR,Ot=ft.glyphAtlasTexture.size,zt.iconsInText&&(Q=ft.imageAtlasTexture.size,Dr=ft.imageAtlasTexture,Pi=Mt||n.options.rotating||n.options.zooming||qt.kind==="composite"||qt.kind==="camera"?oe.LINEAR:oe.NEAREST);else{var yi=o.layout.get("icon-size").constantOr(0)!==1||zt.iconsNeedLinear;Ie=ft.imageAtlasTexture,Wr=dt||n.options.rotating||n.options.zooming||yi||Mt?oe.LINEAR:oe.NEAREST,Ot=ft.imageAtlasTexture.size}var kr=yr(ft,1,n.transform.zoom),Jr=Ar(tt.posMatrix,$,se,n.transform,kr),$i=pr(tt.posMatrix,$,se,n.transform,kr),Ri=Pe&&zt.hasTextData(),en=o.layout.get("icon-text-fit")!=="none"&&Ri&&zt.hasIconData();le&&mn(zt,tt.posMatrix,n,m,Jr,$i,$,L);var Zi=n.translatePosMatrix(tt.posMatrix,ft,w,S),Ln=le||m&&Pe||en?mo:Jr,Bi=n.translatePosMatrix($i,ft,w,S,!0),ya=dt&&o.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ra={program:Vt,buffers:wt,uniformValues:dt?zt.iconsInText?ks(qt.kind,Bt,ye,$,n,Zi,Ln,Bi,Ot,Q):sa(qt.kind,Bt,ye,$,n,Zi,Ln,Bi,m,Ot,!0):Es(qt.kind,Bt,ye,$,n,Zi,Ln,Bi,m,Ot),atlasTexture:Ie,atlasTextureIcon:Dr,atlasInterpolation:Wr,atlasInterpolationIcon:Pi,isSDF:dt,hasHalo:ya};if(ve&&zt.canOverlap){Be=!0;for(var ps=0,fs=wt.segments.get();ps<fs.length;ps+=1){var nl=fs[ps];Oe.push({segments:new a.SegmentVector([nl]),sortKey:nl.sortKey,state:ra})}}else Oe.push({segments:wt.segments,sortKey:0,state:ra})}}}Be&&Oe.sort(function(ds,ms){return ds.sortKey-ms.sortKey});for(var ga=0,Jn=Oe;ga<Jn.length;ga+=1){var ro=Jn[ga],Gi=ro.state;if(J.activeTexture.set(oe.TEXTURE0),Gi.atlasTexture.bind(Gi.atlasInterpolation,oe.CLAMP_TO_EDGE),Gi.atlasTextureIcon&&(J.activeTexture.set(oe.TEXTURE1),Gi.atlasTextureIcon&&Gi.atlasTextureIcon.bind(Gi.atlasInterpolationIcon,oe.CLAMP_TO_EDGE)),Gi.isSDF){var hn=Gi.uniformValues;Gi.hasHalo&&(hn.u_is_halo=1,ns(Gi.buffers,ro.segments,o,n,Gi.program,Te,G,W,hn)),hn.u_is_halo=0}ns(Gi.buffers,ro.segments,o,n,Gi.program,Te,G,W,Gi.uniformValues)}}function ns(n,s,o,u,m,w,S,k,P){var L=u.context;m.draw(L,L.gl.TRIANGLES,w,S,k,me.disabled,P,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,u.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function js(n,s,o,u,m,w,S){var k,P,L,G,W,J=n.context.gl,oe=o.paint.get("fill-pattern"),te=oe&&oe.constantOr(1),se=o.getCrossfadeParameters();S?(P=te&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",k=J.LINES):(P=te?"fillPattern":"fill",k=J.TRIANGLES);for(var $=0,le=u;$<le.length;$+=1){var ye=le[$],ve=s.getTile(ye);if(!te||ve.patternsLoaded()){var Be=ve.getBucket(o);if(Be){var Te=Be.programConfigurations.get(o.id),Pe=n.useProgram(P,Te);te&&(n.context.activeTexture.set(J.TEXTURE0),ve.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Te.updatePaintBuffers(se));var Oe=oe.constantOr(null);if(Oe&&ve.imageAtlas){var Ze=ve.imageAtlas,qe=Ze.patternPositions[Oe.to.toString()],tt=Ze.patternPositions[Oe.from.toString()];qe&&tt&&Te.setConstantPatternPositions(qe,tt)}var ft=n.translatePosMatrix(ye.posMatrix,ve,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(S){G=Be.indexBuffer2,W=Be.segments2;var zt=[J.drawingBufferWidth,J.drawingBufferHeight];L=P==="fillOutlinePattern"&&te?$l(ft,n,se,ve,zt):ws(ft,zt)}else G=Be.indexBuffer,W=Be.segments,L=te?Do(ft,n,se,ve):Aa(ft);Pe.draw(n.context,k,m,n.stencilModeForClipping(ye),w,me.disabled,L,o.id,Be.layoutVertexBuffer,G,W,o.paint,n.transform.zoom,Te)}}}}function Tl(n,s,o,u,m,w,S){for(var k=n.context,P=k.gl,L=o.paint.get("fill-extrusion-pattern"),G=L.constantOr(1),W=o.getCrossfadeParameters(),J=o.paint.get("fill-extrusion-opacity"),oe=0,te=u;oe<te.length;oe+=1){var se=te[oe],$=s.getTile(se),le=$.getBucket(o);if(le){var ye=le.programConfigurations.get(o.id),ve=n.useProgram(G?"fillExtrusionPattern":"fillExtrusion",ye);G&&(n.context.activeTexture.set(P.TEXTURE0),$.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),ye.updatePaintBuffers(W));var Be=L.constantOr(null);if(Be&&$.imageAtlas){var Te=$.imageAtlas,Pe=Te.patternPositions[Be.to.toString()],Oe=Te.patternPositions[Be.from.toString()];Pe&&Oe&&ye.setConstantPatternPositions(Pe,Oe)}var Ze=n.translatePosMatrix(se.posMatrix,$,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),qe=o.paint.get("fill-extrusion-vertical-gradient"),tt=G?Ns(Ze,n,qe,J,se,W,$):xs(Ze,n,qe,J);ve.draw(k,k.gl.TRIANGLES,m,w,S,me.backCCW,tt,o.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,o.paint,n.transform.zoom,ye)}}}function qs(n,s,o,u,m,w){var S=n.context,k=S.gl,P=s.fbo;if(P){var L=n.useProgram("hillshade");S.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,P.colorAttachment.get());var G=function(W,J,oe){var te=oe.paint.get("hillshade-shadow-color"),se=oe.paint.get("hillshade-highlight-color"),$=oe.paint.get("hillshade-accent-color"),le=oe.paint.get("hillshade-illumination-direction")*(Math.PI/180);oe.paint.get("hillshade-illumination-anchor")==="viewport"&&(le-=W.transform.angle);var ye,ve,Be,Te=!W.options.moving;return{u_matrix:W.transform.calculatePosMatrix(J.tileID.toUnwrapped(),Te),u_image:0,u_latrange:(ye=J.tileID,ve=Math.pow(2,ye.canonical.z),Be=ye.canonical.y,[new a.MercatorCoordinate(0,Be/ve).toLngLat().lat,new a.MercatorCoordinate(0,(Be+1)/ve).toLngLat().lat]),u_light:[oe.paint.get("hillshade-exaggeration"),le],u_shadow:te,u_highlight:se,u_accent:$}}(n,s,o);L.draw(S,k.TRIANGLES,u,m,w,me.disabled,G,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function yo(n,s,o,u,m,w){var S=n.context,k=S.gl,P=s.dem;if(P&&P.data){var L=P.dim,G=P.stride,W=P.getPixels();if(S.activeTexture.set(k.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(G),s.demTexture){var J=s.demTexture;J.update(W,{premultiply:!1}),J.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(S,W,k.RGBA,{premultiply:!1}),s.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);S.activeTexture.set(k.TEXTURE0);var oe=s.fbo;if(!oe){var te=new a.Texture(S,{width:L,height:L,data:null},k.RGBA);te.bind(k.LINEAR,k.CLAMP_TO_EDGE),(oe=s.fbo=S.createFramebuffer(L,L,!0)).colorAttachment.set(te.texture)}S.bindFramebuffer.set(oe.framebuffer),S.viewport.set([0,0,L,L]),n.useProgram("hillshadePrepare").draw(S,k.TRIANGLES,u,m,w,me.disabled,function(se,$){var le=$.stride,ye=a.create();return a.ortho(ye,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(ye,ye,[0,-a.EXTENT,0]),{u_matrix:ye,u_image:1,u_dimension:[le,le],u_zoom:se.overscaledZ,u_unpack:$.getUnpackVector()}}(s.tileID,P),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Ro(n,s,o,u,m){var w=u.paint.get("raster-fade-duration");if(w>0){var S=a.browser.now(),k=(S-n.timeAdded)/w,P=s?(S-s.timeAdded)/w:-1,L=o.getSource(),G=m.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),W=!s||Math.abs(s.tileID.overscaledZ-G)>Math.abs(n.tileID.overscaledZ-G),J=W&&n.refreshedUponExpiration?1:a.clamp(W?k:1-P,0,1);return n.refreshedUponExpiration&&k>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}var go=new a.Color(1,0,0,1),Pa=new a.Color(0,1,0,1),iu=new a.Color(0,0,1,1),Ca=new a.Color(1,0,1,1),Du=new a.Color(0,1,1,1);function Il(n,s,o,u){la(n,0,s+o/2,n.transform.width,o,u)}function os(n,s,o,u){la(n,s-o/2,0,o,n.transform.height,u)}function la(n,s,o,u,m,w){var S=n.context,k=S.gl;k.enable(k.SCISSOR_TEST),k.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,u*a.browser.devicePixelRatio,m*a.browser.devicePixelRatio),S.clear({color:w}),k.disable(k.SCISSOR_TEST)}function nu(n,s,o){var u=n.context,m=u.gl,w=o.posMatrix,S=n.useProgram("debug"),k=Y.disabled,P=re.disabled,L=n.colorModeForRenderPass();u.activeTexture.set(m.TEXTURE0),n.emptyTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),S.draw(u,m.LINE_STRIP,k,P,L,me.disabled,ts(w,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var G=s.getTileByID(o.key).latestRawTileData,W=Math.floor((G&&G.byteLength||0)/1024),J=s.getTile(o).tileSize,oe=512/Math.min(J,512)*(o.overscaledZ/n.transform.zoom)*.5,te=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(te+=" => "+o.overscaledZ),function(se,$){se.initDebugOverlayCanvas();var le=se.debugOverlayCanvas,ye=se.context.gl,ve=se.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,le.width,le.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold 36px Open Sans, sans-serif",ve.fillText($,5,5),ve.strokeText($,5,5),se.debugOverlayTexture.update(le),se.debugOverlayTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE)}(n,te+" "+W+"kb"),S.draw(u,m.TRIANGLES,k,P,ue.alphaBlended,me.disabled,ts(w,a.Color.transparent,oe),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var Bo={symbol:function(n,s,o,u,m){if(n.renderPass==="translucent"){var w=re.disabled,S=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(k,P,L,G,W,J,oe){for(var te=P.transform,se=W==="map",$=J==="map",le=0,ye=k;le<ye.length;le+=1){var ve=ye[le],Be=G.getTile(ve),Te=Be.getBucket(L);if(Te&&Te.text&&Te.text.segments.get().length){var Pe=a.evaluateSizeForZoom(Te.textSizeData,te.zoom),Oe=yr(Be,1,P.transform.zoom),Ze=Ar(ve.posMatrix,$,se,P.transform,Oe),qe=L.layout.get("icon-text-fit")!=="none"&&Te.hasIconData();if(Pe){var tt=Math.pow(2,te.zoom-Be.tileID.overscaledZ);Is(Te,se,$,oe,a.symbolSize,te,Ze,ve.posMatrix,tt,Pe,qe)}}}}(u,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),m),o.paint.get("icon-opacity").constantOr(1)!==0&&Lo(n,s,o,u,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),w,S),o.paint.get("text-opacity").constantOr(1)!==0&&Lo(n,s,o,u,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),w,S),s.map.showCollisionBoxes&&(Us(n,s,o,u,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Us(n,s,o,u,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,u){if(n.renderPass==="translucent"){var m=o.paint.get("circle-opacity"),w=o.paint.get("circle-stroke-width"),S=o.paint.get("circle-stroke-opacity"),k=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(m.constantOr(1)!==0||w.constantOr(1)!==0&&S.constantOr(1)!==0){for(var P=n.context,L=P.gl,G=n.depthModeForSublayer(0,Y.ReadOnly),W=re.disabled,J=n.colorModeForRenderPass(),oe=[],te=0;te<u.length;te++){var se=u[te],$=s.getTile(se),le=$.getBucket(o);if(le){var ye=le.programConfigurations.get(o.id),ve={programConfiguration:ye,program:n.useProgram("circle",ye),layoutVertexBuffer:le.layoutVertexBuffer,indexBuffer:le.indexBuffer,uniformValues:es(n,se,$,o)};if(k)for(var Be=0,Te=le.segments.get();Be<Te.length;Be+=1){var Pe=Te[Be];oe.push({segments:new a.SegmentVector([Pe]),sortKey:Pe.sortKey,state:ve})}else oe.push({segments:le.segments,sortKey:0,state:ve})}}k&&oe.sort(function(ft,zt){return ft.sortKey-zt.sortKey});for(var Oe=0,Ze=oe;Oe<Ze.length;Oe+=1){var qe=Ze[Oe],tt=qe.state;tt.program.draw(P,L.TRIANGLES,G,W,J,me.disabled,tt.uniformValues,o.id,tt.layoutVertexBuffer,tt.indexBuffer,qe.segments,o.paint,n.transform.zoom,tt.programConfiguration)}}}},heatmap:function(n,s,o,u){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var m=n.context,w=m.gl,S=re.disabled,k=new ue([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(oe,te,se){var $=oe.gl;oe.activeTexture.set($.TEXTURE1),oe.viewport.set([0,0,te.width/4,te.height/4]);var le=se.heatmapFbo;if(le)$.bindTexture($.TEXTURE_2D,le.colorAttachment.get()),oe.bindFramebuffer.set(le.framebuffer);else{var ye=$.createTexture();$.bindTexture($.TEXTURE_2D,ye),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MAG_FILTER,$.LINEAR),le=se.heatmapFbo=oe.createFramebuffer(te.width/4,te.height/4,!1),function(ve,Be,Te,Pe){var Oe=ve.gl;Oe.texImage2D(Oe.TEXTURE_2D,0,Oe.RGBA,Be.width/4,Be.height/4,0,Oe.RGBA,ve.extRenderToTextureHalfFloat?ve.extTextureHalfFloat.HALF_FLOAT_OES:Oe.UNSIGNED_BYTE,null),Pe.colorAttachment.set(Te)}(oe,te,ye,le)}})(m,n,o),m.clear({color:a.Color.transparent});for(var P=0;P<u.length;P++){var L=u[P];if(!s.hasRenderableParent(L)){var G=s.getTile(L),W=G.getBucket(o);if(W){var J=W.programConfigurations.get(o.id);n.useProgram("heatmap",J).draw(m,w.TRIANGLES,Y.disabled,S,k,me.disabled,tu(L.posMatrix,G,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,o.paint,n.transform.zoom,J)}}}m.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(oe,te){var se=oe.context,$=se.gl,le=te.heatmapFbo;if(le){se.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,le.colorAttachment.get()),se.activeTexture.set($.TEXTURE1);var ye=te.colorRampTexture;ye||(ye=te.colorRampTexture=new a.Texture(se,te.colorRamp,$.RGBA)),ye.bind($.LINEAR,$.CLAMP_TO_EDGE),oe.useProgram("heatmapTexture").draw(se,$.TRIANGLES,Y.disabled,re.disabled,oe.colorModeForRenderPass(),me.disabled,function(ve,Be,Te,Pe){var Oe=a.create();a.ortho(Oe,0,ve.width,ve.height,0,0,1);var Ze=ve.context.gl;return{u_matrix:Oe,u_world:[Ze.drawingBufferWidth,Ze.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Be.paint.get("heatmap-opacity")}}(oe,te),te.id,oe.viewportBuffer,oe.quadTriangleIndexBuffer,oe.viewportSegments,te.paint,oe.transform.zoom)}}(n,o))},line:function(n,s,o,u){if(n.renderPass==="translucent"){var m=o.paint.get("line-opacity"),w=o.paint.get("line-width");if(m.constantOr(1)!==0&&w.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,Y.ReadOnly),k=n.colorModeForRenderPass(),P=o.paint.get("line-dasharray"),L=o.paint.get("line-pattern"),G=L.constantOr(1),W=o.paint.get("line-gradient"),J=o.getCrossfadeParameters(),oe=G?"linePattern":P?"lineSDF":W?"lineGradient":"line",te=n.context,se=te.gl,$=!0,le=0,ye=u;le<ye.length;le+=1){var ve=ye[le],Be=s.getTile(ve);if(!G||Be.patternsLoaded()){var Te=Be.getBucket(o);if(Te){var Pe=Te.programConfigurations.get(o.id),Oe=n.context.program.get(),Ze=n.useProgram(oe,Pe),qe=$||Ze.program!==Oe,tt=L.constantOr(null);if(tt&&Be.imageAtlas){var ft=Be.imageAtlas,zt=ft.patternPositions[tt.to.toString()],wt=ft.patternPositions[tt.from.toString()];zt&&wt&&Pe.setConstantPatternPositions(zt,wt)}var Zt=G?Yo(n,Be,o,J):P?Cu(n,Be,o,P,J):W?_r(n,Be,o,Te.lineClipsArray.length):fo(n,Be,o);if(G)te.activeTexture.set(se.TEXTURE0),Be.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),Pe.updatePaintBuffers(J);else if(P&&(qe||n.lineAtlas.dirty))te.activeTexture.set(se.TEXTURE0),n.lineAtlas.bind(te);else if(W){var dt=Te.gradients[o.id],qt=dt.texture;if(o.gradientVersion!==dt.version){var Mt=256;if(o.stepInterpolant){var Vt=s.getSource().maxzoom,Bt=ve.canonical.z===Vt?Math.ceil(1<<n.transform.maxZoom-ve.canonical.z):1;Mt=a.clamp(a.nextPowerOfTwo(Te.maxLineLength/a.EXTENT*1024*Bt),256,te.maxTextureSize)}dt.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Mt,image:dt.gradient||void 0,clips:Te.lineClipsArray}),dt.texture?dt.texture.update(dt.gradient):dt.texture=new a.Texture(te,dt.gradient,se.RGBA),dt.version=o.gradientVersion,qt=dt.texture}te.activeTexture.set(se.TEXTURE0),qt.bind(o.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}Ze.draw(te,se.TRIANGLES,S,n.stencilModeForClipping(ve),k,me.disabled,Zt,o.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,o.paint,n.transform.zoom,Pe,Te.layoutVertexBuffer2),$=!1}}}}},fill:function(n,s,o,u){var m=o.paint.get("fill-color"),w=o.paint.get("fill-opacity");if(w.constantOr(1)!==0){var S=n.colorModeForRenderPass(),k=o.paint.get("fill-pattern"),P=n.opaquePassEnabledForLayer()&&!k.constantOr(1)&&m.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===P){var L=n.depthModeForSublayer(1,n.renderPass==="opaque"?Y.ReadWrite:Y.ReadOnly);js(n,s,o,u,L,S,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var G=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,Y.ReadOnly);js(n,s,o,u,G,S,!0)}}},"fill-extrusion":function(n,s,o,u){var m=o.paint.get("fill-extrusion-opacity");if(m!==0&&n.renderPass==="translucent"){var w=new Y(n.context.gl.LEQUAL,Y.ReadWrite,n.depthRangeFor3D);if(m!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Tl(n,s,o,u,w,re.disabled,ue.disabled),Tl(n,s,o,u,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();Tl(n,s,o,u,w,re.disabled,S)}}},hillshade:function(n,s,o,u){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var m=n.context,w=n.depthModeForSublayer(0,Y.ReadOnly),S=n.colorModeForRenderPass(),k=n.renderPass==="translucent"?n.stencilConfigForOverlap(u):[{},u],P=k[0],L=0,G=k[1];L<G.length;L+=1){var W=G[L],J=s.getTile(W);J.needsHillshadePrepare&&n.renderPass==="offscreen"?yo(n,J,o,w,re.disabled,S):n.renderPass==="translucent"&&qs(n,J,o,w,P[W.overscaledZ],S)}m.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,u){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&u.length)for(var m=n.context,w=m.gl,S=s.getSource(),k=n.useProgram("raster"),P=n.colorModeForRenderPass(),L=S instanceof ar?[{},u]:n.stencilConfigForOverlap(u),G=L[0],W=L[1],J=W[W.length-1].overscaledZ,oe=!n.options.moving,te=0,se=W;te<se.length;te+=1){var $=se[te],le=n.depthModeForSublayer($.overscaledZ-J,o.paint.get("raster-opacity")===1?Y.ReadWrite:Y.ReadOnly,w.LESS),ye=s.getTile($),ve=n.transform.calculatePosMatrix($.toUnwrapped(),oe);ye.registerFadeDuration(o.paint.get("raster-fade-duration"));var Be=s.findLoadedParent($,0),Te=Ro(ye,Be,s,o,n.transform),Pe=void 0,Oe=void 0,Ze=o.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;m.activeTexture.set(w.TEXTURE0),ye.texture.bind(Ze,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),m.activeTexture.set(w.TEXTURE1),Be?(Be.texture.bind(Ze,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),Pe=Math.pow(2,Be.tileID.overscaledZ-ye.tileID.overscaledZ),Oe=[ye.tileID.canonical.x*Pe%1,ye.tileID.canonical.y*Pe%1]):ye.texture.bind(Ze,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var qe=Mu(ve,Oe||[0,0],Pe||1,Te,o);S instanceof ar?k.draw(m,w.TRIANGLES,le,re.disabled,P,me.disabled,qe,o.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):k.draw(m,w.TRIANGLES,le,G[$.overscaledZ],P,me.disabled,qe,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var u=o.paint.get("background-color"),m=o.paint.get("background-opacity");if(m!==0){var w=n.context,S=w.gl,k=n.transform,P=k.tileSize,L=o.paint.get("background-pattern");if(!n.isPatternMissing(L)){var G=!L&&u.a===1&&m===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===G){var W=re.disabled,J=n.depthModeForSublayer(0,G==="opaque"?Y.ReadWrite:Y.ReadOnly),oe=n.colorModeForRenderPass(),te=n.useProgram(L?"backgroundPattern":"background"),se=k.coveringTiles({tileSize:P});L&&(w.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var $=o.getCrossfadeParameters(),le=0,ye=se;le<ye.length;le+=1){var ve=ye[le],Be=n.transform.calculatePosMatrix(ve.toUnwrapped()),Te=L?Ts(Be,m,n,L,{tileID:ve,tileSize:P},$):Vs(Be,m,u);te.draw(w,S.TRIANGLES,J,W,oe,me.disabled,Te,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var u=0;u<o.length;u++)nu(n,s,o[u])},custom:function(n,s,o){var u=n.context,m=o.implementation;if(n.renderPass==="offscreen"){var w=m.prerender;w&&(n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),w.call(m,u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),u.setStencilMode(re.disabled);var S=m.renderingMode==="3d"?new Y(n.context.gl.LEQUAL,Y.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,Y.ReadOnly);u.setDepthMode(S),m.render(u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState(),u.bindFramebuffer.set(null)}}},Fr=function(n,s){this.context=new Z(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=ie.maxUnderzooming+ie.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _e,this.gpuTimers={}};Fr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,u=this.style._order;o<u.length;o+=1)this.style._layers[u[o]].resize()},Fr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,hi.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,hi.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var u=new a.StructArrayLayout4i8;u.emplaceBack(0,0,0,0),u.emplaceBack(a.EXTENT,0,a.EXTENT,0),u.emplaceBack(0,a.EXTENT,0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(u,et.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var m=new a.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(m,hi.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var k=this.context.gl;this.stencilClearMode=new re({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)},Fr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,Y.disabled,this.stencilClearMode,ue.disabled,me.disabled,po(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Fr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,u=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(ue.disabled),o.setDepthMode(Y.disabled);var m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,S=s;w<S.length;w+=1){var k=S[w],P=this._tileClippingMaskIDs[k.key]=this.nextStencilID++;m.draw(o,u.TRIANGLES,Y.disabled,new re({func:u.ALWAYS,mask:0},P,255,u.KEEP,u.KEEP,u.REPLACE),ue.disabled,me.disabled,po(k.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Fr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new re({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Fr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new re({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Fr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,u=n.sort(function(P,L){return L.overscaledZ-P.overscaledZ}),m=u[u.length-1].overscaledZ,w=u[0].overscaledZ-m+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var S={},k=0;k<w;k++)S[k+m]=new re({func:o.GEQUAL,mask:255},k+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[S,u]}return[(s={},s[m]=re.disabled,s),u]},Fr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new ue([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ue.unblended:ue.alphaBlended},Fr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return Y.disabled;var u=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Y(o||this.context.gl.LEQUAL,s,[u,u])},Fr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Fr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var u=this.style._order,m=this.style.sourceCaches;for(var w in m){var S=m[w];S.used&&S.prepare(this.context)}var k,P,L={},G={},W={};for(var J in m){var oe=m[J];L[J]=oe.getVisibleCoordinates(),G[J]=L[J].slice().reverse(),W[J]=oe.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var te=0;te<u.length;te++)if(this.style._layers[u[te]].is3D()){this.opaquePassCutoff=te;break}this.renderPass="offscreen";for(var se=0,$=u;se<$.length;se+=1){var le=this.style._layers[$[se]];if(le.hasOffscreenPass()&&!le.isHidden(this.transform.zoom)){var ye=G[le.source];(le.type==="custom"||ye.length)&&this.renderLayer(this,m[le.source],le,ye)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){var ve=this.style._layers[u[this.currentLayer]],Be=m[ve.source],Te=L[ve.source];this._renderTileClippingMasks(ve,Te),this.renderLayer(this,Be,ve,Te)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){var Pe=this.style._layers[u[this.currentLayer]],Oe=m[Pe.source],Ze=(Pe.type==="symbol"?W:G)[Pe.source];this._renderTileClippingMasks(Pe,L[Pe.source]),this.renderLayer(this,Oe,Pe,Ze)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(qe){qe.source&&!qe.isHidden(o.transform.zoom)&&(qe.source!==(P&&P.id)&&(P=o.style.sourceCaches[qe.source]),(!k||k.getSource().maxzoom<P.getSource().maxzoom)&&(k=P))}),k&&Bo.debug(this,k,k.getVisibleCoordinates())),this.options.showPadding&&function(qe){var tt=qe.transform.padding;Il(qe,qe.transform.height-(tt.top||0),3,go),Il(qe,tt.bottom||0,3,Pa),os(qe,tt.left||0,3,iu),os(qe,qe.transform.width-(tt.right||0),3,Ca);var ft=qe.transform.centerPoint;(function(zt,wt,Zt,dt){la(zt,wt-1,Zt-10,2,20,dt),la(zt,wt-10,Zt-1,20,2,dt)})(qe,ft.x,qe.transform.height-ft.y,Du)}(this),this.context.setDefault()},Fr.prototype.renderLayer=function(n,s,o,u){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||u.length)&&(this.id=o.id,this.gpuTimingStart(o),Bo[o.type](n,s,o,u,this.style.placement.variableOffsets),this.gpuTimingEnd())},Fr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Fr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Fr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Fr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var u=n[o],m=this.context.extTimerQuery,w=m.getQueryObjectEXT(u.query,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(u.query),s[o]=w}return s},Fr.prototype.translatePosMatrix=function(n,s,o,u,m){if(!o[0]&&!o[1])return n;var w=m?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(w){var S=Math.sin(w),k=Math.cos(w);o=[o[0]*k-o[1]*S,o[0]*S+o[1]*k]}var P=[m?o[0]:yr(s,o[0],this.transform.zoom),m?o[1]:yr(s,o[1],this.transform.zoom),0],L=new Float32Array(16);return a.translate(L,n,P),L},Fr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Fr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Fr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Fr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new Ia(this.context,n,Pu[n],s,rs[n],this._showOverdrawInspector)),this.cache[o]},Fr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Fr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Fr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Fr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Qs=function(n,s){this.points=n,this.planes=s};Qs.fromInvProjectionMatrix=function(n,s,o){var u=Math.pow(2,o),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return a.transformMat4([],S,n)}).map(function(S){return a.scale$1([],S,1/S[3]/s*u)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var k=a.sub([],m[S[0]],m[S[1]]),P=a.sub([],m[S[2]],m[S[1]]),L=a.normalize([],a.cross([],k,P)),G=-a.dot(L,m[S[1]]);return L.concat(G)});return new Qs(m,w)};var as=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};as.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),u=a.clone$2(this.max),m=0;m<s.length;m++)o[m]=s[m]?this.min[m]:this.center[m],u[m]=s[m]?this.center[m]:this.max[m];return u[2]=this.max[2],new as(o,u)},as.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},as.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},as.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,u=0;u<n.planes.length;u++){for(var m=n.planes[u],w=0,S=0;S<s.length;S++)w+=a.dot$1(m,s[S])>=0;if(w===0)return 0;w!==s.length&&(o=!1)}if(o)return 2;for(var k=0;k<3;k++){for(var P=Number.MAX_VALUE,L=-Number.MAX_VALUE,G=0;G<n.points.length;G++){var W=n.points[G][k]-this.min[k];P=Math.min(P,W),L=Math.max(L,W)}if(L<0||P>this.max[k]-this.min[k])return 0}return 1};var eo=function(n,s,o,u){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=u};eo.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},eo.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),u=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,u)},eo.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},eo.prototype.clone=function(){return new eo(this.top,this.bottom,this.left,this.right)},eo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var ur=function(n,s,o,u,m){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=m===void 0||m,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o==null?0:o,this._maxPitch=u==null?60:u,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new eo,this._posMatrixCache={},this._alignedPosMatrixCache={}},xr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};ur.prototype.clone=function(){var n=new ur(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},xr.minZoom.get=function(){return this._minZoom},xr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},xr.maxZoom.get=function(){return this._maxZoom},xr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},xr.minPitch.get=function(){return this._minPitch},xr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},xr.maxPitch.get=function(){return this._maxPitch},xr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},xr.renderWorldCopies.get=function(){return this._renderWorldCopies},xr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},xr.worldSize.get=function(){return this.tileSize*this.scale},xr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},xr.size.get=function(){return new a.Point(this.width,this.height)},xr.bearing.get=function(){return-this.angle/Math.PI*180},xr.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},xr.pitch.get=function(){return this._pitch/Math.PI*180},xr.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},xr.fov.get=function(){return this._fov/Math.PI*180},xr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},xr.zoom.get=function(){return this._zoom},xr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},xr.center.get=function(){return this._center},xr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},xr.padding.get=function(){return this._edgeInsets.toJSON()},xr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},xr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},ur.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},ur.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},ur.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},ur.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),u=this.pointCoordinate(new a.Point(this.width,0)),m=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),S=Math.floor(Math.min(o.x,u.x,m.x,w.x)),k=Math.floor(Math.max(o.x,u.x,m.x,w.x)),P=S-1;P<=k+1;P++)P!==0&&s.push(new a.UnwrappedTileID(P,n));return s},ur.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var u=a.MercatorCoordinate.fromLngLat(this.center),m=Math.pow(2,s),w=[m*u.x,m*u.y,0],S=Qs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),k=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(k=s);var P=function(qe){return{aabb:new as([qe*m,0,0],[(qe+1)*m,m,0]),zoom:0,x:0,y:0,wrap:qe,fullyVisible:!1}},L=[],G=[],W=s,J=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var oe=1;oe<=3;oe++)L.push(P(-oe)),L.push(P(oe));for(L.push(P(0));L.length>0;){var te=L.pop(),se=te.x,$=te.y,le=te.fullyVisible;if(!le){var ye=te.aabb.intersects(S);if(ye===0)continue;le=ye===2}var ve=te.aabb.distanceX(w),Be=te.aabb.distanceY(w),Te=Math.max(Math.abs(ve),Math.abs(Be));if(te.zoom===W||Te>3+(1<<W-te.zoom)-2&&te.zoom>=k)G.push({tileID:new a.OverscaledTileID(te.zoom===W?J:te.zoom,te.wrap,te.zoom,se,$),distanceSq:a.sqrLen([w[0]-.5-se,w[1]-.5-$])});else for(var Pe=0;Pe<4;Pe++){var Oe=(se<<1)+Pe%2,Ze=($<<1)+(Pe>>1);L.push({aabb:te.aabb.quadrant(Pe),zoom:te.zoom+1,x:Oe,y:Ze,wrap:te.wrap,fullyVisible:le})}}return G.sort(function(qe,tt){return qe.distanceSq-tt.distanceSq}).map(function(qe){return qe.tileID})},ur.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},xr.unmodified.get=function(){return this._unmodified},ur.prototype.zoomScale=function(n){return Math.pow(2,n)},ur.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},ur.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},ur.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},xr.point.get=function(){return this.project(this.center)},ur.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),u=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(n),w=new a.MercatorCoordinate(m.x-(o.x-u.x),m.y-(o.y-u.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},ur.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},ur.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},ur.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},ur.prototype.coordinateLocation=function(n){return n.toLngLat()},ur.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var u=s[3],m=o[3],w=s[1]/u,S=o[1]/m,k=s[2]/u,P=o[2]/m,L=k===P?0:(0-k)/(P-k);return new a.MercatorCoordinate(a.number(s[0]/u,o[0]/m,L)/this.worldSize,a.number(w,S,L)/this.worldSize)},ur.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},ur.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},ur.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},ur.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},ur.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,u=s?this._alignedPosMatrixCache:this._posMatrixCache;if(u[o])return u[o];var m=n.canonical,w=this.worldSize/this.zoomScale(m.z),S=m.x+Math.pow(2,m.z)*n.wrap,k=a.identity(new Float64Array(16));return a.translate(k,k,[S*w,m.y*w,0]),a.scale(k,k,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(k,s?this.alignedProjMatrix:this.projMatrix,k),u[o]=new Float32Array(k),u[o]},ur.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},ur.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,u,m=-90,w=90,S=-180,k=180,P=this.size,L=this._unmodified;if(this.latRange){var G=this.latRange;m=a.mercatorYfromLat(G[1])*this.worldSize,n=(w=a.mercatorYfromLat(G[0])*this.worldSize)-m<P.y?P.y/(w-m):0}if(this.lngRange){var W=this.lngRange;S=a.mercatorXfromLng(W[0])*this.worldSize,s=(k=a.mercatorXfromLng(W[1])*this.worldSize)-S<P.x?P.x/(k-S):0}var J=this.point,oe=Math.max(s||0,n||0);if(oe)return this.center=this.unproject(new a.Point(s?(k+S)/2:J.x,n?(w+m)/2:J.y)),this.zoom+=this.scaleZoom(oe),this._unmodified=L,void(this._constraining=!1);if(this.latRange){var te=J.y,se=P.y/2;te-se<m&&(u=m+se),te+se>w&&(u=w-se)}if(this.lngRange){var $=J.x,le=P.x/2;$-le<S&&(o=S+le),$+le>k&&(o=k-le)}o===void 0&&u===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:J.x,u!==void 0?u:J.y))),this._unmodified=L,this._constraining=!1}},ur.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),u=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),m=this.point,w=m.x,S=m.y,k=1.01*(Math.cos(Math.PI/2-this._pitch)*u+this.cameraToCenterDistance),P=this.height/50,L=new Float64Array(16);a.perspective(L,this._fov,this.width/this.height,P,k),L[8]=2*-n.x/this.width,L[9]=2*n.y/this.height,a.scale(L,L,[1,-1,1]),a.translate(L,L,[0,0,-this.cameraToCenterDistance]),a.rotateX(L,L,this._pitch),a.rotateZ(L,L,this.angle),a.translate(L,L,[-w,-S,0]),this.mercatorMatrix=a.scale([],L,[this.worldSize,this.worldSize,this.worldSize]),a.scale(L,L,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=L,this.invProjMatrix=a.invert([],this.projMatrix);var G=this.width%2/2,W=this.height%2/2,J=Math.cos(this.angle),oe=Math.sin(this.angle),te=w-Math.round(w)+J*G+oe*W,se=S-Math.round(S)+J*W+oe*G,$=new Float64Array(L);if(a.translate($,$,[te>.5?te-1:te,se>.5?se-1:se,0]),this.alignedProjMatrix=$,L=a.create(),a.scale(L,L,[this.width/2,-this.height/2,1]),a.translate(L,L,[1,-1,0]),this.labelPlaneMatrix=L,L=a.create(),a.scale(L,L,[1,-1,1]),a.translate(L,L,[-1,-1,0]),a.scale(L,L,[2/this.width,2/this.height,1]),this.glCoordMatrix=L,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(L=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=L,this._posMatrixCache={},this._alignedPosMatrixCache={}}},ur.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},ur.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},ur.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,u=s.y,m=s.x,w=s.y,S=0,k=n;S<k.length;S+=1){var P=k[S];o=Math.min(o,P.x),u=Math.min(u,P.y),m=Math.max(m,P.x),w=Math.max(w,P.y)}return[new a.Point(o,u),new a.Point(m,u),new a.Point(m,w),new a.Point(o,w),new a.Point(o,u)]},Object.defineProperties(ur.prototype,xr);var xi=function(n){var s,o,u,m;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,u=null,m=function(){u=null,o&&(s(),u=setTimeout(m,300),o=!1)},function(){return o=!0,u||m(),u})};xi.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},xi.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},xi.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,u=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,u),w=Math.round(s.lng*m)/m,S=Math.round(s.lat*m)/m,k=this._map.getBearing(),P=this._map.getPitch(),L="";if(L+=n?"/"+w+"/"+S+"/"+o:o+"/"+S+"/"+w,(k||P)&&(L+="/"+Math.round(10*k)/10),P&&(L+="/"+Math.round(P)),this._hashName){var G=this._hashName,W=!1,J=a.window.location.hash.slice(1).split("&").map(function(oe){var te=oe.split("=")[0];return te===G?(W=!0,te+"="+L):oe}).filter(function(oe){return oe});return W||J.push(G+"="+L),"#"+J.join("&")}return"#"+L},xi.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(u){return u.split("=")}).forEach(function(u){u[0]===s._hashName&&(n=u)}),(n&&n[1]||"").split("/")):o.split("/")},xi.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},xi.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var Oo={linearity:.3,easing:a.bezier(0,0,.3,1)},As=a.extend({deceleration:2500,maxSpeed:1400},Oo),ua=a.extend({deceleration:20,maxSpeed:1400},Oo),qc=a.extend({deceleration:1e3,maxSpeed:360},Oo),Lu=a.extend({deceleration:1e3,maxSpeed:90},Oo),ca=function(n){this._map=n,this.clear()};function ha(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function pa(n,s,o){var u=o.maxSpeed,m=o.linearity,w=o.deceleration,S=a.clamp(n*m/(s/1e3),-u,u),k=Math.abs(S)/(w*m);return{easing:o.easing,duration:1e3*k,amount:S*(k/2)}}ca.prototype.clear=function(){this._inertiaBuffer=[]},ca.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},ca.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},ca.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,u=this._inertiaBuffer;o<u.length;o+=1){var m=u[o].settings;s.zoom+=m.zoomDelta||0,s.bearing+=m.bearingDelta||0,s.pitch+=m.pitchDelta||0,m.panDelta&&s.pan._add(m.panDelta),m.around&&(s.around=m.around),m.pinchAround&&(s.pinchAround=m.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(s.pan.mag()){var k=pa(s.pan.mag(),w,a.extend({},As,n||{}));S.offset=s.pan.mult(k.amount/s.pan.mag()),S.center=this._map.transform.center,ha(S,k)}if(s.zoom){var P=pa(s.zoom,w,ua);S.zoom=this._map.transform.zoom+P.amount,ha(S,P)}if(s.bearing){var L=pa(s.bearing,w,qc);S.bearing=this._map.transform.bearing+a.clamp(L.amount,-179,179),ha(S,L)}if(s.pitch){var G=pa(s.pitch,w,Lu);S.pitch=this._map.transform.pitch+G.amount,ha(S,G)}if(S.zoom||S.bearing){var W=s.pinchAround===void 0?s.around:s.pinchAround;S.around=W?this._map.unproject(W):this._map.getCenter()}return this.clear(),a.extend(S,{noMoveStart:!0})}};var li=function(n){function s(u,m,w,S){S===void 0&&(S={});var k=I.mousePos(m.getCanvasContainer(),w),P=m.unproject(k);n.call(this,u,a.extend({point:k,lngLat:P,originalEvent:w},S)),this._defaultPrevented=!1,this.target=m}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),ss=function(n){function s(u,m,w){var S=u==="touchend"?w.changedTouches:w.touches,k=I.touchPos(m.getCanvasContainer(),S),P=k.map(function(W){return m.unproject(W)}),L=k.reduce(function(W,J,oe,te){return W.add(J.div(te.length))},new a.Point(0,0)),G=m.unproject(L);n.call(this,u,{points:k,point:L,lngLats:P,lngLat:G,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),ou=function(n){function s(u,m,w){n.call(this,u,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),wi=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};wi.prototype.reset=function(){delete this._mousedownPos},wi.prototype.wheel=function(n){return this._firePreventable(new ou(n.type,this._map,n))},wi.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new li(n.type,this._map,n))},wi.prototype.mouseup=function(n){this._map.fire(new li(n.type,this._map,n))},wi.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new li(n.type,this._map,n))},wi.prototype.dblclick=function(n){return this._firePreventable(new li(n.type,this._map,n))},wi.prototype.mouseover=function(n){this._map.fire(new li(n.type,this._map,n))},wi.prototype.mouseout=function(n){this._map.fire(new li(n.type,this._map,n))},wi.prototype.touchstart=function(n){return this._firePreventable(new ss(n.type,this._map,n))},wi.prototype.touchmove=function(n){this._map.fire(new ss(n.type,this._map,n))},wi.prototype.touchend=function(n){this._map.fire(new ss(n.type,this._map,n))},wi.prototype.touchcancel=function(n){this._map.fire(new ss(n.type,this._map,n))},wi.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},wi.prototype.isEnabled=function(){return!0},wi.prototype.isActive=function(){return!1},wi.prototype.enable=function(){},wi.prototype.disable=function(){};var lt=function(n){this._map=n};lt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},lt.prototype.mousemove=function(n){this._map.fire(new li(n.type,this._map,n))},lt.prototype.mousedown=function(){this._delayContextMenu=!0},lt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new li("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},lt.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new li(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},lt.prototype.isEnabled=function(){return!0},lt.prototype.isActive=function(){return!1},lt.prototype.enable=function(){},lt.prototype.disable=function(){};var qn=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Fo(n,s){for(var o={},u=0;u<n.length;u++)o[n[u].identifier]=s[u];return o}qn.prototype.isEnabled=function(){return!!this._enabled},qn.prototype.isActive=function(){return!!this._active},qn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},qn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},qn.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(I.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},qn.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var u=this._startPos;this._lastPos=o,this._box||(this._box=I.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var m=Math.min(u.x,o.x),w=Math.max(u.x,o.x),S=Math.min(u.y,o.y),k=Math.max(u.y,o.y);I.setTransform(this._box,"translate("+m+"px,"+S+"px)"),this._box.style.width=w-m+"px",this._box.style.height=k-S+"px"}}},qn.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var u=this._startPos,m=s;if(this.reset(),I.suppressClick(),u.x!==m.x||u.y!==m.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(u,m,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},qn.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},qn.prototype.blur=function(){this.reset()},qn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(I.remove(this._box),this._box=null),I.enableDrag(),delete this._startPos,delete this._lastPos},qn.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var zn=function(n){this.reset(),this.numTouches=n.numTouches};zn.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},zn.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(u){for(var m=new a.Point(0,0),w=0,S=u;w<S.length;w+=1)m._add(S[w]);return m.div(u.length)}(s),this.touches=Fo(o,s)))},zn.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var u=Fo(o,s);for(var m in this.touches){var w=u[m];(!w||w.dist(this.touches[m])>30)&&(this.aborted=!0)}}},zn.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var u=!this.aborted&&this.centroid;if(this.reset(),u)return u}};var un=function(n){this.singleTap=new zn(n),this.numTaps=n.numTaps,this.reset()};un.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},un.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},un.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},un.prototype.touchend=function(n,s,o){var u=this.singleTap.touchend(n,s,o);if(u){var m=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(u)<30;if(m&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}};var Zn=function(){this._zoomIn=new un({numTouches:1,numTaps:2}),this._zoomOut=new un({numTouches:2,numTaps:1}),this.reset()};Zn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Zn.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},Zn.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},Zn.prototype.touchend=function(n,s,o){var u=this,m=this._zoomIn.touchend(n,s,o),w=this._zoomOut.touchend(n,s,o);return m?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(m)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}}):void 0},Zn.prototype.touchcancel=function(){this.reset()},Zn.prototype.enable=function(){this._enabled=!0},Zn.prototype.disable=function(){this._enabled=!1,this.reset()},Zn.prototype.isEnabled=function(){return this._enabled},Zn.prototype.isActive=function(){return this._active};var ls={0:1,2:2},at=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};at.prototype.blur=function(){this.reset()},at.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},at.prototype._correctButton=function(n,s){return!1},at.prototype._move=function(n,s){return{}},at.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=I.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},at.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(u,m){var w=ls[m];return u.buttons===void 0||(u.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},at.prototype.mouseupWindow=function(n){this._lastPoint&&I.mouseButton(n)===this._eventButton&&(this._moved&&I.suppressClick(),this.reset())},at.prototype.enable=function(){this._enabled=!0},at.prototype.disable=function(){this._enabled=!1,this.reset()},at.prototype.isEnabled=function(){return this._enabled},at.prototype.isActive=function(){return this._active};var Al=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,u){n.prototype.mousedown.call(this,o,u),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,u){return u===0&&!o.ctrlKey},s.prototype._move=function(o,u){return{around:u,panDelta:u.sub(o)}},s}(at),Ma=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},s.prototype._move=function(o,u){var m=.8*(u.x-o.x);if(m)return this._active=!0,{bearingDelta:m}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(at),us=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},s.prototype._move=function(o,u){var m=-.5*(u.y-o.y);if(m)return this._active=!0,{pitchDelta:m}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(at),_o=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};_o.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},_o.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},_o.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},_o.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},_o.prototype.touchcancel=function(){this.reset()},_o.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var u=Fo(o,s),m=new a.Point(0,0),w=new a.Point(0,0),S=0;for(var k in u){var P=u[k],L=this._touches[k];L&&(m._add(P),w._add(P.sub(L)),S++,u[k]=P)}if(this._touches=u,!(S<this._minTouches)&&w.mag()){var G=w.div(S);if(this._sum._add(G),!(this._sum.mag()<this._clickTolerance))return{around:m.div(S),panDelta:G}}},_o.prototype.enable=function(){this._enabled=!0},_o.prototype.disable=function(){this._enabled=!1,this.reset()},_o.prototype.isEnabled=function(){return this._enabled},_o.prototype.isActive=function(){return this._active};var Ji=function(){this.reset()};function zs(n,s,o){for(var u=0;u<n.length;u++)if(n[u].identifier===o)return s[u]}function $s(n,s){return Math.log(n/s)/Math.LN2}Ji.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ji.prototype._start=function(n){},Ji.prototype._move=function(n,s,o){return{}},Ji.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Ji.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var u=this._firstTwoTouches,m=u[1],w=zs(o,s,u[0]),S=zs(o,s,m);if(w&&S){var k=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],k,n)}}},Ji.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var u=this._firstTwoTouches,m=u[1],w=zs(o,s,u[0]),S=zs(o,s,m);w&&S||(this._active&&I.suppressClick(),this.reset())}},Ji.prototype.touchcancel=function(){this.reset()},Ji.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Ji.prototype.disable=function(){this._enabled=!1,this.reset()},Ji.prototype.isEnabled=function(){return this._enabled},Ji.prototype.isActive=function(){return this._active};var Gn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,u){var m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs($s(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$s(this._distance,m),pinchAround:u}},s}(Ji);function Kn(n,s){return 180*n.angleWith(s)/Math.PI}var Ru=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,u){var m=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Kn(this._vector,m),pinchAround:u}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var u=25/(Math.PI*this._minDiameter)*360,m=Kn(o,this._startVector);return Math.abs(m)<u},s}(Ji);function Ps(n){return Math.abs(n.y)>Math.abs(n.x)}var Da=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,Ps(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,u,m){var w=o[0].sub(this._lastPoints[0]),S=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,S,m.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,u,m){if(this._valid!==void 0)return this._valid;var w=o.mag()>=2,S=u.mag()>=2;if(w||S){if(!w||!S)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;var k=o.y>0==u.y>0;return Ps(o)&&Ps(u)&&k}},s}(Ji),cs={panStep:100,bearingStep:15,pitchStep:10},No=function(){var n=cs;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function cn(n){return n*(2-n)}No.prototype.blur=function(){this.reset()},No.prototype.reset=function(){this._active=!1},No.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,u=0,m=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?u=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?u=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?m=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?m=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(u=0,m=0),{cameraAnimation:function(k){var P=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:cn,zoom:o?Math.round(P)+o*(n.shiftKey?2:1):P,bearing:k.getBearing()+u*s._bearingStep,pitch:k.getPitch()+m*s._pitchStep,offset:[-w*s._panStep,-S*s._panStep],center:k.getCenter()},{originalEvent:n})}}}},No.prototype.enable=function(){this._enabled=!0},No.prototype.disable=function(){this._enabled=!1,this.reset()},No.prototype.isEnabled=function(){return this._enabled},No.prototype.isActive=function(){return this._active},No.prototype.disableRotation=function(){this._rotationDisabled=!0},No.prototype.enableRotation=function(){this._rotationDisabled=!1};var er=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};er.prototype.setZoomRate=function(n){this._defaultZoomRate=n},er.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},er.prototype.isEnabled=function(){return!!this._enabled},er.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},er.prototype.isZooming=function(){return!!this._zooming},er.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},er.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},er.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),u=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(u*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},er.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},er.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=I.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},er.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,u=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&u!==0&&(u=1/u);var m=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(m*u))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,S=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,k=this._startZoom,P=this._easing,L=!1;if(this._type==="wheel"&&k&&P){var G=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),W=P(G);w=a.number(k,S,W),G<1?this._frameId||(this._frameId=!0):L=!0}else w=S,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},er.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,u=(a.browser.now()-o.start)/o.duration,m=o.easing(u+.01)-o.easing(u),w=.27/Math.sqrt(m*m+1e-4)*.01,S=Math.sqrt(.0729-w*w);s=a.bezier(w,S,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},er.prototype.blur=function(){this.reset()},er.prototype.reset=function(){this._active=!1};var Vo=function(n,s){this._clickZoom=n,this._tapZoom=s};Vo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Vo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Vo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Vo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var vo=function(){this.reset()};vo.prototype.reset=function(){this._active=!1},vo.prototype.blur=function(){this.reset()},vo.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},vo.prototype.enable=function(){this._enabled=!0},vo.prototype.disable=function(){this._enabled=!1,this.reset()},vo.prototype.isEnabled=function(){return this._enabled},vo.prototype.isActive=function(){return this._active};var qi=function(){this._tap=new un({numTouches:1,numTaps:1}),this.reset()};qi.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},qi.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},qi.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var u=s[0],m=u.y-this._swipePoint.y;return this._swipePoint=u,n.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(n,s,o)},qi.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},qi.prototype.touchcancel=function(){this.reset()},qi.prototype.enable=function(){this._enabled=!0},qi.prototype.disable=function(){this._enabled=!1,this.reset()},qi.prototype.isEnabled=function(){return this._enabled},qi.prototype.isActive=function(){return this._active};var Yi=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};Yi.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Yi.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Yi.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Yi.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Pn=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};Pn.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Pn.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Pn.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Pn.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Di=function(n,s,o,u){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0};Di.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Di.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Di.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Di.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Di.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Di.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Si=function(n){return n.zoom||n.drag||n.pitch||n.rotate},Zs=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function vt(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var gt=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ca(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var u=0,m=this._listeners;u<m.length;u+=1){var w=m[u],S=w[0];I.addEventListener(S,w[1],S===a.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};gt.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],u=o[0];I.removeEventListener(u,o[1],u===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},gt.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new wi(s,n));var u=s.boxZoom=new qn(s,n);this._add("boxZoom",u);var m=new Zn,w=new vo;s.doubleClickZoom=new Vo(w,m),this._add("tapZoom",m),this._add("clickZoom",w);var S=new qi;this._add("tapDragZoom",S);var k=s.touchPitch=new Da;this._add("touchPitch",k);var P=new Ma(n),L=new us(n);s.dragRotate=new Pn(n,P,L),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);var G=new Al(n),W=new _o(n);s.dragPan=new Yi(o,G,W),this._add("mousePan",G),this._add("touchPan",W,["touchZoom","touchRotate"]);var J=new Ru,oe=new Gn;s.touchZoomRotate=new Di(o,oe,J,S),this._add("touchRotate",J,["touchPan","touchZoom"]),this._add("touchZoom",oe,["touchPan","touchRotate"]);var te=s.scrollZoom=new er(s,this);this._add("scrollZoom",te,["mousePan"]);var se=s.keyboard=new No;this._add("keyboard",se),this._add("blockableMapEvent",new lt(s));for(var $=0,le=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];$<le.length;$+=1){var ye=le[$];n.interactive&&n[ye]&&s[ye].enable(n[ye])}},gt.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},gt.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},gt.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},gt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},gt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},gt.prototype.isMoving=function(){return Boolean(Si(this._eventsInProgress))||this.isZooming()},gt.prototype._blockedByActive=function(n,s,o){for(var u in n)if(u!==o&&(!s||s.indexOf(u)<0))return!0;return!1},gt.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},gt.prototype._getMapTouches=function(n){for(var s=[],o=0,u=n;o<u.length;o+=1){var m=u[o];this._el.contains(m.target)&&s.push(m)}return s},gt.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,u={needsRenderFrame:!1},m={},w={},S=n.touches?this._getMapTouches(n.touches):void 0,k=S?I.touchPos(this._el,S):I.mousePos(this._el,n),P=0,L=this._handlers;P<L.length;P+=1){var G=L[P],W=G.handlerName,J=G.handler,oe=G.allowed;if(J.isEnabled()){var te=void 0;this._blockedByActive(w,oe,W)?J.reset():J[s||n.type]&&(te=J[s||n.type](n,k,S),this.mergeHandlerResult(u,m,te,W,o),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||J.isActive())&&(w[W]=J)}}var se={};for(var $ in this._previousActiveHandlers)w[$]||(se[$]=o);this._previousActiveHandlers=w,(Object.keys(se).length||vt(u))&&(this._changes.push([u,m,se]),this._triggerRenderFrame()),(Object.keys(w).length||vt(u))&&this._map._stop(!0),this._updatingCamera=!1;var le=u.cameraAnimation;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},gt.prototype.mergeHandlerResult=function(n,s,o,u,m){if(o){a.extend(n,o);var w={handlerName:u,originalEvent:o.originalEvent||m};o.zoomDelta!==void 0&&(s.zoom=w),o.panDelta!==void 0&&(s.drag=w),o.pitchDelta!==void 0&&(s.pitch=w),o.bearingDelta!==void 0&&(s.rotate=w)}},gt.prototype._applyChanges=function(){for(var n={},s={},o={},u=0,m=this._changes;u<m.length;u+=1){var w=m[u],S=w[0],k=w[1],P=w[2];S.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),a.extend(s,k),a.extend(o,P)}this._updateMapTransform(n,s,o),this._changes=[]},gt.prototype._updateMapTransform=function(n,s,o){var u=this._map,m=u.transform;if(!vt(n))return this._fireEvents(s,o,!0);var w=n.panDelta,S=n.zoomDelta,k=n.bearingDelta,P=n.pitchDelta,L=n.around,G=n.pinchAround;G!==void 0&&(L=G),u._stop(!0),L=L||u.transform.centerPoint;var W=m.pointLocation(w?L.sub(w):L);k&&(m.bearing+=k),P&&(m.pitch+=P),S&&(m.zoom+=S),m.setLocationAtPoint(W,L),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},gt.prototype._fireEvents=function(n,s,o){var u=this,m=Si(this._eventsInProgress),w=Si(n),S={};for(var k in n)this._eventsInProgress[k]||(S[k+"start"]=n[k].originalEvent),this._eventsInProgress[k]=n[k];for(var P in!m&&w&&this._fireEvent("movestart",w.originalEvent),S)this._fireEvent(P,S[P]);for(var L in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(L,n[L].originalEvent);var G,W={};for(var J in this._eventsInProgress){var oe=this._eventsInProgress[J],te=oe.handlerName,se=oe.originalEvent;this._handlersById[te].isActive()||(delete this._eventsInProgress[J],W[J+"end"]=G=s[te]||se)}for(var $ in W)this._fireEvent($,W[$]);var le=Si(this._eventsInProgress);if(o&&(m||w)&&!le){this._updatingCamera=!0;var ye=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ve=function(Be){return Be!==0&&-u._bearingSnap<Be&&Be<u._bearingSnap};ye?(ve(ye.bearing||this._map.getBearing())&&(ye.bearing=0),this._map.easeTo(ye,{originalEvent:G})):(this._map.fire(new a.Event("moveend",{originalEvent:G})),ve(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},gt.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},gt.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new Zs("renderFrame",{timeStamp:s})),n._applyChanges()})},gt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var el=function(n){function s(o,u){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,u){return this.jumpTo({center:o},u)},s.prototype.panBy=function(o,u,m){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},u),m)},s.prototype.panTo=function(o,u,m){return this.easeTo(a.extend({center:o},u),m)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,u){return this.jumpTo({zoom:o},u),this},s.prototype.zoomTo=function(o,u,m){return this.easeTo(a.extend({zoom:o},u),m)},s.prototype.zoomIn=function(o,u){return this.zoomTo(this.getZoom()+1,o,u),this},s.prototype.zoomOut=function(o,u){return this.zoomTo(this.getZoom()-1,o,u),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,u){return this.jumpTo({bearing:o},u),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,u){return this.jumpTo({padding:o},u),this},s.prototype.rotateTo=function(o,u,m){return this.easeTo(a.extend({bearing:o},u),m)},s.prototype.resetNorth=function(o,u){return this.rotateTo(0,a.extend({duration:1e3},o),u),this},s.prototype.resetNorthPitch=function(o,u){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),u),this},s.prototype.snapToNorth=function(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,u){return this.jumpTo({pitch:o},u),this},s.prototype.cameraForBounds=function(o,u){o=a.LngLatBounds.convert(o);var m=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),m,u)},s.prototype._cameraForBoxAndBearing=function(o,u,m,w){var S={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var k=w.padding;w.padding={top:k,bottom:k,right:k,left:k}}w.padding=a.extend(S,w.padding);var P=this.transform,L=P.padding,G=P.project(a.LngLat.convert(o)),W=P.project(a.LngLat.convert(u)),J=G.rotate(-m*Math.PI/180),oe=W.rotate(-m*Math.PI/180),te=new a.Point(Math.max(J.x,oe.x),Math.max(J.y,oe.y)),se=new a.Point(Math.min(J.x,oe.x),Math.min(J.y,oe.y)),$=te.sub(se),le=(P.width-(L.left+L.right+w.padding.left+w.padding.right))/$.x,ye=(P.height-(L.top+L.bottom+w.padding.top+w.padding.bottom))/$.y;if(!(ye<0||le<0)){var ve=Math.min(P.scaleZoom(P.scale*Math.min(le,ye)),w.maxZoom),Be=typeof w.offset.x=="number"?new a.Point(w.offset.x,w.offset.y):a.Point.convert(w.offset),Te=new a.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(m*Math.PI/180),Pe=Be.add(Te).mult(P.scale/P.zoomScale(ve));return{center:P.unproject(G.add(W).div(2).sub(Pe)),zoom:ve,bearing:m}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,u,m){return this._fitInternal(this.cameraForBounds(o,u),u,m)},s.prototype.fitScreenCoordinates=function(o,u,m,w,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(u)),m,w),w,S)},s.prototype._fitInternal=function(o,u,m){return o?(delete(u=a.extend(o,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this},s.prototype.jumpTo=function(o,u){this.stop();var m=this.transform,w=!1,S=!1,k=!1;return"zoom"in o&&m.zoom!==+o.zoom&&(w=!0,m.zoom=+o.zoom),o.center!==void 0&&(m.center=a.LngLat.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(S=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(k=!0,m.pitch=+o.pitch),o.padding==null||m.isPaddingEqual(o.padding)||(m.padding=o.padding),this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),w&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),S&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),k&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u))},s.prototype.easeTo=function(o,u){var m=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var w=this.transform,S=this.getZoom(),k=this.getBearing(),P=this.getPitch(),L=this.getPadding(),G="zoom"in o?+o.zoom:S,W="bearing"in o?this._normalizeBearing(o.bearing,k):k,J="pitch"in o?+o.pitch:P,oe="padding"in o?o.padding:w.padding,te=a.Point.convert(o.offset),se=w.centerPoint.add(te),$=w.pointLocation(se),le=a.LngLat.convert(o.center||$);this._normalizeCenter(le);var ye,ve,Be=w.project($),Te=w.project(le).sub(Be),Pe=w.zoomScale(G-S);o.around&&(ye=a.LngLat.convert(o.around),ve=w.locationPoint(ye));var Oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||G!==S,this._rotating=this._rotating||k!==W,this._pitching=this._pitching||J!==P,this._padding=!w.isPaddingEqual(oe),this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,Oe),this._ease(function(Ze){if(m._zooming&&(w.zoom=a.number(S,G,Ze)),m._rotating&&(w.bearing=a.number(k,W,Ze)),m._pitching&&(w.pitch=a.number(P,J,Ze)),m._padding&&(w.interpolatePadding(L,oe,Ze),se=w.centerPoint.add(te)),ye)w.setLocationAtPoint(ye,ve);else{var qe=w.zoomScale(w.zoom-S),tt=G>S?Math.min(2,Pe):Math.max(.5,Pe),ft=Math.pow(tt,1-Ze),zt=w.unproject(Be.add(Te.mult(Ze*ft)).mult(qe));w.setLocationAtPoint(w.renderWorldCopies?zt.wrap():zt,se)}m._fireMoveEvents(u)},function(Ze){m._afterEase(u,Ze)},o),this},s.prototype._prepareEase=function(o,u,m){m===void 0&&(m={}),this._moving=!0,u||m.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!m.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,u){if(!this._easeId||!u||this._easeId!==u){delete this._easeId;var m=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new a.Event("zoomend",o)),w&&this.fire(new a.Event("rotateend",o)),S&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,u){var m=this;if(!o.essential&&a.browser.prefersReducedMotion){var w=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,u)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var S=this.transform,k=this.getZoom(),P=this.getBearing(),L=this.getPitch(),G=this.getPadding(),W="zoom"in o?a.clamp(+o.zoom,S.minZoom,S.maxZoom):k,J="bearing"in o?this._normalizeBearing(o.bearing,P):P,oe="pitch"in o?+o.pitch:L,te="padding"in o?o.padding:S.padding,se=S.zoomScale(W-k),$=a.Point.convert(o.offset),le=S.centerPoint.add($),ye=S.pointLocation(le),ve=a.LngLat.convert(o.center||ye);this._normalizeCenter(ve);var Be=S.project(ye),Te=S.project(ve).sub(Be),Pe=o.curve,Oe=Math.max(S.width,S.height),Ze=Oe/se,qe=Te.mag();if("minZoom"in o){var tt=a.clamp(Math.min(o.minZoom,k,W),S.minZoom,S.maxZoom),ft=Oe/S.zoomScale(tt-k);Pe=Math.sqrt(ft/qe*2)}var zt=Pe*Pe;function wt(Q){var Ie=(Ze*Ze-Oe*Oe+(Q?-1:1)*zt*zt*qe*qe)/(2*(Q?Ze:Oe)*zt*qe);return Math.log(Math.sqrt(Ie*Ie+1)-Ie)}function Zt(Q){return(Math.exp(Q)-Math.exp(-Q))/2}function dt(Q){return(Math.exp(Q)+Math.exp(-Q))/2}var qt=wt(0),Mt=function(Q){return dt(qt)/dt(qt+Pe*Q)},Vt=function(Q){return Oe*((dt(qt)*(Zt(Ie=qt+Pe*Q)/dt(Ie))-Zt(qt))/zt)/qe;var Ie},Bt=(wt(1)-qt)/Pe;if(Math.abs(qe)<1e-6||!isFinite(Bt)){if(Math.abs(Oe-Ze)<1e-6)return this.easeTo(o,u);var Ot=Ze<Oe?-1:1;Bt=Math.abs(Math.log(Ze/Oe))/Pe,Vt=function(){return 0},Mt=function(Q){return Math.exp(Ot*Pe*Q)}}return o.duration="duration"in o?+o.duration:1e3*Bt/("screenSpeed"in o?+o.screenSpeed/Pe:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=P!==J,this._pitching=oe!==L,this._padding=!S.isPaddingEqual(te),this._prepareEase(u,!1),this._ease(function(Q){var Ie=Q*Bt,Wr=1/Mt(Ie);S.zoom=Q===1?W:k+S.scaleZoom(Wr),m._rotating&&(S.bearing=a.number(P,J,Q)),m._pitching&&(S.pitch=a.number(L,oe,Q)),m._padding&&(S.interpolatePadding(G,te,Q),le=S.centerPoint.add($));var Dr=Q===1?ve:S.unproject(Be.add(Te.mult(Vt(Ie))).mult(Wr));S.setLocationAtPoint(S.renderWorldCopies?Dr.wrap():Dr,le),m._fireMoveEvents(u)},function(){return m._afterEase(u)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,u)}if(!o){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(o,u,m){m.animate===!1||m.duration===0?(o(1),u()):(this._easeStart=a.browser.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,u){o=a.wrap(o,-180,180);var m=Math.abs(o-u);return Math.abs(o-360-u)<m&&(o-=360),Math.abs(o+360-u)<m&&(o+=360),o},s.prototype._normalizeCenter=function(o){var u=this.transform;if(u.renderWorldCopies&&!u.lngRange){var m=o.lng-u.center.lng;o.lng+=m>180?-360:m<-180?360:0}},s}(a.Evented),Li=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Li.prototype.getDefaultPosition=function(){return"bottom-right"},Li.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=I.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=I.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Li.prototype.onRemove=function(){I.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Li.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},Li.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Li.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(u,m,w){return m.value&&(u+=m.key+"="+m.value+(w<s.length-1?"&":"")),u},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},Li.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Li.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(k){return typeof k!="string"?"":k})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var u in o){var m=o[u];if(m.used){var w=m.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(k,P){return k.length-P.length});var S=(n=n.filter(function(k,P){for(var L=P+1;L<n.length;L++)if(n[L].indexOf(k)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Li.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Cn=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};Cn.prototype.onAdd=function(n){this._map=n,this._container=I.create("div","mapboxgl-ctrl");var s=I.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Cn.prototype.onRemove=function(){I.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Cn.prototype.getDefaultPosition=function(){return"bottom-left"},Cn.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Cn.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},Cn.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var Qi=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Qi.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},Qi.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,u=s?this._queue.concat(s):this._queue;o<u.length;o+=1){var m=u[o];if(m.id===n)return void(m.cancelled=!0)}},Qi.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,u=s;o<u.length;o+=1){var m=u[o];if(!m.cancelled&&(m.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Qi.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Xn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Gs=a.window.HTMLImageElement,tl=a.window.HTMLElement,Er=a.window.ImageBitmap,pi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},au=function(n){function s(u){var m=this;if((u=a.extend({},pi,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new ur(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies);if(n.call(this,w,u),this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=u.collectResourceTiming,this._renderTaskQueue=new Qi,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Xn,u.locale),this._clickTolerance=u.clickTolerance,this._requestManager=new a.RequestManager(u.transformRequest,u.accessToken),typeof u.container=="string"){if(this._container=a.window.document.getElementById(u.container),!this._container)throw new Error("Container '"+u.container+"' not found.")}else{if(!(u.container instanceof tl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return m._update(!1)}),this.on("moveend",function(){return m._update(!1)}),this.on("zoom",function(){return m._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new gt(this,u),this._hash=u.hash&&new xi(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,a.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Li({customAttribution:u.customAttribution})),this.addControl(new Cn,u.logoPosition),this.on("style.load",function(){m.transform.unmodified&&m.jumpTo(m.style.stylesheet)}),this.on("data",function(S){m._update(S.dataType==="style"),m.fire(new a.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){m.fire(new a.Event(S.dataType+"dataloading",S))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(u,m){if(m===void 0&&(m=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=u.onAdd(this);this._controls.push(u);var S=this._controlPositions[m];return m.indexOf("bottom")!==-1?S.insertBefore(w,S.firstChild):S.appendChild(w),this},s.prototype.removeControl=function(u){if(!u||!u.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var m=this._controls.indexOf(u);return m>-1&&this._controls.splice(m,1),u.onRemove(this),this},s.prototype.hasControl=function(u){return this._controls.indexOf(u)>-1},s.prototype.resize=function(u){var m=this._containerDimensions(),w=m[0],S=m[1];if(w===this.transform.width&&S===this.transform.height)return this;this._resizeCanvas(w,S),this.transform.resize(w,S),this.painter.resize(w,S);var k=!this._moving;return k&&this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),this.fire(new a.Event("resize",u)),k&&this.fire(new a.Event("moveend",u)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(u){return this.transform.setMaxBounds(a.LngLatBounds.convert(u)),this._update()},s.prototype.setMinZoom=function(u){if((u=u==null?-2:u)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u&&this.setZoom(u),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(u){if((u=u==null?22:u)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u&&this.setZoom(u),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(u){if((u=u==null?0:u)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u&&this.setPitch(u),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(u){if((u=u==null?60:u)>60)throw new Error("maxPitch must be less than or equal to 60");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u&&this.setPitch(u),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(u){return this.transform.renderWorldCopies=u,this._update()},s.prototype.project=function(u){return this.transform.locationPoint(a.LngLat.convert(u))},s.prototype.unproject=function(u){return this.transform.pointLocation(a.Point.convert(u))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(u,m,w){var S,k=this;if(u==="mouseenter"||u==="mouseover"){var P=!1;return{layer:m,listener:w,delegates:{mousemove:function(G){var W=k.getLayer(m)?k.queryRenderedFeatures(G.point,{layers:[m]}):[];W.length?P||(P=!0,w.call(k,new li(u,k,G.originalEvent,{features:W}))):P=!1},mouseout:function(){P=!1}}}}if(u==="mouseleave"||u==="mouseout"){var L=!1;return{layer:m,listener:w,delegates:{mousemove:function(G){(k.getLayer(m)?k.queryRenderedFeatures(G.point,{layers:[m]}):[]).length?L=!0:L&&(L=!1,w.call(k,new li(u,k,G.originalEvent)))},mouseout:function(G){L&&(L=!1,w.call(k,new li(u,k,G.originalEvent)))}}}}return{layer:m,listener:w,delegates:(S={},S[u]=function(G){var W=k.getLayer(m)?k.queryRenderedFeatures(G.point,{layers:[m]}):[];W.length&&(G.features=W,w.call(k,G),delete G.features)},S)}},s.prototype.on=function(u,m,w){if(w===void 0)return n.prototype.on.call(this,u,m);var S=this._createDelegatedListener(u,m,w);for(var k in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(S),S.delegates)this.on(k,S.delegates[k]);return this},s.prototype.once=function(u,m,w){if(w===void 0)return n.prototype.once.call(this,u,m);var S=this._createDelegatedListener(u,m,w);for(var k in S.delegates)this.once(k,S.delegates[k]);return this},s.prototype.off=function(u,m,w){var S=this;return w===void 0?n.prototype.off.call(this,u,m):(this._delegatedListeners&&this._delegatedListeners[u]&&function(k){for(var P=k[u],L=0;L<P.length;L++){var G=P[L];if(G.layer===m&&G.listener===w){for(var W in G.delegates)S.off(W,G.delegates[W]);return P.splice(L,1),S}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(u,m){if(!this.style)return[];var w;if(m!==void 0||u===void 0||u instanceof a.Point||Array.isArray(u)||(m=u,u=void 0),m=m||{},(u=u||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof u[0]=="number")w=[a.Point.convert(u)];else{var S=a.Point.convert(u[0]),k=a.Point.convert(u[1]);w=[S,new a.Point(k.x,S.y),k,new a.Point(S.x,k.y),S]}return this.style.queryRenderedFeatures(w,m,this.transform)},s.prototype.querySourceFeatures=function(u,m){return this.style.querySourceFeatures(u,m)},s.prototype.setStyle=function(u,m){return(m=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},m)).diff!==!1&&m.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&u?(this._diffStyle(u,m),this):(this._localIdeographFontFamily=m.localIdeographFontFamily,this._updateStyle(u,m))},s.prototype._getUIString=function(u){var m=this._locale[u];if(m==null)throw new Error("Missing UI string '"+u+"'");return m},s.prototype._updateStyle=function(u,m){return this.style&&(this.style.setEventedParent(null),this.style._remove()),u?(this.style=new _n(this,m||{}),this.style.setEventedParent(this,{style:this.style}),typeof u=="string"?this.style.loadURL(u):this.style.loadJSON(u),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new _n(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(u,m){var w=this;if(typeof u=="string"){var S=this._requestManager.normalizeStyleURL(u),k=this._requestManager.transformRequest(S,a.ResourceType.Style);a.getJSON(k,function(P,L){P?w.fire(new a.ErrorEvent(P)):L&&w._updateDiff(L,m)})}else typeof u=="object"&&this._updateDiff(u,m)},s.prototype._updateDiff=function(u,m){try{this.style.setState(u)&&this._update(!0)}catch(w){a.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(u,m)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(u,m){return this._lazyInitEmptyStyle(),this.style.addSource(u,m),this._update(!0)},s.prototype.isSourceLoaded=function(u){var m=this.style&&this.style.sourceCaches[u];if(m!==void 0)return m.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+u+"'")))},s.prototype.areTilesLoaded=function(){var u=this.style&&this.style.sourceCaches;for(var m in u){var w=u[m]._tiles;for(var S in w){var k=w[S];if(k.state!=="loaded"&&k.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(u,m,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(u,m,w)},s.prototype.removeSource=function(u){return this.style.removeSource(u),this._update(!0)},s.prototype.getSource=function(u){return this.style.getSource(u)},s.prototype.addImage=function(u,m,w){w===void 0&&(w={});var S=w.pixelRatio;S===void 0&&(S=1);var k=w.sdf;k===void 0&&(k=!1);var P=w.stretchX,L=w.stretchY,G=w.content;if(this._lazyInitEmptyStyle(),m instanceof Gs||Er&&m instanceof Er){var W=a.browser.getImageData(m);this.style.addImage(u,{data:new a.RGBAImage({width:W.width,height:W.height},W.data),pixelRatio:S,stretchX:P,stretchY:L,content:G,sdf:k,version:0})}else{if(m.width===void 0||m.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var J=m;this.style.addImage(u,{data:new a.RGBAImage({width:m.width,height:m.height},new Uint8Array(m.data)),pixelRatio:S,stretchX:P,stretchY:L,content:G,sdf:k,version:0,userImage:J}),J.onAdd&&J.onAdd(this,u)}},s.prototype.updateImage=function(u,m){var w=this.style.getImage(u);if(!w)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=m instanceof Gs||Er&&m instanceof Er?a.browser.getImageData(m):m,k=S.width,P=S.height,L=S.data;return k===void 0||P===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):k!==w.data.width||P!==w.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(L,!(m instanceof Gs||Er&&m instanceof Er)),void this.style.updateImage(u,w))},s.prototype.hasImage=function(u){return u?!!this.style.getImage(u):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(u){this.style.removeImage(u)},s.prototype.loadImage=function(u,m){a.getImage(this._requestManager.transformRequest(u,a.ResourceType.Image),m)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(u,m){return this._lazyInitEmptyStyle(),this.style.addLayer(u,m),this._update(!0)},s.prototype.moveLayer=function(u,m){return this.style.moveLayer(u,m),this._update(!0)},s.prototype.removeLayer=function(u){return this.style.removeLayer(u),this._update(!0)},s.prototype.getLayer=function(u){return this.style.getLayer(u)},s.prototype.setLayerZoomRange=function(u,m,w){return this.style.setLayerZoomRange(u,m,w),this._update(!0)},s.prototype.setFilter=function(u,m,w){return w===void 0&&(w={}),this.style.setFilter(u,m,w),this._update(!0)},s.prototype.getFilter=function(u){return this.style.getFilter(u)},s.prototype.setPaintProperty=function(u,m,w,S){return S===void 0&&(S={}),this.style.setPaintProperty(u,m,w,S),this._update(!0)},s.prototype.getPaintProperty=function(u,m){return this.style.getPaintProperty(u,m)},s.prototype.setLayoutProperty=function(u,m,w,S){return S===void 0&&(S={}),this.style.setLayoutProperty(u,m,w,S),this._update(!0)},s.prototype.getLayoutProperty=function(u,m){return this.style.getLayoutProperty(u,m)},s.prototype.setLight=function(u,m){return m===void 0&&(m={}),this._lazyInitEmptyStyle(),this.style.setLight(u,m),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(u,m){return this.style.setFeatureState(u,m),this._update()},s.prototype.removeFeatureState=function(u,m){return this.style.removeFeatureState(u,m),this._update()},s.prototype.getFeatureState=function(u){return this.style.getFeatureState(u)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var u=0,m=0;return this._container&&(u=this._container.clientWidth||400,m=this._container.clientHeight||300),[u,m]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=I.create("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();var m=this._canvasContainer=I.create("div","mapboxgl-canvas-container",u);this._interactive&&m.classList.add("mapboxgl-interactive"),this._canvas=I.create("canvas","mapboxgl-canvas",m),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var S=this._controlContainer=I.create("div","mapboxgl-control-container",u),k=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(P){k[P]=I.create("div","mapboxgl-ctrl-"+P,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(u,m){var w=a.browser.devicePixelRatio||1;this._canvas.width=w*u,this._canvas.height=w*m,this._canvas.style.width=u+"px",this._canvas.style.height=m+"px"},s.prototype._setupPainter=function(){var u=a.extend({},A.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),m=this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);m?(this.painter=new Fr(m,this.transform),a.webpSupported.testSupport(m)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:u}))},s.prototype._contextRestored=function(u){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:u}))},s.prototype._onMapScroll=function(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(u){return this._update(),this._renderTaskQueue.add(u)},s.prototype._cancelRenderFrame=function(u){this._renderTaskQueue.remove(u)},s.prototype._render=function(u){var m,w=this,S=0,k=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(m=k.createQueryEXT(),k.beginQueryEXT(k.TIME_ELAPSED_EXT,m),S=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(u),!this._removed){var P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var L=this.transform.zoom,G=a.browser.now();this.style.zoomHistory.update(L,G);var W=new a.EvaluationParameters(L,{now:G,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),J=W.crossFadingFactor();J===1&&J===this._crossFadingFactor||(P=!0,this._crossFadingFactor=J),this.style.update(W)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var oe=a.browser.now()-S;k.endQueryEXT(k.TIME_ELAPSED_EXT,m),setTimeout(function(){var $=k.getQueryObjectEXT(m,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(m),w.fire(new a.Event("gpu-timing-frame",{cpuTime:oe,gpuTime:$}))},50)}if(this.listens("gpu-timing-layer")){var te=this.painter.collectGpuTimers();setTimeout(function(){var $=w.painter.queryGpuTimers(te);w.fire(new a.Event("gpu-timing-layer",{layerTimes:$}))},50)}var se=this._sourcesDirty||this._styleDirty||this._placementDirty;return se||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||se||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var u=0,m=this._controls;u<m.length;u+=1)m[u].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),Hn(this._canvasContainer),Hn(this._controlContainer),Hn(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var u=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(m){u._frame=null,u._render(m)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(u){this._trackResize&&this.resize({originalEvent:u})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(u){this._showPadding!==u&&(this._showPadding=u,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(u){this._vertices=u,this._update()},s.prototype._setCacheLimits=function(u,m){a.setCacheLimits(u,m)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}(el);function Hn(n){n.parentNode&&n.parentNode.removeChild(n)}var bo={showCompass:!0,showZoom:!0,visualizePitch:!1},Mn=function(n){var s=this;this.options=a.extend({},bo,n),this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),I.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),I.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=I.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Mn.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Mn.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Mn.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wn(this._map,this._compass,this.options.visualizePitch)),this._container},Mn.prototype.onRemove=function(){I.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Mn.prototype._createButton=function(n,s){var o=I.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},Mn.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var Wn=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Ma({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new us({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),I.addEventListener(s,"mousedown",this.mousedown),I.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),I.addEventListener(s,"touchmove",this.touchmove),I.addEventListener(s,"touchend",this.touchend),I.addEventListener(s,"touchcancel",this.reset)};function $o(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var u=new a.LngLat(n.lng-360,n.lat),m=new a.LngLat(n.lng+360,n.lat),w=o.locationPoint(n).distSqr(s);o.locationPoint(u).distSqr(s)<w?n=u:o.locationPoint(m).distSqr(s)<w&&(n=m)}for(;Math.abs(n.lng-o.center.lng)>180;){var S=o.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}Wn.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),I.disableDrag()},Wn.prototype.move=function(n,s){var o=this.map,u=this.mouseRotate.mousemoveWindow(n,s);if(u&&u.bearingDelta&&o.setBearing(o.getBearing()+u.bearingDelta),this.mousePitch){var m=this.mousePitch.mousemoveWindow(n,s);m&&m.pitchDelta&&o.setPitch(o.getPitch()+m.pitchDelta)}},Wn.prototype.off=function(){var n=this.element;I.removeEventListener(n,"mousedown",this.mousedown),I.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),I.removeEventListener(n,"touchmove",this.touchmove),I.removeEventListener(n,"touchend",this.touchend),I.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Wn.prototype.offTemp=function(){I.enableDrag(),I.removeEventListener(a.window,"mousemove",this.mousemove),I.removeEventListener(a.window,"mouseup",this.mouseup)},Wn.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),I.mousePos(this.element,n)),I.addEventListener(a.window,"mousemove",this.mousemove),I.addEventListener(a.window,"mouseup",this.mouseup)},Wn.prototype.mousemove=function(n){this.move(n,I.mousePos(this.element,n))},Wn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Wn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=I.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Wn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=I.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Wn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Wn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var La={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function rl(n,s,o){var u=n.classList;for(var m in La)u.remove("mapboxgl-"+o+"-anchor-"+m);u.add("mapboxgl-"+o+"-anchor-"+s)}var ea,fa=function(n){function s(o,u){if(n.call(this),(o instanceof a.window.HTMLElement||u)&&(o=a.extend({element:o},u)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=I.create("div"),this._element.setAttribute("aria-label","Map marker");var m=I.createNS("http://www.w3.org/2000/svg","svg");m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height","41px"),m.setAttributeNS(null,"width","27px"),m.setAttributeNS(null,"viewBox","0 0 27 41");var w=I.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var S=I.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");var k=I.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");for(var P=0,L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];P<L.length;P+=1){var G=L[P],W=I.createNS("http://www.w3.org/2000/svg","ellipse");W.setAttributeNS(null,"opacity","0.04"),W.setAttributeNS(null,"cx","10.5"),W.setAttributeNS(null,"cy","5.80029008"),W.setAttributeNS(null,"rx",G.rx),W.setAttributeNS(null,"ry",G.ry),k.appendChild(W)}var J=I.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"fill",this._color);var oe=I.createNS("http://www.w3.org/2000/svg","path");oe.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),J.appendChild(oe);var te=I.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"fill","#000000");var se=I.createNS("http://www.w3.org/2000/svg","path");se.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),te.appendChild(se);var $=I.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");var le=I.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ye=I.createNS("http://www.w3.org/2000/svg","circle");ye.setAttributeNS(null,"fill","#000000"),ye.setAttributeNS(null,"opacity","0.25"),ye.setAttributeNS(null,"cx","5.5"),ye.setAttributeNS(null,"cy","5.5"),ye.setAttributeNS(null,"r","5.4999962");var ve=I.createNS("http://www.w3.org/2000/svg","circle");ve.setAttributeNS(null,"fill","#FFFFFF"),ve.setAttributeNS(null,"cx","5.5"),ve.setAttributeNS(null,"cy","5.5"),ve.setAttributeNS(null,"r","5.4999962"),le.appendChild(ye),le.appendChild(ve),S.appendChild(k),S.appendChild(J),S.appendChild(te),S.appendChild($),S.appendChild(le),m.appendChild(S),m.setAttributeNS(null,"height",41*this._scale+"px"),m.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(m),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Be){Be.preventDefault()}),this._element.addEventListener("mousedown",function(Be){Be.preventDefault()}),rl(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),I.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var u=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(24.6+u)],"bottom-right":[-u,-1*(24.6+u)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var u=o.code,m=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&m!==32&&m!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var u=o.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=$o(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(u="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),I.setTransform(this._element,La[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+m+" "+u)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var u=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),zl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ta=0,da=!1,Pl=function(n){function s(o){n.call(this),this.options=a.extend({},zl,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var u;return this._map=o,this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),u=this._setupUI,ea!==void 0?u(ea):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(m){u(ea=m.state!=="denied")}):u(ea=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),I.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ta=0,da=!1},s.prototype._isOutOfMapMaxBounds=function(o){var u=this._map.getMaxBounds(),m=o.coords;return u&&(m.longitude<u.getWest()||m.longitude>u.getEast()||m.latitude<u.getSouth()||m.latitude>u.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var u=new a.LngLat(o.coords.longitude,o.coords.latitude),m=o.coords.accuracy,w=this._map.getBearing(),S=a.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(m),S,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var u=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,u=this._map.unproject([0,o]),m=this._map.unproject([1,o]),w=u.distanceTo(m),S=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&da)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var u=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=I.create("button","mapboxgl-ctrl-geolocate",this._container),I.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=I.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new fa(this._dotElement),this._circleElement=I.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new fa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||u._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(u._watchState="BACKGROUND",u._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),u._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),u.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ta--,da=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ta>1?(o={maximumAge:6e5,timeout:0},da=!0):(o=this.options.positionOptions,da=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),Ra={maxWidth:100,unit:"metric"},to=function(n){this.options=a.extend({},Ra,n),a.bindAll(["_onMove","setUnit"],this)};function il(n,s,o){var u=o&&o.maxWidth||100,m=n._container.clientHeight/2,w=n.unproject([0,m]),S=n.unproject([u,m]),k=w.distanceTo(S);if(o&&o.unit==="imperial"){var P=3.2808*k;P>5280?Dn(s,u,P/5280,n._getUIString("ScaleControl.Miles")):Dn(s,u,P,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Dn(s,u,k/1852,n._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Dn(s,u,k/1e3,n._getUIString("ScaleControl.Kilometers")):Dn(s,u,k,n._getUIString("ScaleControl.Meters"))}function Dn(n,s,o,u){var m,w,S,k=(m=o,(w=Math.pow(10,(""+Math.floor(m)).length-1))*(S=(S=m/w)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(P){var L=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*L)/L}(S)));n.style.width=s*(k/o)+"px",n.innerHTML=k+"&nbsp;"+u}to.prototype.getDefaultPosition=function(){return"bottom-left"},to.prototype._onMove=function(){il(this._map,this._container,this.options)},to.prototype.onAdd=function(n){return this._map=n,this._container=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},to.prototype.onRemove=function(){I.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},to.prototype.setUnit=function(n){this.options.unit=n,il(this._map,this._container,this.options)};var zi=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};zi.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=I.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},zi.prototype.onRemove=function(){I.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},zi.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},zi.prototype._setupUI=function(){var n=this._fullscreenButton=I.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);I.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},zi.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},zi.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},zi.prototype._isFullscreen=function(){return this._fullscreen},zi.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},zi.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var ma={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ks=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),hs=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(ma),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&I.remove(this._content),this._container&&(I.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var u,m=a.window.document.createDocumentFragment(),w=a.window.document.createElement("body");for(w.innerHTML=o;u=w.firstChild;)m.appendChild(u);return this.setDOMContent(m)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=I.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=I.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var u=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=I.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=I.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(W){return u._container.classList.add(W)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=$o(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var m=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),w=this.options.anchor,S=function W(J){if(J){if(typeof J=="number"){var oe=Math.round(Math.sqrt(.5*Math.pow(J,2)));return{center:new a.Point(0,0),top:new a.Point(0,J),"top-left":new a.Point(oe,oe),"top-right":new a.Point(-oe,oe),bottom:new a.Point(0,-J),"bottom-left":new a.Point(oe,-oe),"bottom-right":new a.Point(-oe,-oe),left:new a.Point(J,0),right:new a.Point(-J,0)}}if(J instanceof a.Point||Array.isArray(J)){var te=a.Point.convert(J);return{center:te,top:te,"top-left":te,"top-right":te,bottom:te,"bottom-left":te,"bottom-right":te,left:te,right:te}}return{center:a.Point.convert(J.center||[0,0]),top:a.Point.convert(J.top||[0,0]),"top-left":a.Point.convert(J["top-left"]||[0,0]),"top-right":a.Point.convert(J["top-right"]||[0,0]),bottom:a.Point.convert(J.bottom||[0,0]),"bottom-left":a.Point.convert(J["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(J["bottom-right"]||[0,0]),left:a.Point.convert(J.left||[0,0]),right:a.Point.convert(J.right||[0,0])}}return W(new a.Point(0,0))}(this.options.offset);if(!w){var k,P=this._container.offsetWidth,L=this._container.offsetHeight;k=m.y+S.bottom.y<L?["top"]:m.y>this._map.transform.height-L?["bottom"]:[],m.x<P/2?k.push("left"):m.x>this._map.transform.width-P/2&&k.push("right"),w=k.length===0?"bottom":k.join("-")}var G=m.add(S[w]).round();I.setTransform(this._container,La[w]+" translate("+G.x+"px,"+G.y+"px)"),rl(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(Ks);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),su={version:a.version,supported:A,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:au,NavigationControl:Mn,GeolocateControl:Pl,AttributionControl:Li,ScaleControl:to,FullscreenControl:zi,Popup:hs,Marker:fa,Style:_n,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){Re().acquire(ze)},clearPrewarmedResources:function(){var n=ht;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(ze),ht=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return je.workerCount},set workerCount(n){je.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return su}),v})})(Uh);const j0=Uh.exports;function dy(c){let h;const f=c[15].default,y=Fc(f,c,c[14],null);return{c(){y&&y.c()},l(v){y&&y.l(v)},m(v,x){y&&y.m(v,x),h=!0},p(v,x){y&&y.p&&(!h||x&16384)&&Nc(y,f,v,v[14],h?Uc(f,v[14],x,null):Vc(v[14]),null)},i(v){h||(bt(y,v),h=!0)},o(v){Ft(y,v),h=!1},d(v){y&&y.d(v)}}}function q0(c){let h,f,y,v=c[0]&&dy(c);return{c(){h=ce("div"),v&&v.c(),this.h()},l(x){h=he(x,"DIV",{class:!0,id:!0});var a=fe(h);v&&v.l(a),a.forEach(O),this.h()},h(){U(h,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),U(h,"id",c[1]),Lc(()=>c[16].call(h))},m(x,a){ke(x,h,a),v&&v.m(h,null),f=Rc(h,c[16].bind(h)),c[17](h),y=!0},p(x,[a]){x[0]?v?(v.p(x,a),a&1&&bt(v,1)):(v=dy(x),v.c(),bt(v,1),v.m(h,null)):v&&(Ls(),Ft(v,1,1,()=>{v=null}),Rs()),(!y||a&2)&&U(h,"id",x[1])},i(x){y||(bt(v),y=!0)},o(x){Ft(v),y=!1},d(x){x&&O(h),v&&v.d(),f(),c[17](null)}}}function Z0(c,h,f){let{$$slots:y={},$$scope:v}=h,{map:x}=h,{id:a="map"}=h,{location:A={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=h,{style:I="https://raw.githubusercontent.com/nisra-explore/map_tiles/main/basemap_styles/style-omt.json"}=h,{interactive:R=!0}=h,{minzoom:B=0}=h,{maxzoom:K=14}=h,{zoom:j=null}=h,{scrollzoom:H=!0}=h,{geolocate:de=!0}=h,{zoomcontrol:Me=!0}=h,{options:Se={}}=h,He,Ue;Uy("map",{getMap:()=>x}),A.bounds?Se={...Se,bounds:A.bounds}:A.lon&&A.lat&&(Se={...Se,center:[A.lon,A.lat]},A.zoom&&(Se.zoom=A.zoom)),Vy(()=>{const We=document.createElement("link");return We.rel="stylesheet",We.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",We.onload=()=>{f(0,x=new Uh.exports.Map({container:He,style:I,minZoom:B,maxZoom:K,interactive:R,...Se})),Me&&x.addControl(new Uh.exports.NavigationControl({showCompass:!1})),H||x.scrollZoom.disable(),de&&x.addControl(new Uh.exports.GeolocateControl),x.on("load",()=>{f(4,j=x.getZoom())}),x.on("zoom",()=>{f(4,j=x.getZoom())})},document.head.appendChild(We),()=>{x.remove(),We.parentNode.removeChild(We)}});function Rt(){let We=document.getElementsByClassName("mapboxgl-canvas");We[0]&&(We[0].style.width="100%",x.resize())}function kt(){Ue=this.clientWidth,f(2,Ue)}function ut(We){Kl[We?"unshift":"push"](()=>{He=We,f(3,He)})}return c.$$set=We=>{"map"in We&&f(0,x=We.map),"id"in We&&f(1,a=We.id),"location"in We&&f(6,A=We.location),"style"in We&&f(7,I=We.style),"interactive"in We&&f(8,R=We.interactive),"minzoom"in We&&f(9,B=We.minzoom),"maxzoom"in We&&f(10,K=We.maxzoom),"zoom"in We&&f(4,j=We.zoom),"scrollzoom"in We&&f(11,H=We.scrollzoom),"geolocate"in We&&f(12,de=We.geolocate),"zoomcontrol"in We&&f(13,Me=We.zoomcontrol),"options"in We&&f(5,Se=We.options),"$$scope"in We&&f(14,v=We.$$scope)},c.$$.update=()=>{c.$$.dirty&4&&Ue&&Rt()},[x,a,Ue,He,j,Se,A,I,R,B,K,H,de,Me,v,y,kt,ut]}class G0 extends qa{constructor(h){super(),Za(this,h,Z0,q0,Ga,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function my(c){let h;const f=c[11].default,y=Fc(f,c,c[10],null);return{c(){y&&y.c()},l(v){y&&y.l(v)},m(v,x){y&&y.m(v,x),h=!0},p(v,x){y&&y.p&&(!h||x&1024)&&Nc(y,f,v,v[10],h?Uc(f,v[10],x,null):Vc(v[10]),null)},i(v){h||(bt(y,v),h=!0)},o(v){Ft(y,v),h=!1},d(v){y&&y.d(v)}}}function K0(c){let h,f,y=c[0]&&my(c);return{c(){y&&y.c(),h=Ei()},l(v){y&&y.l(v),h=Ei()},m(v,x){y&&y.m(v,x),ke(v,h,x),f=!0},p(v,[x]){v[0]?y?(y.p(v,x),x&1&&bt(y,1)):(y=my(v),y.c(),bt(y,1),y.m(h.parentNode,h)):y&&(Ls(),Ft(y,1,1,()=>{y=null}),Rs())},i(v){f||(bt(y),f=!0)},o(v){Ft(y),f=!1},d(v){y&&y.d(v),v&&O(h)}}}function X0(c,h,f){let{$$slots:y={},$$scope:v}=h,{id:x}=h,{type:a}=h,{url:A=null}=h,{props:I={}}=h,{data:R=null}=h,{layer:B=null}=h,{promoteId:K=null}=h,{minzoom:j=null}=h,{maxzoom:H=null}=h,de=!1;const{getMap:Me}=Gh("map"),Se=Me();Se.getSource(x)&&Se.removeSource(x);function He(){Se.isSourceLoaded(x)?(f(0,de=!0),console.log(x+" loaded!")):setTimeout(()=>{console.log("..."),He()},500)}function Ue(){Se.isStyleLoaded(x)?(Rt(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),Ue()},500)}j&&(I.minzoom=j),H&&(I.maxzoom=H),B&&K?(I.promoteId={},I.promoteId[B]=K):K&&(I.promoteId=K);function Rt(){console.log(x+" map source loading..."),a=="geojson"?R?(Se.addSource(x,{type:a,data:R,...I}),He()):A&&(Se.addSource(x,{type:a,data:A,...I}),He()):a=="vector"&&(Se.addSource(x,{type:a,tiles:[A],...I}),He())}Ue();function kt(){Se.getSource(x).setData(R)}return c.$$set=ut=>{"id"in ut&&f(2,x=ut.id),"type"in ut&&f(3,a=ut.type),"url"in ut&&f(4,A=ut.url),"props"in ut&&f(1,I=ut.props),"data"in ut&&f(5,R=ut.data),"layer"in ut&&f(6,B=ut.layer),"promoteId"in ut&&f(7,K=ut.promoteId),"minzoom"in ut&&f(8,j=ut.minzoom),"maxzoom"in ut&&f(9,H=ut.maxzoom),"$$scope"in ut&&f(10,v=ut.$$scope)},c.$$.update=()=>{c.$$.dirty&33&&de&&R&&kt()},[de,I,x,a,A,R,B,K,j,H,v,y]}class pg extends qa{constructor(h){super(),Za(this,h,X0,K0,Ga,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function H0(c,h,f){const{Popup:y}=j0,v=jy(),x=new y({closeButton:!1,closeOnClick:!1});let{id:a}=h,{source:A}=h,{sourceLayer:I=null}=h,{type:R}=h,{filter:B=null}=h,{layout:K={}}=h,{paint:j={}}=h,{data:H=null}=h,{code:de=null}=h,{name:Me="name"}=h,{colorCode:Se=null}=h,{click:He=!1}=h,{ignoreClick:Ue=!1}=h,{clickCenter:Rt=!1}=h,{selected:kt=null}=h,{hover:ut=!1}=h,{hovered:We=null}=h,{highlight:tr=!1}=h,{highlightKey:Gt="highlighted"}=h,{highlighted:St=[]}=h,{order:jt=null}=h,{maxzoom:Ke=null}=h,{minzoom:Lt=null}=h,{isChild:mt=!1}=h;const{getMap:yt}=Gh("map"),De=yt();let Ne=null,Tt=null,fr=[];De.getLayer(a)&&De.removeLayer(a);let Kt={id:a,type:R,source:A,paint:j,layout:K};B&&(Kt.filter=B),I&&(Kt["source-layer"]=I),Ke&&(Kt.maxzoom=Ke),Lt&&(Kt.minzoom=Lt),De.addLayer(Kt,jt);function Ge(){console.log("updating colors..."),H.forEach(et=>{De.setFeatureState({source:A,sourceLayer:I,id:et[de]},{color:et[Se]})})}return He&&De.on("click",a,et=>{if(et.features.length>0&&!Ue){let ar=et.features[0].id;if(mt&&St.includes(ar)||!mt&&kt!=ar){if(f(0,kt=ar),v("select",{code:kt}),Ne&&De.setFeatureState({source:A,sourceLayer:I,id:Ne},{selected:!1}),De.setFeatureState({source:A,sourceLayer:I,id:kt},{selected:!0}),Rt){let vr=centroid(et.features[0].toJSON().geometry);De.flyTo({center:vr.geometry.coordinates})}f(24,Ne=kt)}}}),ut&&(De.on("mousemove",a,et=>{if(et.features.length>0){let ar=et.features[0].id;We&&De.setFeatureState({source:A,sourceLayer:I,id:We},{hovered:!1}),mt&&St.includes(ar)||!mt&&kt!=ar?(f(1,We=f(25,Tt=ar)),De.setFeatureState({source:A,sourceLayer:I,id:We},{hovered:!0}),De.getCanvas().style.cursor="pointer",x.setLngLat(et.lngLat).setHTML(`<strong>${et.features[0].properties[Me]?et.features[0].properties[Me]:et.features[0].properties[de]}</strong>`).addTo(De)):x.remove()}}),De.on("mouseleave",a,et=>{We&&De.setFeatureState({source:A,sourceLayer:I,id:We},{hovered:!1}),f(1,We=f(25,Tt=null)),De.getCanvas().style.cursor="",x.remove()})),c.$$set=et=>{"id"in et&&f(2,a=et.id),"source"in et&&f(3,A=et.source),"sourceLayer"in et&&f(4,I=et.sourceLayer),"type"in et&&f(5,R=et.type),"filter"in et&&f(6,B=et.filter),"layout"in et&&f(7,K=et.layout),"paint"in et&&f(8,j=et.paint),"data"in et&&f(9,H=et.data),"code"in et&&f(10,de=et.code),"name"in et&&f(11,Me=et.name),"colorCode"in et&&f(12,Se=et.colorCode),"click"in et&&f(13,He=et.click),"ignoreClick"in et&&f(14,Ue=et.ignoreClick),"clickCenter"in et&&f(15,Rt=et.clickCenter),"selected"in et&&f(0,kt=et.selected),"hover"in et&&f(16,ut=et.hover),"hovered"in et&&f(1,We=et.hovered),"highlight"in et&&f(17,tr=et.highlight),"highlightKey"in et&&f(18,Gt=et.highlightKey),"highlighted"in et&&f(19,St=et.highlighted),"order"in et&&f(20,jt=et.order),"maxzoom"in et&&f(21,Ke=et.maxzoom),"minzoom"in et&&f(22,Lt=et.minzoom),"isChild"in et&&f(23,mt=et.isChild)},c.$$.update=()=>{c.$$.dirty[0]&4096&&Se&&Ge(),c.$$.dirty[0]&68026392&&tr&&St!=fr&&(fr[0]&&fr.forEach(et=>{let ar={};ar[Gt]=!1,De.setFeatureState({source:A,sourceLayer:I,id:et},ar)}),f(26,fr=St),St[0]&&St.forEach(et=>{let ar={};ar[Gt]=!0,De.setFeatureState({source:A,sourceLayer:I,id:et},ar)})),c.$$.dirty[0]&16777241&&kt!=Ne&&(Ne&&De.setFeatureState({source:A,sourceLayer:I,id:Ne},{selected:!1}),kt&&De.setFeatureState({source:A,sourceLayer:I,id:kt},{selected:!0}),f(24,Ne=kt)),c.$$.dirty[0]&33619994&&ut&&We!=Tt&&(Tt&&De.setFeatureState({source:A,sourceLayer:I,id:Tt},{hovered:!1}),We&&De.setFeatureState({source:A,sourceLayer:I,id:We},{hovered:!0}),f(25,Tt=We))},[kt,We,a,A,I,R,B,K,j,H,de,Me,Se,He,Ue,Rt,ut,tr,Gt,St,jt,Ke,Lt,mt,Ne,Tt,fr]}class Oc extends qa{constructor(h){super(),Za(this,h,H0,null,Ga,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function yy(c,h,f){const y=c.slice();return y[33]=h[f],y[35]=f,y}function gy(c,h,f){const y=c.slice();return y[36]=h[f],y[35]=f,y}function _y(c,h,f){const y=c.slice();return y[38]=h[f],y}function vy(c,h,f){const y=c.slice();return y[38]=h[f],y}function by(c,h,f){const y=c.slice();return y[36]=h[f],y[35]=f,y}function xy(c){let h,f,y,v,x,a,A=" &gt; ",I,R,B,K,j,H=c[1].name+"",de,Me,Se,He,Ue,Rt,kt,ut,We,tr,Gt,St,jt,Ke,Lt,mt,yt,De,Ne,Tt,fr,Kt,Ge,et,ar,vr,di,Qr,Vr,Ur,ui,xt,sr,Et,Ht,Nt,nn,ii,dr,ni,$r,on,Vi,Sn,$n,Ir,jr,Mi,Wi,En,Ka=" &#x24D8; ",qo,Nn,kn,na,Tn,ao,so,Zo,Vn,To=c[1].data.population.value[2021].all.toLocaleString()+"",Go,lo,Un,In,Io,ei,mr,M,F,q,Y=" &#x24D8; ",re,ue,me,Z,ie,be,Ve,Xe,ze,je=c[1].data.households.value[2021].all_households.toLocaleString()+"",ht,st,Re,ot,rt,Qe,Dt,it,$t,lr,Wt=" &#x24D8; ",ir,Xt,ti,hr,Ar,pr,Jt,nr,ri,mn,ci,ki,ba,An,zr,Ko,Ti,Or,an,yr,mi,bi,Bs,oi,xa=" &#x24D8; ",Ui,ai,sn,ji,jn,Xa,wl,Ha,wa,Wa,yn,Xo,Sa,Ea,ka,oa=c[1].name+"",Os,Ta,Ii,gn,_e,ln,Ai,Mr,Ho,_n,hi,Wo,zu,Xl,vs,Ja,Sl,Ya,Fs=c[1].name+"",El,Hl,Wl,vn,uo,Ao,si,kl,co,bs=" &#x24D8; ",Qa,zo,ho,$a,Po,Jo,Jl,Yl,br,Pu,Co,Mo,Ia,Ql,xs,Ns=" &#x24D8; ",Aa,Do,ws,$l,es,aa,eu,ts,po,tu,fo,_r,Yo,Cu,Qo,sc=" &#x24D8; ",Mu,Ss,za,Es,sa,ks,Vs,Ts,rs,Us,mo,is,Is,ru,Lo,ns=c[1].name+"",js,Tl,qs,yo,Ro,go,Pa,iu,Ca,Du=" &#x24D8; ",Il,os,la,nu,Bo,Fr,Qs,as,eo,ur,xr,xi,Oo,As,ua,qc=" &#x24D8; ",Lu,ca,ha,pa,li,ss,ou,wi,lt,qn,Fo,zn,un,Zn,ls,at=" &#x24D8; ",Al,Ma,us,_o,Ji,zs,$s,Gn,Kn,Ru,Ps,Da,cs,No,cn,er=c[1].name+"",Vo,vo,qi,Yi,Pn,Di,Si,Zs,vt,gt=" &#x24D8; ",el,Li,Cn,Qi,Xn,Gs,tl,Er,pi,au,Hn,bo,Mn,Wn,$o,La=" &#x24D8; ",rl,ea,fa,zl,ta,da,Pl,Ra,to,il,Dn,zi,ma,Ks,hs,su=" &#x24D8; ",n,s,o,u,m,w,S,k,P,L,G,W,J;function oe(Q,Ie){return Q[1].parents[0]?J0:W0}let te=oe(c),se=te(c),$=c[1].type!="ew"&&Sy(c);yt=new U0({props:{options:c[0],group:"typestr",search:!0}}),yt.$on("select",c[14]);function le(Q,Ie){return Q[1].type=="ew"||Q[1].type=="ctry"?Q0:Y0}let ye=le(c),ve=ye(c);function Be(Q,Ie){return Q[1].data.population.value.change.all==0?o1:Q[1].data.population.value.change.all>0?n1:i1}let Te=Be(c),Pe=Te(c),Oe=c[1].type!="ew"&&Ey(c),Ze=c[4]&&Ty(c),qe=c[1].type!="ew"&c[10]&&Iy(c),tt=c[4]&&Ay(c);mn=new qv({props:{data:c[1]&&c[12](["age","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null}});let ft=!c[9]&&c[11]&&zy(c);function zt(Q,Ie){if(Q[9])return y1;if(Q[4])return m1;if(Q[10])return d1}let wt=zt(c),Zt=wt&&wt(c);Or=new Ws({props:{data:c[1]&&c[12](["population","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),wa=new Ws({props:{data:c[1]&&c[12](["hh_size","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}});function dt(Q){c[24](Q)}let qt={location:{bounds:c[1].bounds},options:{fitBoundsOptions:{padding:20}},style:Jg,$$slots:{default:[v1]},$$scope:{ctx:c}};c[6]!==void 0&&(qt.map=c[6]),gn=new G0({props:qt}),Kl.push(()=>Xg(gn,"map",dt));let Mt=c[1].parents[0]&&By(c);function Vt(Q,Ie){return Q[2].children[0]?x1:b1}let Bt=Vt(c),Ot=Bt(c);return br=new Ws({props:{data:c[1]&&c[12](["natid","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),po=new Ws({props:{data:c[1]&&c[12](["cob","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),rs=new Ws({props:{data:c[1]&&c[12](["passport","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),eo=new Ws({props:{data:c[1]&&c[12](["mainlang","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),lt=new Ws({props:{data:c[1]&&c[12](["irish","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),Kn=new Ws({props:{data:c[1]&&c[12](["ulster","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),pi=new Ws({props:{data:c[1]&&c[12](["religion","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),to=new Ws({props:{data:c[1]&&c[12](["religion_or_religion_brought_up_in","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),P=new Ws({props:{data:c[1]&&c[12](["ethnic","perc","2021"]),zKey:c[9]?null:c[4]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[11]}}),{c(){h=ce("div"),f=ce("div"),y=ce("span"),v=ce("a"),x=xe("Home"),a=new qy(!1),I=Je(),se.c(),R=Je(),B=ce("br"),K=Je(),j=ce("span"),de=xe(H),Me=Je(),Se=ce("div"),He=xe(`Click for :\r
		\r
			`),Ue=ce("button"),Rt=xe("No comparison"),kt=Je(),$&&$.c(),ut=Je(),We=ce("button"),tr=xe("2011 Census comparison"),Gt=Je(),St=ce("div"),jt=ce("div"),Ke=ce("b"),Lt=xe("Search for your Local Government District:"),mt=Je(),Gr(yt.$$.fragment),De=Je(),Ne=ce("script"),Tt=xe(`// Share button\r
			// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
			\r
			\r
 				function copyToClipboard(text) {\r
					var inputc = document.body.appendChild(document.createElement("input"));\r
					inputc.value = window.location.href;\r
					inputc.select();\r
					document.execCommand('copy');\r
					inputc.parentNode.removeChild(inputc);\r
					alert("URL Copied.");\r
					\r
				}\r
\r
\r
\r
			\r
			\r
				(function (win, doc) {\r
					const testButton = doc.createElement('button');\r
					testButton.setAttribute('type','share');\r
					if (testButton.type != 'share') {\r
					win.addEventListener('click', function(ev) {\r
						ev = ev || win.event;\r
						let target = ev.target;\r
						let button = target.closest('button[type="share"]');\r
						if (button) {\r
						const title = "Share URL";\r
						const url = win.location.href;\r
						if (navigator.share) {\r
							navigator.share({ title: title, url: url });\r
						} else {\r
							copyToClipboard();\r
						}\r
						}\r
					});\r
				}\r
			}(this, this.document));`),fr=Je(),Kt=ce("div"),Ge=ce("button"),et=xe("Print / PDF"),ar=Je(),vr=ce("button"),di=xe("Menu"),Qr=Je(),Vr=ce("button"),Ur=xe("Share"),ui=Je(),xt=ce("div"),sr=ce("h2"),Et=xe("Census 2021"),Ht=Je(),Nt=ce("h2"),nn=xe("THIS APP USES SYNTHETIC DATA AND DOES NOT CONTAIN ANY CENSUS 2021 DATA"),ii=Je(),dr=ce("div"),ni=ce("div"),$r=ce("h3"),on=xe("Overview"),Vi=Je(),ve.c(),Sn=Je(),Pe.c(),$n=Je(),Ir=ce("div"),jr=ce("div"),Mi=ce("div"),Wi=xe("Population  "),En=ce("span"),qo=Je(),Nn=ce("div"),kn=ce("div"),na=xe("Population is based on the number of usual residents.  A usual resident is anyone who, on 21 March 2021 is in the UK, and staying in the UK for a period of 3 months or more; or has a permanent UK address and is outside the UK and is staying outside the UK for less than 12 months.      "),Tn=ce("a"),ao=ce("strong"),so=xe("Statistical bulletins"),Zo=Je(),Vn=ce("span"),Go=xe(To),lo=ce("br"),Un=Je(),Oe&&Oe.c(),In=Je(),Ze&&Ze.c(),Io=Je(),ei=ce("div"),mr=ce("div"),M=ce("div"),F=xe("Households"),q=ce("span"),re=Je(),ue=ce("div"),me=ce("div"),Z=xe("A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area.      "),ie=ce("a"),be=ce("strong"),Ve=xe("Statistical bulletins"),Xe=Je(),ze=ce("span"),ht=xe(je),st=ce("br"),Re=Je(),qe&&qe.c(),ot=Je(),tt&&tt.c(),rt=Je(),Qe=ce("div"),Dt=ce("div"),it=ce("div"),$t=xe("Broad age bands (years) "),lr=ce("span"),ir=Je(),Xt=ce("div"),ti=ce("div"),hr=xe("A grouping of ages where a person\u2019s age is their age at their last birthday on or prior to census day.      "),Ar=ce("a"),pr=ce("strong"),Jt=xe("Statistical bulletins"),nr=Je(),ri=ce("div"),Gr(mn.$$.fragment),ci=Je(),ft&&ft.c(),ki=Je(),Zt&&Zt.c(),ba=Je(),An=ce("div"),zr=ce("div"),Ko=xe("Sex"),Ti=Je(),Gr(Or.$$.fragment),an=Je(),yr=ce("div"),mi=ce("div"),bi=ce("div"),Bs=xe("Household size"),oi=ce("span"),Ui=Je(),ai=ce("div"),sn=ce("div"),ji=xe("The number of usual residents in the household.      "),jn=ce("a"),Xa=ce("strong"),wl=xe("Statistical bulletins"),Ha=Je(),Gr(wa.$$.fragment),Wa=Je(),yn=ce("div"),Xo=ce("div"),Sa=ce("h3"),Ea=xe("Explore "),ka=ce("span"),Os=xe(oa),Ta=Je(),Ii=ce("div"),Gr(gn.$$.fragment),ln=Je(),Ai=ce("div"),Mr=ce("span"),Mt&&Mt.c(),Ho=Je(),_n=ce("div"),hi=ce("span"),Wo=ce("ul"),Ot.c(),Xl=Je(),vs=ce("div"),Ja=ce("h2"),Sl=xe("Nationality Statistics "),Ya=ce("span"),El=xe(Fs),Hl=xe(" - Census 2021"),Wl=Je(),vn=ce("div"),uo=ce("div"),Ao=ce("div"),si=ce("div"),kl=xe("National identity (person based)"),co=ce("span"),Qa=Je(),zo=ce("div"),ho=ce("div"),$a=xe("The nationality or nationalities that the person identifies with.  "),Po=ce("a"),Jo=ce("strong"),Jl=xe("Statistical bulletins"),Yl=Je(),Gr(br.$$.fragment),Pu=Je(),Co=ce("div"),Mo=ce("div"),Ia=ce("div"),Ql=xe("Country of birth"),xs=ce("span"),Aa=Je(),Do=ce("div"),ws=ce("div"),$l=xe("The country in which a person was born.  "),es=ce("a"),aa=ce("strong"),eu=xe("Statistical bulletins"),ts=Je(),Gr(po.$$.fragment),tu=Je(),fo=ce("div"),_r=ce("div"),Yo=ce("div"),Cu=xe("Passport(s) held"),Qo=ce("span"),Mu=Je(),Ss=ce("div"),za=ce("div"),Es=xe("Passport or passports that an individual holds.   "),sa=ce("a"),ks=ce("strong"),Vs=xe("Statistical bulletins"),Ts=Je(),Gr(rs.$$.fragment),mo=Je(),is=ce("div"),Is=ce("h2"),ru=xe("Language Statistics "),Lo=ce("span"),js=xe(ns),Tl=xe(" - Census 2021"),qs=Je(),yo=ce("div"),Ro=ce("div"),go=ce("div"),Pa=ce("div"),iu=xe("Main language"),Ca=ce("span"),Il=Je(),os=ce("div"),la=ce("div"),nu=xe("Person's main language as declared in the Census. Statistics for all language questions are restricted to persons aged 3 and over.    "),Bo=ce("a"),Fr=ce("strong"),Qs=xe("Statistical bulletins"),as=Je(),Gr(eo.$$.fragment),ur=Je(),xr=ce("div"),xi=ce("div"),Oo=ce("div"),As=xe("Knowledge of Irish"),ua=ce("span"),Lu=Je(),ca=ce("div"),ha=ce("div"),pa=xe("A person has some ability in Irish if they can understand, speak, read or write Irish. Statistics for all language questions are restricted to persons aged 3 and over.  "),li=ce("a"),ss=ce("strong"),ou=xe("Statistical bulletins"),wi=Je(),Gr(lt.$$.fragment),qn=Je(),Fo=ce("div"),zn=ce("div"),un=ce("div"),Zn=xe("Knowledge of Ulster-Scots"),ls=ce("span"),Al=Je(),Ma=ce("div"),us=ce("div"),_o=xe("A person has some ability in Ulster-Scots if they can understand, speak, read or write Ulster-Scots. Statistics for all language questions are restricted to persons aged 3 and over.  "),Ji=ce("a"),zs=ce("strong"),$s=xe("Statistical bulletins"),Gn=Je(),Gr(Kn.$$.fragment),Ps=Je(),Da=ce("div"),cs=ce("h2"),No=xe("Religion and Ethnicity Statistics "),cn=ce("span"),Vo=xe(er),vo=xe(" - Census 2021"),qi=Je(),Yi=ce("div"),Pn=ce("div"),Di=ce("div"),Si=ce("div"),Zs=xe("Religion"),vt=ce("span"),el=Je(),Li=ce("div"),Cn=ce("div"),Qi=xe("Religion, religious denomination or body the person indicated they belong to.    "),Xn=ce("a"),Gs=ce("strong"),tl=xe("Statistical bulletins"),Er=Je(),Gr(pi.$$.fragment),au=Je(),Hn=ce("div"),bo=ce("div"),Mn=ce("div"),Wn=xe("Religion, Religion brought up"),$o=ce("span"),rl=Je(),ea=ce("div"),fa=ce("div"),zl=xe("The religious group the person belongs to or for people with no current religion their religious group of upbringing. People with no current religion and no religion of upbringing are labelled 'None'.    "),ta=ce("a"),da=ce("strong"),Pl=xe("Statistical bulletins"),Ra=Je(),Gr(to.$$.fragment),il=Je(),Dn=ce("div"),zi=ce("div"),ma=ce("div"),Ks=xe("Ethnic group"),hs=ce("span"),n=Je(),s=ce("div"),o=ce("div"),u=xe("Person\u2019s ethnic group as declared in the Census.  "),m=ce("a"),w=ce("strong"),S=xe("Statistical bulletins"),k=Je(),Gr(P.$$.fragment),this.h()},l(Q){h=he(Q,"DIV",{class:!0});var Ie=fe(h);f=he(Ie,"DIV",{});var Wr=fe(f);y=he(Wr,"SPAN",{class:!0});var Dr=fe(y);v=he(Dr,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var Pi=fe(v);x=we(Pi,"Home"),Pi.forEach(O),a=Zy(Dr,!1),I=Ye(Dr),se.l(Dr),R=Ye(Dr),Dr.forEach(O),B=he(Wr,"BR",{}),K=Ye(Wr),j=he(Wr,"SPAN",{class:!0});var yi=fe(j);de=we(yi,H),yi.forEach(O),Me=Ye(Wr),Se=he(Wr,"DIV",{class:!0,style:!0});var kr=fe(Se);He=we(kr,`Click for :\r
		\r
			`),Ue=he(kr,"BUTTON",{class:!0});var Jr=fe(Ue);Rt=we(Jr,"No comparison"),Jr.forEach(O),kt=Ye(kr),$&&$.l(kr),ut=Ye(kr),We=he(kr,"BUTTON",{class:!0});var $i=fe(We);tr=we($i,"2011 Census comparison"),$i.forEach(O),kr.forEach(O),Wr.forEach(O),Gt=Ye(Ie),St=he(Ie,"DIV",{});var Ri=fe(St);jt=he(Ri,"DIV",{style:!0,class:!0});var en=fe(jt);Ke=he(en,"B",{});var Zi=fe(Ke);Lt=we(Zi,"Search for your Local Government District:"),Zi.forEach(O),mt=Ye(en),Kr(yt.$$.fragment,en),De=Ye(en),Ne=he(en,"SCRIPT",{});var Ln=fe(Ne);Tt=we(Ln,`// Share button\r
			// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
			\r
			\r
 				function copyToClipboard(text) {\r
					var inputc = document.body.appendChild(document.createElement("input"));\r
					inputc.value = window.location.href;\r
					inputc.select();\r
					document.execCommand('copy');\r
					inputc.parentNode.removeChild(inputc);\r
					alert("URL Copied.");\r
					\r
				}\r
\r
\r
\r
			\r
			\r
				(function (win, doc) {\r
					const testButton = doc.createElement('button');\r
					testButton.setAttribute('type','share');\r
					if (testButton.type != 'share') {\r
					win.addEventListener('click', function(ev) {\r
						ev = ev || win.event;\r
						let target = ev.target;\r
						let button = target.closest('button[type="share"]');\r
						if (button) {\r
						const title = "Share URL";\r
						const url = win.location.href;\r
						if (navigator.share) {\r
							navigator.share({ title: title, url: url });\r
						} else {\r
							copyToClipboard();\r
						}\r
						}\r
					});\r
				}\r
			}(this, this.document));`),Ln.forEach(O),fr=Ye(en),Kt=he(en,"DIV",{width:!0});var Bi=fe(Kt);Ge=he(Bi,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var ya=fe(Ge);et=we(ya,"Print / PDF"),ya.forEach(O),ar=Ye(Bi),vr=he(Bi,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var ra=fe(vr);di=we(ra,"Menu"),ra.forEach(O),Qr=Ye(Bi),Vr=he(Bi,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var ps=fe(Vr);Ur=we(ps,"Share"),ps.forEach(O),Bi.forEach(O),en.forEach(O),Ri.forEach(O),Ie.forEach(O),ui=Ye(Q),xt=he(Q,"DIV",{});var fs=fe(xt);sr=he(fs,"H2",{style:!0,class:!0});var nl=fe(sr);Et=we(nl,"Census 2021"),nl.forEach(O),Ht=Ye(fs),Nt=he(fs,"H2",{style:!0,class:!0});var ga=fe(Nt);nn=we(ga,"THIS APP USES SYNTHETIC DATA AND DOES NOT CONTAIN ANY CENSUS 2021 DATA"),ga.forEach(O),fs.forEach(O),ii=Ye(Q),dr=he(Q,"DIV",{id:!0,class:!0});var Jn=fe(dr);ni=he(Jn,"DIV",{class:!0,style:!0});var ro=fe(ni);$r=he(ro,"H3",{style:!0,class:!0});var Gi=fe($r);on=we(Gi,"Overview"),Gi.forEach(O),Vi=Ye(ro),ve.l(ro),Sn=Ye(ro),Pe.l(ro),ro.forEach(O),$n=Ye(Jn),Ir=he(Jn,"DIV",{class:!0});var hn=fe(Ir);jr=he(hn,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ds=fe(jr);Mi=he(ds,"DIV",{class:!0,style:!0});var ms=fe(Mi);Wi=we(ms,"Population  "),En=he(ms,"SPAN",{style:!0});var Tr=fe(En);Tr.forEach(O),ms.forEach(O),ds.forEach(O),qo=Ye(hn),Nn=he(hn,"DIV",{class:!0,id:!0});var xo=fe(Nn);kn=he(xo,"DIV",{class:!0});var Rn=fe(kn);na=we(Rn,"Population is based on the number of usual residents.  A usual resident is anyone who, on 21 March 2021 is in the UK, and staying in the UK for a period of 3 months or more; or has a permanent UK address and is outside the UK and is staying outside the UK for less than 12 months.      "),Tn=he(Rn,"A",{href:!0,class:!0});var Cs=fe(Tn);ao=he(Cs,"STRONG",{});var lc=fe(ao);so=we(lc,"Statistical bulletins"),lc.forEach(O),Cs.forEach(O),Rn.forEach(O),xo.forEach(O),Zo=Ye(hn),Vn=he(hn,"SPAN",{class:!0,style:!0});var Cl=fe(Vn);Go=we(Cl,To),Cl.forEach(O),lo=he(hn,"BR",{}),Un=Ye(hn),Oe&&Oe.l(hn),In=Ye(hn),Ze&&Ze.l(hn),hn.forEach(O),Io=Ye(Jn),ei=he(Jn,"DIV",{class:!0});var _a=fe(ei);mr=he(_a,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ol=fe(mr);M=he(ol,"DIV",{class:!0,style:!0});var lu=fe(M);F=we(lu,"Households"),q=he(lu,"SPAN",{style:!0});var al=fe(q);al.forEach(O),lu.forEach(O),ol.forEach(O),re=Ye(_a),ue=he(_a,"DIV",{class:!0,id:!0});var Ml=fe(ue);me=he(Ml,"DIV",{class:!0});var Bu=fe(me);Z=we(Bu,"A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area.      "),ie=he(Bu,"A",{href:!0,class:!0});var sl=fe(ie);be=he(sl,"STRONG",{});var io=fe(be);Ve=we(io,"Statistical bulletins"),io.forEach(O),sl.forEach(O),Bu.forEach(O),Ml.forEach(O),Xe=Ye(_a),ze=he(_a,"SPAN",{class:!0,style:!0});var ep=fe(ze);ht=we(ep,je),ep.forEach(O),st=he(_a,"BR",{}),Re=Ye(_a),qe&&qe.l(_a),ot=Ye(_a),tt&&tt.l(_a),_a.forEach(O),rt=Ye(Jn),Qe=he(Jn,"DIV",{class:!0});var ys=fe(Qe);Dt=he(ys,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var tp=fe(Dt);it=he(tp,"DIV",{class:!0,style:!0});var Zc=fe(it);$t=we(Zc,"Broad age bands (years) "),lr=he(Zc,"SPAN",{style:!0});var gf=fe(lr);gf.forEach(O),Zc.forEach(O),tp.forEach(O),ir=Ye(ys),Xt=he(ys,"DIV",{class:!0,id:!0});var rp=fe(Xt);ti=he(rp,"DIV",{class:!0});var Ou=fe(ti);hr=we(Ou,"A grouping of ages where a person\u2019s age is their age at their last birthday on or prior to census day.      "),Ar=he(Ou,"A",{href:!0,class:!0});var ip=fe(Ar);pr=he(ip,"STRONG",{});var Fu=fe(pr);Jt=we(Fu,"Statistical bulletins"),Fu.forEach(O),ip.forEach(O),Ou.forEach(O),rp.forEach(O),nr=Ye(ys),ri=he(ys,"DIV",{class:!0,style:!0});var Gc=fe(ri);Kr(mn.$$.fragment,Gc),Gc.forEach(O),ci=Ye(ys),ft&&ft.l(ys),ki=Ye(ys),Zt&&Zt.l(ys),ys.forEach(O),ba=Ye(Jn),An=he(Jn,"DIV",{class:!0});var gs=fe(An);zr=he(gs,"DIV",{class:!0,style:!0});var uu=fe(zr);Ko=we(uu,"Sex"),uu.forEach(O),Ti=Ye(gs),Kr(Or.$$.fragment,gs),gs.forEach(O),an=Ye(Jn),yr=he(Jn,"DIV",{class:!0});var cu=fe(yr);mi=he(cu,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var np=fe(mi);bi=he(np,"DIV",{class:!0,style:!0});var Kc=fe(bi);Bs=we(Kc,"Household size"),oi=he(Kc,"SPAN",{style:!0});var _f=fe(oi);_f.forEach(O),Kc.forEach(O),np.forEach(O),Ui=Ye(cu),ai=he(cu,"DIV",{class:!0,id:!0});var op=fe(ai);sn=he(op,"DIV",{class:!0});var Xc=fe(sn);ji=we(Xc,"The number of usual residents in the household.      "),jn=he(Xc,"A",{href:!0,class:!0});var ap=fe(jn);Xa=he(ap,"STRONG",{});var uc=fe(Xa);wl=we(uc,"Statistical bulletins"),uc.forEach(O),ap.forEach(O),Xc.forEach(O),op.forEach(O),Ha=Ye(cu),Kr(wa.$$.fragment,cu),cu.forEach(O),Jn.forEach(O),Wa=Ye(Q),yn=he(Q,"DIV",{class:!0});var ll=fe(yn);Xo=he(ll,"DIV",{style:!0});var Dl=fe(Xo);Sa=he(Dl,"H3",{class:!0});var Hc=fe(Sa);Ea=we(Hc,"Explore "),ka=he(Hc,"SPAN",{style:!0});var Oi=fe(ka);Os=we(Oi,oa),Oi.forEach(O),Hc.forEach(O),Dl.forEach(O),Ta=Ye(ll),Ii=he(ll,"DIV",{id:!0,style:!0,class:!0});var Nu=fe(Ii);Kr(gn.$$.fragment,Nu),Nu.forEach(O),ln=Ye(ll),Ai=he(ll,"DIV",{});var Wc=fe(Ai);Mr=he(Wc,"SPAN",{});var Vu=fe(Mr);Mt&&Mt.l(Vu),Vu.forEach(O),Wc.forEach(O),Ho=Ye(ll),_n=he(ll,"DIV",{});var Uu=fe(_n);hi=he(Uu,"SPAN",{});var hu=fe(hi);Wo=he(hu,"UL",{style:!0});var Jc=fe(Wo);Ot.l(Jc),Jc.forEach(O),hu.forEach(O),Uu.forEach(O),ll.forEach(O),Xl=Ye(Q),vs=he(Q,"DIV",{style:!0});var Yc=fe(vs);Ja=he(Yc,"H2",{class:!0});var Ll=fe(Ja);Sl=we(Ll,"Nationality Statistics "),Ya=he(Ll,"SPAN",{class:!0});var ju=fe(Ya);El=we(ju,Fs),Hl=we(ju," - Census 2021"),ju.forEach(O),Ll.forEach(O),Yc.forEach(O),Wl=Ye(Q),vn=he(Q,"DIV",{class:!0});var ul=fe(vn);uo=he(ul,"DIV",{class:!0});var pu=fe(uo);Ao=he(pu,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var fu=fe(Ao);si=he(fu,"DIV",{class:!0,style:!0});var Qc=fe(si);kl=we(Qc,"National identity (person based)"),co=he(Qc,"SPAN",{style:!0});var $c=fe(co);$c.forEach(O),Qc.forEach(O),fu.forEach(O),Qa=Ye(pu),zo=he(pu,"DIV",{class:!0,id:!0});var sp=fe(zo);ho=he(sp,"DIV",{class:!0});var qu=fe(ho);$a=we(qu,"The nationality or nationalities that the person identifies with.  "),Po=he(qu,"A",{href:!0,class:!0});var cc=fe(Po);Jo=he(cc,"STRONG",{});var Ba=fe(Jo);Jl=we(Ba,"Statistical bulletins"),Ba.forEach(O),cc.forEach(O),qu.forEach(O),sp.forEach(O),Yl=Ye(pu),Kr(br.$$.fragment,pu),pu.forEach(O),Pu=Ye(ul),Co=he(ul,"DIV",{class:!0});var du=fe(Co);Mo=he(du,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var lp=fe(Mo);Ia=he(lp,"DIV",{class:!0,style:!0});var eh=fe(Ia);Ql=we(eh,"Country of birth"),xs=he(eh,"SPAN",{style:!0});var vf=fe(xs);vf.forEach(O),eh.forEach(O),lp.forEach(O),Aa=Ye(du),Do=he(du,"DIV",{class:!0,id:!0});var th=fe(Do);ws=he(th,"DIV",{class:!0});var cl=fe(ws);$l=we(cl,"The country in which a person was born.  "),es=he(cl,"A",{href:!0,class:!0});var up=fe(es);aa=he(up,"STRONG",{});var cp=fe(aa);eu=we(cp,"Statistical bulletins"),cp.forEach(O),up.forEach(O),cl.forEach(O),th.forEach(O),ts=Ye(du),Kr(po.$$.fragment,du),du.forEach(O),tu=Ye(ul),fo=he(ul,"DIV",{class:!0});var Rl=fe(fo);_r=he(Rl,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var rh=fe(_r);Yo=he(rh,"DIV",{class:!0,style:!0});var ih=fe(Yo);Cu=we(ih,"Passport(s) held"),Qo=he(ih,"SPAN",{style:!0});var bf=fe(Qo);bf.forEach(O),ih.forEach(O),rh.forEach(O),Mu=Ye(Rl),Ss=he(Rl,"DIV",{class:!0,id:!0});var Bl=fe(Ss);za=he(Bl,"DIV",{class:!0});var nh=fe(za);Es=we(nh,"Passport or passports that an individual holds.   "),sa=he(nh,"A",{href:!0,class:!0});var hc=fe(sa);ks=he(hc,"STRONG",{});var mu=fe(ks);Vs=we(mu,"Statistical bulletins"),mu.forEach(O),hc.forEach(O),nh.forEach(O),Bl.forEach(O),Ts=Ye(Rl),Kr(rs.$$.fragment,Rl),Rl.forEach(O),ul.forEach(O),mo=Ye(Q),is=he(Q,"DIV",{style:!0});var Oa=fe(is);Is=he(Oa,"H2",{class:!0});var oh=fe(Is);ru=we(oh,"Language Statistics "),Lo=he(oh,"SPAN",{class:!0});var ah=fe(Lo);js=we(ah,ns),Tl=we(ah," - Census 2021"),ah.forEach(O),oh.forEach(O),Oa.forEach(O),qs=Ye(Q),yo=he(Q,"DIV",{class:!0});var yu=fe(yo);Ro=he(yu,"DIV",{class:!0});var Ms=fe(Ro);go=he(Ms,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var sh=fe(go);Pa=he(sh,"DIV",{class:!0,style:!0});var lh=fe(Pa);iu=we(lh,"Main language"),Ca=he(lh,"SPAN",{style:!0});var xf=fe(Ca);xf.forEach(O),lh.forEach(O),sh.forEach(O),Il=Ye(Ms),os=he(Ms,"DIV",{class:!0,id:!0});var hp=fe(os);la=he(hp,"DIV",{class:!0});var uh=fe(la);nu=we(uh,"Person's main language as declared in the Census. Statistics for all language questions are restricted to persons aged 3 and over.    "),Bo=he(uh,"A",{href:!0,class:!0});var ch=fe(Bo);Fr=he(ch,"STRONG",{});var Yn=fe(Fr);Qs=we(Yn,"Statistical bulletins"),Yn.forEach(O),ch.forEach(O),uh.forEach(O),hp.forEach(O),as=Ye(Ms),Kr(eo.$$.fragment,Ms),Ms.forEach(O),ur=Ye(yu),xr=he(yu,"DIV",{class:!0});var gu=fe(xr);xi=he(gu,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var hh=fe(xi);Oo=he(hh,"DIV",{class:!0,style:!0});var pc=fe(Oo);As=we(pc,"Knowledge of Irish"),ua=he(pc,"SPAN",{style:!0});var wf=fe(ua);wf.forEach(O),pc.forEach(O),hh.forEach(O),Lu=Ye(gu),ca=he(gu,"DIV",{class:!0,id:!0});var ph=fe(ca);ha=he(ph,"DIV",{class:!0});var fh=fe(ha);pa=we(fh,"A person has some ability in Irish if they can understand, speak, read or write Irish. Statistics for all language questions are restricted to persons aged 3 and over.  "),li=he(fh,"A",{href:!0,class:!0});var pp=fe(li);ss=he(pp,"STRONG",{});var fp=fe(ss);ou=we(fp,"Statistical bulletins"),fp.forEach(O),pp.forEach(O),fh.forEach(O),ph.forEach(O),wi=Ye(gu),Kr(lt.$$.fragment,gu),gu.forEach(O),qn=Ye(yu),Fo=he(yu,"DIV",{class:!0});var Ol=fe(Fo);zn=he(Ol,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var dp=fe(zn);un=he(dp,"DIV",{class:!0,style:!0});var dh=fe(un);Zn=we(dh,"Knowledge of Ulster-Scots"),ls=he(dh,"SPAN",{style:!0});var Zu=fe(ls);Zu.forEach(O),dh.forEach(O),dp.forEach(O),Al=Ye(Ol),Ma=he(Ol,"DIV",{class:!0,id:!0});var mh=fe(Ma);us=he(mh,"DIV",{class:!0});var fc=fe(us);_o=we(fc,"A person has some ability in Ulster-Scots if they can understand, speak, read or write Ulster-Scots. Statistics for all language questions are restricted to persons aged 3 and over.  "),Ji=he(fc,"A",{href:!0,class:!0});var Gu=fe(Ji);zs=he(Gu,"STRONG",{});var qr=fe(zs);$s=we(qr,"Statistical bulletins"),qr.forEach(O),Gu.forEach(O),fc.forEach(O),mh.forEach(O),Gn=Ye(Ol),Kr(Kn.$$.fragment,Ol),Ol.forEach(O),yu.forEach(O),Ps=Ye(Q),Da=he(Q,"DIV",{style:!0});var yh=fe(Da);cs=he(yh,"H2",{class:!0});var _s=fe(cs);No=we(_s,"Religion and Ethnicity Statistics "),cn=he(_s,"SPAN",{class:!0});var hl=fe(cn);Vo=we(hl,er),vo=we(hl," - Census 2021"),hl.forEach(O),_s.forEach(O),yh.forEach(O),qi=Ye(Q),Yi=he(Q,"DIV",{class:!0});var Fl=fe(Yi);Pn=he(Fl,"DIV",{class:!0});var _u=fe(Pn);Di=he(_u,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var mp=fe(Di);Si=he(mp,"DIV",{class:!0,style:!0});var gh=fe(Si);Zs=we(gh,"Religion"),vt=he(gh,"SPAN",{style:!0});var Sf=fe(vt);Sf.forEach(O),gh.forEach(O),mp.forEach(O),el=Ye(_u),Li=he(_u,"DIV",{class:!0,id:!0});var yp=fe(Li);Cn=he(yp,"DIV",{class:!0});var _h=fe(Cn);Qi=we(_h,"Religion, religious denomination or body the person indicated they belong to.    "),Xn=he(_h,"A",{href:!0,class:!0});var gp=fe(Xn);Gs=he(gp,"STRONG",{});var _p=fe(Gs);tl=we(_p,"Statistical bulletins"),_p.forEach(O),gp.forEach(O),_h.forEach(O),yp.forEach(O),Er=Ye(_u),Kr(pi.$$.fragment,_u),_u.forEach(O),au=Ye(Fl),Hn=he(Fl,"DIV",{class:!0});var vu=fe(Hn);bo=he(vu,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Ku=fe(bo);Mn=he(Ku,"DIV",{class:!0,style:!0});var pl=fe(Mn);Wn=we(pl,"Religion, Religion brought up"),$o=he(pl,"SPAN",{style:!0});var vp=fe($o);vp.forEach(O),pl.forEach(O),Ku.forEach(O),rl=Ye(vu),ea=he(vu,"DIV",{class:!0,id:!0});var bp=fe(ea);fa=he(bp,"DIV",{class:!0});var vh=fe(fa);zl=we(vh,"The religious group the person belongs to or for people with no current religion their religious group of upbringing. People with no current religion and no religion of upbringing are labelled 'None'.    "),ta=he(vh,"A",{href:!0,class:!0});var xp=fe(ta);da=he(xp,"STRONG",{});var bh=fe(da);Pl=we(bh,"Statistical bulletins"),bh.forEach(O),xp.forEach(O),vh.forEach(O),bp.forEach(O),Ra=Ye(vu),Kr(to.$$.fragment,vu),vu.forEach(O),il=Ye(Fl),Dn=he(Fl,"DIV",{class:!0});var Xs=fe(Dn);zi=he(Xs,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var bu=fe(zi);ma=he(bu,"DIV",{class:!0,style:!0});var Nl=fe(ma);Ks=we(Nl,"Ethnic group"),hs=he(Nl,"SPAN",{style:!0});var ia=fe(hs);ia.forEach(O),Nl.forEach(O),bu.forEach(O),n=Ye(Xs),s=he(Xs,"DIV",{class:!0,id:!0});var Vl=fe(s);o=he(Vl,"DIV",{class:!0});var bn=fe(o);u=we(bn,"Person\u2019s ethnic group as declared in the Census.  "),m=he(bn,"A",{href:!0,class:!0});var Xu=fe(m);w=he(Xu,"STRONG",{});var Hu=fe(w);S=we(Hu,"Statistical bulletins"),Hu.forEach(O),Xu.forEach(O),bn.forEach(O),Vl.forEach(O),k=Ye(Xs),Kr(P.$$.fragment,Xs),Xs.forEach(O),Fl.forEach(O),this.h()},h(){U(v,"href",xl+"/"),U(v,"sveltekit:noscroll",""),U(v,"class","svelte-ls2yfr"),a.a=I,U(y,"class","text-small"),U(j,"class","text-big title svelte-ls2yfr"),U(Ue,"class","btn svelte-ls2yfr"),rn(Ue,"btn-active",c[9]),U(We,"class","btn svelte-ls2yfr"),rn(We,"btn-active",c[4]&!c[9]&!c[10]),U(Se,"class","text-bold"),Ce(Se,"font-size","0.85em"),U(Ge,"class","btn svelte-ls2yfr"),Ce(Ge,"width","33%"),U(Ge,"title","Click to print this page to pdf or printer"),U(Ge,"onclick","window.print();return false;"),U(vr,"class","btn svelte-ls2yfr"),Ce(vr,"width","33%"),U(vr,"alt","Return to the landing page"),U(vr,"onclick","window.location.href='"+xl+"';"),U(Vr,"class","btn svelte-ls2yfr"),Ce(Vr,"width","30%"),U(Vr,"type","share"),U(Vr,"alt","Share this page"),U(Kt,"width","100%"),Ce(jt,"width","350px"),Ce(jt,"padding-top","5px"),U(jt,"class","svelte-ls2yfr"),rn(jt,"float-right",c[5]>1),U(h,"class","grid mtl svelte-ls2yfr"),Ce(sr,"page-break-before","avoid"),U(sr,"class","svelte-ls2yfr"),Ce(Nt,"page-break-before","avoid"),Ce(Nt,"color","#ff0000"),U(Nt,"class","svelte-ls2yfr"),Ce($r,"margin","0 0 10px 0"),Ce($r,"line-height","1.78"),U($r,"class","svelte-ls2yfr"),U(ni,"class","div-grey-box svelte-ls2yfr"),Ce(ni,"line-height","1.3"),Ce(En,"color","gray"),Ce(En,"font-size","14pt"),U(Mi,"class","blocktitle svelte-ls2yfr"),Ce(Mi,"margin","0"),Ce(Mi,"width","100%"),U(jr,"class","row"),Ce(jr,"display","flex"),Ce(jr,"cursor","pointer"),U(jr,"data-bs-toggle","collapse"),U(jr,"data-bs-target","#pop-info"),U(jr,"aria-expanded","false"),U(jr,"aria-controls","pop-info"),U(Tn,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Tn,"class","svelte-ls2yfr"),U(kn,"class","card card-body svelte-ls2yfr"),U(Nn,"class","collapse svelte-ls2yfr"),U(Nn,"id","pop-info"),U(Vn,"class","text-big"),Ce(Vn,"font-size","2.8em"),U(Ir,"class","div-grey-box svelte-ls2yfr"),Ce(q,"color","gray"),Ce(q,"font-size","14pt"),U(M,"class","blocktitle svelte-ls2yfr"),Ce(M,"margin","0"),Ce(M,"width","100%"),U(mr,"class","row"),Ce(mr,"display","flex"),Ce(mr,"cursor","pointer"),U(mr,"data-bs-toggle","collapse"),U(mr,"data-bs-target","#households-info"),U(mr,"aria-expanded","false"),U(mr,"aria-controls","households-info"),U(ie,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(ie,"class","svelte-ls2yfr"),U(me,"class","card card-body svelte-ls2yfr"),U(ue,"class","collapse svelte-ls2yfr"),U(ue,"id","households-info"),U(ze,"class","text-big"),Ce(ze,"font-size","2.8em"),U(ei,"class","div-grey-box svelte-ls2yfr"),Ce(lr,"color","gray"),Ce(lr,"font-size","14pt"),U(it,"class","blocktitle svelte-ls2yfr"),Ce(it,"margin","0"),Ce(it,"width","100%"),U(Dt,"class","row"),Ce(Dt,"display","flex"),Ce(Dt,"cursor","pointer"),U(Dt,"data-bs-toggle","collapse"),U(Dt,"data-bs-target","#broadagebands-info"),U(Dt,"aria-expanded","false"),U(Dt,"aria-controls","broadagebands-info"),U(Ar,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Ar,"class","svelte-ls2yfr"),U(ti,"class","card card-body svelte-ls2yfr"),U(Xt,"class","collapse svelte-ls2yfr"),U(Xt,"id","broadagebands-info"),U(ri,"class","chart svelte-ls2yfr"),Ce(ri,"height","100px"),Ce(ri,"padding-bottom","5px"),U(Qe,"class","div-grey-box svelte-ls2yfr"),U(zr,"class","blocktitle svelte-ls2yfr"),Ce(zr,"margin","0"),Ce(zr,"width","100%"),U(An,"class","div-grey-box svelte-ls2yfr"),Ce(oi,"color","gray"),Ce(oi,"font-size","14pt"),U(bi,"class","blocktitle svelte-ls2yfr"),Ce(bi,"margin","0"),Ce(bi,"width","100%"),U(mi,"class","row"),Ce(mi,"display","flex"),Ce(mi,"cursor","pointer"),U(mi,"data-bs-toggle","collapse"),U(mi,"data-bs-target","#hhsize-info"),U(mi,"aria-expanded","false"),U(mi,"aria-controls","hhsize-info"),U(jn,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(jn,"class","svelte-ls2yfr"),U(sn,"class","card card-body svelte-ls2yfr"),U(ai,"class","collapse svelte-ls2yfr"),U(ai,"id","hhsize-info"),U(yr,"class","div-grey-box svelte-ls2yfr"),U(dr,"id","grid"),U(dr,"class","grid mt svelte-ls2yfr"),Ce(ka,"color","#93328E"),U(Sa,"class","svelte-ls2yfr"),Ce(Xo,"grid-column","span "+c[5]),U(Ii,"id","map"),Ce(Ii,"padding-right","45px"),Ce(Ii,"grid-column","span "+(c[5]==2?2:c[5]&&c[5]>2?c[5]-1:1)),U(Ii,"class","svelte-ls2yfr"),Ce(Wo,"padding-left","0"),U(yn,"class","grid mt svelte-ls2yfr"),Lc(()=>c[25].call(yn)),U(Ya,"class","title-inset muted svelte-ls2yfr"),U(Ja,"class","svelte-ls2yfr"),Ce(vs,"grid-column","span "+c[5]),Ce(co,"color","gray"),Ce(co,"font-size","14pt"),U(si,"class","blocktitle svelte-ls2yfr"),Ce(si,"font-size","1.02em"),Ce(si,"margin","0"),Ce(si,"width","100%"),U(Ao,"class","row"),Ce(Ao,"display","flex"),Ce(Ao,"cursor","pointer"),U(Ao,"data-bs-toggle","collapse"),U(Ao,"data-bs-target","#natid-info"),U(Ao,"aria-expanded","false"),U(Ao,"aria-controls","natid-info"),U(Po,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Po,"class","svelte-ls2yfr"),U(ho,"class","card card-body svelte-ls2yfr"),U(zo,"class","collapse svelte-ls2yfr"),U(zo,"id","natid-info"),U(uo,"class","div-grey-box svelte-ls2yfr"),Ce(xs,"color","gray"),Ce(xs,"font-size","14pt"),U(Ia,"class","blocktitle svelte-ls2yfr"),Ce(Ia,"margin","0"),Ce(Ia,"width","100%"),U(Mo,"class","row"),Ce(Mo,"display","flex"),Ce(Mo,"cursor","pointer"),U(Mo,"data-bs-toggle","collapse"),U(Mo,"data-bs-target","#cob-info"),U(Mo,"aria-expanded","false"),U(Mo,"aria-controls","cob-info"),U(es,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(es,"class","svelte-ls2yfr"),U(ws,"class","card card-body svelte-ls2yfr"),U(Do,"class","collapse svelte-ls2yfr"),U(Do,"id","cob-info"),U(Co,"class","div-grey-box svelte-ls2yfr"),Ce(Qo,"color","gray"),Ce(Qo,"font-size","14pt"),U(Yo,"class","blocktitle svelte-ls2yfr"),Ce(Yo,"margin","0"),Ce(Yo,"width","100%"),U(_r,"class","row"),Ce(_r,"display","flex"),Ce(_r,"cursor","pointer"),U(_r,"data-bs-toggle","collapse"),U(_r,"data-bs-target","#passport-info"),U(_r,"aria-expanded","false"),U(_r,"aria-controls","passport-info"),U(sa,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(sa,"class","svelte-ls2yfr"),U(za,"class","card card-body svelte-ls2yfr"),U(Ss,"class","collapse svelte-ls2yfr"),U(Ss,"id","passport-info"),U(fo,"class","div-grey-box svelte-ls2yfr"),U(vn,"class","grid mt svelte-ls2yfr"),Lc(()=>c[26].call(vn)),U(Lo,"class","title-inset muted svelte-ls2yfr"),U(Is,"class","svelte-ls2yfr"),Ce(is,"grid-column","span "+c[5]),Ce(Ca,"color","gray"),Ce(Ca,"font-size","14pt"),U(Pa,"class","blocktitle svelte-ls2yfr"),Ce(Pa,"margin","0"),Ce(Pa,"width","100%"),U(go,"class","row"),Ce(go,"display","flex"),Ce(go,"cursor","pointer"),U(go,"data-bs-toggle","collapse"),U(go,"data-bs-target","#mainlang-info"),U(go,"aria-expanded","false"),U(go,"aria-controls","mainlang-info"),U(Bo,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Bo,"class","svelte-ls2yfr"),U(la,"class","card card-body svelte-ls2yfr"),U(os,"class","collapse svelte-ls2yfr"),U(os,"id","mainlang-info"),U(Ro,"class","div-grey-box svelte-ls2yfr"),Ce(ua,"color","gray"),Ce(ua,"font-size","14pt"),U(Oo,"class","blocktitle svelte-ls2yfr"),Ce(Oo,"margin","0"),Ce(Oo,"width","100%"),U(xi,"class","row"),Ce(xi,"display","flex"),Ce(xi,"cursor","pointer"),U(xi,"data-bs-toggle","collapse"),U(xi,"data-bs-target","#irish-info"),U(xi,"aria-expanded","false"),U(xi,"aria-controls","irish-info"),U(li,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(li,"class","svelte-ls2yfr"),U(ha,"class","card card-body svelte-ls2yfr"),U(ca,"class","collapse svelte-ls2yfr"),U(ca,"id","irish-info"),U(xr,"class","div-grey-box svelte-ls2yfr"),Ce(ls,"color","gray"),Ce(ls,"font-size","14pt"),U(un,"class","blocktitle svelte-ls2yfr"),Ce(un,"margin","0"),Ce(un,"width","100%"),U(zn,"class","row"),Ce(zn,"display","flex"),Ce(zn,"cursor","pointer"),U(zn,"data-bs-toggle","collapse"),U(zn,"data-bs-target","#ulster-info"),U(zn,"aria-expanded","false"),U(zn,"aria-controls","ulster-info"),U(Ji,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Ji,"class","svelte-ls2yfr"),U(us,"class","card card-body svelte-ls2yfr"),U(Ma,"class","collapse svelte-ls2yfr"),U(Ma,"id","ulster-info"),U(Fo,"class","div-grey-box svelte-ls2yfr"),U(yo,"class","grid mt svelte-ls2yfr"),Lc(()=>c[27].call(yo)),U(cn,"class","title-inset muted svelte-ls2yfr"),U(cs,"class","svelte-ls2yfr"),Ce(Da,"grid-column","span "+c[5]),Ce(vt,"color","gray"),Ce(vt,"font-size","14pt"),U(Si,"class","blocktitle svelte-ls2yfr"),Ce(Si,"margin","0"),Ce(Si,"width","100%"),U(Di,"class","row"),Ce(Di,"display","flex"),Ce(Di,"cursor","pointer"),U(Di,"data-bs-toggle","collapse"),U(Di,"data-bs-target","#rel-info"),U(Di,"aria-expanded","false"),U(Di,"aria-controls","rel-info"),U(Xn,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(Xn,"class","svelte-ls2yfr"),U(Cn,"class","card card-body svelte-ls2yfr"),U(Li,"class","collapse svelte-ls2yfr"),U(Li,"id","rel-info"),U(Pn,"class","div-grey-box svelte-ls2yfr"),Ce($o,"color","gray"),Ce($o,"font-size","14pt"),U(Mn,"class","blocktitle svelte-ls2yfr"),Ce(Mn,"margin","0"),Ce(Mn,"width","100%"),U(bo,"class","row"),Ce(bo,"display","flex"),Ce(bo,"cursor","pointer"),U(bo,"data-bs-toggle","collapse"),U(bo,"data-bs-target","#relbup-info"),U(bo,"aria-expanded","false"),U(bo,"aria-controls","relbup-info"),U(ta,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(ta,"class","svelte-ls2yfr"),U(fa,"class","card card-body svelte-ls2yfr"),U(ea,"class","collapse svelte-ls2yfr"),U(ea,"id","relbup-info"),U(Hn,"class","div-grey-box svelte-ls2yfr"),Ce(hs,"color","gray"),Ce(hs,"font-size","14pt"),U(ma,"class","blocktitle svelte-ls2yfr"),Ce(ma,"margin","0"),Ce(ma,"width","100%"),U(zi,"class","row"),Ce(zi,"display","flex"),Ce(zi,"cursor","pointer"),U(zi,"data-bs-toggle","collapse"),U(zi,"data-bs-target","#ethnic-info"),U(zi,"aria-expanded","false"),U(zi,"aria-controls","ethnic-info"),U(m,"href","https://www.nisra.gov.uk/publications/census-2021-main-statistics-for-northern-ireland-phase-1"),U(m,"class","svelte-ls2yfr"),U(o,"class","card card-body svelte-ls2yfr"),U(s,"class","collapse svelte-ls2yfr"),U(s,"id","ethnic-info"),U(Dn,"class","div-grey-box svelte-ls2yfr"),U(Yi,"class","grid mt svelte-ls2yfr"),Lc(()=>c[28].call(Yi))},m(Q,Ie){ke(Q,h,Ie),N(h,f),N(f,y),N(y,v),N(v,x),a.m(A,y),N(y,I),se.m(y,null),N(y,R),N(f,B),N(f,K),N(f,j),N(j,de),N(f,Me),N(f,Se),N(Se,He),N(Se,Ue),N(Ue,Rt),N(Se,kt),$&&$.m(Se,null),N(Se,ut),N(Se,We),N(We,tr),N(h,Gt),N(h,St),N(St,jt),N(jt,Ke),N(Ke,Lt),N(jt,mt),Xr(yt,jt,null),N(jt,De),N(jt,Ne),N(Ne,Tt),N(jt,fr),N(jt,Kt),N(Kt,Ge),N(Ge,et),N(Kt,ar),N(Kt,vr),N(vr,di),N(Kt,Qr),N(Kt,Vr),N(Vr,Ur),ke(Q,ui,Ie),ke(Q,xt,Ie),N(xt,sr),N(sr,Et),N(xt,Ht),N(xt,Nt),N(Nt,nn),ke(Q,ii,Ie),ke(Q,dr,Ie),N(dr,ni),N(ni,$r),N($r,on),N(ni,Vi),ve.m(ni,null),N(ni,Sn),Pe.m(ni,null),N(dr,$n),N(dr,Ir),N(Ir,jr),N(jr,Mi),N(Mi,Wi),N(Mi,En),En.innerHTML=Ka,N(Ir,qo),N(Ir,Nn),N(Nn,kn),N(kn,na),N(kn,Tn),N(Tn,ao),N(ao,so),N(Ir,Zo),N(Ir,Vn),N(Vn,Go),N(Ir,lo),N(Ir,Un),Oe&&Oe.m(Ir,null),N(Ir,In),Ze&&Ze.m(Ir,null),N(dr,Io),N(dr,ei),N(ei,mr),N(mr,M),N(M,F),N(M,q),q.innerHTML=Y,N(ei,re),N(ei,ue),N(ue,me),N(me,Z),N(me,ie),N(ie,be),N(be,Ve),N(ei,Xe),N(ei,ze),N(ze,ht),N(ei,st),N(ei,Re),qe&&qe.m(ei,null),N(ei,ot),tt&&tt.m(ei,null),N(dr,rt),N(dr,Qe),N(Qe,Dt),N(Dt,it),N(it,$t),N(it,lr),lr.innerHTML=Wt,N(Qe,ir),N(Qe,Xt),N(Xt,ti),N(ti,hr),N(ti,Ar),N(Ar,pr),N(pr,Jt),N(Qe,nr),N(Qe,ri),Xr(mn,ri,null),N(Qe,ci),ft&&ft.m(Qe,null),N(Qe,ki),Zt&&Zt.m(Qe,null),N(dr,ba),N(dr,An),N(An,zr),N(zr,Ko),N(An,Ti),Xr(Or,An,null),N(dr,an),N(dr,yr),N(yr,mi),N(mi,bi),N(bi,Bs),N(bi,oi),oi.innerHTML=xa,N(yr,Ui),N(yr,ai),N(ai,sn),N(sn,ji),N(sn,jn),N(jn,Xa),N(Xa,wl),N(yr,Ha),Xr(wa,yr,null),ke(Q,Wa,Ie),ke(Q,yn,Ie),N(yn,Xo),N(Xo,Sa),N(Sa,Ea),N(Sa,ka),N(ka,Os),N(yn,Ta),N(yn,Ii),Xr(gn,Ii,null),N(yn,ln),N(yn,Ai),N(Ai,Mr),Mt&&Mt.m(Mr,null),N(yn,Ho),N(yn,_n),N(_n,hi),N(hi,Wo),Ot.m(Wo,null),zu=Rc(yn,c[25].bind(yn)),ke(Q,Xl,Ie),ke(Q,vs,Ie),N(vs,Ja),N(Ja,Sl),N(Ja,Ya),N(Ya,El),N(Ya,Hl),ke(Q,Wl,Ie),ke(Q,vn,Ie),N(vn,uo),N(uo,Ao),N(Ao,si),N(si,kl),N(si,co),co.innerHTML=bs,N(uo,Qa),N(uo,zo),N(zo,ho),N(ho,$a),N(ho,Po),N(Po,Jo),N(Jo,Jl),N(uo,Yl),Xr(br,uo,null),N(vn,Pu),N(vn,Co),N(Co,Mo),N(Mo,Ia),N(Ia,Ql),N(Ia,xs),xs.innerHTML=Ns,N(Co,Aa),N(Co,Do),N(Do,ws),N(ws,$l),N(ws,es),N(es,aa),N(aa,eu),N(Co,ts),Xr(po,Co,null),N(vn,tu),N(vn,fo),N(fo,_r),N(_r,Yo),N(Yo,Cu),N(Yo,Qo),Qo.innerHTML=sc,N(fo,Mu),N(fo,Ss),N(Ss,za),N(za,Es),N(za,sa),N(sa,ks),N(ks,Vs),N(fo,Ts),Xr(rs,fo,null),Us=Rc(vn,c[26].bind(vn)),ke(Q,mo,Ie),ke(Q,is,Ie),N(is,Is),N(Is,ru),N(Is,Lo),N(Lo,js),N(Lo,Tl),ke(Q,qs,Ie),ke(Q,yo,Ie),N(yo,Ro),N(Ro,go),N(go,Pa),N(Pa,iu),N(Pa,Ca),Ca.innerHTML=Du,N(Ro,Il),N(Ro,os),N(os,la),N(la,nu),N(la,Bo),N(Bo,Fr),N(Fr,Qs),N(Ro,as),Xr(eo,Ro,null),N(yo,ur),N(yo,xr),N(xr,xi),N(xi,Oo),N(Oo,As),N(Oo,ua),ua.innerHTML=qc,N(xr,Lu),N(xr,ca),N(ca,ha),N(ha,pa),N(ha,li),N(li,ss),N(ss,ou),N(xr,wi),Xr(lt,xr,null),N(yo,qn),N(yo,Fo),N(Fo,zn),N(zn,un),N(un,Zn),N(un,ls),ls.innerHTML=at,N(Fo,Al),N(Fo,Ma),N(Ma,us),N(us,_o),N(us,Ji),N(Ji,zs),N(zs,$s),N(Fo,Gn),Xr(Kn,Fo,null),Ru=Rc(yo,c[27].bind(yo)),ke(Q,Ps,Ie),ke(Q,Da,Ie),N(Da,cs),N(cs,No),N(cs,cn),N(cn,Vo),N(cn,vo),ke(Q,qi,Ie),ke(Q,Yi,Ie),N(Yi,Pn),N(Pn,Di),N(Di,Si),N(Si,Zs),N(Si,vt),vt.innerHTML=gt,N(Pn,el),N(Pn,Li),N(Li,Cn),N(Cn,Qi),N(Cn,Xn),N(Xn,Gs),N(Gs,tl),N(Pn,Er),Xr(pi,Pn,null),N(Yi,au),N(Yi,Hn),N(Hn,bo),N(bo,Mn),N(Mn,Wn),N(Mn,$o),$o.innerHTML=La,N(Hn,rl),N(Hn,ea),N(ea,fa),N(fa,zl),N(fa,ta),N(ta,da),N(da,Pl),N(Hn,Ra),Xr(to,Hn,null),N(Yi,il),N(Yi,Dn),N(Dn,zi),N(zi,ma),N(ma,Ks),N(ma,hs),hs.innerHTML=su,N(Dn,n),N(Dn,s),N(s,o),N(o,u),N(o,m),N(m,w),N(w,S),N(Dn,k),Xr(P,Dn,null),L=Rc(Yi,c[28].bind(Yi)),G=!0,W||(J=[Qn(Ue,"click",c[15]),Qn(Ue,"click",c[16]),Qn(Ue,"click",c[17]),Qn(We,"click",c[21]),Qn(We,"click",c[22]),Qn(We,"click",c[23])],W=!0)},p(Q,Ie){te===(te=oe(Q))&&se?se.p(Q,Ie):(se.d(1),se=te(Q),se&&(se.c(),se.m(y,R))),(!G||Ie[0]&2)&&H!==(H=Q[1].name+"")&&At(de,H),Ie[0]&512&&rn(Ue,"btn-active",Q[9]),Q[1].type!="ew"?$?$.p(Q,Ie):($=Sy(Q),$.c(),$.m(Se,ut)):$&&($.d(1),$=null),Ie[0]&1552&&rn(We,"btn-active",Q[4]&!Q[9]&!Q[10]);const Wr={};Ie[0]&1&&(Wr.options=Q[0]),yt.$set(Wr),Ie[0]&32&&rn(jt,"float-right",Q[5]>1),ye===(ye=le(Q))&&ve?ve.p(Q,Ie):(ve.d(1),ve=ye(Q),ve&&(ve.c(),ve.m(ni,Sn))),Te===(Te=Be(Q))&&Pe?Pe.p(Q,Ie):(Pe.d(1),Pe=Te(Q),Pe&&(Pe.c(),Pe.m(ni,null))),(!G||Ie[0]&2)&&To!==(To=Q[1].data.population.value[2021].all.toLocaleString()+"")&&At(Go,To),Q[1].type!="ew"?Oe?(Oe.p(Q,Ie),Ie[0]&2&&bt(Oe,1)):(Oe=Ey(Q),Oe.c(),bt(Oe,1),Oe.m(Ir,In)):Oe&&(Ls(),Ft(Oe,1,1,()=>{Oe=null}),Rs()),Q[4]?Ze?(Ze.p(Q,Ie),Ie[0]&16&&bt(Ze,1)):(Ze=Ty(Q),Ze.c(),bt(Ze,1),Ze.m(Ir,null)):Ze&&(Ls(),Ft(Ze,1,1,()=>{Ze=null}),Rs()),(!G||Ie[0]&2)&&je!==(je=Q[1].data.households.value[2021].all_households.toLocaleString()+"")&&At(ht,je),Q[1].type!="ew"&Q[10]?qe?(qe.p(Q,Ie),Ie[0]&1026&&bt(qe,1)):(qe=Iy(Q),qe.c(),bt(qe,1),qe.m(ei,ot)):qe&&(Ls(),Ft(qe,1,1,()=>{qe=null}),Rs()),Q[4]?tt?(tt.p(Q,Ie),Ie[0]&16&&bt(tt,1)):(tt=Ay(Q),tt.c(),bt(tt,1),tt.m(ei,null)):tt&&(Ls(),Ft(tt,1,1,()=>{tt=null}),Rs());const Dr={};Ie[0]&2&&(Dr.data=Q[1]&&Q[12](["age","perc","2021"])),Ie[0]&530&&(Dr.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),mn.$set(Dr),!Q[9]&&Q[11]?ft?ft.p(Q,Ie):(ft=zy(Q),ft.c(),ft.m(Qe,ki)):ft&&(ft.d(1),ft=null),wt===(wt=zt(Q))&&Zt?Zt.p(Q,Ie):(Zt&&Zt.d(1),Zt=wt&&wt(Q),Zt&&(Zt.c(),Zt.m(Qe,null)));const Pi={};Ie[0]&2&&(Pi.data=Q[1]&&Q[12](["population","perc","2021"])),Ie[0]&530&&(Pi.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&(Pi.label=Q[11]),Or.$set(Pi);const yi={};Ie[0]&2&&(yi.data=Q[1]&&Q[12](["hh_size","perc","2021"])),Ie[0]&530&&(yi.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&(yi.label=Q[11]),wa.$set(yi),(!G||Ie[0]&2)&&oa!==(oa=Q[1].name+"")&&At(Os,oa),(!G||Ie[0]&32)&&Ce(Xo,"grid-column","span "+Q[5]);const kr={};Ie[0]&2&&(kr.location={bounds:Q[1].bounds}),Ie[0]&384|Ie[1]&8192&&(kr.$$scope={dirty:Ie,ctx:Q}),!_e&&Ie[0]&64&&(_e=!0,kr.map=Q[6],Hg(()=>_e=!1)),gn.$set(kr),(!G||Ie[0]&32)&&Ce(Ii,"grid-column","span "+(Q[5]==2?2:Q[5]&&Q[5]>2?Q[5]-1:1)),Q[1].parents[0]?Mt?Mt.p(Q,Ie):(Mt=By(Q),Mt.c(),Mt.m(Mr,null)):Mt&&(Mt.d(1),Mt=null),Bt===(Bt=Vt(Q))&&Ot?Ot.p(Q,Ie):(Ot.d(1),Ot=Bt(Q),Ot&&(Ot.c(),Ot.m(Wo,null))),(!G||Ie[0]&2)&&Fs!==(Fs=Q[1].name+"")&&At(El,Fs),(!G||Ie[0]&32)&&Ce(vs,"grid-column","span "+Q[5]);const Jr={};Ie[0]&2&&(Jr.data=Q[1]&&Q[12](["natid","perc","2021"])),Ie[0]&530&&(Jr.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&(Jr.label=Q[11]),br.$set(Jr);const $i={};Ie[0]&2&&($i.data=Q[1]&&Q[12](["cob","perc","2021"])),Ie[0]&530&&($i.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&($i.label=Q[11]),po.$set($i);const Ri={};Ie[0]&2&&(Ri.data=Q[1]&&Q[12](["passport","perc","2021"])),Ie[0]&530&&(Ri.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&(Ri.label=Q[11]),rs.$set(Ri),(!G||Ie[0]&2)&&ns!==(ns=Q[1].name+"")&&At(js,ns),(!G||Ie[0]&32)&&Ce(is,"grid-column","span "+Q[5]);const en={};Ie[0]&2&&(en.data=Q[1]&&Q[12](["mainlang","perc","2021"])),Ie[0]&530&&(en.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&(en.label=Q[11]),eo.$set(en);const Zi={};Ie[0]&2&&(Zi.data=Q[1]&&Q[12](["irish","perc","2021"])),Ie[0]&530&&(Zi.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&(Zi.label=Q[11]),lt.$set(Zi);const Ln={};Ie[0]&2&&(Ln.data=Q[1]&&Q[12](["ulster","perc","2021"])),Ie[0]&530&&(Ln.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&(Ln.label=Q[11]),Kn.$set(Ln),(!G||Ie[0]&2)&&er!==(er=Q[1].name+"")&&At(Vo,er),(!G||Ie[0]&32)&&Ce(Da,"grid-column","span "+Q[5]);const Bi={};Ie[0]&2&&(Bi.data=Q[1]&&Q[12](["religion","perc","2021"])),Ie[0]&530&&(Bi.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&(Bi.label=Q[11]),pi.$set(Bi);const ya={};Ie[0]&2&&(ya.data=Q[1]&&Q[12](["religion_or_religion_brought_up_in","perc","2021"])),Ie[0]&530&&(ya.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&(ya.label=Q[11]),to.$set(ya);const ra={};Ie[0]&2&&(ra.data=Q[1]&&Q[12](["ethnic","perc","2021"])),Ie[0]&530&&(ra.zKey=Q[9]?null:Q[4]?"prev":!Q[4]&&Q[1].type!="ew"?"ew":null),Ie[0]&2048&&(ra.label=Q[11]),P.$set(ra)},i(Q){G||(bt(yt.$$.fragment,Q),bt(Oe),bt(Ze),bt(qe),bt(tt),bt(mn.$$.fragment,Q),bt(Or.$$.fragment,Q),bt(wa.$$.fragment,Q),bt(gn.$$.fragment,Q),bt(br.$$.fragment,Q),bt(po.$$.fragment,Q),bt(rs.$$.fragment,Q),bt(eo.$$.fragment,Q),bt(lt.$$.fragment,Q),bt(Kn.$$.fragment,Q),bt(pi.$$.fragment,Q),bt(to.$$.fragment,Q),bt(P.$$.fragment,Q),G=!0)},o(Q){Ft(yt.$$.fragment,Q),Ft(Oe),Ft(Ze),Ft(qe),Ft(tt),Ft(mn.$$.fragment,Q),Ft(Or.$$.fragment,Q),Ft(wa.$$.fragment,Q),Ft(gn.$$.fragment,Q),Ft(br.$$.fragment,Q),Ft(po.$$.fragment,Q),Ft(rs.$$.fragment,Q),Ft(eo.$$.fragment,Q),Ft(lt.$$.fragment,Q),Ft(Kn.$$.fragment,Q),Ft(pi.$$.fragment,Q),Ft(to.$$.fragment,Q),Ft(P.$$.fragment,Q),G=!1},d(Q){Q&&O(h),se.d(),$&&$.d(),Hr(yt),Q&&O(ui),Q&&O(xt),Q&&O(ii),Q&&O(dr),ve.d(),Pe.d(),Oe&&Oe.d(),Ze&&Ze.d(),qe&&qe.d(),tt&&tt.d(),Hr(mn),ft&&ft.d(),Zt&&Zt.d(),Hr(Or),Hr(wa),Q&&O(Wa),Q&&O(yn),Hr(gn),Mt&&Mt.d(),Ot.d(),zu(),Q&&O(Xl),Q&&O(vs),Q&&O(Wl),Q&&O(vn),Hr(br),Hr(po),Hr(rs),Us(),Q&&O(mo),Q&&O(is),Q&&O(qs),Q&&O(yo),Hr(eo),Hr(lt),Hr(Kn),Ru(),Q&&O(Ps),Q&&O(Da),Q&&O(qi),Q&&O(Yi),Hr(pi),Hr(to),Hr(P),L(),W=!1,nc(J)}}}function W0(c){let h=c[1].name+"",f;return{c(){f=xe(h)},l(y){f=we(y,h)},m(y,v){ke(y,f,v)},p(y,v){v[0]&2&&h!==(h=y[1].name+"")&&At(f,h)},d(y){y&&O(f)}}}function J0(c){let h,f=c[1].name+"",y,v=[...c[1].parents].reverse(),x=[];for(let a=0;a<v.length;a+=1)x[a]=wy(by(c,v,a));return{c(){for(let a=0;a<x.length;a+=1)x[a].c();h=Je(),y=xe(f)},l(a){for(let A=0;A<x.length;A+=1)x[A].l(a);h=Ye(a),y=we(a,f)},m(a,A){for(let I=0;I<x.length;I+=1)x[I].m(a,A);ke(a,h,A),ke(a,y,A)},p(a,A){if(A[0]&2){v=[...a[1].parents].reverse();let I;for(I=0;I<v.length;I+=1){const R=by(a,v,I);x[I]?x[I].p(R,A):(x[I]=wy(R),x[I].c(),x[I].m(h.parentNode,h))}for(;I<x.length;I+=1)x[I].d(1);x.length=v.length}A[0]&2&&f!==(f=a[1].name+"")&&At(y,f)},d(a){Ys(x,a),a&&O(h),a&&O(y)}}}function wy(c){let h,f=c[36].name+"",y,v,x,a=" &gt; ",A;return{c(){h=ce("a"),y=xe(f),x=new qy(!1),A=Ei(),this.h()},l(I){h=he(I,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var R=fe(h);y=we(R,f),R.forEach(O),x=Zy(I,!1),A=Ei(),this.h()},h(){U(h,"href",v=xl+"/"+c[36].code+"/"),U(h,"sveltekit:noscroll",""),U(h,"class","svelte-ls2yfr"),x.a=A},m(I,R){ke(I,h,R),N(h,y),x.m(a,I,R),ke(I,A,R)},p(I,R){R[0]&2&&f!==(f=I[36].name+"")&&At(y,f),R[0]&2&&v!==(v=xl+"/"+I[36].code+"/")&&U(h,"href",v)},d(I){I&&O(h),I&&O(A),I&&x.d()}}}function Sy(c){let h,f,y,v;return{c(){h=ce("button"),f=xe("NI comparison"),this.h()},l(x){h=he(x,"BUTTON",{class:!0});var a=fe(h);f=we(a,"NI comparison"),a.forEach(O),this.h()},h(){U(h,"class","btn svelte-ls2yfr"),rn(h,"btn-active",c[10]&!c[9]&!c[4])},m(x,a){ke(x,h,a),N(h,f),y||(v=[Qn(h,"click",c[18]),Qn(h,"click",c[19]),Qn(h,"click",c[20])],y=!0)},p(x,a){a[0]&1552&&rn(h,"btn-active",x[10]&!x[9]&!x[4])},d(x){x&&O(h),y=!1,nc(v)}}}function Y0(c){let h,f=c[1].name+"",y,v,x=c[1].data.population.value[2021].all.toLocaleString()+"",a,A,I;function R(j,H){return j[1].data.population.value_rank[2021].all==1?r1:j[1].data.population.value_rank[2021].all==j[1].count?t1:j[1].data.population.value_rank[2021].all<=(j[1].count+1)/2&&j[1].data.population.value_rank[2021].all!=1?e1:$0}let B=R(c),K=B(c);return{c(){h=xe("The population of "),y=xe(f),v=xe(" was "),a=xe(x),A=xe(` at the time of the 2021 Census, which made it the \r
			`),K.c(),I=Ei()},l(j){h=we(j,"The population of "),y=we(j,f),v=we(j," was "),a=we(j,x),A=we(j,` at the time of the 2021 Census, which made it the \r
			`),K.l(j),I=Ei()},m(j,H){ke(j,h,H),ke(j,y,H),ke(j,v,H),ke(j,a,H),ke(j,A,H),K.m(j,H),ke(j,I,H)},p(j,H){H[0]&2&&f!==(f=j[1].name+"")&&At(y,f),H[0]&2&&x!==(x=j[1].data.population.value[2021].all.toLocaleString()+"")&&At(a,x),B===(B=R(j))&&K?K.p(j,H):(K.d(1),K=B(j),K&&(K.c(),K.m(I.parentNode,I)))},d(j){j&&O(h),j&&O(y),j&&O(v),j&&O(a),j&&O(A),K.d(j),j&&O(I)}}}function Q0(c){let h,f=c[1].name+"",y,v,x=c[1].data.population.value[2021].all.toLocaleString()+"",a,A;return{c(){h=xe("The population of "),y=xe(f),v=xe(" was "),a=xe(x),A=xe(" at the time of the 2021 Census.")},l(I){h=we(I,"The population of "),y=we(I,f),v=we(I," was "),a=we(I,x),A=we(I," at the time of the 2021 Census.")},m(I,R){ke(I,h,R),ke(I,y,R),ke(I,v,R),ke(I,a,R),ke(I,A,R)},p(I,R){R[0]&2&&f!==(f=I[1].name+"")&&At(y,f),R[0]&2&&x!==(x=I[1].data.population.value[2021].all.toLocaleString()+"")&&At(a,x)},d(I){I&&O(h),I&&O(y),I&&O(v),I&&O(a),I&&O(A)}}}function $0(c){let h=c[1].count+1-c[1].data.population.value_rank[2021].all.toLocaleString()+"",f,y=Au(c[1].count+1-c[1].data.population.value_rank[2021].all)+"",v,x;return{c(){f=xe(h),v=xe(y),x=xe(" smallest area.")},l(a){f=we(a,h),v=we(a,y),x=we(a," smallest area.")},m(a,A){ke(a,f,A),ke(a,v,A),ke(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].count+1-a[1].data.population.value_rank[2021].all.toLocaleString()+"")&&At(f,h),A[0]&2&&y!==(y=Au(a[1].count+1-a[1].data.population.value_rank[2021].all)+"")&&At(v,y)},d(a){a&&O(f),a&&O(v),a&&O(x)}}}function e1(c){let h=c[1].data.population.value_rank[2021].all.toLocaleString()+"",f,y=Au(c[1].data.population.value_rank[2021].all)+"",v,x;return{c(){f=xe(h),v=xe(y),x=xe(" largest area.")},l(a){f=we(a,h),v=we(a,y),x=we(a," largest area.")},m(a,A){ke(a,f,A),ke(a,v,A),ke(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].data.population.value_rank[2021].all.toLocaleString()+"")&&At(f,h),A[0]&2&&y!==(y=Au(a[1].data.population.value_rank[2021].all)+"")&&At(v,y)},d(a){a&&O(f),a&&O(v),a&&O(x)}}}function t1(c){let h;return{c(){h=xe("smallest area.")},l(f){h=we(f,"smallest area.")},m(f,y){ke(f,h,y)},p:jo,d(f){f&&O(h)}}}function r1(c){let h;return{c(){h=xe("largest area.")},l(f){h=we(f,"largest area.")},m(f,y){ke(f,h,y)},p:jo,d(f){f&&O(h)}}}function i1(c){let h,f=or(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=xe("A decrease of "),y=xe(f),v=xe(" since the 2011 Census.")},l(x){h=we(x,"A decrease of "),y=we(x,f),v=we(x," since the 2011 Census.")},m(x,a){ke(x,h,a),ke(x,y,a),ke(x,v,a)},p(x,a){a[0]&2&&f!==(f=or(x[1].data.population.value.change.all,"%",1)+"")&&At(y,f)},d(x){x&&O(h),x&&O(y),x&&O(v)}}}function n1(c){let h,f=or(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=xe("An increase of "),y=xe(f),v=xe(" since the 2011 Census.")},l(x){h=we(x,"An increase of "),y=we(x,f),v=we(x," since the 2011 Census.")},m(x,a){ke(x,h,a),ke(x,y,a),ke(x,v,a)},p(x,a){a[0]&2&&f!==(f=or(x[1].data.population.value.change.all,"%",1)+"")&&At(y,f)},d(x){x&&O(h),x&&O(y),x&&O(v)}}}function o1(c){let h;return{c(){h=xe("No change in population since the 2011 Census.")},l(f){h=we(f,"No change in population since the 2011 Census.")},m(f,y){ke(f,h,y)},p:jo,d(f){f&&O(h)}}}function Ey(c){let h,f,y=c[1].type!="ctry"&c[10]&!c[4]&&ky(c);return{c(){y&&y.c(),h=Ei()},l(v){y&&y.l(v),h=Ei()},m(v,x){y&&y.m(v,x),ke(v,h,x),f=!0},p(v,x){v[1].type!="ctry"&v[10]&!v[4]?y?(y.p(v,x),x[0]&1042&&bt(y,1)):(y=ky(v),y.c(),bt(y,1),y.m(h.parentNode,h)):y&&(Ls(),Ft(y,1,1,()=>{y=null}),Rs())},i(v){f||(bt(y),f=!0)},o(v){Ft(y),f=!1},d(v){y&&y.d(v),v&&O(h)}}}function ky(c){let h,f,y,v,x,a,A=c[1].count.toLocaleString()+"",I,R,B=Vh[c[1].type].pl.toLowerCase()+"",K,j;f=new yf({props:{$$slots:{default:[a1]},$$scope:{ctx:c}}});function H(Se,He){return Se[1].data.population.value_rank[2021].all==1?c1:Se[1].data.population.value_rank[2021].all==Se[1].count?u1:Se[1].data.population.value_rank[2021].all<=(Se[1].count+1)/2&&Se[1].data.population.value_rank[2021].all!=1?l1:s1}let de=H(c),Me=de(c);return{c(){h=ce("span"),Gr(f.$$.fragment),y=xe(" of Northern Ireland population"),v=Je(),x=ce("div"),Me.c(),a=xe(`\r
			 population of `),I=xe(A),R=Je(),K=xe(B),this.h()},l(Se){h=he(Se,"SPAN",{class:!0});var He=fe(h);Kr(f.$$.fragment,He),y=we(He," of Northern Ireland population"),He.forEach(O),v=Ye(Se),x=he(Se,"DIV",{class:!0});var Ue=fe(x);Me.l(Ue),a=we(Ue,`\r
			 population of `),I=we(Ue,A),R=Ye(Ue),K=we(Ue,B),Ue.forEach(O),this.h()},h(){U(h,"class","text-small "),U(x,"class","text-small ")},m(Se,He){ke(Se,h,He),Xr(f,h,null),N(h,y),ke(Se,v,He),ke(Se,x,He),Me.m(x,null),N(x,a),N(x,I),N(x,R),N(x,K),j=!0},p(Se,He){const Ue={};He[0]&6|He[1]&8192&&(Ue.$$scope={dirty:He,ctx:Se}),f.$set(Ue),de===(de=H(Se))&&Me?Me.p(Se,He):(Me.d(1),Me=de(Se),Me&&(Me.c(),Me.m(x,a))),(!j||He[0]&2)&&A!==(A=Se[1].count.toLocaleString()+"")&&At(I,A),(!j||He[0]&2)&&B!==(B=Vh[Se[1].type].pl.toLowerCase()+"")&&At(K,B)},i(Se){j||(bt(f.$$.fragment,Se),j=!0)},o(Se){Ft(f.$$.fragment,Se),j=!1},d(Se){Se&&O(h),Hr(f),Se&&O(v),Se&&O(x),Me.d()}}}function a1(c){let h=(c[1].data.population.value[2021].all/c[2].data.population.value[2021].all>=.001?(c[1].data.population.value[2021].all/c[2].data.population.value[2021].all*100).toFixed(1):"<0.1")+"",f,y;return{c(){f=xe(h),y=xe("%")},l(v){f=we(v,h),y=we(v,"%")},m(v,x){ke(v,f,x),ke(v,y,x)},p(v,x){x[0]&6&&h!==(h=(v[1].data.population.value[2021].all/v[2].data.population.value[2021].all>=.001?(v[1].data.population.value[2021].all/v[2].data.population.value[2021].all*100).toFixed(1):"<0.1")+"")&&At(f,h)},d(v){v&&O(f),v&&O(y)}}}function s1(c){let h=c[1].count+1-c[1].data.population.value_rank[2021].all.toLocaleString()+"",f,y=Au(c[1].count+1-c[1].data.population.value_rank[2021].all)+"",v,x;return{c(){f=xe(h),v=xe(y),x=xe(" smallest")},l(a){f=we(a,h),v=we(a,y),x=we(a," smallest")},m(a,A){ke(a,f,A),ke(a,v,A),ke(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].count+1-a[1].data.population.value_rank[2021].all.toLocaleString()+"")&&At(f,h),A[0]&2&&y!==(y=Au(a[1].count+1-a[1].data.population.value_rank[2021].all)+"")&&At(v,y)},d(a){a&&O(f),a&&O(v),a&&O(x)}}}function l1(c){let h=c[1].data.population.value_rank[2021].all.toLocaleString()+"",f,y=Au(c[1].data.population.value_rank[2021].all)+"",v,x;return{c(){f=xe(h),v=xe(y),x=xe(" largest")},l(a){f=we(a,h),v=we(a,y),x=we(a," largest")},m(a,A){ke(a,f,A),ke(a,v,A),ke(a,x,A)},p(a,A){A[0]&2&&h!==(h=a[1].data.population.value_rank[2021].all.toLocaleString()+"")&&At(f,h),A[0]&2&&y!==(y=Au(a[1].data.population.value_rank[2021].all)+"")&&At(v,y)},d(a){a&&O(f),a&&O(v),a&&O(x)}}}function u1(c){let h;return{c(){h=xe("The smallest")},l(f){h=we(f,"The smallest")},m(f,y){ke(f,h,y)},p:jo,d(f){f&&O(h)}}}function c1(c){let h;return{c(){h=xe("The largest")},l(f){h=we(f,"The largest")},m(f,y){ke(f,h,y)},p:jo,d(f){f&&O(h)}}}function Ty(c){let h,f,y,v;return f=new yf({props:{$$slots:{default:[h1]},$$scope:{ctx:c}}}),{c(){h=ce("span"),Gr(f.$$.fragment),y=xe(" since 2011 Census"),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);Kr(f.$$.fragment,a),y=we(a," since 2011 Census"),a.forEach(O),this.h()},h(){U(h,"class","text-small ")},m(x,a){ke(x,h,a),Xr(f,h,null),N(h,y),v=!0},p(x,a){const A={};a[0]&2|a[1]&8192&&(A.$$scope={dirty:a,ctx:x}),f.$set(A)},i(x){v||(bt(f.$$.fragment,x),v=!0)},o(x){Ft(f.$$.fragment,x),v=!1},d(x){x&&O(h),Hr(f)}}}function h1(c){let h,f=or(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=ce("span"),y=xe(f),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);y=we(a,f),a.forEach(O),this.h()},h(){U(h,"class",v=rf(af(c[1].data.population.value.change.all))+" svelte-ls2yfr")},m(x,a){ke(x,h,a),N(h,y)},p(x,a){a[0]&2&&f!==(f=or(x[1].data.population.value.change.all,"%",1)+"")&&At(y,f),a[0]&2&&v!==(v=rf(af(x[1].data.population.value.change.all))+" svelte-ls2yfr")&&U(h,"class",v)},d(x){x&&O(h)}}}function Iy(c){let h,f,y,v;return f=new yf({props:{$$slots:{default:[p1]},$$scope:{ctx:c}}}),{c(){h=ce("span"),Gr(f.$$.fragment),y=xe(" of Northern Ireland households"),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);Kr(f.$$.fragment,a),y=we(a," of Northern Ireland households"),a.forEach(O),this.h()},h(){U(h,"class","text-small")},m(x,a){ke(x,h,a),Xr(f,h,null),N(h,y),v=!0},p(x,a){const A={};a[0]&6|a[1]&8192&&(A.$$scope={dirty:a,ctx:x}),f.$set(A)},i(x){v||(bt(f.$$.fragment,x),v=!0)},o(x){Ft(f.$$.fragment,x),v=!1},d(x){x&&O(h),Hr(f)}}}function p1(c){let h=(c[1].data.households.value[2021].all_households/c[2].data.households.value[2021].all_households>=.001?(c[1].data.households.value[2021].all_households/c[2].data.households.value[2021].all_households*100).toFixed(1):"<0.1")+"",f,y;return{c(){f=xe(h),y=xe("%")},l(v){f=we(v,h),y=we(v,"%")},m(v,x){ke(v,f,x),ke(v,y,x)},p(v,x){x[0]&6&&h!==(h=(v[1].data.households.value[2021].all_households/v[2].data.households.value[2021].all_households>=.001?(v[1].data.households.value[2021].all_households/v[2].data.households.value[2021].all_households*100).toFixed(1):"<0.1")+"")&&At(f,h)},d(v){v&&O(f),v&&O(y)}}}function Ay(c){let h,f,y,v;return f=new yf({props:{$$slots:{default:[f1]},$$scope:{ctx:c}}}),{c(){h=ce("span"),Gr(f.$$.fragment),y=xe(" since 2011 Census"),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);Kr(f.$$.fragment,a),y=we(a," since 2011 Census"),a.forEach(O),this.h()},h(){U(h,"class","text-small")},m(x,a){ke(x,h,a),Xr(f,h,null),N(h,y),v=!0},p(x,a){const A={};a[0]&2|a[1]&8192&&(A.$$scope={dirty:a,ctx:x}),f.$set(A)},i(x){v||(bt(f.$$.fragment,x),v=!0)},o(x){Ft(f.$$.fragment,x),v=!1},d(x){x&&O(h),Hr(f)}}}function f1(c){let h,f=or(c[1].data.households.value.change.all_households,"%",1)+"",y,v;return{c(){h=ce("span"),y=xe(f),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);y=we(a,f),a.forEach(O),this.h()},h(){U(h,"class",v=rf(af(c[1].data.households.value.change.all_households))+" svelte-ls2yfr")},m(x,a){ke(x,h,a),N(h,y)},p(x,a){a[0]&2&&f!==(f=or(x[1].data.households.value.change.all_households,"%",1)+"")&&At(y,f),a[0]&2&&v!==(v=rf(af(x[1].data.households.value.change.all_households))+" svelte-ls2yfr")&&U(h,"class",v)},d(x){x&&O(h)}}}function zy(c){let h,f,y,v,x;return{c(){h=ce("div"),f=Eo("svg"),y=Eo("rect"),v=Je(),x=xe(c[11]),this.h()},l(a){h=he(a,"DIV",{class:!0});var A=fe(h);f=ko(A,"svg",{width:!0,height:!0,style:!0});var I=fe(f);y=ko(I,"rect",{width:!0,height:!0,style:!0});var R=fe(y);R.forEach(O),I.forEach(O),v=Ye(A),x=we(A,c[11]),A.forEach(O),this.h()},h(){U(y,"width","25"),U(y,"height","4"),Ce(y,"fill","#CEDC20"),U(f,"width","25"),U(f,"height","4"),Ce(f,"display","inline-block"),Ce(f,"margin-bottom","3px"),U(h,"class","text-small muted; ")},m(a,A){ke(a,h,A),N(h,f),N(f,y),N(h,v),N(h,x)},p(a,A){A[0]&2048&&At(x,a[11])},d(a){a&&O(h)}}}function d1(c){let h,f,y=or(c[1].data.age.perc[2021].a0to14,"%",0)+"",v,x,a,A,I,R,B=or(c[1].data.age.perc[2021].a15to39,"%",0)+"",K,j,H,de,Me,Se,He=or(c[1].data.age.perc[2021].a40to64,"%",0)+"",Ue,Rt,kt,ut,We,tr,Gt=or(c[1].data.age.perc[2021].a65plus,"%",0)+"",St,jt,Ke,Lt=c[1].parents[0]&&Py(c),mt=c[1].parents[0]&&Cy(c),yt=c[1].parents[0]&&My(c),De=c[1].parents[0]&&Dy(c);return{c(){h=ce("span"),f=xe("0-14 years "),v=xe(y),x=Je(),Lt&&Lt.c(),a=ce("br"),A=Je(),I=ce("span"),R=xe("15-39 years "),K=xe(B),j=Je(),mt&&mt.c(),H=ce("br"),de=Je(),Me=ce("span"),Se=xe("40-64 years "),Ue=xe(He),Rt=Je(),yt&&yt.c(),kt=ce("br"),ut=Je(),We=ce("span"),tr=xe("65+ years "),St=xe(Gt),jt=Je(),De&&De.c(),Ke=Ei(),this.h()},l(Ne){h=he(Ne,"SPAN",{class:!0});var Tt=fe(h);f=we(Tt,"0-14 years "),v=we(Tt,y),x=Ye(Tt),Tt.forEach(O),Lt&&Lt.l(Ne),a=he(Ne,"BR",{}),A=Ye(Ne),I=he(Ne,"SPAN",{class:!0});var fr=fe(I);R=we(fr,"15-39 years "),K=we(fr,B),j=Ye(fr),fr.forEach(O),mt&&mt.l(Ne),H=he(Ne,"BR",{}),de=Ye(Ne),Me=he(Ne,"SPAN",{class:!0});var Kt=fe(Me);Se=we(Kt,"40-64 years "),Ue=we(Kt,He),Rt=Ye(Kt),Kt.forEach(O),yt&&yt.l(Ne),kt=he(Ne,"BR",{}),ut=Ye(Ne),We=he(Ne,"SPAN",{class:!0});var Ge=fe(We);tr=we(Ge,"65+ years "),St=we(Ge,Gt),jt=Ye(Ge),Ge.forEach(O),De&&De.l(Ne),Ke=Ei(),this.h()},h(){U(h,"class","text-small"),U(I,"class","text-small"),U(Me,"class","text-small"),U(We,"class","text-small")},m(Ne,Tt){ke(Ne,h,Tt),N(h,f),N(h,v),N(h,x),Lt&&Lt.m(Ne,Tt),ke(Ne,a,Tt),ke(Ne,A,Tt),ke(Ne,I,Tt),N(I,R),N(I,K),N(I,j),mt&&mt.m(Ne,Tt),ke(Ne,H,Tt),ke(Ne,de,Tt),ke(Ne,Me,Tt),N(Me,Se),N(Me,Ue),N(Me,Rt),yt&&yt.m(Ne,Tt),ke(Ne,kt,Tt),ke(Ne,ut,Tt),ke(Ne,We,Tt),N(We,tr),N(We,St),N(We,jt),De&&De.m(Ne,Tt),ke(Ne,Ke,Tt)},p(Ne,Tt){Tt[0]&2&&y!==(y=or(Ne[1].data.age.perc[2021].a0to14,"%",0)+"")&&At(v,y),Ne[1].parents[0]?Lt?Lt.p(Ne,Tt):(Lt=Py(Ne),Lt.c(),Lt.m(a.parentNode,a)):Lt&&(Lt.d(1),Lt=null),Tt[0]&2&&B!==(B=or(Ne[1].data.age.perc[2021].a15to39,"%",0)+"")&&At(K,B),Ne[1].parents[0]?mt?mt.p(Ne,Tt):(mt=Cy(Ne),mt.c(),mt.m(H.parentNode,H)):mt&&(mt.d(1),mt=null),Tt[0]&2&&He!==(He=or(Ne[1].data.age.perc[2021].a40to64,"%",0)+"")&&At(Ue,He),Ne[1].parents[0]?yt?yt.p(Ne,Tt):(yt=My(Ne),yt.c(),yt.m(kt.parentNode,kt)):yt&&(yt.d(1),yt=null),Tt[0]&2&&Gt!==(Gt=or(Ne[1].data.age.perc[2021].a65plus,"%",0)+"")&&At(St,Gt),Ne[1].parents[0]?De?De.p(Ne,Tt):(De=Dy(Ne),De.c(),De.m(Ke.parentNode,Ke)):De&&(De.d(1),De=null)},d(Ne){Ne&&O(h),Lt&&Lt.d(Ne),Ne&&O(a),Ne&&O(A),Ne&&O(I),mt&&mt.d(Ne),Ne&&O(H),Ne&&O(de),Ne&&O(Me),yt&&yt.d(Ne),Ne&&O(kt),Ne&&O(ut),Ne&&O(We),De&&De.d(Ne),Ne&&O(Ke)}}}function m1(c){let h,f,y=or(c[1].data.age.perc[2021].a0to14,"%",0)+"",v,x,a,A,I=or(c[1].data.age.perc[2011].a0to14,"%",0)+"",R,B,K,j,H,de,Me=or(c[1].data.age.perc[2021].a15to39,"%",0)+"",Se,He,Ue,Rt,kt=or(c[1].data.age.perc[2011].a15to39,"%",0)+"",ut,We,tr,Gt,St,jt,Ke=or(c[1].data.age.perc[2021].a40to64,"%",0)+"",Lt,mt,yt,De,Ne=or(c[1].data.age.perc[2011].a40to64,"%",0)+"",Tt,fr,Kt,Ge,et,ar,vr=or(c[1].data.age.perc[2021].a65plus,"%",0)+"",di,Qr,Vr,Ur,ui=or(c[1].data.age.perc[2011].a65plus,"%",0)+"",xt,sr;return{c(){h=ce("span"),f=xe("0-14 years "),v=xe(y),x=Je(),a=ce("span"),A=xe("(2011 "),R=xe(I),B=xe(")"),K=ce("br"),j=Je(),H=ce("span"),de=xe("15-39 years "),Se=xe(Me),He=Je(),Ue=ce("span"),Rt=xe("(2011 "),ut=xe(kt),We=xe(")"),tr=ce("br"),Gt=Je(),St=ce("span"),jt=xe("40-64 years "),Lt=xe(Ke),mt=Je(),yt=ce("span"),De=xe("(2011 "),Tt=xe(Ne),fr=xe(")"),Kt=ce("br"),Ge=Je(),et=ce("span"),ar=xe("65+ years "),di=xe(vr),Qr=Je(),Vr=ce("span"),Ur=xe("(2011 "),xt=xe(ui),sr=xe(")"),this.h()},l(Et){h=he(Et,"SPAN",{class:!0});var Ht=fe(h);f=we(Ht,"0-14 years "),v=we(Ht,y),x=Ye(Ht),Ht.forEach(O),a=he(Et,"SPAN",{class:!0,style:!0});var Nt=fe(a);A=we(Nt,"(2011 "),R=we(Nt,I),B=we(Nt,")"),Nt.forEach(O),K=he(Et,"BR",{}),j=Ye(Et),H=he(Et,"SPAN",{class:!0});var nn=fe(H);de=we(nn,"15-39 years "),Se=we(nn,Me),He=Ye(nn),nn.forEach(O),Ue=he(Et,"SPAN",{class:!0,style:!0});var ii=fe(Ue);Rt=we(ii,"(2011 "),ut=we(ii,kt),We=we(ii,")"),ii.forEach(O),tr=he(Et,"BR",{}),Gt=Ye(Et),St=he(Et,"SPAN",{class:!0});var dr=fe(St);jt=we(dr,"40-64 years "),Lt=we(dr,Ke),mt=Ye(dr),dr.forEach(O),yt=he(Et,"SPAN",{class:!0,style:!0});var ni=fe(yt);De=we(ni,"(2011 "),Tt=we(ni,Ne),fr=we(ni,")"),ni.forEach(O),Kt=he(Et,"BR",{}),Ge=Ye(Et),et=he(Et,"SPAN",{class:!0});var $r=fe(et);ar=we($r,"65+ years "),di=we($r,vr),Qr=Ye($r),$r.forEach(O),Vr=he(Et,"SPAN",{class:!0,style:!0});var on=fe(Vr);Ur=we(on,"(2011 "),xt=we(on,ui),sr=we(on,")"),on.forEach(O),this.h()},h(){U(h,"class","text-small"),U(a,"class","text-small"),Ce(a,"color","#3878C5"),U(H,"class","text-small"),U(Ue,"class","text-small"),Ce(Ue,"color","#3878C5"),U(St,"class","text-small"),U(yt,"class","text-small"),Ce(yt,"color","#3878C5"),U(et,"class","text-small"),U(Vr,"class","text-small"),Ce(Vr,"color","#3878C5")},m(Et,Ht){ke(Et,h,Ht),N(h,f),N(h,v),N(h,x),ke(Et,a,Ht),N(a,A),N(a,R),N(a,B),ke(Et,K,Ht),ke(Et,j,Ht),ke(Et,H,Ht),N(H,de),N(H,Se),N(H,He),ke(Et,Ue,Ht),N(Ue,Rt),N(Ue,ut),N(Ue,We),ke(Et,tr,Ht),ke(Et,Gt,Ht),ke(Et,St,Ht),N(St,jt),N(St,Lt),N(St,mt),ke(Et,yt,Ht),N(yt,De),N(yt,Tt),N(yt,fr),ke(Et,Kt,Ht),ke(Et,Ge,Ht),ke(Et,et,Ht),N(et,ar),N(et,di),N(et,Qr),ke(Et,Vr,Ht),N(Vr,Ur),N(Vr,xt),N(Vr,sr)},p(Et,Ht){Ht[0]&2&&y!==(y=or(Et[1].data.age.perc[2021].a0to14,"%",0)+"")&&At(v,y),Ht[0]&2&&I!==(I=or(Et[1].data.age.perc[2011].a0to14,"%",0)+"")&&At(R,I),Ht[0]&2&&Me!==(Me=or(Et[1].data.age.perc[2021].a15to39,"%",0)+"")&&At(Se,Me),Ht[0]&2&&kt!==(kt=or(Et[1].data.age.perc[2011].a15to39,"%",0)+"")&&At(ut,kt),Ht[0]&2&&Ke!==(Ke=or(Et[1].data.age.perc[2021].a40to64,"%",0)+"")&&At(Lt,Ke),Ht[0]&2&&Ne!==(Ne=or(Et[1].data.age.perc[2011].a40to64,"%",0)+"")&&At(Tt,Ne),Ht[0]&2&&vr!==(vr=or(Et[1].data.age.perc[2021].a65plus,"%",0)+"")&&At(di,vr),Ht[0]&2&&ui!==(ui=or(Et[1].data.age.perc[2011].a65plus,"%",0)+"")&&At(xt,ui)},d(Et){Et&&O(h),Et&&O(a),Et&&O(K),Et&&O(j),Et&&O(H),Et&&O(Ue),Et&&O(tr),Et&&O(Gt),Et&&O(St),Et&&O(yt),Et&&O(Kt),Et&&O(Ge),Et&&O(et),Et&&O(Vr)}}}function y1(c){let h,f,y=or(c[1].data.age.perc[2021].a0to14,"%",0)+"",v,x,a,A,I,R,B,K=or(c[1].data.age.perc[2021].a15to39,"%",0)+"",j,H,de,Me,Se,He,Ue,Rt=or(c[1].data.age.perc[2021].a40to64,"%",0)+"",kt,ut,We,tr,Gt,St,jt,Ke=or(c[1].data.age.perc[2021].a65plus,"%",0)+"",Lt,mt,yt;return{c(){h=ce("span"),f=xe("0-14 years "),v=xe(y),x=Je(),a=ce("span"),A=ce("br"),I=Je(),R=ce("span"),B=xe("15-39 years "),j=xe(K),H=Je(),de=ce("span"),Me=ce("br"),Se=Je(),He=ce("span"),Ue=xe("40-64 years "),kt=xe(Rt),ut=Je(),We=ce("span"),tr=ce("br"),Gt=Je(),St=ce("span"),jt=xe("65+ years "),Lt=xe(Ke),mt=Je(),yt=ce("span"),this.h()},l(De){h=he(De,"SPAN",{class:!0});var Ne=fe(h);f=we(Ne,"0-14 years "),v=we(Ne,y),x=Ye(Ne),Ne.forEach(O),a=he(De,"SPAN",{class:!0,style:!0}),fe(a).forEach(O),A=he(De,"BR",{}),I=Ye(De),R=he(De,"SPAN",{class:!0});var Tt=fe(R);B=we(Tt,"15-39 years "),j=we(Tt,K),H=Ye(Tt),Tt.forEach(O),de=he(De,"SPAN",{class:!0,style:!0}),fe(de).forEach(O),Me=he(De,"BR",{}),Se=Ye(De),He=he(De,"SPAN",{class:!0});var fr=fe(He);Ue=we(fr,"40-64 years "),kt=we(fr,Rt),ut=Ye(fr),fr.forEach(O),We=he(De,"SPAN",{class:!0,style:!0}),fe(We).forEach(O),tr=he(De,"BR",{}),Gt=Ye(De),St=he(De,"SPAN",{class:!0});var Kt=fe(St);jt=we(Kt,"65+ years "),Lt=we(Kt,Ke),mt=Ye(Kt),Kt.forEach(O),yt=he(De,"SPAN",{class:!0,style:!0}),fe(yt).forEach(O),this.h()},h(){U(h,"class","text-small"),U(a,"class","text-small"),Ce(a,"color","#3878C5"),U(R,"class","text-small"),U(de,"class","text-small"),Ce(de,"color","#3878C5"),U(He,"class","text-small"),U(We,"class","text-small"),Ce(We,"color","#3878C5"),U(St,"class","text-small"),U(yt,"class","text-small"),Ce(yt,"color","#3878C5")},m(De,Ne){ke(De,h,Ne),N(h,f),N(h,v),N(h,x),ke(De,a,Ne),ke(De,A,Ne),ke(De,I,Ne),ke(De,R,Ne),N(R,B),N(R,j),N(R,H),ke(De,de,Ne),ke(De,Me,Ne),ke(De,Se,Ne),ke(De,He,Ne),N(He,Ue),N(He,kt),N(He,ut),ke(De,We,Ne),ke(De,tr,Ne),ke(De,Gt,Ne),ke(De,St,Ne),N(St,jt),N(St,Lt),N(St,mt),ke(De,yt,Ne)},p(De,Ne){Ne[0]&2&&y!==(y=or(De[1].data.age.perc[2021].a0to14,"%",0)+"")&&At(v,y),Ne[0]&2&&K!==(K=or(De[1].data.age.perc[2021].a15to39,"%",0)+"")&&At(j,K),Ne[0]&2&&Rt!==(Rt=or(De[1].data.age.perc[2021].a40to64,"%",0)+"")&&At(kt,Rt),Ne[0]&2&&Ke!==(Ke=or(De[1].data.age.perc[2021].a65plus,"%",0)+"")&&At(Lt,Ke)},d(De){De&&O(h),De&&O(a),De&&O(A),De&&O(I),De&&O(R),De&&O(de),De&&O(Me),De&&O(Se),De&&O(He),De&&O(We),De&&O(tr),De&&O(Gt),De&&O(St),De&&O(yt)}}}function Py(c){let h,f,y=or(c[2].data.age.perc[2021].a0to14,"%",0)+"",v,x;return{c(){h=ce("span"),f=xe("(NI "),v=xe(y),x=xe(")"),this.h()},l(a){h=he(a,"SPAN",{class:!0,style:!0});var A=fe(h);f=we(A,"(NI "),v=we(A,y),x=we(A,")"),A.forEach(O),this.h()},h(){U(h,"class","text-small"),Ce(h,"color","#3878C5")},m(a,A){ke(a,h,A),N(h,f),N(h,v),N(h,x)},p(a,A){A[0]&4&&y!==(y=or(a[2].data.age.perc[2021].a0to14,"%",0)+"")&&At(v,y)},d(a){a&&O(h)}}}function Cy(c){let h,f,y=or(c[2].data.age.perc[2021].a15to39,"%",0)+"",v,x;return{c(){h=ce("span"),f=xe("(NI "),v=xe(y),x=xe(")"),this.h()},l(a){h=he(a,"SPAN",{class:!0,style:!0});var A=fe(h);f=we(A,"(NI "),v=we(A,y),x=we(A,")"),A.forEach(O),this.h()},h(){U(h,"class","text-small"),Ce(h,"color","#3878C5")},m(a,A){ke(a,h,A),N(h,f),N(h,v),N(h,x)},p(a,A){A[0]&4&&y!==(y=or(a[2].data.age.perc[2021].a15to39,"%",0)+"")&&At(v,y)},d(a){a&&O(h)}}}function My(c){let h,f,y=or(c[2].data.age.perc[2021].a40to64,"%",0)+"",v,x;return{c(){h=ce("span"),f=xe("(NI "),v=xe(y),x=xe(")"),this.h()},l(a){h=he(a,"SPAN",{class:!0,style:!0});var A=fe(h);f=we(A,"(NI "),v=we(A,y),x=we(A,")"),A.forEach(O),this.h()},h(){U(h,"class","text-small"),Ce(h,"color","#3878C5")},m(a,A){ke(a,h,A),N(h,f),N(h,v),N(h,x)},p(a,A){A[0]&4&&y!==(y=or(a[2].data.age.perc[2021].a40to64,"%",0)+"")&&At(v,y)},d(a){a&&O(h)}}}function Dy(c){let h,f,y=or(c[2].data.age.perc[2021].a65plus,"%",0)+"",v,x;return{c(){h=ce("span"),f=xe("(NI "),v=xe(y),x=xe(")"),this.h()},l(a){h=he(a,"SPAN",{class:!0,style:!0});var A=fe(h);f=we(A,"(NI "),v=we(A,y),x=we(A,")"),A.forEach(O),this.h()},h(){U(h,"class","text-small"),Ce(h,"color","#3878C5")},m(a,A){ke(a,h,A),N(h,f),N(h,v),N(h,x)},p(a,A){A[0]&4&&y!==(y=or(a[2].data.age.perc[2021].a65plus,"%",0)+"")&&At(v,y)},d(a){a&&O(h)}}}function g1(c){let h,f,y,v,x,a;const A=[Ua[c[38]],{id:c[38]+"-fill"},{type:"fill"},{isChild:c[8][c[38]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[38]||c[7].childType==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Br["fill-self"]:c[7].childType==c[38]?Br["fill-child"]:Br.fill}];let I={};for(let H=0;H<A.length;H+=1)I=ku(I,A[H]);h=new Oc({props:I}),h.$on("select",c[13]);const R=[Ua[c[38]],{id:c[38]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[38]||c[7].childType==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Br["line-active"]:c[7].childType==c[38]?Br["line-child"]:Br.line}];let B={};for(let H=0;H<R.length;H+=1)B=ku(B,R[H]);y=new Oc({props:B});const K=[Ua[c[38]],{id:c[38]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Br["line-self"]:Br.line}];let j={};for(let H=0;H<K.length;H+=1)j=ku(j,K[H]);return x=new Oc({props:j}),{c(){Gr(h.$$.fragment),f=Je(),Gr(y.$$.fragment),v=Je(),Gr(x.$$.fragment)},l(H){Kr(h.$$.fragment,H),f=Ye(H),Kr(y.$$.fragment,H),v=Ye(H),Kr(x.$$.fragment,H)},m(H,de){Xr(h,H,de),ke(H,f,de),Xr(y,H,de),ke(H,v,de),Xr(x,H,de),a=!0},p(H,de){const Me=de[0]&384?Tu(A,[de&0&&Iu(Ua[H[38]]),A[1],A[2],de[0]&256&&{isChild:H[8][H[38]]},A[4],de[0]&128&&{selected:H[7].selected},A[6],de[0]&128&&{highlighted:H[7].highlighted},A[8],de[0]&128&&{hovered:H[7].hovered},de[0]&128&&{layout:{visibility:H[7].type==H[38]||H[7].childType==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Br["fill-self"]:H[7].childType==H[38]?Br["fill-child"]:Br.fill}]):{};h.$set(Me);const Se=de[0]&128?Tu(R,[de&0&&Iu(Ua[H[38]]),R[1],R[2],de[0]&128&&{selected:H[7].selected},R[4],de[0]&128&&{highlighted:H[7].highlighted},de[0]&128&&{layout:{visibility:H[7].type==H[38]||H[7].childType==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Br["line-active"]:H[7].childType==H[38]?Br["line-child"]:Br.line}]):{};y.$set(Se);const He=de[0]&128?Tu(K,[de&0&&Iu(Ua[H[38]]),K[1],K[2],de[0]&128&&{selected:H[7].selected},de[0]&128&&{layout:{visibility:H[7].type==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Br["line-self"]:Br.line}]):{};x.$set(He)},i(H){a||(bt(h.$$.fragment,H),bt(y.$$.fragment,H),bt(x.$$.fragment,H),a=!0)},o(H){Ft(h.$$.fragment,H),Ft(y.$$.fragment,H),Ft(x.$$.fragment,H),a=!1},d(H){Hr(h,H),H&&O(f),Hr(y,H),H&&O(v),Hr(x,H)}}}function Ly(c){let h,f;const y=[of[c[38]]];let v={$$slots:{default:[g1]},$$scope:{ctx:c}};for(let x=0;x<y.length;x+=1)v=ku(v,y[x]);return h=new pg({props:v}),{c(){Gr(h.$$.fragment)},l(x){Kr(h.$$.fragment,x)},m(x,a){Xr(h,x,a),f=!0},p(x,a){const A=a&0?Tu(y,[Iu(of[x[38]])]):{};a[0]&384|a[1]&8192&&(A.$$scope={dirty:a,ctx:x}),h.$set(A)},i(x){f||(bt(h.$$.fragment,x),f=!0)},o(x){Ft(h.$$.fragment,x),f=!1},d(x){Hr(h,x)}}}function Ry(c){let h,f,y,v,x,a;const A=[Ua[c[38]],{id:c[38]+"-fill"},{type:"fill"},{isChild:c[8][c[38]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[38]||c[7].childType==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Br["fill-self"]:c[7].childType==c[38]?Br["fill-child"]:Br.fill}];let I={};for(let H=0;H<A.length;H+=1)I=ku(I,A[H]);h=new Oc({props:I}),h.$on("select",c[13]);const R=[Ua[c[38]],{id:c[38]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[38]||c[7].childType==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Br["line-active"]:c[7].childType==c[38]?Br["line-child"]:Br.line}];let B={};for(let H=0;H<R.length;H+=1)B=ku(B,R[H]);y=new Oc({props:B});const K=[Ua[c[38]],{id:c[38]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[38]?"visible":"none"}},{paint:c[7].type==c[38]?Br["line-self"]:Br.line}];let j={};for(let H=0;H<K.length;H+=1)j=ku(j,K[H]);return x=new Oc({props:j}),{c(){Gr(h.$$.fragment),f=Je(),Gr(y.$$.fragment),v=Je(),Gr(x.$$.fragment)},l(H){Kr(h.$$.fragment,H),f=Ye(H),Kr(y.$$.fragment,H),v=Ye(H),Kr(x.$$.fragment,H)},m(H,de){Xr(h,H,de),ke(H,f,de),Xr(y,H,de),ke(H,v,de),Xr(x,H,de),a=!0},p(H,de){const Me=de[0]&384?Tu(A,[de&0&&Iu(Ua[H[38]]),A[1],A[2],de[0]&256&&{isChild:H[8][H[38]]},A[4],de[0]&128&&{selected:H[7].selected},A[6],de[0]&128&&{highlighted:H[7].highlighted},A[8],de[0]&128&&{hovered:H[7].hovered},de[0]&128&&{layout:{visibility:H[7].type==H[38]||H[7].childType==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Br["fill-self"]:H[7].childType==H[38]?Br["fill-child"]:Br.fill}]):{};h.$set(Me);const Se=de[0]&128?Tu(R,[de&0&&Iu(Ua[H[38]]),R[1],R[2],de[0]&128&&{selected:H[7].selected},R[4],de[0]&128&&{highlighted:H[7].highlighted},de[0]&128&&{layout:{visibility:H[7].type==H[38]||H[7].childType==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Br["line-active"]:H[7].childType==H[38]?Br["line-child"]:Br.line}]):{};y.$set(Se);const He=de[0]&128?Tu(K,[de&0&&Iu(Ua[H[38]]),K[1],K[2],de[0]&128&&{selected:H[7].selected},de[0]&128&&{layout:{visibility:H[7].type==H[38]?"visible":"none"}},de[0]&128&&{paint:H[7].type==H[38]?Br["line-self"]:Br.line}]):{};x.$set(He)},i(H){a||(bt(h.$$.fragment,H),bt(y.$$.fragment,H),bt(x.$$.fragment,H),a=!0)},o(H){Ft(h.$$.fragment,H),Ft(y.$$.fragment,H),Ft(x.$$.fragment,H),a=!1},d(H){Hr(h,H),H&&O(f),Hr(y,H),H&&O(v),Hr(x,H)}}}function _1(c){let h,f,y=["lgd"],v=[];for(let a=0;a<1;a+=1)v[a]=Ry(_y(c,y,a));const x=a=>Ft(v[a],1,1,()=>{v[a]=null});return{c(){for(let a=0;a<1;a+=1)v[a].c();h=Ei()},l(a){for(let A=0;A<1;A+=1)v[A].l(a);h=Ei()},m(a,A){for(let I=0;I<1;I+=1)v[I].m(a,A);ke(a,h,A),f=!0},p(a,A){if(A[0]&8576){y=["lgd"];let I;for(I=0;I<1;I+=1){const R=_y(a,y,I);v[I]?(v[I].p(R,A),bt(v[I],1)):(v[I]=Ry(R),v[I].c(),bt(v[I],1),v[I].m(h.parentNode,h))}for(Ls(),I=1;I<1;I+=1)x(I);Rs()}},i(a){if(!f){for(let A=0;A<1;A+=1)bt(v[A]);f=!0}},o(a){v=v.filter(Boolean);for(let A=0;A<1;A+=1)Ft(v[A]);f=!1},d(a){Ys(v,a),a&&O(h)}}}function v1(c){let h,f,y,v=["dea"],x=[];for(let R=0;R<1;R+=1)x[R]=Ly(vy(c,v,R));const a=R=>Ft(x[R],1,1,()=>{x[R]=null}),A=[of.crd];let I={$$slots:{default:[_1]},$$scope:{ctx:c}};for(let R=0;R<A.length;R+=1)I=ku(I,A[R]);return f=new pg({props:I}),{c(){for(let R=0;R<1;R+=1)x[R].c();h=Je(),Gr(f.$$.fragment)},l(R){for(let B=0;B<1;B+=1)x[B].l(R);h=Ye(R),Kr(f.$$.fragment,R)},m(R,B){for(let K=0;K<1;K+=1)x[K].m(R,B);ke(R,h,B),Xr(f,R,B),y=!0},p(R,B){if(B[0]&8576){v=["dea"];let j;for(j=0;j<1;j+=1){const H=vy(R,v,j);x[j]?(x[j].p(H,B),bt(x[j],1)):(x[j]=Ly(H),x[j].c(),bt(x[j],1),x[j].m(h.parentNode,h))}for(Ls(),j=1;j<1;j+=1)a(j);Rs()}const K=B&0?Tu(A,[Iu(of.crd)]):{};B[0]&384|B[1]&8192&&(K.$$scope={dirty:B,ctx:R}),f.$set(K)},i(R){if(!y){for(let B=0;B<1;B+=1)bt(x[B]);bt(f.$$.fragment,R),y=!0}},o(R){x=x.filter(Boolean);for(let B=0;B<1;B+=1)Ft(x[B]);Ft(f.$$.fragment,R),y=!1},d(R){Ys(x,R),R&&O(h),Hr(f,R)}}}function By(c){let h,f=[...c[1].parents].reverse(),y=[];for(let v=0;v<f.length;v+=1)y[v]=Oy(gy(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=Ei()},l(v){for(let x=0;x<y.length;x+=1)y[x].l(v);h=Ei()},m(v,x){for(let a=0;a<y.length;a+=1)y[a].m(v,x);ke(v,h,x)},p(v,x){if(x[0]&2){f=[...v[1].parents].reverse();let a;for(a=0;a<f.length;a+=1){const A=gy(v,f,a);y[a]?y[a].p(A,x):(y[a]=Oy(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){Ys(y,v),v&&O(h)}}}function Oy(c){let h,f=c[1].name+"",y,v,x,a,A=c[36].name+"",I,R;return{c(){h=ce("span"),y=xe(f),v=xe(" is located in "),x=ce("span"),a=ce("a"),I=xe(A),this.h()},l(B){h=he(B,"SPAN",{});var K=fe(h);y=we(K,f),v=we(K," is located in "),K.forEach(O),x=he(B,"SPAN",{class:!0});var j=fe(x);a=he(j,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var H=fe(a);I=we(H,A),H.forEach(O),j.forEach(O),this.h()},h(){U(a,"href",R=xl+"/"+c[36].code+"/"),U(a,"sveltekit:noscroll",""),U(a,"class","svelte-ls2yfr"),U(x,"class","text-bold")},m(B,K){ke(B,h,K),N(h,y),N(h,v),ke(B,x,K),N(x,a),N(a,I)},p(B,K){K[0]&2&&f!==(f=B[1].name+"")&&At(y,f),K[0]&2&&A!==(A=B[36].name+"")&&At(I,A),K[0]&2&&R!==(R=xl+"/"+B[36].code+"/")&&U(a,"href",R)},d(B){B&&O(h),B&&O(x)}}}function b1(c){let h,f,y=c[1].name+"",v;return{c(){h=ce("span"),f=xe("No areas within "),v=xe(y),this.h()},l(x){h=he(x,"SPAN",{class:!0});var a=fe(h);f=we(a,"No areas within "),v=we(a,y),a.forEach(O),this.h()},h(){U(h,"class","muted")},m(x,a){ke(x,h,a),N(h,f),N(h,v)},p(x,a){a[0]&2&&y!==(y=x[1].name+"")&&At(v,y)},d(x){x&&O(h)}}}function x1(c){let h,f,y,v,x,a=c[2].children,A=[];for(let I=0;I<a.length;I+=1)A[I]=Fy(yy(c,a,I));return{c(){h=ce("span"),f=xe("Districts within Northern Ireland"),y=ce("br"),v=Je();for(let I=0;I<A.length;I+=1)A[I].c();x=Ei(),this.h()},l(I){h=he(I,"SPAN",{class:!0});var R=fe(h);f=we(R,"Districts within Northern Ireland"),R.forEach(O),y=he(I,"BR",{}),v=Ye(I);for(let B=0;B<A.length;B+=1)A[B].l(I);x=Ei(),this.h()},h(){U(h,"class","text-bold")},m(I,R){ke(I,h,R),N(h,f),ke(I,y,R),ke(I,v,R);for(let B=0;B<A.length;B+=1)A[B].m(I,R);ke(I,x,R)},p(I,R){if(R[0]&4){a=I[2].children;let B;for(B=0;B<a.length;B+=1){const K=yy(I,a,B);A[B]?A[B].p(K,R):(A[B]=Fy(K),A[B].c(),A[B].m(x.parentNode,x))}for(;B<A.length;B+=1)A[B].d(1);A.length=a.length}},d(I){I&&O(h),I&&O(y),I&&O(v),Ys(A,I),I&&O(x)}}}function Fy(c){let h,f,y=c[33].name+"",v,x,a=(c[35]<c[2].children.length-1,""),A;return{c(){h=ce("li"),f=ce("a"),v=xe(y),A=xe(a),this.h()},l(I){h=he(I,"LI",{style:!0});var R=fe(h);f=he(R,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var B=fe(f);v=we(B,y),B.forEach(O),A=we(R,a),R.forEach(O),this.h()},h(){U(f,"href",x=xl+"/"+c[33].code+"/"),U(f,"sveltekit:noscroll",""),U(f,"class","svelte-ls2yfr"),Ce(h,"margin","3px"),Ce(h,"display","block"),Ce(h,"line-height","20px"),Ce(h,"padding-bottom","5px")},m(I,R){ke(I,h,R),N(h,f),N(f,v),N(h,A)},p(I,R){R[0]&4&&y!==(y=I[33].name+"")&&At(v,y),R[0]&4&&x!==(x=xl+"/"+I[33].code+"/")&&U(f,"href",x),R[0]&4&&a!==(a=(I[35]<I[2].children.length-1,""))&&At(A,a)},d(I){I&&O(h)}}}function w1(c){let h,f,y=c[1]&&c[2]&&xy(c);return{c(){y&&y.c(),h=Ei()},l(v){y&&y.l(v),h=Ei()},m(v,x){y&&y.m(v,x),ke(v,h,x),f=!0},p(v,x){v[1]&&v[2]?y?(y.p(v,x),x[0]&6&&bt(y,1)):(y=xy(v),y.c(),bt(y,1),y.m(h.parentNode,h)):y&&(Ls(),Ft(y,1,1,()=>{y=null}),Rs())},i(v){f||(bt(y),f=!0)},o(v){Ft(y),f=!1},d(v){y&&y.d(v),v&&O(h)}}}function S1(c){let h,f,y,v,x,a,A,I,R,B,K,j,H,de;return document.title=h=c[1].name+" Census Data",H=new Wg({props:{column:"wide",$$slots:{default:[w1]},$$scope:{ctx:c}}}),{c(){f=ce("meta"),y=ce("meta"),x=ce("meta"),a=ce("meta"),I=ce("meta"),B=ce("meta"),j=Je(),Gr(H.$$.fragment),this.h()},l(Me){const Se=Kg('[data-svelte="svelte-wtlqhu"]',document.head);f=he(Se,"META",{name:!0,content:!0}),y=he(Se,"META",{property:!0,content:!0}),x=he(Se,"META",{property:!0,content:!0}),a=he(Se,"META",{property:!0,content:!0}),I=he(Se,"META",{property:!0,content:!0}),B=he(Se,"META",{name:!0,content:!0}),Se.forEach(O),j=Ye(Me),Kr(H.$$.fragment,Me),this.h()},h(){U(f,"name","description"),U(f,"content",""),U(y,"property","og:title"),U(y,"content",v=c[1].name+" Census Data"),U(x,"property","og:type"),U(x,"content","website"),U(a,"property","og:url"),U(a,"content",A=nf.base+"/"+c[1].code+"/"),U(I,"property","og:description"),U(I,"content",R="Explore census data for "+c[1].name+"."),U(B,"name","description"),U(B,"content",K="Explore census data for "+c[1].name+".")},m(Me,Se){N(document.head,f),N(document.head,y),N(document.head,x),N(document.head,a),N(document.head,I),N(document.head,B),ke(Me,j,Se),Xr(H,Me,Se),de=!0},p(Me,Se){(!de||Se[0]&2)&&h!==(h=Me[1].name+" Census Data")&&(document.title=h),(!de||Se[0]&2&&v!==(v=Me[1].name+" Census Data"))&&U(y,"content",v),(!de||Se[0]&2&&A!==(A=nf.base+"/"+Me[1].code+"/"))&&U(a,"content",A),(!de||Se[0]&2&&R!==(R="Explore census data for "+Me[1].name+"."))&&U(I,"content",R),(!de||Se[0]&2&&K!==(K="Explore census data for "+Me[1].name+"."))&&U(B,"content",K);const He={};Se[0]&4095|Se[1]&8192&&(He.$$scope={dirty:Se,ctx:Me}),H.$set(He)},i(Me){de||(bt(H.$$.fragment,Me),de=!0)},o(Me){Ft(H.$$.fragment,Me),de=!1},d(Me){O(f),O(y),O(x),O(a),O(I),O(B),Me&&O(j),Hr(H,Me)}}}const z1=!0;async function Ny(c,h){return await(await h(nf.places+c+".json")).json()}async function P1({params:c,fetch:h}){let f=c.code,y=await o_(nf.options,h),v={};y.forEach(I=>v[I.code]=I.name),y.forEach(I=>{I.typepl=Vh[I.type].pl,I.typenm=Vh[I.type].name,I.typestr=v[I.parent]?`${Vh[I.type].name} within ${v[I.parent]}`:""});let x=y.sort((I,R)=>I.name.localeCompare(R.name)),a=await Ny("N92000002",h),A=await Ny(f,h);return{props:{options:x,place:A,ew:a}}}function E1(c,h,f){let y,v,x,{options:a,place:A,ew:I}=h,R,B,K=null,j=!1,H={selected:null,type:null,childType:null,highlighted:[],hovered:null},de={};Object.keys(Ua).forEach(Ge=>f(8,de[Ge]=!1,de));function Me(Ge){const et=(sr,Et)=>sr+Et;let ar=Ge[0],vr=Ge[1],di=A.data[ar][vr][2021],Qr=A.data[ar][vr][2011],Vr=I.data[ar][vr][2021],Ur=gm[ar].map(sr=>sr.code),ui=gm[ar].map(sr=>sr.label?sr.label:sr.code);return Ur.map((sr,Et)=>Array.isArray(sr)?{x:ui[Et],y:sr.map(Ht=>di[Ht]).reduce(et,0),ew:sr.map(Ht=>Vr[Ht]).reduce(et,0),prev:sr.map(Ht=>Qr[Ht]).reduce(et,0)}:{x:ui[Et],y:di[sr],ew:Vr[sr],prev:Qr[sr]})}function Se(Ge){K&&K.fitBounds(Ge,{padding:20})}function He(Ge){let et=JSON.parse(JSON.stringify(H)),ar=Ge.code,vr=Ge.type,di=Ge.children[0]?Ge.children.map(xt=>xt.code):[],Qr=Ge.type=="rgn"?"cty":di[0]?Ge.children[0].type:null;f(7,H.selected=ar,H),f(7,H.type=vr,H),f(7,H.childType=Qr,H),f(7,H.highlighted=di,H);let Vr=Object.keys(Ua),Ur=["fill-color","fill-opacity"],ui=["line-color","line-width","line-opacity"];K&&(H.type!=et.type||H.childType!=et.childType)&&(Vr.forEach(xt=>{let sr=xt==vr||Qr&&xt==Qr?"visible":"none";K.setLayoutProperty(xt+"-fill","visibility",sr),K.setLayoutProperty(xt+"-bounds","visibility",sr),Ge.parents[0]&&K.setLayoutProperty(xt+"-self","visibility",sr),f(8,de[xt]=xt==Qr,de)}),Ge.parents[0]&&(Ur.forEach(xt=>K.setPaintProperty(vr+"-fill",xt,Br[di[0]?"fill-active":"fill-self"][xt])),ui.forEach(xt=>{K.setPaintProperty(vr+"-bounds",xt,Br["line-active"][xt]),K.setPaintProperty(vr+"-self",xt,Br["line-self"][xt])})),Qr&&(Ur.forEach(xt=>K.setPaintProperty(Qr+"-fill",xt,Br["fill-child"][xt])),ui.forEach(xt=>K.setPaintProperty(Qr+"-bounds",xt,Br["line-child"][xt]))))}function Ue(Ge){He(Ge),Se(Ge.bounds)}function Rt(Ge){xm(`${xl}/${Ge.detail.code}/`,{noscroll:!0})}function kt(Ge){xm(`${xl}/${Ge.detail.value}/`,{noscroll:!0})}function ut(){f(5,B=R<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}const We=()=>f(9,x=!0),tr=()=>f(4,j=!1),Gt=()=>f(10,v=!1),St=()=>f(10,v=!0),jt=()=>f(9,x=!1),Ke=()=>f(4,j=!1),Lt=()=>f(4,j=!0),mt=()=>f(9,x=!1),yt=()=>f(10,v=!1);function De(Ge){K=Ge,f(6,K)}function Ne(){R=this.clientWidth,f(3,R)}function Tt(){R=this.clientWidth,f(3,R)}function fr(){R=this.clientWidth,f(3,R)}function Kt(){R=this.clientWidth,f(3,R)}return c.$$set=Ge=>{"options"in Ge&&f(0,a=Ge.options),"place"in Ge&&f(1,A=Ge.place),"ew"in Ge&&f(2,I=Ge.ew)},c.$$.update=()=>{c.$$.dirty[0]&8&&R&&ut(),c.$$.dirty[0]&18&&f(11,y=j?"2011 comparison":A&&A.parents[0]?"Northern Ireland comparison":null),c.$$.dirty[0]&2&&A&&Ue(A)},f(10,v=!1),f(9,x=!0),[a,A,I,R,j,B,K,H,de,x,v,y,Me,Rt,kt,We,tr,Gt,St,jt,Ke,Lt,mt,yt,De,Ne,Tt,fr,Kt]}class C1 extends qa{constructor(h){super(),Za(this,h,E1,S1,Ga,{options:0,place:1,ew:2},null,[-1,-1])}}export{C1 as default,P1 as load,z1 as prerender};
